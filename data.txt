

// CREATE PROGRAM CASE DETAILS
Function AIN49P9-CRT-PCD()
  /* CREATE PROGRAM CASE DETAILS*/

  /* DB INITIALIZATION*/
  WDB00PI();

  set H2-PRGM-CASE-DTLS empty;

  H2-PRGM-CASE-DTLS.ICI = AIN49W.WS-ICI;
  H2-PRGM-CASE-DTLS.PRGM-CASE-TYPE = "CW";
  /* --------------------PTR 5245 BEGIN --------------------------*/
  /* **MOVE '0001-01-01' TO H2-PRGM-CASE-DTLS.UNEMPLD_31ST_DT;*/
  /* --------------------PTR 5245 END -----------------------------*/
  /*  */
  AIN49P9-INS-I11();
  /*  */
  VDBCOMMON.UDUP = "Y";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN49P9-CRT-PCD


// CREATE PROGRAM CASE HISTORY
Function AIN49P9-CRT-PCH()
  /* CREATE PROGRAM CASE HSTRY*/

  /* --------------------------PTR 4613 BEGIN----------------------------*/
  /* The data sent by DCFS for a new case is true for the current month*/
  /* and next month*/
  /*  */
  AIN49W.WS-YYMM-DATE = SR-Q-DCF-REC.D-BENEFIT-START-MONTH;
  AIN49W.WS-MM = AIN49W.WS-YYMM-MM;
  /* MOVE AIN49W.WS-YYMM-YY TO AIN49W.WS-YY-CC2;*/
  AIN49W.WS-YY = AIN49W.WS-YYMM-YY;
  AIN49W.WS-DD = "01";
  /* IF AIN49W.WS-YY-CC2 > '90';*/
  /* MOVE '19' TO AIN49W.WS-YY-CC1;*/
  /* ELSE;*/
  /* MOVE '20' TO AIN49W.WS-YY-CC1;*/
  /* END;*/
  AIN49W.WS-FIL1 = "-";
  AIN49W.WS-FIL2 = "-";
  AIN49W.WS-PRGM-CASE-HST-BEG-DATE = AIN49W.WS-DATE;

  AIN49W.WS-TEMP-DATE = AIN49W.WS-DATE;
  AIN49P9-LST-DATE();
  AIN49W.WS-PRGM-CASE-HST-END-DATE = AIN49W.WS-LAST-DATE;

  AIN49P9-INS-PCH();

  AIN49W.WS-TEMP-DATE = AIN49W.WS-DATE;
  AIN49W.WS-TEMP-MM-NUM = AIN49W.WS-TEMP-MM-NUM + 1;
  if (AIN49W.WS-TEMP-MM-NUM > 12)
    AIN49W.WS-TEMP-MM-NUM = 1;
    AIN49W.WS-TEMP-CCYY-NUM = AIN49W.WS-TEMP-CCYY-NUM + 1;
  end
  AIN49W.WS-TEMP-DD = "01";

  AIN49W.WS-PRGM-CASE-HST-BEG-DATE = AIN49W.WS-TEMP-DATE;
  AIN49W.WS-PRGM-CASE-HST-END-DATE = "9999-12-31";

  AIN49P9-INS-PCH();

  /* --------------------PTR 4613 END--------------------------------*/
end // end AIN49P9-CRT-PCH


// CREATE PERSON HISTORY PROCESS
Function AIN49P9-CRT-PEH()
  /* CREATE PERSON HISTORY PROCESS*/

  /* DB INITIALIZATION*/
  WDB00PI();

  set H2-PERSON-HSTRY empty;

  H2-PERSON-HSTRY.UPI = AIN49W.WS-UPI;
  AIN49W.WS-YYMM-DATE = SR-Q-DCF-REC.D-BENEFIT-START-MONTH;
  AIN49W.WS-MM = AIN49W.WS-YYMM-MM;
  /* MOVE AIN49W.WS-YYMM-YY TO AIN49W.WS-YY-CC2;*/
  AIN49W.WS-YY = AIN49W.WS-YYMM-YY;
  /* IF AIN49W.WS-YY-CC2 > '90';*/
  /* MOVE '19' TO AIN49W.WS-YY-CC1;*/
  /* ELSE;*/
  /* MOVE '20' TO AIN49W.WS-YY-CC1;*/
  /* END;*/
  AIN49W.WS-DD = "01";
  AIN49W.WS-FIL1 = "-";
  AIN49W.WS-FIL2 = "-";
  H2-PERSON-HSTRY.PRD-BEG-DT = AIN49W.WS-DATE;
  H2-PERSON-HSTRY.US-CTZN-IND = SR-Q-DCF-REC.D-MEMB-US-CITIZEN;
  H2-PERSON-HSTRY.US-CTZN-VRFN-IND = "Y";
  H2-PERSON-HSTRY.LST-GR-VRFD-IND = "Y";
  H2-PERSON-HSTRY.PRD-END-DT = "9999-12-31";
  H2-PERSON-HSTRY.MRTL-STS-CD = "N";
  H2-PERSON-HSTRY.US-CTZN-VRFD-DT = "9999-12-31";
  H2-PERSON-HSTRY.LST-GRADE-CMPLT-DT = "9999-12-31"; /* WI 69*/
  
  H2-PERSON-HSTRY.PUB-EMP-CHD = "N";
  H2-PERSON-HSTRY.PAST-HLTH-CVRG = "N";
        
  H2-PERSON-HSTRY.CVRG-END-DT = "9999-12-31";
  H2-PERSON-HSTRY.CVRG-END-RSN = " ";
        
  H2-PERSON-HSTRY.NCU-ENRL-DT = "9999-12-31";
  H2-PERSON-HSTRY.TAX-FILE-STS = " ";
  
  AIN49P9-INS-I02();
  /*  */
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN49P9-CRT-PEH


// CREATE PERSON DATA
Function AIN49P9-CRT-PER()
  /* CREATE PERSON PROCESS.*/
  /* DB INITIALIZATION.*/
  WDB00PI();
  set H2-PERSON empty;

  /* SETTING THE VALUES FOR INSERT*/
  H2-PERSON.UPI = AIN49W.WS-UPI;
  if (AIN49W.WS-PSEUDO-IND == "Y")
    H2-PERSON.SSN = AIN49W.WS-SSN;
  /*  */
  /* CHANGES DUE TO WI15289 - BEGIN;*/
  /*  */
    AIN49W.WS-CASE-LOG-CHILDS-SSN = AIN49W.WS-SSN;
  /*  */
  /* CHANGES DUE TO WI15289 - END;*/
  /*  */
  else
    H2-PERSON.SSN = SR-Q-DCF-REC.D-MEMB-SSN;
  /*  */
  /* CHANGES DUE TO WI15289 - BEGIN;*/
  /*  */
    AIN49W.WS-CASE-LOG-CHILDS-SSN = SR-Q-DCF-REC.D-MEMB-SSN;
  /*  */
  /* CHANGES DUE TO WI15289 - END;*/
  /*  */
  end
  H2-PERSON.SSN-VRFN-STS-CD = SR-Q-DCF-REC.D-MEMB-SSN-VERIFY;
  H2-PERSON.LST-NM = SR-Q-DCF-REC.D-MEMB-LAST-NAME;
  H2-PERSON.MID-NM = SR-Q-DCF-REC.D-MEMB-MIDDLE-NAME;
  H2-PERSON.FRST-NM = SR-Q-DCF-REC.D-MEMB-FIRST-NAME;
  AIN49W5.WS-DATE3 = SR-Q-DCF-REC.D-MEMB-DOB;
  AIN49W.WS-YY-CC1 = AIN49W5.WS-CC3;
  AIN49W.WS-YY-CC2 = AIN49W5.WS-YY3;
  AIN49W.WS-MM = AIN49W5.WS-MM3;
  AIN49W.WS-DD = AIN49W5.WS-DD3;
  AIN49W.WS-FIL1 = "-";
  AIN49W.WS-FIL2 = "-";
  H2-PERSON.DOB = AIN49W.WS-DATE;
  H2-PERSON.BIRTH-DT-VRFN-IND = "Y";
  H2-PERSON.SEX-CD = SR-Q-DCF-REC.D-MEMB-SEX;
  H2-PERSON.INTND-TO-RESD-IND = "Y";
  H2-PERSON.PRMRY-LANG-CD = "01";
  H2-PERSON.ETHNC-CD = SR-Q-DCF-REC.D-MEMB-ETHNICITY;
  H2-PERSON.IVE-MMBR-IND = "Y";
  H2-PERSON.ESD-SENT-DT = "9999-12-31";
  H2-PERSON.DEATH-VRFD-DT = "9999-12-31";
  H2-PERSON.DEATH-DT = "9999-12-31";
  H2-PERSON.GRADN-DT = "9999-12-31";
  H2-PERSON.SSN-APL-DT = "9999-12-31";
  H2-PERSON.SS5-DT = "9999-12-31";
  /*  */
  /* CHANGED FOR WI# 15289 - BEGIN;*/
  /*  */
  /* ** Changes due to PTR 9047 --- Begin---*/
  /* MOVE SR-Q-DCF-REC.D-MEMB-MA-NBR TO*/
  /* AIN49W5.WS-MEMB-MA-NBR;*/
  /* MOVE AIN49W5.WS-MEMB-MA-NBR1 TO AIN49W5.WS-MEMB-MA-NBR2;*/
  /* MOVE AIN49W5.WS-MEMB-MA-NBR2 TO H2-PERSON.MEDIC-BLNG-SQ-NMB;*/
  /* ** Changes due to PTR 9047 --- End ---*/
  /*  */
  if (SR-Q-DCF-REC.D-MEMB-MA-NBR != " ")
    if (SR-Q-DCF-REC.D-MEMB-MA-NBR is numeric)
      AIN49W5.WS-MEMB-MA-NBR = SR-Q-DCF-REC.D-MEMB-MA-NBR;
      AIN49W5.WS-MEMB-MA-NBR2 = AIN49W5.WS-MEMB-MA-NBR;
      H2-PERSON.MEDIC-BLNG-SQ-NMB = AIN49W5.WS-MEMB-MA-NBR2;
    else
      AIN49W5.WS-MEMB-MA-NBR = SR-Q-DCF-REC.D-MEMB-MA-NBR;
      AIN49W5.WS-COUNT1 = 11;
      AIN49W5.WS-COUNT2 = 11;
      while (AIN49W5.WS-COUNT1 > 0)
        if (AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT1] == " ")
        else
          AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT2] = AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT1];
          AIN49W5.WS-COUNT2 = AIN49W5.WS-COUNT2 - 1;
        end
        AIN49W5.WS-COUNT1 = AIN49W5.WS-COUNT1 - 1;
      end
      while (AIN49W5.WS-COUNT2 > 0)
        AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT2] = "0";
        AIN49W5.WS-COUNT2 = AIN49W5.WS-COUNT2 - 1;
      end
      AIN49W5.WS-MEMB-MA-NBR2 = AIN49W5.WS-MEMB-MA-NBR;
      H2-PERSON.MEDIC-BLNG-SQ-NMB = AIN49W5.WS-MEMB-MA-NBR2;
    end
  else
    WDB00PI();
    AIN49P9-READ-S35();
    VDBCOMMON.UNRF = "Y";
    WDB00PE-SQLERR();
    if (VDBCONTROL.URC >= 104)
      WCM00P2-TO-CEP01A();
    end
    H2-MA-BILL-SQ-NMB.LST-MA-BILL-SQ-NMB = H2-MA-BILL-SQ-NMB.LST-MA-BILL-SQ-NMB + 1;
    H2-PERSON.MEDIC-BLNG-SQ-NMB = H2-MA-BILL-SQ-NMB.LST-MA-BILL-SQ-NMB;
    WDB00PI();
    AIN49P9-UPD-U28();
    VDBCOMMON.UNRF = "Y";
    VDBCOMMON.UDUP = "N";
    WDB00PE-SQLERR();
    if (VDBCONTROL.URC > 104)
      WCM00P2-TO-CEP01A();
    end
  end
  /*  */
  /* CHANGED FOR WI# 15289 - END;*/
  /*  */
  AIN49P9-GEN-PHNAME();
  AIN49P9-INS-I01();
  /*  */
  VDBCOMMON.UDUP = "Y";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /* Begin changes WI# 15828*/

  H2-PERSON-ADRS-HST.UPI = AIN49W.WS-UPI;
  AIN49P9-INSERT-IVD();
end // end AIN49P9-CRT-PER


Function AIN49P9-CRT-REUNIF()
  H2-REUNIF-DATA.PRD-BEG-DATE = AIN49W.WS-FIRST-DATE;
  H2-REUNIF-DATA.PRD-END-DATE = "9999-12-31";
  if (SR-Q-DCF-REC.D-REUNIF-IND != " ")
    H2-REUNIF-DATA.REUNIF-IND = SR-Q-DCF-REC.D-REUNIF-IND;
  end
  if (SR-Q-DCF-REC.D-REUNIF-START-DATE != " ")
    AIN49W5.WS-DATE3 = SR-Q-DCF-REC.D-REUNIF-START-DATE;
    AIN49W.WS-YY-CC1 = AIN49W5.WS-CC3;
    AIN49W.WS-YY-CC2 = AIN49W5.WS-YY3;
    AIN49W.WS-MM = AIN49W5.WS-MM3;
    AIN49W.WS-DD = AIN49W5.WS-DD3;
    AIN49W.WS-FIL1 = "-";
    AIN49W.WS-FIL2 = "-";
    H2-REUNIF-DATA.REUNIF-START-DATE = AIN49W.WS-DATE;
  else
    H2-REUNIF-DATA.REUNIF-START-DATE = "9999-12-31";
  end
  if (SR-Q-DCF-REC.D-REUNIF-STOP-DATE != " ")
    AIN49W5.WS-DATE3 = SR-Q-DCF-REC.D-REUNIF-STOP-DATE;
    AIN49W.WS-YY-CC1 = AIN49W5.WS-CC3;
    AIN49W.WS-YY-CC2 = AIN49W5.WS-YY3;
    AIN49W.WS-MM = AIN49W5.WS-MM3;
    AIN49W.WS-DD = AIN49W5.WS-DD3;
    AIN49W.WS-FIL1 = "-";
    AIN49W.WS-FIL2 = "-";
    H2-REUNIF-DATA.REUNIF-STOP-DATE = AIN49W.WS-DATE;
  else
    H2-REUNIF-DATA.REUNIF-STOP-DATE = "9999-12-31";
  end
  WDB00PI();
  AIN49P9-INS-I24();
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN49P9-CRT-REUNIF


// CREATE UNEARNED INCOME
Function AIN49P9-CRT-UNIN()
  /* THE DCFS MASTER RECORD HAS 12 OCCURENCES OF THE CHECK INFO.*/
  /* THE CHECK AMOUNT FOR ALL SIMILAR MONTHS WILL BE CUMULATED AND*/
  /* STORED IN ONE ELEMENT OF ANOTHER ARRAY.*/

  AIN49W.WS-D-CHECK-AMOUNT = 0;
  move " " to AIN49W.WS-CHECK-DATE[1] for all;
  AIN49W.WS-INDEX = 1;

  /* ****----------START CHANGES DUE TO WI# 13992------------*/

  set AIN49W9 empty;
  AIN49W9.WS-INDEX-1 = 1;

  /* **********************************/
  /* SETTING KEY H2-CASE-MEMBER-HST **/
  /* **********************************/

  H2-CASE-MEMBER-HST.ICI = AIN49W.WS-ICI;

  /* **************************************/
  /* END SETTING KEY H2-CASE-MEMBER-HST **/
  /* **************************************/

  AIN49P9-READ-S32();

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  /* ********************************/
  /* perform sql error processing **/
  /* ********************************/

  WDB00PE-SQLERR();

  /* **************************/
  /* check for fatal errors **/
  /* **************************/

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  while (AIN49W.WS-INDEX <= SR-Q-DCF-REC.D-UNIN-NUMBER-OF-GRANTS)

  /* changes due to wi 15289 - begin;*/
  /*  */
  /* the check date receive through interface contains the cc part also;*/
  /* CHECK DATE IS IN THE MMDDYY FORMAT, THIS HAS TO BE CONVERTED INTO*/
  /* THE CORRECT FORMAT BEFORE QUERYING THE DATABASE.*/

  /* MOVE SR-Q-DCF-REC.D-BENEFIT-DATE(WS-INDEX) TO AIN49W.WS-MMDDYY-DATE;*/
  /* MOVE AIN49W.WS-MMDDYY-MM TO AIN49W.WS-TEMP-MM;*/
  /* MOVE AIN49W.WS-MMDDYY-DD TO AIN49W.WS-TEMP-DD;*/
  /* MOVE AIN49W.WS-MMDDYY-YY TO AIN49W.WS-TEMP-YY;*/
    AIN49W.WS-TEMP-MM = SR-Q-DCF-REC.D-BENEFIT-DATE-MM[WS-INDEX];
    AIN49W.WS-TEMP-DD = SR-Q-DCF-REC.D-BENEFIT-DATE-DD[WS-INDEX];
    AIN49W.WS-TEMP-CCYY = SR-Q-DCF-REC.D-BENEFIT-DATE-CCYY[WS-INDEX];
    AIN49W.WS-TEMP-SEP1 = "-";
    AIN49W.WS-TEMP-SEP2 = "-";

  /* INCLUDING THE CENTURY TO THE DATE FORMAT.*/
  /* IF AIN49W.WS-TEMP-YY-NUM > 90;*/
  /* MOVE 19 TO AIN49W.WS-TEMP-CC-NUM;*/
  /* ELSE;*/
  /* MOVE 20 TO AIN49W.WS-TEMP-CC-NUM;*/
  /* END;*/

  /* changes due to wi 15289 - end;*/
  /*  */
    if (AIN49W.WS-TEMP-DATE < H2-CASE-MEMBER-HST.PRD-BEG-DT)
      AIN49P9-RETRO-GRNT();
      AIN49W9.WS-GRNT-PROCESS = "Y";
    end
    AIN49W.WS-INDEX = AIN49W.WS-INDEX + 1;
  end
   /* ----------END CHANGES DUE TO WI# 13992-------******/

  AIN49W.WS-INDEX = 1;

  while (AIN49W.WS-INDEX <= SR-Q-DCF-REC.D-UNIN-NUMBER-OF-GRANTS)

  /* FOR SAME MONTH AND YEAR CUMMULATE THE AMOUNT AND STORE IT IN*/
  /* WS-CHECK-ARRAY.*/

    AIN49W.WS-EXIT-FLAG = "N";
    AIN49W.WS-CHECK-INDEX = 1;

    while (((AIN49W.WS-CHECK-INDEX <= 12) && (AIN49W.WS-EXIT-FLAG != "Y")))
  /*  */
  /* ******** ----------- Changes due to ptr 3049 begin -------- ******/
  /*  */
      if ((SR-Q-DCF-REC.D-BENEFIT-DATE-MM[WS-INDEX]
       == AIN49W.WS-CHECK-DATE-MM[WS-CHECK-INDEX]) && 
      (SR-Q-DCF-REC.D-BENEFIT-DATE-CCYY[WS-INDEX]
       == AIN49W.WS-CHECK-DATE-CCYY[WS-CHECK-INDEX]) && 
       /**/
       /* CHANGES DUE TO WI# 15289 - BEGIN;*/
       /**/
      (SR-Q-DCF-REC.D-UNIN-CODE[WS-INDEX]
       == AIN49W.WS-D-UNIN-CODE[WS-CHECK-INDEX]) && 
      (SR-Q-DCF-REC.D-IVE-NONIVE-IND[WS-INDEX]
       == AIN49W.WS-D-IVE-NONIVE-IND[WS-CHECK-INDEX]))
  /*  */
  /* CHANGES DUE TO WI# 15289 - END;*/
  /*  */

  /*  */
  /* ******** ----------- Changes due to ptr 3049 end ---------- ******/
  /*  */
        AIN49W.WS-D-CHECK-AMOUNT[WS-CHECK-INDEX] = AIN49W.WS-D-CHECK-AMOUNT[WS-CHECK-INDEX] +         SR-Q-DCF-REC.D-CHECK-AMOUNT[WS-INDEX];

        AIN49W.WS-EXIT-FLAG = "Y";
      else
        if ((AIN49W.WS-CHECK-DATE[WS-CHECK-INDEX] == " ") && 
        (AIN49W.WS-D-CHECK-AMOUNT[WS-CHECK-INDEX] == 0) && 
         /**/
         /* CHANGES DUE TO WI# 15289 - BEGIN;*/
         /**/
        (AIN49W.WS-D-UNIN-CODE[WS-CHECK-INDEX] == 0) && 
        (AIN49W.WS-D-IVE-NONIVE-IND[WS-CHECK-INDEX] == " "))
  /*  */
  /* CHANGES DUE TO WI# 15289 - END;*/
  /*  */

          AIN49W.WS-CHECK-DATE[WS-CHECK-INDEX] = SR-Q-DCF-REC.D-BENEFIT-DATE[WS-INDEX];
          AIN49W.WS-D-CHECK-AMOUNT[WS-CHECK-INDEX] = SR-Q-DCF-REC.D-CHECK-AMOUNT[WS-INDEX];
  /*  */
  /* CHANGES DUE TO WI# 15289 - BEGIN;*/
  /*  */
          AIN49W.WS-D-UNIN-CODE[WS-CHECK-INDEX] = SR-Q-DCF-REC.D-UNIN-CODE[WS-INDEX];
          AIN49W.WS-D-IVE-NONIVE-IND[WS-CHECK-INDEX] = SR-Q-DCF-REC.D-IVE-NONIVE-IND[WS-INDEX];
  /*  */
  /* CHANGES DUE TO WI# 15289 - END;*/
  /*  */
          AIN49W.WS-EXIT-FLAG = "Y";

        end
      end
      AIN49W.WS-CHECK-INDEX = AIN49W.WS-CHECK-INDEX + 1;
    end
    AIN49W.WS-INDEX = AIN49W.WS-INDEX + 1;
  end

  /* ALL DATA FOR THE SAME MONTH AND YEAR HAS BEEN ACCUMULATED AND STORED*/
  /* IN WS-CHECK-ARRAY.  THE TWNUERND_INCM_DTL WILL BE READ FOR EACH ELEMEN*/
  /* OF THE ARRAY.  IF RECORD EXISTS, THEN THE UNEARNED INCOM AMOUNT WILL*/
  /* BE UPDATED, ELSE A RECORD WILL BE INSERTED.*/


  AIN49W.WS-INDEX = 1;

  while (((AIN49W.WS-INDEX <= 12) && 
  (AIN49W.WS-CHECK-DATE[WS-INDEX] != " ") && 
  (AIN49W.WS-D-CHECK-AMOUNT[WS-INDEX] != 0)))
  /*  */
  /* changes due to wi 15289 - begin;*/
  /* check date received through interface is in mmddccyy format;*/
  /*  */
  /* CHECK DATE IS IN THE MMDDYY FORMAT, THIS HAS TO BE CONVERTED INTO*/
  /* THE CORRECT FORMAT BEFORE QUERYING THE DATABASE.*/

    AIN49W.WS-MMDDCCYY-DATE = AIN49W.WS-CHECK-DATE[WS-INDEX];
    AIN49W.WS-TEMP-MM = AIN49W.WS-MMDDCCYY-MM;
    AIN49W.WS-TEMP-DD = AIN49W.WS-MMDDCCYY-DD;
    AIN49W.WS-TEMP-CCYY = AIN49W.WS-MMDDCCYY-CCYY;
    AIN49W.WS-TEMP-SEP1 = "-";
    AIN49W.WS-TEMP-SEP2 = "-";

  /* INCLUDING THE CENTURY TO THE DATE FORMAT.*/
  /* IF AIN49W.WS-TEMP-YY-NUM > 90;*/
  /* MOVE 19 TO AIN49W.WS-TEMP-CC-NUM;*/
  /* ELSE;*/
  /* MOVE 20 TO AIN49W.WS-TEMP-CC-NUM;*/
  /* END;*/
  /*  */
  /* changes due to wi 15289 - end;*/

   /* ----------END CHANGES DUE TO WI# 13992-------******/

    if (AIN49W.WS-TEMP-DATE < H2-CASE-MEMBER-HST.PRD-BEG-DT)
      AIN49W.WS-INDEX = AIN49W.WS-INDEX + 1;
    else

   /* ----------END CHANGES DUE TO WI# 13992-------******/

   /* SETTING THE H2-RECORD-EMPTY;*/
      set H2-UERND-INCM-DTL empty;

   /* KEY SETTING PROCESS*/
      H2-UERND-INCM-DTL.UPI = AIN49W.WS-UPI;
      H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "17";

   /*  */
      H2-UERND-INCM-DTL.PRD-BEG-DT = AIN49W.WS-TEMP-DATE;
  /*  */
  /* CHANGES DUE TO WI# 15289 - BEGIN;*/
  /*  */
      H2-UERND-INCM-DTL.UERND-INCM-CD = AIN49W.WS-D-UNIN-CODE[WS-INDEX];
      H2-UERND-INCM-DTL.IVE-NONIVE-IND = AIN49W.WS-D-IVE-NONIVE-IND[WS-INDEX];
  /*  */
  /* CHANGES DUE TO WI# 15289 - END;*/
  /*  */
   /* DB INITIALIZATION*/
      WDB00PI();
    /* ***** p-02> changes due to ptr ain49003 start ---------- ********/
    /* determine the first of date of ws-check-date*/
      AIN49W.WS-MMDDCCYY-DATE = AIN49W.WS-CHECK-DATE[WS-INDEX];
      AIN49W.WS-TEMP-MM = AIN49W.WS-MMDDCCYY-MM;
      AIN49W.WS-TEMP-DD = AIN49W.WS-MMDDCCYY-DD;
      AIN49W.WS-TEMP-CCYY = AIN49W.WS-MMDDCCYY-CCYY;
      AIN49W.WS-TEMP-SEP1 = "-";
      AIN49W.WS-TEMP-SEP2 = "-";

   /* INCLUDING THE CENTURY TO THE DATE FORMAT.*/
   /* IF AIN49W.WS-TEMP-YY-NUM > 90;*/
   /* MOVE 19 TO AIN49W.WS-TEMP-CC-NUM;*/
   /* ELSE;*/
   /* MOVE 20 TO AIN49W.WS-TEMP-CC-NUM;*/
   /* END;*/

      AIN49W.WS-TEMP-DD = "01";
      AIN49W.WS-FIRST-DATE = AIN49W.WS-TEMP-DATE;
   /* ** determine the last date of ws-check-date;*/
      AIN49P9-LST-DATE();
   /* END KEY SETTING PROCESS*/
   /*  */
  /* ********* ------- Changes due to ptr 2819 begin --------- ************/
  /*  */
  /* Sql S09 is changed to retreive PRD_END_DT also*/
  /*  */
  /* ********* ------- Changes due to ptr 2819 end   --------- ************/
   /*  */
      AIN49P9-READ-S09();
      VDBCOMMON.UNRF = "Y";
      VDBCOMMON.UDUP = "N";
    /* perform sql error processing*/
    /*  */
      WDB00PE-SQLERR();
    /* check for fatal errors*/
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
    /*  */
      if (AIN49W5.WS-SQCOD == 0)
        AIN49P9-SCAN-S09();
        if (AIN49W5.WS-SQCOD == 0)
  /* ---------------- PTR 4631 BEGIN ------------------------------*/
  /* the alert to IVA worker is done when the PRD_BEG_DATE or PRD_END_DATES*/
  /* do not match with the check date. The AND condition is changed to OR*/
  /* and the ALERT-WORKER-PROCESS is called instead of CALL-ALERT-PROCESS*/
  /*  */
          if (H2-UERND-INCM-DTL.PRD-BEG-DT != AIN49W.WS-FIRST-DATE || 
          H2-UERND-INCM-DTL.PRD-END-DT != AIN49W.WS-LAST-DATE)
            AIN49P9-ALRT-WRK();
  /* ---------------- PTR 4631 END --------------------------------*/
          else
  /* ---------------- PTR 4635 BEGIN ------------------------------*/
            H2-UERND-INCM-DTL.UERND-INC-AMT = H2-UERND-INCM-DTL.UERND-INC-AMT +             AIN49W.WS-D-CHECK-AMOUNT[WS-INDEX];
  /* ---------------- PTR 4635 END --------------------------------*/
  /* ---------------- PTR 7276 BEGIN-------------------------------*/
            if (H2-UERND-INCM-DTL.UERND-INC-AMT < 0)
              H2-UERND-INCM-DTL.UERND-INC-AMT = 0;
            end
  /* ---------------- PTR 7276 END---------------------------------*/

  /* ---------------- PTR 7975 BEGIN------------------------------*/
            H2-UERND-INCM-DTL.RSDI-CLM-NUM = SR-Q-DCF-REC.D-USDI-RSDI-CLAIM-NBR;
  /* ---------------- PTR 7975 END -------------------------------*/

            AIN49P9-REP-U01();
            VDBCOMMON.UNRF = "Y";
            VDBCOMMON.UDUP = "N";
            WDB00PE-SQLERR();
            if (VDBCONTROL.URC > 104)
              WCM00P2-TO-CEP01A();
            end
          end
  /*  */
  /* ----------------PTR 4635 BEGIN --------------------------------*/
          AIN49P9-VER-REF();
  /* ----------------PTR 4635 END ----------------------------------*/
  /*  */
        else
          if (VDBCONTROL.UROWR == 0)
            AIN49P9-INS-UNIN();
            VDBCOMMON.UNRF = "N";
            VDBCOMMON.UDUP = "Y";
            WDB00PE-SQLERR();

            if (VDBCONTROL.URC >= 104)
              WCM00P2-TO-CEP01A();
            end
  /* ------------------------ PTR 4635 BEGIN ----------------------------*/
            AIN49P9-VER-REF();
  /* ------------------------ PTR 4635 END ----------------------*/
          end
        end
      end
      WDB00PI();
  /*  */
      if ((AIN49W.WS-PROCESS-DT-MM-CHA != AIN49W.WS-TEMP-MM) || 
      (AIN49W.WS-PROCESS-DT-YY != AIN49W.WS-TEMP-YY))

        H2-FAM-NCP.ICI = AIN49W.WS-ICI;
        H2-FAM-NCP.PRD-BEG-DT = AIN49W.WS-FIRST-DATE;
        H2-FAM-NCP.PRD-END-DT = AIN49W.WS-FIRST-DATE;
        H2-FAM-NCP.RETRO-GRNT-DT = AIN49W.WS-FIRST-DATE;

        AIN49P9-U-NCP-RDT();
      end

  /* ****------START CHANGES DUE TO WI# 13992-----------*/
    end
    AIN49W.WS-INDEX = AIN49W.WS-INDEX + 1;
  end
  if (AIN49W9.WS-GRNT-PROCESS == "Y")
    AIN49P9-GRNT-INFO();
    AIN49P9-WRT-REGRNT();
    AIN49W9.WS-GRNT-PROCESS = "N";
  end
  /* ----------END CHANGES DUE TO WI# 13992--------******/
  /*  */
  /* ***** p-02> changes due to ptr # ain49003 end ------- *********/
end // end AIN49P9-CRT-UNIN


Function AIN49P9-CRTDUP-CMH()
  set H2-CASE-MEMBER-HST empty;
  H2-CASE-MEMBER-HST.ICI = AIN49W.WS-ICI;
  H2-CASE-MEMBER-HST.UPI = AIN49W.WS-UPI;
  AIN49W.WS-YYMM-DATE = SR-Q-DCF-REC.D-BENEFIT-START-MONTH;
  AIN49W.WS-MM = AIN49W.WS-YYMM-MM;
  AIN49W.WS-YY = AIN49W.WS-YYMM-YY;
  AIN49W.WS-DD = "01";
  AIN49W.WS-FIL1 = "-";
  AIN49W.WS-FIL2 = "-";
  H2-CASE-MEMBER-HST.PRD-BEG-DT = AIN49W.WS-DATE;
  WDB00PI();
  AIN49P9-READ-S07();
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  if (sysVar.sqlData.sqlcode == 0)
    AIN49W.WS-TEMP-DATE = AIN49W.WS-PROCESS-DT;
    AIN49W.WS-TEMP-DD = "01";

    if (H2-CASE-MEMBER-HST.PRD-BEG-DT < AIN49W.WS-DATE)
      AIN49W.WS-PRD-END-DT = H2-CASE-MEMBER-HST.PRD-END-DT;
      AIN49W.WS-TEMP-DATE = AIN49W.WS-DATE;
      AIN49P9-LAST-DATE();
      H2-CASE-MEMBER-HST.PRD-END-DT = AIN49W.WS-LAST-DATE;

      WDB00PI();
      AIN49P9-UPD-U06();
  /*  */
      VDBCOMMON.UDUP = "N";
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
      if (AIN49W.WS-PRD-END-DT == "9999-12-31")
        AIN49W.WS-TEMP-DATE = AIN49W.WS-DATE;
        AIN49W.WS-TEMP-DD = "01";
        H2-CASE-MEMBER-HST.PRD-BEG-DT = AIN49W.WS-TEMP-DATE;
        H2-CASE-MEMBER-HST.PRD-END-DT = "9999-12-31";
        if (SR-Q-DCF-REC.D-MEMB-MA-AID-CODE != " "
         || SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE != " "
         || AIN49W3.RPT-ELIG-CD != " ")
          AIN49W5.WS-MEMB-MA-AID-CODE = SR-Q-DCF-REC.D-MEMB-MA-AID-CODE;
          AIN49W5.WS-MEMB-MA-AID-CODE-2 = AIN49W5.WS-MEMB-MA-AID-CODE-2DIGITS;
          H2-CASE-MEMBER-HST.IVE-AID-CD = AIN49W5.WS-MEMB-MA-AID-CODE-2;
          if (SR-Q-DCF-REC.D-NEW-LAYOUT-FLAG == " ")
            H2-CASE-MEMBER-HST.IVE-ELIG-CD = SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE;
          else
            H2-CASE-MEMBER-HST.IVE-ELIG-CD = AIN49W3.RPT-ELIG-CD;
          end
        end
  /* CHAGES FOR WI# 21138 - START;*/
  /* IF SR-Q-DCF-REC.D-MEMB-LEFT-HH-DATE = ' ';*/
  /* MOVE '9999-12-31' TO H2-CASE-MEMBER-HST.HH-LEFT-DT;*/
  /* ELSE;*/
  /* MOVE SR-Q-DCF-REC.D-MEMB-LEFT-HH-DATE TO*/
  /* AIN49W.WS-MMDDCCYY-DATE;*/
  /* MOVE AIN49W.WS-MMDDCCYY-MM TO AIN49W.WS-TEMP-MM;*/
  /* MOVE AIN49W.WS-MMDDCCYY-DD TO AIN49W.WS-TEMP-DD;*/
  /* MOVE AIN49W.WS-MMDDCCYY-CC TO AIN49W.WS-TEMP-CC;*/
  /* MOVE AIN49W.WS-MMDDCCYY-YY TO AIN49W.WS-TEMP-YY;*/
  /* MOVE AIN49W.WS-TEMP-DATE TO*/
  /* H2-CASE-MEMBER-HST.HH-LEFT-DT;*/
  /* END;*/
  /* CHAGES FOR WI# 21138 - END;*/
        WDB00PI();
        AIN49P9-INS-I04();
        VDBCOMMON.UDUP = "N";
        WDB00PE-SQLERR();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
      else
        AIN49W.WS-TEMP-DATE = AIN49W.WS-DATE;
        AIN49W.WS-TEMP-DD = "01";
        H2-CASE-MEMBER-HST.PRD-BEG-DT = AIN49W.WS-TEMP-DATE;
        H2-CASE-MEMBER-HST.PRD-END-DT = AIN49W.WS-PRD-END-DT;
        if (SR-Q-DCF-REC.D-MEMB-MA-AID-CODE != " "
         || SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE != " "
         || AIN49W3.RPT-ELIG-CD != " ")
          AIN49W5.WS-MEMB-MA-AID-CODE = SR-Q-DCF-REC.D-MEMB-MA-AID-CODE;
          AIN49W5.WS-MEMB-MA-AID-CODE-2 = AIN49W5.WS-MEMB-MA-AID-CODE-2DIGITS;
          H2-CASE-MEMBER-HST.IVE-AID-CD = AIN49W5.WS-MEMB-MA-AID-CODE-2;
          if (SR-Q-DCF-REC.D-NEW-LAYOUT-FLAG == " ")
            H2-CASE-MEMBER-HST.IVE-ELIG-CD = SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE;
          else
            H2-CASE-MEMBER-HST.IVE-ELIG-CD = AIN49W3.RPT-ELIG-CD;
          end
        end
  /* CHANGES FOR WI 21138 - START;*/
  /* IF SR-Q-DCF-REC.D-MEMB-LEFT-HH-DATE = ' ';*/
  /* MOVE '9999-12-31' TO H2-CASE-MEMBER-HST.HH-LEFT-DT;*/
  /* ELSE;*/
  /* MOVE SR-Q-DCF-REC.D-MEMB-LEFT-HH-DATE TO*/
  /* AIN49W.WS-MMDDCCYY-DATE;*/
  /* MOVE AIN49W.WS-MMDDCCYY-MM TO AIN49W.WS-TEMP-MM;*/
  /* MOVE AIN49W.WS-MMDDCCYY-DD TO AIN49W.WS-TEMP-DD;*/
  /* MOVE AIN49W.WS-MMDDCCYY-CC TO AIN49W.WS-TEMP-CC;*/
  /* MOVE AIN49W.WS-MMDDCCYY-YY TO AIN49W.WS-TEMP-YY;*/
  /* MOVE AIN49W.WS-TEMP-DATE TO*/
  /* H2-CASE-MEMBER-HST.HH-LEFT-DT;*/
  /* END;*/
  /* CHANGES FOR WI 21138 - END;*/
        WDB00PI();
        AIN49P9-INS-I04();
        AIN49W.WS-YYMM-DATE = SR-Q-DCF-REC.D-BENEFIT-START-MONTH;
        AIN49W.WS-MM = AIN49W.WS-YYMM-MM;
        AIN49W.WS-YY = AIN49W.WS-YYMM-YY;
        AIN49W.WS-DD = "01";
        AIN49W.WS-FIL1 = "-";
        AIN49W.WS-FIL2 = "-";
        H2-CASE-MEMBER-HST.PRD-BEG-DT = AIN49W.WS-DATE;
        WDB00PI();
        AIN49P9-UPD-U32();
        WDB00PE-SQLERR();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
      end
    else
      if (SR-Q-DCF-REC.D-MEMB-MA-AID-CODE != " "
       || SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE != " "
       || AIN49W3.RPT-ELIG-CD != " ")
        AIN49W5.WS-MEMB-MA-AID-CODE = SR-Q-DCF-REC.D-MEMB-MA-AID-CODE;
        AIN49W5.WS-MEMB-MA-AID-CODE-2 = AIN49W5.WS-MEMB-MA-AID-CODE-2DIGITS;
        H2-CASE-MEMBER-HST.IVE-AID-CD = AIN49W5.WS-MEMB-MA-AID-CODE-2;
        if (SR-Q-DCF-REC.D-NEW-LAYOUT-FLAG == " ")
          H2-CASE-MEMBER-HST.IVE-ELIG-CD = SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE;
        else
          H2-CASE-MEMBER-HST.IVE-ELIG-CD = AIN49W3.RPT-ELIG-CD;
        end
      end
  /* CHANGES FOR WI 21138 - START;*/
  /* IF SR-Q-DCF-REC.D-MEMB-LEFT-HH-DATE = ' ';*/
  /* MOVE '9999-12-31' TO H2-CASE-MEMBER-HST.HH-LEFT-DT;*/
  /* ELSE;*/
  /* MOVE SR-Q-DCF-REC.D-MEMB-LEFT-HH-DATE TO*/
  /* AIN49W.WS-MMDDCCYY-DATE;*/
  /* MOVE AIN49W.WS-MMDDCCYY-MM TO AIN49W.WS-TEMP-MM;*/
  /* MOVE AIN49W.WS-MMDDCCYY-DD TO AIN49W.WS-TEMP-DD;*/
  /* MOVE AIN49W.WS-MMDDCCYY-CC TO AIN49W.WS-TEMP-CC;*/
  /* MOVE AIN49W.WS-MMDDCCYY-YY TO AIN49W.WS-TEMP-YY;*/
  /* MOVE AIN49W.WS-TEMP-DATE TO*/
  /* H2-CASE-MEMBER-HST.HH-LEFT-DT;*/
  /* END;*/
  /* CHANGES FOR WI 21138 - END;*/
      AIN49W.WS-YYMM-DATE = SR-Q-DCF-REC.D-BENEFIT-START-MONTH;
      AIN49W.WS-MM = AIN49W.WS-YYMM-MM;
      AIN49W.WS-YY = AIN49W.WS-YYMM-YY;
      AIN49W.WS-DD = "01";
      AIN49W.WS-FIL1 = "-";
      AIN49W.WS-FIL2 = "-";
      H2-CASE-MEMBER-HST.PRD-BEG-DT = AIN49W.WS-DATE;
      WDB00PI();
      AIN49P9-UPD-U32();
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
  /*  */
    end
  end
end // end AIN49P9-CRTDUP-CMH


Function AIN49P9-CRTDUP-FCC()
  /* IF ANY PROGRAM OTHER THAN 'CW' IS ONGOING OR PENDING RETAIN THE*/
  /* CASELOAD, ELSE ASSIGN DCFS CASELOAD TO THIS CASE*/
  set H2-PRGM-CASE-HSTRY empty;
  H2-PRGM-CASE-HSTRY.ICI = AIN49W.WS-ICI;
  H2-PRGM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN49A";
  AIN49P9-READ-S39();
  VDBCOMMON.UNRF = "Y";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end
  if (sysVar.sqlData.sqlcode == 100)
    WDB00PI();
    set H2-FAM-CASELD-CASE empty;
    H2-FAM-CASELD-CASE.ICI = AIN49W.WS-ICI;
    AIN49P9-D01();
    VDBCOMMON.UNRF = "Y";
    VDBCOMMON.UDUP = "N";
    WDB00PE-SQLERR();
    if (VDBCONTROL.URC > 104)
      WCM00P2-TO-CEP01A();
    end

    H2-CASELD-DEBTLD.OFC-CD = SR-Q-DCF-REC.D-APPL-DISTRICT-OFFICE;
    H2-CASELD-DEBTLD.PRGM-OFC-TYPE = "A";
  /* MOVE SR-Q-DCF-REC.D-APPL-CASLD-ID TO AIN49W.WS-APPL-CASLD-ID;*/
    AIN49W.WS-APPL-CASLD-ID = "XBW01";
    H2-CASELD-DEBTLD.SPRVS-UNIT = AIN49W.WS-SPRVS-UNIT;
    H2-CASELD-DEBTLD.PSN-NMB = AIN49W.WS-PSN-NMB;
    H2-CASELD-DEBTLD.FUNC-AREA-CD = AIN49W.WS-FUNC-AREA-CODE;
    H2-CASELD-DEBTLD.WRKR-TYPE = AIN49W.WS-WRKR-TYPE;
    WDB00PI();
    VDBCONTROL.UACCTYP = "R";
    VDBCOMMON.UAPPLNAM = "AIN49A";
    AIN49P9-READ-S20();
    VDBCOMMON.UNRF = "Y";
    VDBCOMMON.UDUP = "N";
    WDB00PE-SQLERR();
    if (VDBCONTROL.URC >= 104)
      WCM00P2-TO-CEP01A();
    end
    if (sysVar.sqlData.sqlcode == 0)
      WDB00PI();
      set H2-FAM-CASELD-CASE empty;
      H2-FAM-CASELD-CASE.OFC-CD = SR-Q-DCF-REC.D-APPL-DISTRICT-OFFICE;
      AIN49W.WS-APPL-CASLD-ID = "XBW01";
      H2-FAM-CASELD-CASE.SPRVS-UNIT = AIN49W.WS-SPRVS-UNIT;
      H2-FAM-CASELD-CASE.PSN-NMB = AIN49W.WS-PSN-NMB;
      H2-FAM-CASELD-CASE.FUNC-AREA-CD = AIN49W.WS-FUNC-AREA-CODE;
      H2-FAM-CASELD-CASE.WRKR-TYPE = AIN49W.WS-WRKR-TYPE;
      H2-FAM-CASELD-CASE.CASLD-EFF-DT = H2-CASELD-DEBTLD.CASLD-EFF-DT;
      H2-FAM-CASELD-CASE.PRGM-OFC-TYPE = "A";
      H2-FAM-CASELD-CASE.CASLD-ID = "XBW01";
      H2-FAM-CASELD-CASE.IVE-CASLD-ID = SR-Q-DCF-REC.D-APPL-CASLD-ID;
      H2-FAM-CASELD-CASE.ICI = AIN49W.WS-ICI;
      AIN49P9-INS-I15();
      VDBCOMMON.UDUP = "Y";
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
  /*  */
  /* the caseload case history is also maintained for the dcfs cases*/
  /*  */
      H2-CASLD-CASE-HST.ICI = AIN49W.WS-ICI;
      H2-CASLD-CASE-HST.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
      AIN49P9-READ-S25();
      VDBCOMMON.UNRF = "Y";
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC >= 104)
        WCM00P2-TO-CEP01A();
      end
      if (sysVar.sqlData.sqlcode == 0)
        if (H2-CASLD-CASE-HST.PRD-BEG-DT == AIN49W.WS-PROCESS-DT)
          H2-CASLD-CASE-HST.ICI = AIN49W.WS-ICI;
          H2-CASLD-CASE-HST.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
          H2-CASLD-CASE-HST.PRD-END-DT = AIN49W.WS-PROCESS-DT;
          WDB00PI();
          AIN49P9-DEL-D02();
          VDBCOMMON.UNRF = "Y";
          VDBCOMMON.UDUP = "N";
          WDB00PE-SQLERR();
          if (VDBCONTROL.URC > 104)
            WCM00P2-TO-CEP01A();
          end
          H2-CASLD-CASE-HST.OFC-CD = SR-Q-DCF-REC.D-APPL-DISTRICT-OFFICE;
          H2-CASLD-CASE-HST.SPRVS-UNIT = AIN49W.WS-SPRVS-UNIT;
          H2-CASLD-CASE-HST.PSN-NMB = AIN49W.WS-PSN-NMB;
          H2-CASLD-CASE-HST.FUNC-AREA-CD = AIN49W.WS-FUNC-AREA-CODE;
          H2-CASLD-CASE-HST.WRKR-TYPE = AIN49W.WS-WRKR-TYPE;
          H2-CASLD-CASE-HST.CASLD-EFF-DT = H2-CASELD-DEBTLD.CASLD-EFF-DT;
          H2-CASLD-CASE-HST.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
          H2-CASLD-CASE-HST.PRD-END-DT = "9999-12-31";
          AIN49P9-INS-I20();
          VDBCOMMON.UNRF = "Y";
          VDBCOMMON.UDUP = "N";
          WDB00PE-SQLERR();
          if (VDBCONTROL.URC > 104)
            WCM00P2-TO-CEP01A();
          end
        else
          P-DATE-REC2.C-INPUT-DATE = AIN49W.WS-PROCESS-DT;
          P-DATE-REC2.N-SUB-DAYS = 1;
          call "DATES1A" (VDBCONTROL, VMESSAGE, P-DATE-REC2) {isNoRefresh = yes};

          H2-CASLD-CASE-HST.PRD-END-DT = P-DATE-REC2.C-OUTPUT-DATE;
          H2-CASLD-CASE-HST.ICI = AIN49W.WS-ICI;
          H2-CASLD-CASE-HST.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
          WDB00PI();
          AIN49P9-UPD-U20();
          VDBCOMMON.UNRF = "Y";
          VDBCOMMON.UDUP = "N";
          WDB00PE-SQLERR();
          if (VDBCONTROL.URC >= 104)
            WCM00P2-TO-CEP01A();
          end
          H2-CASLD-CASE-HST.OFC-CD = SR-Q-DCF-REC.D-APPL-DISTRICT-OFFICE;
          H2-CASLD-CASE-HST.SPRVS-UNIT = AIN49W.WS-SPRVS-UNIT;
          H2-CASLD-CASE-HST.PSN-NMB = AIN49W.WS-PSN-NMB;
          H2-CASLD-CASE-HST.FUNC-AREA-CD = AIN49W.WS-FUNC-AREA-CODE;
          H2-CASLD-CASE-HST.WRKR-TYPE = AIN49W.WS-WRKR-TYPE;
          H2-CASLD-CASE-HST.CASLD-EFF-DT = H2-CASELD-DEBTLD.CASLD-EFF-DT;
          H2-CASLD-CASE-HST.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
          H2-CASLD-CASE-HST.PRD-END-DT = "9999-12-31";
          AIN49P9-INS-I20();
          VDBCOMMON.UNRF = "Y";
          VDBCOMMON.UDUP = "N";
          WDB00PE-SQLERR();
          if (VDBCONTROL.URC > 104)
            WCM00P2-TO-CEP01A();
          end
        end
      else
        H2-CASLD-CASE-HST.OFC-CD = SR-Q-DCF-REC.D-APPL-DISTRICT-OFFICE;
        H2-CASLD-CASE-HST.SPRVS-UNIT = AIN49W.WS-SPRVS-UNIT;
        H2-CASLD-CASE-HST.PSN-NMB = AIN49W.WS-PSN-NMB;
        H2-CASLD-CASE-HST.FUNC-AREA-CD = AIN49W.WS-FUNC-AREA-CODE;
        H2-CASLD-CASE-HST.WRKR-TYPE = AIN49W.WS-WRKR-TYPE;
        H2-CASLD-CASE-HST.CASLD-EFF-DT = H2-CASELD-DEBTLD.CASLD-EFF-DT;
        H2-CASLD-CASE-HST.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
        H2-CASLD-CASE-HST.PRD-END-DT = "9999-12-31";
        AIN49P9-INS-I20();
        VDBCOMMON.UNRF = "Y";
        VDBCOMMON.UDUP = "N";
        WDB00PE-SQLERR();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
      end
    else
      VDBCONTROL.UPROC-NM = "AIN49P9-CRTDUP-FCC";
      VDBCONTROL.UPROC-OBJ = "SR-Q-DCF-REC";
      VDBCONTROL.UPROC-OPT = "EXECUTE";
      VMESSAGE.UMSGINS[2] = "AIN49A";
      AIN49W4.WS-MSGTEXT-1 = "RECORD NOT FOUND IN TWNCASELD_DEBTLD FOR RECD ";
      AIN49W4.WS-MSGTEXT-N = SR-Q-CNT-REC.AININT-CNT-NO-RECS;
      AIN49W4.WS-MSGTEXT-2 = " PROCESS ROLLED BACK";
      VDBCONTROL.UEZESQRRM = AIN49W4.WS-MESSAGE;
      WCM00P2-TO-CEP01A();
    end
  else
    if (sysVar.sqlData.sqlcode == 0)
      WDB00PI();
      set H2-FAM-CASELD-CASE empty;
      H2-FAM-CASELD-CASE.ICI = AIN49W.WS-ICI;
      H2-FAM-CASELD-CASE.IVE-CASLD-ID = SR-Q-DCF-REC.D-APPL-CASLD-ID;
      AIN49P9-UPD-U33();
      VDBCOMMON.UNRF = "Y";
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC >= 104)
        WCM00P2-TO-CEP01A();
      end
    end
  end
  /*  */
end // end AIN49P9-CRTDUP-FCC


Function AIN49P9-CRTDUP-FCE()
  set H2-FAM-CASE empty;
  H2-FAM-CASE.ICI = AIN49W.WS-ICI;
  H2-FAM-CASE.IVE-CASE-ID = SR-Q-DCF-REC.D-KEY-CASE-NUMBER;
  H2-FAM-CASE.ALT-PAYEE-IND = "Y";
  WDB00PI();
  AIN49P9-UPD-U31();
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN49P9-CRTDUP-FCE


Function AIN49P9-CRTDUP-FCH()
  set H2-FAM-CASE-HSTRY empty;
  H2-FAM-CASE-HSTRY.ICI = AIN49W.WS-ICI;
  H2-FAM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
  WDB00PI();
  AIN49P9-READ-S24();
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  if (sysVar.sqlData.sqlcode == 0)
    if (H2-FAM-CASE-HSTRY.PRD-BEG-DT != AIN49W.WS-FIRST-DATE)
      AIN49W.WS-PRD-END-DT = H2-FAM-CASE-HSTRY.PRD-END-DT;
      AIN49W.WS-TEMP-DATE = AIN49W.WS-PROCESS-DT;
      AIN49P9-LAST-DATE();
      H2-FAM-CASE-HSTRY.PRD-END-DT = AIN49W.WS-LAST-DATE;
      WDB00PI();
      AIN49P9-UPD-U19();
      VDBCOMMON.UDUP = "N";
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
      if (AIN49W.WS-PRD-END-DT == "9999-12-31")
        H2-FAM-CASE-HSTRY.ICI = AIN49W.WS-ICI;
        H2-FAM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-FIRST-DATE;
        H2-FAM-CASE-HSTRY.PRD-END-DT = "9999-12-31";
        H2-FAM-CASE-HSTRY.CASE-STS = "O";
        H2-FAM-CASE-HSTRY.DCFS-OFC-CNTY-CD = SR-Q-DCF-REC.D-ADDR-RESIDENT-COUNTY;
        WDB00PI();
        AIN49P9-INS-I19();
        VDBCOMMON.UDUP = "N";
        WDB00PE-SQLERR();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
      else
        AIN49W.WS-TEMP-DATE = AIN49W.WS-PROCESS-DT;
        AIN49W.WS-TEMP-DD = "01";
        H2-FAM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-TEMP-DATE;
        H2-FAM-CASE-HSTRY.PRD-END-DT = AIN49W.WS-PRD-END-DT;
        H2-FAM-CASE-HSTRY.CASE-STS = "O";
        H2-FAM-CASE-HSTRY.DCFS-OFC-CNTY-CD = SR-Q-DCF-REC.D-ADDR-RESIDENT-COUNTY;
        WDB00PI();
        AIN49P9-INS-I19();
        VDBCOMMON.UDUP = "N";
        WDB00PE-SQLERR();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
        H2-FAM-CASE-HSTRY.CASE-STS = "O";
        H2-FAM-CASE-HSTRY.DCFS-OFC-CNTY-CD = SR-Q-DCF-REC.D-ADDR-RESIDENT-COUNTY;
        H2-FAM-CASE-HSTRY.PRD-END-DT = AIN49W.WS-PROCESS-DT;
        WDB00PI();
        AIN49P9-UPD-U24();
        VDBCOMMON.UDUP = "N";
        WDB00PE-SQLERR();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
      end
    else
      if (H2-FAM-CASE-HSTRY.PRD-BEG-DT == AIN49W.WS-FIRST-DATE)
        H2-FAM-CASE-HSTRY.DCFS-OFC-CNTY-CD = SR-Q-DCF-REC.D-ADDR-RESIDENT-COUNTY;
        H2-FAM-CASE-HSTRY.CASE-STS = "O";
        H2-FAM-CASE-HSTRY.ICI = AIN49W.WS-ICI;
        H2-FAM-CASE-HSTRY.PRD-END-DT = AIN49W.WS-PROCESS-DT;
        WDB00PI();
        AIN49P9-UPD-U24();
        VDBCOMMON.UDUP = "N";
        WDB00PE-SQLERR();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
      end
    end
  end
  /*  */
end // end AIN49P9-CRTDUP-FCH


// DELETE FAM CASELOAD CASE
Function AIN49P9-D01()
  VDBCONTROL.UPROC-NM = "AIN49P9-D01";
  VDBCONTROL.UPROC-OPT = "SQLEXEC";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-CASELD-CASE";
  VDBCOMMON.USQLREC = "H2-FAM-CASELD-CASE";
  try
    execute delete 
      #sql{
        DELETE FROM
          twnfam_caseld_case T1
        WHERE
            ICI = :ICI
      }
      for H2-FAM-CASELD-CASE ; // model = delete
  end
end // end AIN49P9-D01


// PROCESS APPL DATE CHANGES
Function AIN49P9-DATE-CHG()
  set H2-FAM-CASE empty;
  if (SR-Q-DCF-REC.D-APPL-MA-APPLICATION-DATE not blanks)
    AIN49W5.WS-DATE3 = SR-Q-DCF-REC.D-APPL-MA-APPLICATION-DATE;
    AIN49W.WS-DD = AIN49W5.WS-DD3;
    AIN49W.WS-MM = AIN49W5.WS-MM3;
    AIN49W.WS-YY-CC2 = AIN49W5.WS-YY3;
    AIN49W.WS-YY-CC1 = AIN49W5.WS-CC3;
  /* IF AIN49W.WS-YY-CC2 > '90';*/
  /* MOVE '19' TO AIN49W.WS-YY-CC1;*/
  /* ELSE;*/
  /* MOVE '20' TO AIN49W.WS-YY-CC1;*/
  /* END;*/
    AIN49W.WS-FIL1 = "-";
    AIN49W.WS-FIL2 = "-";
    H2-FAM-CASE.CASE-APPL-DT = AIN49W.WS-DATE;
    AIN49W.WS-ICI = H2-3-CMH-FCE-PER.ICI;
    H2-FAM-CASE.ICI = AIN49W.WS-ICI;
  /* DB INITIALIZATION*/
    WDB00PI();
    AIN49P9-UPD-U12();

    VDBCOMMON.UNRF = "Y";
    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();

    if (VDBCONTROL.URC > 104)
      WCM00P2-TO-CEP01A();
    end
  /*  */
  /* DB INITIALIZATION*/
    WDB00PI();
  /*  */
    set H2-PRGM-CASE-HSTRY empty;
  /*  */
  /* NEXT KEY SETTING PROCESS*/
  /*  */
  /* Splitting of TWNPRGM_CASE_HSTRY incorporated*/
  /*  */
    H2-PRGM-CASE-HSTRY.ICI = AIN49W.WS-ICI;
  /* ------------------CHANGES DUE TO PTR3144 BEGIN ---------------*/
    H2-PRGM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
  /* ------------------Changes due to PTR3144 END ------------------*/
    H2-PRGM-CASE-HSTRY.PRGM-CASE-TYPE = "CW";
  /*  */
  /* Perform the process for standard database app initialisation*/
  /*  */
    WDB00PI();
  /*  */
  /* Set the values for access type and application name*/
  /*  */
    VDBCONTROL.UACCTYP = "R";
    VDBCOMMON.UAPPLNAM = "AIN49A";
  /*  */
  /* Fetch values from TWNPRGM_CASE_HSTRY*/
  /*  */
    AIN49P9-READ-S03();
  /*  */
  /* Set the NRF flag*/
  /*  */
    VDBCOMMON.UNRF = "Y";
  /*  */
    WDB00PE-SQLERR();
  /*  */
  /* Check for fatal errors*/
  /*  */
    if (VDBCONTROL.URC >= 104)
      WCM00P2-TO-CEP01A();
    end
  /*  */
    if (sysVar.sqlData.sqlcode == 0)
  /*  */
  /* --------------------------PTR 8170 - 12 BEGIN-------------------*/
  /*  */
      if (H2-PRGM-CASE-HSTRY.PRD-BEG-DT == AIN49W.WS-FIRST-DATE)
        H2-PRGM-CASE-HSTRY.ICI = H2-FAM-CASE.ICI;
        H2-PRGM-CASE-HSTRY.PRGM-CASE-TYPE = "CW";
        H2-PRGM-CASE-HSTRY.PRD-END-DT = AIN49W.WS-PROCESS-DT;

        AIN49W5.WS-DATE3 = SR-Q-DCF-REC.D-APPL-MA-APPLICATION-DATE;
        AIN49W.WS-DD = AIN49W5.WS-DD3;
        AIN49W.WS-MM = AIN49W5.WS-MM3;
        AIN49W.WS-YY-CC2 = AIN49W5.WS-YY3;
        AIN49W.WS-YY-CC1 = AIN49W5.WS-CC3;
  /* IF AIN49W.WS-YY-CC2 > '90';*/
  /* MOVE '19' TO AIN49W.WS-YY-CC1;*/
  /* ELSE;*/
  /* MOVE '20' TO AIN49W.WS-YY-CC1;*/
  /* END;*/
        AIN49W.WS-FIL1 = "-";
        AIN49W.WS-FIL2 = "-";
        H2-PRGM-CASE-HSTRY.APPL-DT = AIN49W.WS-DATE;
    /*  */
    /* perform the process to update TWNPRGM_CASE_HSTRY*/
        AIN49P9-UPD-U22();
         /*  */
        VDBCOMMON.UDUP = "N";
  /*  */
        WDB00PE-SQLERR();
  /*  */
  /*  */
  /* Check for fatal errors*/
  /*  */
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
  /*  */
      else
  /*  */
        if (H2-PRGM-CASE-HSTRY.PRD-END-DT == "9999-12-31")
          H2-PRGM-CASE-HSTRY.ICI = H2-FAM-CASE.ICI;
          H2-PRGM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
          H2-PRGM-CASE-HSTRY.PRGM-CASE-TYPE = "CW";

          AIN49W.WS-TEMP-DATE = AIN49W.WS-PROCESS-DT;
          AIN49P9-LAST-DATE();
          H2-PRGM-CASE-HSTRY.PRD-END-DT = AIN49W.WS-LAST-DATE;

          AIN49P9-UPD-U23();
          VDBCOMMON.UDUP = "N";
  /*  */
          WDB00PE-SQLERR();
  /*  */
  /* Check for fatal errors*/
  /*  */
          if (VDBCONTROL.URC > 104)
            WCM00P2-TO-CEP01A();
          end
          H2-PRGM-CASE-HSTRY.ICI = H2-FAM-CASE.ICI;
          H2-PRGM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-FIRST-DATE;
          H2-PRGM-CASE-HSTRY.PRGM-CASE-TYPE = "CW";

          H2-PRGM-CASE-HSTRY.PRD-END-DT = "9999-12-31";
          AIN49W5.WS-DATE3 = SR-Q-DCF-REC.D-APPL-MA-APPLICATION-DATE;
          AIN49W.WS-DD = AIN49W5.WS-DD3;
          AIN49W.WS-MM = AIN49W5.WS-MM3;
          AIN49W.WS-YY-CC2 = AIN49W5.WS-YY3;
          AIN49W.WS-YY-CC1 = AIN49W5.WS-CC3;
  /* IF AIN49W.WS-YY-CC2 > '90';*/
  /* MOVE '19' TO AIN49W.WS-YY-CC1;*/
  /* ELSE;*/
  /* MOVE '20' TO AIN49W.WS-YY-CC1;*/
  /* END;*/
          AIN49W.WS-FIL1 = "-";
          AIN49W.WS-FIL2 = "-";
          H2-PRGM-CASE-HSTRY.APPL-DT = AIN49W.WS-DATE;
  /*  */
  /*  */
  /* Perform the standard database app initialisation*/
  /*  */
          WDB00PI();
  /*  */
  /* Set the values for access type and application name*/
  /*  */
          VDBCONTROL.UACCTYP = "W";
          VDBCOMMON.UAPPLNAM = "AIN49A";
  /*  */
  /* Perform the process to insert a record into twnprgm_case_hstry*/
  /*  */
          AIN49P9-INS-I12();
          VDBCOMMON.UNRF = "Y";
          VDBCOMMON.UDUP = "N";

          WDB00PE-SQLERR();

          if (VDBCONTROL.URC > 104)
            WCM00P2-TO-CEP01A();
          end
        else
  /*  */
          AIN49P9-ALRT-WRK();

        end
  /* ---------------------------PTR 8170 - 12 BEGIN-----------------------*/
      end
    end
  end
end // end AIN49P9-DATE-CHG


// DELETE CASELOAD CASE HISTORY
Function AIN49P9-DEL-D02()
  VDBCONTROL.UPROC-NM = "AIN49P9-DEL-D02";
  VDBCONTROL.UPROC-OPT = "SQLEXEC";
  VDBCONTROL.UPROC-OBJ = "H2-CASLD-CASE-HST";
  VDBCOMMON.USQLREC = "H2-CASLD-CASE-HST";
  try
    execute delete 
      #sql{
        DELETE FROM
          TWNCASLD_CASE_HST T1
        WHERE
            ICI = :ICI
        AND PRD_BEG_DT <= :PRD-BEG-DT
        AND PRD_END_DT >= :PRD-BEG-DT
      }
      for H2-CASLD-CASE-HST ; // model = delete
  end
end // end AIN49P9-DEL-D02


// DERIVE CASE RESULT CODE
Function AIN49P9-DER-CRC()
  /* ----------------------PTR 4654 BEGIN-------------------------*/
  /*  */
  /* DERIVE CASE RSLT CD*/
  /*  */
  if (SR-Q-DCF-REC.D-NEW-LAYOUT-FLAG == "Y")
    if (AIN49W3.RPT-ELIG-CD == "8"
     || AIN49W3.RPT-ELIG-CD == "9")
      AIN49W.WS-CASE-RSLT-CD = "I";
    else
      AIN49W.WS-CASE-RSLT-CD = "E";
    end
  else
    if (SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE == "8"
     || SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE == "9")
      AIN49W.WS-CASE-RSLT-CD = "I";
    else
      AIN49W.WS-CASE-RSLT-CD = "E";
    end
  end
  /* ----------------------PTR 4654 END---------------------------*/
end // end AIN49P9-DER-CRC


// DERIVE ISSUE INDICATOR
Function AIN49P9-DER-ISS()
  /* ---------------------PTR 4654 BEGIN------------------------------*/
  /*  */
  /* Derive Issue Indicator*/
  /*  */
  /* To determine the issue indicator, the medicaid card details table*/
  /* is read to determine if the medicaid card for the benefit month*/
  /* has already been issued*/
  /*  */
  set H2-2-MCD-MRM empty;
  AIN49W.WS-MEDICAID-CARD-ISSUED = "N";
  AIN49W.WS-CNT = 0;

  if (SR-Q-DCF-REC.D-RECORD-TYPE == "N")
    H2-2-MCD-MRM.UPI = AIN49W.WS-UPI;
  else
    if (SR-Q-DCF-REC.D-RECORD-TYPE == "U")
      H2-2-MCD-MRM.UPI = AIN49W.WS-IVA-UPI;
    end
  end

  H2-2-MCD-MRM.CARD-VALID-MTH = AIN49W.WS-ELIG-VER-MTH;
  H2-2-MCD-MRM.CARD-VALID-YR = AIN49W.WS-ELIG-VER-YEAR;

  WDB00PI();
  AIN49P9-READ-S30();
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  /* Check for fatal errors*/
  /*  */
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  if (AIN49W.WS-CNT > 0)
    AIN49W.WS-MEDICAID-CARD-ISSUED = "Y";
  end

  /* ----------------------PTR 4654 END--------------------------------*/
end // end AIN49P9-DER-ISS


// DERIVE SCHEDULE PAY DATE
Function AIN49P9-DER-SPD()
  /* ----------------------PTR 4654 BEGIN--------------------------*/
  /*  */
  /* Derive Schedule Pay Date*/
  /*  */
  AIN49W.WS-SCHD-PAY-DATE = 0;

  AIN49W.WS-TEMP-CCYY-NUM = AIN49W.WS-ELIG-VER-YEAR;
  AIN49W.WS-TEMP-MM-NUM = AIN49W.WS-ELIG-VER-MTH;
  AIN49W.WS-TEMP-DD = "01";


  AIN49W.WS-DATE = AIN49W.WS-PROCESS-DT;
  AIN49W.WS-DD = "01";

  if (AIN49W.WS-TEMP-DATE <= AIN49W.WS-DATE)
    AIN49W.WS-SCHD-PAY-DATE = AIN49W.WS-PROCESS-DT;
  else
    AIN49W.WS-TEMP-DATE = AIN49W.WS-PROCESS-DT;
    AIN49W.WS-TEMP-DD = "01";
    AIN49P9-NXT-MNTH();
    AIN49W.WS-SCHD-PAY-DATE = AIN49W.WS-TEMP-DATE;
  end

  /* --------------------PTR 4654 END---------------------------------*/
end // end AIN49P9-DER-SPD


// PROCESS DIST OFF CHANGE
Function AIN49P9-DIST-OFF()
  /* DIST OFFICE CHANGE PROCESS*/
  /* --------------------PTR 4646 BEGIN --------------------------*/
  /* DB INITIALIZATION*/
  /* changes for wi#22828 - start;*/
  set H2-PRGM-CASE-HSTRY empty;
  H2-PRGM-CASE-HSTRY.ICI = H2-3-CMH-FCE-PER.ICI;
  H2-PRGM-CASE-HSTRY.PRD-BEG-DT = AIN49W.WS-PROCESS-DT;
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN49A";
  AIN49P9-READ-S39();
  VDBCOMMON.UNRF = "Y";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end
  if (sysVar.sqlData.sqlcode == 0)
    WDB00PI();
    set H2-FAM-CASELD-CASE empty;
    H2-FAM-CASELD-CASE.ICI = AIN49W.WS-IVA-ICI;
    H2-FAM-CASELD-CASE.IVE-CASLD-ID = SR-Q-DCF-REC.D-APPL-CASLD-ID;
    AIN49P9-UPD-U33();
    VDBCOMMON.UNRF = "Y";
    WDB00PE-SQLERR();
    if (VDBCONTROL.URC >= 104)
      WCM00P2-TO-CEP01A();
    end
    return;
  end
  /* changes for wi#22828 - end;*/
  WDB00PI();

  set H2-FAM-CASELD-CASE empty;

  H2-FAM-CASELD-CASE.ICI = H2-3-CMH-FCE-PER.ICI;

  AIN49P9-D01();

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /* the ICI is assigned to the caseload "XBW01" in the new district office*/
  H2-FAM-CASELD-CASE.OFC-CD = SR-Q-DCF-REC.D-APPL-DISTRICT-OFFICE;
  /* MOVE SR-Q-DCF-REC.D-APPL-CASLD-ID TO AIN49W.WS-APPL-CASLD-ID;*/
  AIN49W.WS-APPL-CASLD-ID = "XBW01";
  H2-FAM-CASELD-CASE.SPRVS-UNIT = AIN49W.WS-SPRVS-UNIT;
  H2-FAM-CASELD-CASE.PSN-NMB = AIN49W.WS-PSN-NMB;
  H2-FAM-CASELD-CASE.FUNC-AREA-CD = AIN49W.WS-FUNC-AREA-CODE;
  H2-FAM-CASELD-CASE.WRKR-TYPE = AIN49W.WS-WRKR-TYPE;
  H2-FAM-CASELD-CASE.PRGM-OFC-TYPE = "A";
  H2-FAM-CASELD-CASE.CASLD-ID = AIN49W.WS-APPL-CASLD-ID;
  H2-FAM-CASELD-CASE.IVE-CASLD-ID = SR-Q-DCF-REC.D-APPL-CASLD-ID;
  H2-FAM-CASELD-CASE.ICI = AIN49W.WS-IVA-ICI;
  /* -----------------------PTR 8170 - 11 ------------------------*/
  H2-CASELD-DEBTLD.OFC-CD = SR-Q-DCF-REC.D-APPL-DISTRICT-OFFICE;
  H2-CASELD-DEBTLD.PRGM-OFC-TYPE = "A";
  H2-CASELD-DEBTLD.SPRVS-UNIT = AIN49W.WS-SPRVS-UNIT;
  H2-CASELD-DEBTLD.PSN-NMB = AIN49W.WS-PSN-NMB;
  H2-CASELD-DEBTLD.FUNC-AREA-CD = AIN49W.WS-FUNC-AREA-CODE;
  H2-CASELD-DEBTLD.WRKR-TYPE = AIN49W.WS-WRKR-TYPE;
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN49A";
  AIN49P9-READ-S20();
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end

  H2-FAM-CASELD-CASE.CASLD-EFF-DT = H2-CASELD-DEBTLD.CASLD-EFF-DT;
  /* --------------------PTR 8170 - 11 END----------------------------*/
  AIN49P9-INS-I15();

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  AIN49P9-SPLIT-CCH();
  /* ----------------------- PTR 4646 END -------------------------*/
end // end AIN49P9-DIST-OFF


Function AIN49P9-DUPHOH-PRC()
  H2-PERSON.UPI = AIN49W.WS-UPI;
  H2-PERSON.IVE-MMBR-IND = "Y";
  H2-PERSON.LST-NM = SR-Q-DCF-REC.D-MEMB-LAST-NAME;
  H2-PERSON.FRST-NM = SR-Q-DCF-REC.D-MEMB-FIRST-NAME;
  H2-PERSON.MID-NM = SR-Q-DCF-REC.D-MEMB-MIDDLE-NAME;
  AIN49P9-GEN-PHNAME();
  if (H2-PERSON.MEDIC-BLNG-SQ-NMB == 0)
    if (SR-Q-DCF-REC.D-MEMB-MA-NBR != " ")
      if (SR-Q-DCF-REC.D-MEMB-MA-NBR is numeric)
        AIN49W5.WS-MEMB-MA-NBR = SR-Q-DCF-REC.D-MEMB-MA-NBR;
        AIN49W5.WS-MEMB-MA-NBR2 = AIN49W5.WS-MEMB-MA-NBR;
        H2-PERSON.MEDIC-BLNG-SQ-NMB = AIN49W5.WS-MEMB-MA-NBR2;
      else
        AIN49W5.WS-MEMB-MA-NBR = SR-Q-DCF-REC.D-MEMB-MA-NBR;
        AIN49W5.WS-COUNT1 = 11;
        AIN49W5.WS-COUNT2 = 11;
        while (AIN49W5.WS-COUNT1 > 0)
          if (AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT1] == " ")
          else
            AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT2] = AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT1];
            AIN49W5.WS-COUNT2 = AIN49W5.WS-COUNT2 - 1;
          end
          AIN49W5.WS-COUNT1 = AIN49W5.WS-COUNT1 - 1;
        end
        while (AIN49W5.WS-COUNT2 > 0)
          AIN49W5.WS-MEMB-MA-NBR1[WS-COUNT2] = "0";
          AIN49W5.WS-COUNT2 = AIN49W5.WS-COUNT2 - 1;
        end
        AIN49W5.WS-MEMB-MA-NBR2 = AIN49W5.WS-MEMB-MA-NBR;
        H2-PERSON.MEDIC-BLNG-SQ-NMB = AIN49W5.WS-MEMB-MA-NBR2;
      end
    else
      WDB00PI();
      AIN49P9-READ-S35();
      VDBCOMMON.UNRF = "Y";
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC >= 104)
        WCM00P2-TO-CEP01A();
      end
      H2-MA-BILL-SQ-NMB.LST-MA-BILL-SQ-NMB = H2-MA-BILL-SQ-NMB.LST-MA-BILL-SQ-NMB + 1;
      H2-PERSON.MEDIC-BLNG-SQ-NMB = H2-MA-BILL-SQ-NMB.LST-MA-BILL-SQ-NMB;
      WDB00PI();
      AIN49P9-UPD-U28();
      VDBCOMMON.UNRF = "Y";
      VDBCOMMON.UDUP = "N";
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
    end
  end

  AIN49P9-UPD-U27();
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  AIN49W3.RPT-LST-NM = H2-PERSON.LST-NM;
  AIN49W3.RPT-FRST-NM = H2-PERSON.FRST-NM;
  AIN49W3.RPT-SSN = SR-Q-DCF-REC.D-MEMB-SSN;
  AIN49W3.RPT-SSN-VRFN-CODE = SR-Q-DCF-REC.D-MEMB-SSN-VERIFY;
  AIN49W3.RPT-DOB = H2-PERSON.DOB;
  AIN49W3.RPT-BLNG-NMB = H2-PERSON.MEDIC-BLNG-SQ-NMB;

  AIN49P9-CRTDUP-FCE();
  AIN49P9-CRTDUP-CMH();
  AIN49P9-CRTDUP-FCH();
  AIN49P9-CRTDUP-FCC();
  AIN49P9-CRT-FAP();
  AIN49P9-CRT-PCD();
  AIN49P9-CRT-PCH();

  AIN49P9-CRT-ELIG();
  AIN49P9-CRT-FAA();
  AIN49P9-CRE-CLOG();
  if (SR-Q-DCF-REC.D-REUNIF-CHANGED == "Y")
    AIN49P9-PRC-REUNIF();
  end

  AIN49P9-AGDOUT-PRC(); /* WI 27695*/

  /* CHANGES FOR WI# 24622 - MMIS -START;*/
  set AIF25W1 empty;
  AIF25W1.CALLING-PRGM = "AIN49A";
  AIF25W1.ICI = AIN49W.WS-ICI;
  AIF25W1.UPI = AIN49W.WS-UPI;
  AIF25W1.PRGM-CASE-TYPE = "CW";
  AIF25W1.CASE-FLAG = "Y";
  AIF25W1.DEMO-FLAG = "Y";
  call "AIF25A" (VDBCONTROL, VMESSAGE, AIF25W1) {isNoRefresh = yes};
  /*  */
end // end AIN49P9-DUPHOH-PRC


// GENERATE ICI
Function AIN49P9-GEN-ICI()
  /* GENERATE ICI PROCESS.*/
  /* CHANGES DUE TO PTR 11494 --------- BEGIN ---------*/
  /*  */
  /* THE ICI IS GENERATED USING THE COMMON ROUTINE CMR03A INSTEAD OF*/
  /* EXECUTING AN SQL*/
  PCMR-ICI.PCMR-ICI-NUM = 0;
  PCMR-ICI.PCMR-NO-COMMIT-FLAG = "Y";
  call "CMR03A" (VDBCONTROL, VMESSAGE, PCMR-ICI) {isNoRefresh = yes};
  AIN49W.WS-ICI = PCMR-ICI.PCMR-ICI-NUM;
  /*  */
  /* CHANGES DUE TO PTR 11494 ---------- END -----------*/
end // end AIN49P9-GEN-ICI


// GENERATE PHONETIC NAMES
Function AIN49P9-GEN-PHNAME()
  /* ** Cbsi start*/
  set AIN49W8 empty;
  if (((SR-Q-DCF-REC.D-RECORD-TYPE == "N") || 
  (SR-Q-DCF-REC.D-RECORD-TYPE == "U" && 
  SR-Q-DCF-REC.D-MEMB-LAST-NAME != " ")))
    AIN49W8.POP-NAME = SR-Q-DCF-REC.D-MEMB-LAST-NAME;
    AIN49W8.POP-FLAG = "L";
    call "CPR03A" (VDBCONTROL, VMESSAGE, AIN49W8);
    if (VDBCONTROL.URC > 104)
      WCM00P2-TO-CEP01A();
    end
  /*  */
    H2-PERSON.PHONETIC-NM1 = AIN49W8.POP-METAPH-CD;
  end
  set AIN49W8 empty;
  /*  */
  if (((SR-Q-DCF-REC.D-RECORD-TYPE == "N") || 
  (SR-Q-DCF-REC.D-RECORD-TYPE == "U" && 
  SR-Q-DCF-REC.D-MEMB-FIRST-NAME != " ")))

    AIN49W8.POP-NAME = SR-Q-DCF-REC.D-MEMB-FIRST-NAME;
    AIN49W8.POP-FLAG = "F";
    call "CPR03A" (VDBCONTROL, VMESSAGE, AIN49W8);
    if (VDBCONTROL.URC > 104)
      WCM00P2-TO-CEP01A();
    end
    H2-PERSON.PHONETIC-NM2 = AIN49W8.POP-METAPH-CD;
  end
  /* ** Cbsi end*/
end // end AIN49P9-GEN-PHNAME


// GENERATE PSEUDO SSN
Function AIN49P9-GEN-SSN()
  /* GENERATE NOMADS-PSEUDO-SSN*/
  /* -----------------------PTR 4614 BEGIN ----------------------*/
  /* A CALL is made to CMR02A to get the new SSN. The SQL's S06 and U10*/
  /* are deleted.*/

  /* CALL CMR02A WITH RETURN TO GET THE PSEUDO SSN*/
  CMR02W1.PMP-TEMP-SSN = 0;
  CMR02W1.PCMR-NO-COMMIT-FLAG = "Y";
  call "CMR02A" (VDBCONTROL, VMESSAGE, CMR02W1) {isNoRefresh = yes};
  AIN49W.WS-SSN = CMR02W1.PMP-TEMP-SSN;

  /* -----------------------PTR 4614 END -------------------------*/
end // end AIN49P9-GEN-SSN


// GENERATE UPI
Function AIN49P9-GEN-UPI()
  /* GENERATE UPI PROCESS*/
  /* -----------------------PTR 4614 BEGIN -----------------------*/
  /* a CALL is made to CMR01A to get the new UPI. The SQL'S S04 and U08*/
  /* are deleted.*/
  CMR01W1.PCMR-LST-UPI-USD = 0;
  CMR01W1.PCMR-NO-COMMIT-FLAG = "Y";
  call "CMR01A" (VDBCONTROL, VMESSAGE, CMR01W1) {isNoRefresh = yes};
  AIN49W.WS-UPI = CMR01W1.PCMR-LST-UPI-USD;

  /* -----------------------PTR 4614 END --------------------------*/
end // end AIN49P9-GEN-UPI


Function AIN49P9-GET-CASSTS()
  /* ******** DETERMINE CASE STATUS ************/
  /* PROGRAM CASE STATUS WILL BE SET TO ONE OF THE FOLLOWING:*/
  /* O - ONGOING*/
  /* C - CLOSED*/
  /* P - PENDING*/
  /*  */
  AIN49W.WS-CAL-CASE-STS = " ";
  /*  */
  /* ************* WI 14240 08/14/00 WNMLS START **************/
  /*  */
  /* CASE STATUS CAN ALSO BE SET TO:*/
  /* D - DENIED.*/
  /*  */
  /* FOR THIS MODIFICATION, THE FOUNDATION FOR THE LOGIC IS AS FOLLOWS:*/
  /* IF ANY PROGRAM IS ONGOING, CASE STATUS IS SET TO 'O', ELSE*/
  /* IF ANY PROGRAM IS PENDING, CASE STATUS IS SET TO 'P', ELSE*/
  /* IF ALL PROGRAMS ARE terninated, CASE STATUS IS SET TO 'c', ELSE*/
  /* IF ALL PROGRAMS ARE CLOSED ('D' OR 'T' BUT AT LEAST ONE PROGRAM IS*/
  /* 'd'), CASE STATUS IS SET TO 'd';*/
  /*  */
  /* **********************************************************/
  /*  */

  H2-PRGM-CASE-HSTRY.ICI = H2-3-CMH-FCE-PER.ICI;

  AIN49W.WS-ROW-COUNT = 0;
  AIN49W.WS-D-T-ACCUM = 0;
  AIN49W.WS-D-ACCUM = 0;
  AIN49W.WS-T-ACCUM = 0;
  AIN49W.WS-O-ACCUM = 0;
  AIN49W.WS-P-ACCUM = 0;
  /*  */
  /* THE CORRESPONDING ACCUMULATORS ARE INCREMENTED FOR EACH OCCURANCE*/
  /* OF EACH PROGRAM STATUS.  IF THE CLIENT HAS NOT APPLIED FOR A*/
  /* PARTICULAR PROGRAM, A ROW WILL NOT EXIST, AND THEREFORE NO STATUS*/
  /* WILL EXIST.  THE NUMBER OF ROWS IS COUNTED TO COMPARE WITH THE*/
  /* ACCUMULATOR TO DETERMINE IF ALL OCCURANCES ARE OF THE SAME STATUS*/
  /* OR VARIOUS STATUSES.  IT IS NOT NECESSARY TO DETERMINE PROGRAM TYPE.*/
  /*  */
  AIN49P9-SETINQ-S29();
  if (sysVar.sqlData.sqlcode == 0)
    AIN49P9-SCAN-S29();
  end
  while (sysVar.sqlData.sqlcode == 0)
    AIN49W.WS-PRGM-CASE-STS = H2-PRGM-CASE-HSTRY.PRGM-CASE-STS;

    if (AIN49W.WS-PRGM-CASE-STS == "D")
      AIN49W.WS-D-ACCUM = AIN49W.WS-D-ACCUM + 1;
    else
      if (AIN49W.WS-PRGM-CASE-STS == "T")
        AIN49W.WS-T-ACCUM = AIN49W.WS-T-ACCUM + 1;
      else
        if (AIN49W.WS-PRGM-CASE-STS == "O")
          AIN49W.WS-O-ACCUM = AIN49W.WS-O-ACCUM + 1;
        else
          if (AIN49W.WS-PRGM-CASE-STS == "P")
            AIN49W.WS-P-ACCUM = AIN49W.WS-P-ACCUM + 1;
          end
        end
      end
    end
    AIN49W.WS-ROW-COUNT = AIN49W.WS-ROW-COUNT + 1;
    AIN49P9-SCAN-S29();
    if (sysVar.sqlData.sqlcode == 0)
      AIN49W.WS-PRGM-CASE-STS = H2-PRGM-CASE-HSTRY.PRGM-CASE-STS;
    end
  end /* WHILE*/
  /*  */
  /* THE FOUNDATION FOR THIS 'IF'STRUCTURE IS AS FOLLOWS:*/
  /* IF ANY PROGRAM IS ONGOING, CASE STATUS IS SET TO 'O', ELSE*/
  /* IF ANY PROGRAM IS PENDING, CASE STATUS IS SET TO 'P', ELSE*/
  /* IF ALL PROGRAMS ARE terninated, CASE STATUS IS SET TO 'c', ELSE*/
  /* IF ALL PROGRAMS ARE CLOSED ('D' OR 'T' BUT AT LEAST ONE PROGRAM IS*/
  /* 'd'), CASE STATUS IS SET TO 'd';*/
  /*  */
  if (AIN49W.WS-O-ACCUM > 0) /* (AT LEAST ONE 'O')*/
    AIN49W.WS-CAL-CASE-STS = "O"; /* (ONGOING)*/
  else /* 'O' SUPERCEDES 'P'*/
    if (AIN49W.WS-P-ACCUM > 0) /* (AT LEAST ONE 'P')*/
      AIN49W.WS-CAL-CASE-STS = "P"; /* (PENDING)*/
    else
      AIN49W.WS-D-T-ACCUM = (AIN49W.WS-D-ACCUM + AIN49W.WS-T-ACCUM);
      if (AIN49W.WS-D-T-ACCUM == AIN49W.WS-ROW-COUNT) /* (ALL D'S &/OR T'S)*/
        if (AIN49W.WS-T-ACCUM == AIN49W.WS-ROW-COUNT) /* (ALL t'S)*/
          AIN49W.WS-CAL-CASE-STS = "C"; /* (closed)*/
        else /* (t'S & AT LEAST ONE 'd', OR ALL d'S)*/
          AIN49W.WS-CAL-CASE-STS = "D"; /* (denied)*/
        end
      end /* (NOT ALL D'S & T'S)*/
    end
  end
end // end AIN49P9-GET-CASSTS


// CALL DATEAPP TO GET CURR DATE
Function AIN49P9-GET-DATE()
  /* THIS PROCESS GETS THE CURRENT DATE AND STORES IT IN THE WS*/
  AIN49W.WS-FIL1 = "-";
  AIN49W.WS-FIL2 = "-";

  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  AIN49W.WS-DATE1 = GDW.DTL;
  AIN49W.WS-YY = AIN49W.WS-YY1;
  AIN49W.WS-MM = AIN49W.WS-MM1;
  AIN49W.WS-DD = AIN49W.WS-DD1;
  AIN49W.WS-CURRENT-DATE = AIN49W.WS-DATE;
end // end AIN49P9-GET-DATE


// Gets retro grant information
Function AIN49P9-GRNT-INFO()
  /* Changes due to WI# 13992*/
  /* This process is excuted only if a retro grant (prior to date of case*/
  /* conversion) is recieved in NOMADS.*/

  set H2-PERSON empty;
  set H2-FAM-CASE-HSTRY empty;

  AIN49W9.WS-CURRENT-CC = BDATEREC.BDATE-PROCESS-DATE-CC;
  AIN49W9.WS-CURRENT-YY = BDATEREC.BDATE-PROCESS-DATE-YY;
  AIN49W9.WS-CURRENT-FIL1 = "-";
  AIN49W9.WS-CURRENT-MM = BDATEREC.BDATE-PROCESS-DATE-MM;
  AIN49W9.WS-CURRENT-FIL2 = "-";
  AIN49W9.WS-CURRENT-DD = BDATEREC.BDATE-PROCESS-DATE-DD;

  /* *************************/
  /* SETTING KEY H2-PERSON **/
  /* *************************/

  H2-PERSON.UPI = AIN49W.WS-UPI;

  /* *****************************/
  /* END SETTING KEY H2-PERSON **/
  /* *****************************/

  AIN49P9-READ-S33();

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  /* ********************************/
  /* perform sql error processing **/
  /* ********************************/

  WDB00PE-SQLERR();

  /* **************************/
  /* check for fatal errors **/
  /* **************************/

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  AIN49W9.WS-9-CHILD-SSN = H2-PERSON.SSN;
  AIN49W9.WS-9-LST-NM = H2-PERSON.LST-NM;
  AIN49W9.WS-9-FRST-NM = H2-PERSON.FRST-NM;

  /* *********************************/
  /* SETTING KEY H2-FAM-CASE-HSTRY **/
  /* *********************************/

  H2-FAM-CASE-HSTRY.ICI = AIN49W.WS-ICI;
  H2-FAM-CASE-HSTRY.PRD-BEG-DT = AIN49W9.WS-CURRENT-DT;
  H2-FAM-CASE-HSTRY.PRD-END-DT = AIN49W9.WS-CURRENT-DT;

  /* *************************************/
  /* END SETTING KEY H2-FAM-CASE-HSTRY **/
  /* *************************************/

  AIN49P9-READ-S34();

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  /* ********************************/
  /* perform sql error processing **/
  /* ********************************/

  WDB00PE-SQLERR();

  /* **************************/
  /* check for fatal errors **/
  /* **************************/

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  AIN49W9.WS-9-CNTY-CD = H2-FAM-CASE-HSTRY.DCFS-OFC-CNTY-CD;
  SR-Q-REGRNT-REC.DD-FILE = AIN49W9.WS-9-FILE;
end // end AIN49P9-GRNT-INFO


// INSERT CASE MEMBER HIST DATA
Function AIN49P9-INS-CMHD()
  /* -------------------------PTR 4613 BEGIN----------------------------*/
  /*  */
  /* INSERT CASE MEMB HST DATA*/
  /*  */
  /* The period begin date and period end date are set in the create case*/
  /* member hst process. The remaining data is moved into the case member*/
  /* history table in the INSERT-CASE-MEMB-HST-DATA process.*/
  /*  */

  H2-CASE-MEMBER-HST.UPI = AIN49W.WS-UPI;
  H2-CASE-MEMBER-HST.ICI = AIN49W.WS-ICI;

  H2-CASE-MEMBER-HST.PRD-BEG-DT = AIN49W.WS-CASE-MEMB-BEG-DATE;
  H2-CASE-MEMBER-HST.PRD-END-DT = AIN49W.WS-CASE-MEMB-END-DATE;
  H2-CASE-MEMBER-HST.FS-ASST-IND = "N";

  /* ** Changes due to PTR 9047 --- Begin---*/
  /* MOVE SR-Q-DCF-REC.D-MEMB-MA-NBR TO*/
  /* AIN49W5.WS-MEMB-MA-NBR;*/
  /* MOVE AIN49W5.WS-MEMB-MA-NBR1 TO AIN49W5.WS-MEMB-MA-NBR2;*/
  /* MOVE AIN49W5.WS-MEMB-MA-NBR2 TO H2-CASE-MEMBER-HST.MEDIC-BLNG-SQ-NMB;*/
  /* ** Changes due to PTR 9047 --- End ---*/

  H2-CASE-MEMBER-HST.TC-ASST-IND = "N"; /* WI 28413*/
  H2-CASE-MEMBER-HST.TL-ASST-IND = "N"; /* WI 28413*/
  H2-CASE-MEMBER-HST.TN-ASST-IND = "N"; /* WI 28413*/
  H2-CASE-MEMBER-HST.TP-ASST-IND = "N"; /* WI 28413*/

  H2-CASE-MEMBER-HST.AFDC-ASST-IND = "N";
  H2-CASE-MEMBER-HST.MA-ASST-IND = "N";
  AIN49W5.WS-MEMB-MA-AID-CODE = SR-Q-DCF-REC.D-MEMB-MA-AID-CODE;
  AIN49W5.WS-MEMB-MA-AID-CODE-2 = AIN49W5.WS-MEMB-MA-AID-CODE-2DIGITS;
  H2-CASE-MEMBER-HST.IVE-AID-CD = AIN49W5.WS-MEMB-MA-AID-CODE-2;
  if (SR-Q-DCF-REC.D-NEW-LAYOUT-FLAG == " ")
    H2-CASE-MEMBER-HST.IVE-ELIG-CD = SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE;
  else
    H2-CASE-MEMBER-HST.IVE-ELIG-CD = AIN49W3.RPT-ELIG-CD;
  end
  H2-CASE-MEMBER-HST.MA-30-1-3-D1-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.MA-30-BEG-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.AFDC-30-BEG-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.FS-QUIT-SANC-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.HH-LEFT-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.JOIN-RPRTD-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.JOIN-HH-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.AFDC-30-1-3-D1-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.AFDC-30-1-3-D2-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.AFDC-30-1-3-D3-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.AFDC-30-1-3-D4-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.MA-30-1-3-D1-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.MA-30-1-3-D2-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.MA-30-1-3-D3-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.MA-30-1-3-D4-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.AFDC-BEG-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.FS-BEG-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.AFDCAID-CD-CHNG-DT = "9999-12-31";
  H2-CASE-MEMBER-HST.MAAID-CD-CHNG-DT = "9999-12-31";

  H2-CASE-MEMBER-HST.TC-BEG-DT = "9999-12-31"; /* WI 28413*/
  H2-CASE-MEMBER-HST.TL-BEG-DT = "9999-12-31"; /* WI 28413*/
  H2-CASE-MEMBER-HST.TN-BEG-DT = "9999-12-31"; /* WI 28413*/
  H2-CASE-MEMBER-HST.TP-BEG-DT = "9999-12-31"; /* WI 28413*/

  /* PERFORM AIN49P9-INS-I04;*/
  AIN49P9-CMH-I04();
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";

  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /* --------------------------PTR 4613 END------------------------------*/
end // end AIN49P9-INS-CMHD


// INSERT ELIG VERSION MEMBER
Function AIN49P9-INS-ELIGDC()
  set H2-ELIG-DCFS empty;

  H2-ELIG-DCFS.ICI = H2-ELG-VER-MBR.ICI;
  H2-ELIG-DCFS.PRGM-CASE-TYPE = "CW";
  H2-ELIG-DCFS.BNFT-YR = H2-ELG-VER-MBR.BNFT-YR;
  H2-ELIG-DCFS.BNFT-MTH = H2-ELG-VER-MBR.BNFT-MTH;
  H2-ELIG-DCFS.VER-NMB = H2-ELG-VER-MBR.VER-NMB;
  H2-ELIG-DCFS.UPI = H2-ELG-VER-MBR.UPI;
  H2-ELIG-DCFS.DENIAL-REASON-CD = SR-Q-DCF-REC.D-DENIAL-TERM-REASON-CODE;
  H2-ELIG-DCFS.TRMN-REASON-CD = SR-Q-DCF-REC.D-TERM-REASON-CODE;
  H2-ELIG-DCFS.CASH-IND = SR-Q-DCF-REC.D-CASH-IND;
  H2-ELIG-DCFS.MEDICAL-IND = SR-Q-DCF-REC.D-MEDICAL-IND;
  H2-ELIG-DCFS.PRIOR-MED-EXP-IND = SR-Q-DCF-REC.D-PRIOR-MEDICAL-EXP-IND;
  H2-ELIG-DCFS.PROOF-OF-PRIOR-MED = SR-Q-DCF-REC.D-PROOF-OF-PRIOR-MEDICAL-IND;
  H2-ELIG-DCFS.JRSDN-OF-LEGL-CUST = SR-Q-DCF-REC.D-JURISDICTION-OF-LEGAL-CUST;
  H2-ELIG-DCFS.JRSDN-OF-HEARING = SR-Q-DCF-REC.D-JURISDICTION-OF-HEARING;
  H2-ELIG-DCFS.QLFD-ALIEN-IND = SR-Q-DCF-REC.D-QUALIFIED-ALIEN-IND;

  WDB00PI();
  AIN49P9-INS-I25();

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
end // end AIN49P9-INS-ELIGDC


// INSERT ELIG VERSION
Function AIN49P9-INS-EVER()
  /* ----------------------PTR 4654 BEGIN------------------------*/
  /*  */
  /* INSERT ELIG VERSION*/
  /*  */
  set H2-ELIG-VERSION empty;
  if (SR-Q-DCF-REC.D-RECORD-TYPE == "N")
    H2-ELIG-VERSION.VER-NMB = 1;
    H2-ELIG-VERSION.ICI = AIN49W.WS-ICI;
  else
    H2-ELIG-VERSION.VER-NMB = AIN49W.WS-ELIG-NUM;
    H2-ELIG-VERSION.ICI = AIN49W.WS-IVA-ICI;
  end
  H2-ELIG-VERSION.CRY-FWD-PRC-IND = "Y";

  H2-ELIG-VERSION.PRGM-CASE-TYPE = "CW";
  H2-ELIG-VERSION.BNFT-MTH = AIN49W.WS-ELIG-VER-MTH;
  H2-ELIG-VERSION.BNFT-YR = AIN49W.WS-ELIG-VER-YEAR;
  H2-ELIG-VERSION.ELIG-NUM = 1;
  H2-ELIG-VERSION.CHD-NMB = 1;
  H2-ELIG-VERSION.CASE-RSLT-CD = AIN49W.WS-CASE-RSLT-CD;
  H2-ELIG-VERSION.SCHD-PAY-DT = AIN49W.WS-SCHD-PAY-DATE;

  /* -----------------------PTR 3144 BEGIN----------------------------*/
  AIN49W.WS-TEMP-MM-NUM = AIN49W.WS-ELIG-VER-MTH;
  AIN49W.WS-TEMP-CCYY-NUM = AIN49W.WS-ELIG-VER-YEAR;
  AIN49W.WS-TEMP-DD-NUM = 01;
  AIN49W.WS-TEMP-SEP1 = "-";
  AIN49W.WS-TEMP-SEP2 = "-";
  H2-ELIG-VERSION.BNFT-DUE-DT = AIN49W.WS-TEMP-DATE;

  H2-ELIG-VERSION.BNFT-TYPE = AIN49W.WS-BNFT-TYPE;
  H2-ELIG-VERSION.ISSUE-IND = AIN49W.WS-ISSUE-IND;
  /* not to issue med cards in NOMADS*/
  /* MOVE 'Y' TO H2-ELIG-VERSION.ISSUE-IND;*/

  /* changes due to wi#15289 - begin;*/
  /* all the dcfs cases must be autoposted;*/

  /* IF AIN49W.WS-POST-TYPE = 'A';*/
  H2-ELIG-VERSION.POST-TYPE = "A";
  H2-ELIG-VERSION.POSTD-DT = AIN49W.WS-PROCESS-DT;
  H2-ELIG-VERSION.POSTD-BY = "SYSTEM";
  H2-ELIG-VERSION.LST-POSTD-VER-IND = "Y";
  /* ELSE;*/
  /* IF AIN49W.WS-POST-TYPE = 'M';*/
  /* MOVE 'M' TO H2-ELIG-VERSION.POST-TYPE;*/
  /* SET H2-ELIG-VERSION.POSTD-DT NULL;*/
  /* END;*/
  /* END;*/
  /* changes due to wi#15289 - end;*/
  /* ----------------------PTR 7826 -   BEGIN---------------------------*/
  AIN49W.WS-TEMP-MM-NUM = H2-ELIG-VERSION.BNFT-MTH;
  AIN49W.WS-TEMP-CCYY-NUM = AIN49W.WS-ELIG-VER-YEAR;
  AIN49W.WS-TEMP-DD-NUM = 01;
  AIN49W.WS-TEMP-SEP1 = "-";
  AIN49W.WS-TEMP-SEP2 = "-";

  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};

  H2-ELIG-VERSION.ELG-VER-EFF-DT = AIN49W.WS-TEMP-DATE;
  H2-ELIG-VERSION.ELG-VER-COMP-TM = GDW.TS;
  H2-ELIG-VERSION.LST-PRCSD-TS = GDW.TS;
  H2-ELIG-VERSION.ESTM-TRMNT-DT = "9999-12-31";
  H2-ELIG-VERSION.RCPT-DT = "9999-12-31";
  H2-ELIG-VERSION.RPRTD-DT = "9999-12-31";
  H2-ELIG-VERSION.LSUM-DISQ-ST-DT = "9999-12-31";
  H2-ELIG-VERSION.LSUM-DISQ-END-DT = "9999-12-31";
  H2-ELIG-VERSION.INSTL-HBW-STRT-DT = "9999-12-31";
  /* ----------------------PTR 7826 -   END-----------------------------*/


  /* For a new case, create TWNELIG_VERSION and TWNELG_VER_MBR for the*/
  /* Benefit month and Benefit month + 1;*/

  WDB00PI();
  AIN49P9-CRE-I14();
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  /* Check for fatal errors*/
  /*  */
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* -------------------PTR 4654 END-------------------------------*/

  AIN49P9-AGDOUT-PRC(); /* WI 27695*/

  /* CHANGES DUE TO WI# 24622 - START;*/
  set AIF25W1 empty;
  AIF25W1.CALLING-PRGM = "AIN49A";
  AIF25W1.ICI = H2-ELIG-VERSION.ICI;
  AIF25W1.PRGM-CASE-TYPE = "CW";
  AIF25W1.BNFT-MTH = H2-ELIG-VERSION.BNFT-MTH;
  AIF25W1.BNFT-YR = H2-ELIG-VERSION.BNFT-YR;
  call "AIF25A" (VDBCONTROL, VMESSAGE, AIF25W1) {isNoRefresh = yes};
  /* CHANGES DUE TO WI# 24622 - END ;*/
  /*  */
  if (SR-Q-DCF-REC.D-NEW-LAYOUT-FLAG == "Y")
    AIN49W3.RPT-JLC = SR-Q-DCF-REC.D-JURISDICTION-OF-LEGAL-CUST;
    AIN49W3.RPT-REC-TYPE = SR-Q-DCF-REC.D-RECORD-TYPE;
    AIN49W3.RPT-BNFT-MTH = H2-ELIG-VERSION.BNFT-MTH;
    AIN49W3.RPT-BNFT-YEAR = H2-ELIG-VERSION.BNFT-YR;
    AIN49P9-NEW-REPORT();
  end
  /*  */
end // end AIN49P9-INS-EVER


// INSERT ELIG VERSION MEMBER
Function AIN49P9-INS-EVERM()
  /* -----------------------PTR 4654 BEGIN-----------------------------*/
  /*  */
  /* Insert Elig Version Member*/
  /*  */
  set H2-ELG-VER-MBR empty;

  H2-ELG-VER-MBR.ICI = H2-ELIG-VERSION.ICI;
  H2-ELG-VER-MBR.PRGM-CASE-TYPE = "CW";
  H2-ELG-VER-MBR.BNFT-MTH = AIN49W.WS-ELIG-VER-MTH;
  H2-ELG-VER-MBR.BNFT-YR = AIN49W.WS-ELIG-VER-YEAR;
  H2-ELG-VER-MBR.UPI = AIN49W.WS-UPI;
  H2-ELG-VER-MBR.AID-CD = SR-Q-DCF-REC.D-MEMB-MA-AID-CODE;
  if (SR-Q-DCF-REC.D-NEW-LAYOUT-FLAG == " ")
    H2-ELG-VER-MBR.ELIG-CD = SR-Q-DCF-REC.D-MEMB-MA-ELIG-CODE;
  else
    H2-ELG-VER-MBR.ELIG-CD = AIN49W3.RPT-ELIG-CD;
  end
  if (SR-Q-DCF-REC.D-RECORD-TYPE == "N")
    H2-ELG-VER-MBR.VER-NMB = 1;
  else
    H2-ELG-VER-MBR.VER-NMB = AIN49W.WS-ELIG-NUM;
  end

  WDB00PI();
  AIN49P9-INS-I17();

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  /* Check for fatal errors*/
  /*  */
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* -----------------------PTR 4654 BEGIN-----------------------------*/
end // end AIN49P9-INS-EVERM


// INSERT TWNPERSON ( SQL)
Function AIN49P9-INS-I01()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I01";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCOMMON.USQLREC = "H2-PERSON";
  try
    add H2-PERSON
      with #sql{
        insert into TWNPERSON
        (UPI, IVE_MMBR_IND,
            ETHNC_CD, SEX_CD,BIRTH_PLACE_CD, DOB,
            BIRTH_DT_VRFN_IND,MID_NM,FRST_NM, LST_NM,
            INTND_TO_RESD_IND, PRMRY_LANG_CD,PLACE_OF_BIRTH,INTRP_REQD_IND,
             SSN,SSN_VRFN_STS_CD,ESD_SENT_DT,DEATH_VRFD_DT,DEATH_DT,GRADN_DT,
             SSN_APL_DT,SS5_DT,MEDIC_BLNG_SQ_NMB,PHONETIC_NM1,PHONETIC_NM2)
        values (:UPI, :IVE-MMBR-IND, :ETHNC-CD, :SEX-CD, :BIRTH-PLACE-CD,
             :DOB, :BIRTH-DT-VRFN-IND,:MID-NM, :FRST-NM,
            :LST-NM, :INTND-TO-RESD-IND, :PRMRY-LANG-CD,:PLACE-OF-BIRTH,
            :INTRP-REQD-IND,:SSN, :SSN-VRFN-STS-CD,:ESD-SENT-DT,:DEATH-VRFD-DT,
            :DEATH-DT,:GRADN-DT,:SSN-APL-DT,:SS5-DT,:MEDIC-BLNG-SQ-NMB,
            :PHONETIC-NM1,:PHONETIC-NM2)
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I01


// INSERT PERSON HISTORY ( SQL )
Function AIN49P9-INS-I02()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I02";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON-HSTRY";
  VDBCOMMON.USQLREC = "H2-PERSON-HSTRY";
  try
    add H2-PERSON-HSTRY
      with #sql{
        insert into TWNPERSON_HSTRY
        (UPI, PRD_BEG_DT, MRTL_STS_CD, US_CTZN_IND, US_CTZN_VRFN_IND,
             PRD_END_DT, US_CTZN_VRFD_BY, US_CTZN_VRFD_DT,LST_GR_VRFD_IND,
             LST_GRADE_CMPL_CD, OLD_FRST_NM, OLD_LST_NM, OLD_MID_NM, 
             OLD_MODFR, OLD_SSN, LST_GRADE_CMPLT_DT, DRG_CNVCT_TANF_IND,             
             DRG_CNVCT_FS_IND, FELON_TANF_IND, FELON_FS_IND, PUB_EMP_CHD,
             PAST_HLTH_CVRG, CVRG_END_DT, CVRG_END_RSN, NCU_ENRL_DT, TAX_FILE_STS
            )
        values (:UPI, :PRD-BEG-DT,:MRTL-STS-CD,:US-CTZN-IND, :US-CTZN-VRFN-IND,
             :PRD-END-DT,:US-CTZN-VRFD-BY,:US-CTZN-VRFD-DT,:LST-GR-VRFD-IND,
             :LST-GRADE-CMPL-CD, :OLD-FRST-NM, :OLD-LST-NM, :OLD-MID-NM, 
             :OLD-MODFR, :OLD-SSN, :LST-GRADE-CMPLT-DT, :DRG-CNVCT-TANF-IND, 
             :DRG-CNVCT-FS-IND, :FELON-TANF-IND, :FELON-FS-IND, :PUB-EMP-CHD,
             :PAST-HLTH-CVRG, :CVRG-END-DT, :CVRG-END-RSN, :NCU-ENRL-DT, :TAX-FILE-STS 
            )
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I02


// INSERT CASE MEMB HIST ( SQL )
Function AIN49P9-INS-I04()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I04";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-CASE-MEMBER-HST";
  VDBCOMMON.USQLREC = "H2-CASE-MEMBER-HST";
  try
    add H2-CASE-MEMBER-HST ;
  end

  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I04


// INSERT CASE MEMBER ( SQL )
Function AIN49P9-INS-I05()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I05";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-CASE-MEMBER";
  VDBCOMMON.USQLREC = "H2-CASE-MEMBER";
  try
    add H2-CASE-MEMBER
      with #sql{
        insert into TWNCASE_MEMBER
        (UPI, ICI)
        values (:UPI, :ICI)
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end

  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I05


// INSERT MEMBER RELATION ( SQL )
Function AIN49P9-INS-I06()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I06";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-MEMBER-REL";
  VDBCOMMON.USQLREC = "H2-MEMBER-REL";
  try
    add H2-MEMBER-REL
      with #sql{
        insert into TWNMEMBER_REL
        (FROM_UPI, ICI, TO_UPI, PRD_BEG_DT, RELSH_CD,
          PRD_END_DT, REL_VERF_CD, REL_VERF_BY,
          REL_VERF_DT)
        values (:FROM-UPI, :ICI, :TO-UPI, :PRD-BEG-DT, :RELSH-CD,
          :PRD-END-DT, :REL-VERF-CD, :REL-VERF-BY,
          :REL-VERF-DT)
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end

  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I06


// INSERT FAM CASE ( SQL )
Function AIN49P9-INS-I07()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I07";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-CASE";
  VDBCOMMON.USQLREC = "H2-FAM-CASE";
  try
    add H2-FAM-CASE
      with #sql{
        insert into TWNFAM_CASE
        (ICI, CASE_ESTBL_DT, DUPL_ASST_IND,CASE_APPL_DT,
            OOS_SSP_RCVD_IND,FRST_BNFT_DT,IVE_RFRL_DT,MVD_DT,
            FS_APLD_IND,
            MAABD_APLD_IND, IVE_CASE_ID,LVNG_ARRGT_CD,FS_ISNCE_CD_EFF_DT,
            HOH_UPI, APPL_UPI,
            ATZD_RPRSN_IND,EXFS_APLD_IND,ALT_PAYEE_IND,
            AFDC_APLD_IND , PRGD_DT,
            TC_APLD_IND, TL_APLD_IND, TN_APLD_IND, TP_APLD_IND)
        values (:ICI, :CASE-ESTBL-DT, :DUPL-ASST-IND,
            :CASE-APPL-DT, :OOS-SSP-RCVD-IND,
            :FRST-BNFT-DT,:IVE-RFRL-DT,:MVD-DT,
            :FS-APLD-IND, :MAABD-APLD-IND,
            :IVE-CASE-ID,:LVNG-ARRGT-CD,:FS-ISNCE-CD-EFF-DT,
            :HOH-UPI, :APPL-UPI, :ATZD-RPRSN-IND,:EXFS-APLD-IND,:ALT-PAYEE-IND,
            :AFDC-APLD-IND,:PRGD-DT,
            :TC-APLD-IND, :TL-APLD-IND, :TN-APLD-IND, :TP-APLD-IND)
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end

  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I07


// INSERT FAM CASE HISTORY (SQL)
Function AIN49P9-INS-I08()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I08";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-CASE-HSTRY";
  VDBCOMMON.USQLREC = "H2-FAM-CASE-HSTRY";
  try
    add H2-FAM-CASE-HSTRY
      with #sql{
        insert into TWNFAM_CASE_HSTRY
        (ICI, PRD_BEG_DT, CASE_STS, MTHLY_RPTR_IND, AUTO_POST_IND,
             PRD_END_DT,HOH_UPI, APPL_UPI,OLD_MTHLY_RPTR_IND,
            HOH_UPI_CHNG_DT,VERF_DUE_DT, DCFS_OFC_CNTY_CD)
        values (:ICI, :PRD-BEG-DT, :CASE-STS, :MTHLY-RPTR-IND, :AUTO-POST-IND,
             :PRD-END-DT, :HOH-UPI, :APPL-UPI,:OLD-MTHLY-RPTR-IND,
             :HOH-UPI-CHNG-DT,:VERF-DUE-DT, :DCFS-OFC-CNTY-CD)
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end

  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I08


// INSERT FAM ALTERNATE PAYEE-SQL
Function AIN49P9-INS-I09()
  VDBCONTROL.UPROC-NM = "AIN49AP9-INS-I09";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-ALT-PAYEE";
  VDBCOMMON.USQLREC = "H2-FAM-ALT-PAYEE";
  try
    add H2-FAM-ALT-PAYEE
      with #sql{
        insert into twnfam_alt_payee
        (ICI,EFF_FR_DT,ALT_PYE_LST_NM, ALT_PYE_FRST_NM, ALT_PYE_MID_NM,
             ALT_PYE_MODFR, PHN_NMB, PHN_EXT, HOUSE_NMB, STR_NM, STR_DIR,
             STR_TYPE, APT_NMB, OTH_ADDR, CITY, ST_CD, ZIP_CD,EFF_TO_DT,
             PYEE_RSN_CD , SSN , ISS_NTCE_IND , DOB, ALT_PYE_TYP,
             EBT_AP_MAIL_IND, SEND_DEMO_NOW, WRK_PHN_NMB, WRK_PHN_EXT,
             MSG_PHN_NMB, MSG_PHN_EXT, CELL_PHN_NMB, CELL_PHN_EXT,
             FAX_NMB, FAX_EXT, EMAIL_ID)
        values (:ICI,:EFF-FR-DT,:ALT-PYE-LST-NM, :ALT-PYE-FRST-NM,
            :ALT-PYE-MID-NM, :ALT-PYE-MODFR, :PHN-NMB, :PHN-EXT, :HOUSE-NMB,
            :STR-NM, :STR-DIR, :STR-TYPE, :APT-NMB, :OTH-ADDR, :CITY, :ST-CD,
            :ZIP-CD,:EFF-TO-DT, :PYEE-RSN-CD, :SSN, :ISS-NTCE-IND ,:DOB ,
            :ALT-PYE-TYP,
            :EBT-AP-MAIL-IND, :SEND-DEMO-NOW, :WRK-PHN-NMB, :WRK-PHN-EXT,
            :MSG-PHN-NMB, :MSG-PHN-EXT, :CELL-PHN-NMB, :CELL-PHN-EXT,
            :FAX-NMB, :FAX-EXT, :EMAIL-ID)
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end

  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I09


// INSERT ALTERNATE SSN ( SQL )
Function AIN49P9-INS-I10()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I10";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-ALTERNATE-SSN";
  VDBCOMMON.USQLREC = "H2-ALTERNATE-SSN";
  try
    add H2-ALTERNATE-SSN
      with #sql{
        insert into twnalternate_ssn
        (UPI, ALT_SSN,VRFN_FG, VRFN_DT)
        values (:UPI, :ALT-SSN,:VRFN-FG,:VRFN-DT)
      } ;
  end

  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I10


// INSERT PROGM CASE DTLS ( SQL )
Function AIN49P9-INS-I11()
  VDBCONTROL.UPROC-NM = "AIN49AP9-INS-I11";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-PRGM-CASE-DTLS";
  VDBCOMMON.USQLREC = "H2-PRGM-CASE-DTLS";
  try
    add H2-PRGM-CASE-DTLS
      with #sql{
        insert into TWNPRGM_CASE_DTLS
        (ICI, PRGM_CASE_TYPE, UNEMPLD_31ST_DT,
             IVF_CALL_DT )
        values (:ICI, :PRGM-CASE-TYPE, '0001-01-01',
             '0001-01-01')
      } ;
  end

  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I11


// INSERT PRGM CASE HSTRY ( SQL )
Function AIN49P9-INS-I12()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I12";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-PRGM-CASE-HSTRY";
  VDBCOMMON.USQLREC = "H2-PRGM-CASE-HSTRY";
  try
    add H2-PRGM-CASE-HSTRY ;
  end

  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I12


// INSERT UNEARNED INCM ( SQL )
Function AIN49P9-INS-I13()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I13";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";
  VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";
  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  try
    add H2-UERND-INCM-DTL
      with #sql{
        insert into TWNUERND_INCM_DTL
        (UPI, PRD_BEG_DT, UERND_INC_TYPE_CD, INCM_SQ_NMB,UERND_INC_FREQ,
             UERND_INC_AMT,AFDC_CNTBL_IND,FS_CNTBL_IND, MA_CNTBL_CD,PRD_END_DT,
             UNE_INC_VERF_CD,UERND_INC_RCVD_DT,RECUR_IND,
             CHNG_ENTRY_DT,
             UNE_INC_VERF_DT,RCVD_DT,RPRTD_DT,RCPT_DT, RSDI_CLM_NUM,
             UERND_INCM_CD, IVE_NONIVE_IND)
        values (:UPI, :PRD-BEG-DT, :UERND-INC-TYPE-CD, :INCM-SQ-NMB,
             :UERND-INC-FREQ,:UERND-INC-AMT,
             :AFDC-CNTBL-IND, :FS-CNTBL-IND, :MA-CNTBL-CD,:PRD-END-DT,
             :UNE-INC-VERF-CD,:UERND-INC-RCVD-DT,:RECUR-IND,
             :GDW.DTCD,
             :UNE-INC-VERF-DT,:RCVD-DT,:RPRTD-DT,:RCPT-DT, :RSDI-CLM-NUM,
             :UERND-INCM-CD, :IVE-NONIVE-IND)
      } ;
  end

  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I13


// INSERT FAM CASELD CASE ( SQL )
Function AIN49P9-INS-I15()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I15";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-CASELD-CASE";
  VDBCOMMON.USQLREC = "H2-FAM-CASELD-CASE";
  try
    add H2-FAM-CASELD-CASE ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end

  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I15


// INSERT FAM ALTERNATE PAYEE-SQL
Function AIN49P9-INS-I16()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I16";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-ALT-PAYEE";
  VDBCOMMON.USQLREC = "H2-FAM-ALT-PAYEE";
  try
    add H2-FAM-ALT-PAYEE
      with #sql{
        insert into twnfam_alt_payee
        (ICI, EFF_FR_DT, ALT_PYE_LST_NM,
          ALT_PYE_FRST_NM, ALT_PYE_MID_NM, ALT_PYE_MODFR,
          PHN_NMB, PHN_EXT, HOUSE_NMB, STR_NM, STR_DIR,
          STR_TYPE, APT_NMB, OTH_ADDR, CITY, ST_CD,
          ZIP_CD, EFF_TO_DT, PYEE_RSN_CD, SSN,
          ISS_NTCE_IND, DOB , ALT_PYE_TYP,
          EBT_AP_MAIL_IND, SEND_DEMO_NOW, WRK_PHN_NMB, WRK_PHN_EXT,
          MSG_PHN_NMB, MSG_PHN_EXT, CELL_PHN_NMB, CELL_PHN_EXT,
          FAX_NMB, FAX_EXT, EMAIL_ID)
        values (:ICI, :EFF-FR-DT, :ALT-PYE-LST-NM,
          :ALT-PYE-FRST-NM, :ALT-PYE-MID-NM, :ALT-PYE-MODFR,
          :PHN-NMB, :PHN-EXT, :HOUSE-NMB, :STR-NM, :STR-DIR,
          :STR-TYPE, :APT-NMB, :OTH-ADDR, :CITY, :ST-CD,
          :ZIP-CD, :EFF-TO-DT, :PYEE-RSN-CD, :SSN,
          :ISS-NTCE-IND, :DOB , :ALT-PYE-TYP,
          :EBT-AP-MAIL-IND, :SEND-DEMO-NOW, :WRK-PHN-NMB, :WRK-PHN-EXT,
          :MSG-PHN-NMB, :MSG-PHN-EXT, :CELL-PHN-NMB, :CELL-PHN-EXT,
          :FAX-NMB, :FAX-EXT, :EMAIL-ID)
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I16


// INSERT ELG VER MBR ( SQL )
Function AIN49P9-INS-I17()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I17";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-ELG-VER-MBR";
  VDBCOMMON.USQLREC = "H2-ELG-VER-MBR";
  try
    add H2-ELG-VER-MBR
      with #sql{
        insert into twnelg_ver_mbr
        (ICI, PRGM_CASE_TYPE, BNFT_YR, BNFT_MTH, VER_NMB, UPI,
             AID_CD, ELIG_CD,RMVL_DT)
        values (:ICI, :PRGM-CASE-TYPE, :BNFT-YR, :BNFT-MTH, :VER-NMB, :UPI,
             :AID-CD, :ELIG-CD,'9999-12-31')
      } ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCOMMON.UAPPLNAM = "AIN49A";
  VDBCONTROL.UACCTYP = "W";
end // end AIN49P9-INS-I17


// INSERT FAM ACTIONS ( SQL )
Function AIN49P9-INS-I18()
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I18";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-ACTNS";
  VDBCOMMON.USQLREC = "H2-FAM-ACTNS";
  VDBCONTROL.UPROC-OPT = "ADD";
  /* CALL DATEAPP GDW,VDBCONTROL,VMESSAGE (NOMAPS;*/
  try
    add H2-FAM-ACTNS ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN49A";
end // end AIN49P9-INS-I18


// INSERT FAM CASE HSTRY ( SQL )
Function AIN49P9-INS-I19()
  /*  */
  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I19";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-FAM-CASE-HSTRY";
  VDBCOMMON.USQLREC = "H2-FAM-CASE-HSTRY";
  try
    add H2-FAM-CASE-HSTRY
      with #sql{
        insert into TWNFAM_CASE_HSTRY
        (ICI, PRD_BEG_DT, CASE_STS, MTHLY_RPTR_IND,
          AUTO_POST_IND, RESET_VRFN_IND, PRD_END_DT,
          NMB_OF_DPNDS, HOH_UPI, APPL_UPI, PREV_HOH_UPI,
          HOH_UPI_CHNG_DT, AUTO_CLSRE_IND, VERF_DUE_DT,
          DCFS_OFC_CNTY_CD, SBSDZ_IND, HSG_TYP_CD,
          NMB_OF_PA_PRSNS, FS_SUFX, VRFN_EXTN_IND,
          HMLS_IND, SPLZD_CD, OLD_MTHLY_RPTR_IND,
          VERF_ELIG_FM_DT, VERF_ELIG_TO_DT,
          PRP_SGND_DT, NXT_PRP_RVW_DT, PRP_EXPRS_DT, TANF_ABSNTPRNT_CNT,
          TANF_APPL_REAP_CD, SPSL_MNT_RQRD_IND, TANF_INCM_TST_IND,
          CHAP_INCM_TST_IND, TF_RLTD_MEDICAID)
        values (:ICI, :PRD-BEG-DT, :CASE-STS, :MTHLY-RPTR-IND,
          :AUTO-POST-IND, :RESET-VRFN-IND, :PRD-END-DT,
          :NMB-OF-DPNDS, :HOH-UPI, :APPL-UPI, :PREV-HOH-UPI,
          :HOH-UPI-CHNG-DT, :AUTO-CLSRE-IND, :VERF-DUE-DT,
          :DCFS-OFC-CNTY-CD, :SBSDZ-IND, :HSG-TYP-CD,
          :NMB-OF-PA-PRSNS, :FS-SUFX, :VRFN-EXTN-IND,
          :HMLS-IND, :SPLZD-CD, :OLD-MTHLY-RPTR-IND,
          :VERF-ELIG-FM-DT, :VERF-ELIG-TO-DT,
          :PRP-SGND-DT, :NXT-PRP-RVW-DT, :PRP-EXPRS-DT, :TANF-ABSNTPRNT-CNT,
          :TANF-APPL-REAP-CD, :SPSL-MNT-RQRD-IND, :TANF-INCM-TST-IND,
          :CHAP-INCM-TST-IND, :TF-RLTD-MEDICAID)
      } ;
  end
end // end AIN49P9-INS-I19


// INSERT CASELOAD CASE HST (SQL)
Function AIN49P9-INS-I20()

  VDBCONTROL.UPROC-NM = "AIN49P9-I20";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-CASLD-CASE-HST";
  VDBCOMMON.USQLREC = "H2-CASLD-CASE-HST";
  /*  */
  try
    add H2-CASLD-CASE-HST ;
  end
end // end AIN49P9-INS-I20


// INSERT CASE LOG ( SQL )
Function AIN49P9-INS-I22()

  VDBCONTROL.UPROC-NM = "AIN49P9-INS-I22";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCONTROL.UPROC-OBJ = "H2-CASE-LOG";
  VDBCOMMON.USQLREC = "H2-CASE-LOG";
  try
    add H2-CASE-LOG
      with #sql{
        insert into TWNCASE_LOG
        (ICI, ACTVY_DT, LOG_CRN_TS, PRGM_CASE_TYPE,
          ACTVY_TM, LOG_ENTRY_DESC,
          LOG_ENTRY_TYPE, CL_ACTVY_DESC)
        values (:ICI, :ACTVY-DT, :LOG-CRN-TS, :PRGM-CASE-TYPE,
          :ACTVY-TM, :LOG-ENTRY-DESC,
          :LOG-ENTRY-TYPE, :CL-ACTVY-DESC)
      } ;
  end
end // end AIN49P9-INS-I22