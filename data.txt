
// QUERY TO GET CUT OFF
Function AIN22P9-S06-Q06()
  /*  */

  WDB00PI();

  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN22A";
  VDBCONTROL.UPROC-OBJ = "H2-CLNDR";
  VDBCONTROL.UPROC-NM = "AIN22P9-S06-Q06";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-CLNDR";
  try
    get H2-CLNDR singleRow
      with #sql{
        select CLNDR_DT
        from TWNCLNDR T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        where t1.CLNDR_DT >= :AIN22W.WS-DATE-BEG AND
              t1.CLNDR_DT <= :AIN22W.WS-DATE-END AND
             T1.AFDC_BNFT_TYPE = 'RS'
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into CLNDR-DT ;
  end

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end


  /*  */
end // end AIN22P9-S06-Q06


// READ NEXT INPUT SDX RECORD
Function AIN22P9-SCAN-Q22IP()
  /* CBSI START*/
  VGVar.handleHardIOErrors = 1;
  try
    get next SR-Q22IP-REC ;
  end
  if (SR-Q22IP-REC is ioError && 
  SR-Q22IP-REC not endOfFile)
    VDBCONTROL.UPROC-OBJ = "SR-Q22IP-REC";
    VDBCONTROL.UPROC-NM = "AIN22P9-SCAN-Q22IP";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VMESSAGE.UMSGCODE = sysVar.errorCode;
    WCM00P2-TO-CEP01A();
  end
  /* CBSI END*/
end // end AIN22P9-SCAN-Q22IP


// READ NEXT PUBLIC LAW
Function AIN22P9-SCAN12()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/07/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-SDX-SSI-BNFDTL";
  VDBCONTROL.UPROC-OBJ = "H2-SDX-SSI-BNFDTL";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCAN12";
  VDBCONTROL.UPROC-OPT = "SCAN";
  try
    get next H2-SDX-SSI-BNFDTL ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /* CBSI END*/
end // end AIN22P9-SCAN12


// READ NEXT ALTERNATE SSN
Function AIN22P9-SCAN16()
  VDBCOMMON.USQLREC = "H2-ALTERNATE-SSN";
  VDBCONTROL.UPROC-OBJ = "H2-ALTERNATE-SSN";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCAN16";
  VDBCONTROL.UPROC-OPT = "SCAN";
  try
    get next H2-ALTERNATE-SSN ;
  end
  WDB00PE-SQLERR();
  /*  */
end // end AIN22P9-SCAN16


// READ NEXT UERND_INCM_DTL
Function AIN22P9-SCAN3()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCAN3";
  VDBCONTROL.UPROC-OPT = "SCAN";
  try
    get next H2-UERND-INCM-DTL ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /* CBSI END*/
end // end AIN22P9-SCAN3


// READ NEXT CASE_MEM_HST
Function AIN22P9-SCAN4()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-CASE-MEMBER-HST";
  VDBCONTROL.UPROC-OBJ = "H2-CASE-MEMBER-HST";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCAN4";
  VDBCONTROL.UPROC-OPT = "SCAN";
  try
    get next H2-CASE-MEMBER-HST ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /* CBSI END*/
end // end AIN22P9-SCAN4


// SCAN CASE-MEM-HST ROWS
Function AIN22P9-SCAN6()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-3-CMH-FAC-SPT";
  VDBCONTROL.UPROC-OBJ = "H2-3-CMH-FAC-SPT";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCAN6";
  VDBCONTROL.UPROC-OPT = "SCAN";
  try
    get next H2-CASE-MEMBER-HST ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /* CBSI END*/
end // end AIN22P9-SCAN6


// SCAN  H2-2-CMH-FCH ROWS
Function AIN22P9-SCAN8()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-2-CMH-FCH";
  VDBCONTROL.UPROC-OBJ = "H2-2-CMH-FCH";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCAN8";
  VDBCONTROL.UPROC-OPT = "SCAN";
  try
    get next H2-2-CMH-FCH ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /* CBSI END*/
end // end AIN22P9-SCAN8


// READ NEXT UERND_INCM_DTL
Function AIN22P9-SCAN9()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCAN9";
  VDBCONTROL.UPROC-OPT = "SCAN";
  try
    get next H2-UERND-INCM-DTL ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /* CBSI END*/
end // end AIN22P9-SCAN9


Function AIN22P9-SCN5()
  /*  */
  VDBCOMMON.USQLREC = "H2-INCAP-DSBLTY";
  VDBCONTROL.UPROC-OBJ = "H2-INCAP-DSBLTY";
  VDBCONTROL.UPROC-NM = "AIN22P9-SCN5";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    get next H2-INCAP-DSBLTY ;
  end
  /*  */
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /*  */
end // end AIN22P9-SCN5


// INS-IN-SDX-SSI
Function AIN22P9-SDX-SSI()
  set H2-SDXI-UERND-INCM empty;
  set H2-SDX-SSI-BNFDTL empty;

  /* --------CHANGES DUE TO PHASE III REWORK START---------*/

  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
  AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-PROCESSING-MO;
  AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-PROCESSING-DY;
  AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-PROCESSING-YR;
  AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-PROCESSING-CC;
  /* IF AIN22W.WS-NUM1-YY > 90;*/
  /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
  /* ELSE;*/
  /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
  /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
  AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
  AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
  AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
  AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
  AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
  AIN22W.WS-SYS1-F1 = "-";
  AIN22W.WS-SYS1-F2 = "-";
  H2-SDX-SSI-BNFDTL.TAPE-PRCSG-DT = AIN22W.WS-SYS1-DATE;

  /* Move current date to twnsdx_ssi_bnfdtl.process_dt*/

  /* PTR3143 BEGIN*/
  /* CALL DATEAPP GDW,VDBCONTROL,VMESSAGE (NOMAPS;*/
  /* MOVE GDW.DTLC TO AIN22W.WS-SYS-DATE;*/
  /* MOVE AIN22W.WS-SYS-MM TO AIN22W.WS-SYS1-MM;*/
  /* MOVE AIN22W.WS-SYS-DD TO AIN22W.WS-SYS1-DD;*/
  /* MOVE AIN22W.WS-SYS-YY TO AIN22W.WS-SYS1-YY;*/
  /* MOVE AIN22W.WS-SYS-CC TO AIN22W.WS-SYS1-CC;*/
  H2-SDX-SSI-BNFDTL.PROCESS-DT = AIN22W.WS-NOMADS-PROCESS-DATE;
  /* PTR3143 END*/

  /* --------CHANGES DUE TO PHASE III REWORK END----------*/

  H2-SDX-SSI-BNFDTL.LST-NM = SR-Q22IP-REC.TRE-LAST-NAME;
  H2-SDX-SSI-BNFDTL.FRST-NM = SR-Q22IP-REC.TRE-FIRST-NAME;
  H2-SDX-SSI-BNFDTL.MID-INIT = SR-Q22IP-REC.TRE-MIDDLE-INIT;
  H2-SDX-SSI-BNFDTL.UPI = H2-2-CMH-PER.UPI;
  H2-SDX-SSI-BNFDTL.ADR-LINE1 = SR-Q22IP-REC.TRE-PAYEE-NAME-ADDR[1];
  H2-SDX-SSI-BNFDTL.ADR-LINE2 = SR-Q22IP-REC.TRE-PAYEE-NAME-ADDR[2];
  /* PTR 9081 -- ADD MISSING FIELDS ----- 01/03/96 ------ BEGIN -----*/
  H2-SDX-SSI-BNFDTL.ADR-LINE3 = SR-Q22IP-REC.TRE-PAYEE-NAME-ADDR[3];
  H2-SDX-SSI-BNFDTL.RESID-ADR-LINE3 = SR-Q22IP-REC.TRE-RESIDENCE-ADDR[3];
  /* PTR 9081 -- ADD MISSING FIELDS ----- 01/03/96 ------ END -------*/
  AIN22W.WS-ZIP-CODE-5 = SR-Q22IP-REC.TRE-PAYEE-ZIP;
  AIN22W.WS-ZIP-CODE-PLUS-4 = SR-Q22IP-REC.TRE-PAYEE-ZIP-PLUS4;
  H2-SDX-SSI-BNFDTL.ZIP-CD = AIN22W.WS-ZIP-CODE-9;
  H2-SDX-SSI-BNFDTL.RESID-ADR-LINE1 = SR-Q22IP-REC.TRE-RESIDENCE-ADDR[1];
  H2-SDX-SSI-BNFDTL.RESID-ADR-LINE2 = SR-Q22IP-REC.TRE-RESIDENCE-ADDR[2];
  H2-SDX-SSI-BNFDTL.SPS-PRNT-SSN = SR-Q22IP-REC.TRE-INELIG-SPOUSE-OR-PARENT-SSN;

  /* CONVERT TRE-APEALS-DT TO DB2 FORMAT*/

  /* PTR 5715 CHANGES  *** START *****/
  if (SR-Q22IP-REC.TRE-APPEALS-DT == 000000)
    H2-SDX-SSI-BNFDTL.APEAL-DT = "9999-12-31";
  else
  /* PTR 5715 CHANGES  ***  END  *****/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-APPEALS-MO;
    AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-APPEALS-DY;
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-APPEALS-YR;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-APPEALS-CC;
    /* IF AIN22W.WS-NUM1-YY > 90;*/
    /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
    /* ELSE;*/
    /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
    /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
    AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
    AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
    AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
    AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
    AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
    AIN22W.WS-SYS1-F1 = "-";
    AIN22W.WS-SYS1-F2 = "-";
    H2-SDX-SSI-BNFDTL.APEAL-DT = AIN22W.WS-SYS1-DATE;
  end
  /* MOVE PERSON DOB TO BNFT-DTL DOB*/
  H2-SDX-SSI-BNFDTL.DOB = H2-2-CMH-PER.DOB;
  /* PTR 8650 MOVE TRE-ESTABLISHMENT-DT TO DB2 FORMAT --- 11/25/96 - BEG*/

  /* PTR 5715 CHANGES  *** START *****/
  if (SR-Q22IP-REC.TRE-ESTABLISHMENT-DT == 000000)
    H2-SDX-SSI-BNFDTL.ELIG-DT = "9999-12-31";
  else
  /* PTR 5715 CHANGES  ***  END  *****/
   /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-ESTABLIMENT-MO;
    AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-ESTABLIMENT-DY;
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-ESTABLIMENT-YR;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-ESTABLIMENT-CC;
  /* PTR 8650 MOVE TRE-ESTABLISHMENT-DT TO DB2 FORMAT --- 11/25/96 - END*/
  /* PTR 11316 change century data cutoff  ----- 05/19/97 --------------*/
    /* IF AIN22W.WS-NUM1-YY > 50;*/
    /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
    /* ELSE;*/
    /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
    /* END;*/
   /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
    AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
    AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
    AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
    AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
    AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
    AIN22W.WS-SYS1-F1 = "-";
    AIN22W.WS-SYS1-F2 = "-";
    H2-SDX-SSI-BNFDTL.ELIG-DT = AIN22W.WS-SYS1-DATE;
  end
  /* CONVERT TRE-APPLICATION-DT TO DB2 FORMAT*/

  /* PTR 5715 CHANGES  *** START *****/
  if (SR-Q22IP-REC.TRE-APPLICATION-FILING-DT == 000000)
  /* PTR 5715 CHANGES  ***  END  *****/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-APPLICATION-MO;
    AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-APPLICATION-DY;
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-APPLICATION-YR;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-APPLICATION-CC;
  else
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-APPLICATION-FILING-MO;
    AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-APPLICATION-FILING-DY;
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-APPLICATION-FILING-YR;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-APPLICATION-FILING-CC;
  end
  /* ptr 11316 change century date cutoff ------ 05/19/97 -------*/
  /* IF AIN22W.WS-NUM1-YY > 50;*/
  /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
  /* ELSE;*/
  /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
  /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
  AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
  AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
  AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
  AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
  AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
  AIN22W.WS-SYS1-F1 = "-";
  AIN22W.WS-SYS1-F2 = "-";
  H2-SDX-SSI-BNFDTL.APPL-FILNG-DT = AIN22W.WS-SYS1-DATE;
  H2-SDX-SSI-BNFDTL.PB-LAW-CD = AIN22W.WS-PUBLIC-LAW;

  /* CONVERT TRE-APPLICATION-DT TO DB2 FORMAT*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
  AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-APPLICATION-MO;
  AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-APPLICATION-DY;
  AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-APPLICATION-YR;
  AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-APPLICATION-YR;
  /* ptr 11316 change century date cutoff ------ 05/19/97 -------*/
  /* IF AIN22W.WS-NUM1-YY > 50;*/
  /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
  /* ELSE;*/
  /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
  /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
  AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
  AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
  AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
  AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
  AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
  AIN22W.WS-SYS1-F1 = "-";
  AIN22W.WS-SYS1-F2 = "-";
  H2-SDX-SSI-BNFDTL.APL-DT = AIN22W.WS-SYS1-DATE;
  H2-SDX-SSI-BNFDTL.DSBLD-PYMT-CD = SR-Q22IP-REC.TRE-DISABILITY-CD;
  H2-SDX-SSI-BNFDTL.APEAL-STS-CD = SR-Q22IP-REC.TRE-APPEALS-CD;

  /* CONVERT TRE-RESIDENCE-START-DT TO DB2 FORMAT*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
  AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-RESIDENCE-START-MO;
  AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-RESIDENCE-START-DY;
  AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-RESIDENCE-START-YR;
  AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-RESIDENCE-START-CC;
  /* ptr 11316 change century date cutoff ------ 05/19/97 -------*/
  /* IF AIN22W.WS-NUM1-YY > 50;*/
  /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
  /* ELSE;*/
  /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
  /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
  AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
  AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
  AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
  AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
  AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
  AIN22W.WS-SYS1-F1 = "-";
  AIN22W.WS-SYS1-F2 = "-";
  H2-SDX-SSI-BNFDTL.RSDN-DT = AIN22W.WS-SYS1-DATE;
  /* MOVE AIN22W.WS-FED-LIVING-ARR-CD TO*/
  H2-SDX-SSI-BNFDTL.FED-LIVNG-ARGMT-CD = SR-Q22IP-REC.TRE-FED-LIVING-ARRANGE-CD;
  /* MOVE AIN22W.WS-STA-LIVING-ARR-CD TO*/
  H2-SDX-SSI-BNFDTL.ST-LIVNG-ARGMT-CD = SR-Q22IP-REC.TRE-OPT-STATE-SUP-LIV-ARR-CD;
  /* MOVE AIN22W.WS-MOVED-OUT-OF-STATE TO*/
  if (SR-Q22IP-REC.TRE-TRAN-CODE == "05")
    H2-SDX-SSI-BNFDTL.OUT-OF-ST-MVD-IND = "Y";
  else
    H2-SDX-SSI-BNFDTL.OUT-OF-ST-MVD-IND = " ";
  end
  H2-SDX-SSI-BNFDTL.PYMT-STS-CD = SR-Q22IP-REC.TRE-PAY-STATUS-CD[1];
  H2-SDX-SSI-BNFDTL.PYMT-TYP = SR-Q22IP-REC.TRE-MULTI-CATEGORY-IND;
  if (SR-Q22IP-REC.TRE-ONSET-DISABILITY-DT > 0)
    AIN22W.WS-ONSET-DSAB-DT-CY = SR-Q22IP-REC.TRE-DISABILITY-CY;
    AIN22W.WS-ONSET-DSAB-DT-MM = SR-Q22IP-REC.TRE-DISABILITY-MO;
    AIN22W.WS-ONSET-DSAB-DT-DD = SR-Q22IP-REC.TRE-DISABILITY-DY;
    AIN22W.WS-ONSET-DSAB-DT-F1 = "-";
    AIN22W.WS-ONSET-DSAB-DT-F2 = "-";
    H2-SDX-SSI-BNFDTL.DSBLD-ONSET-DT = AIN22W.WS-ONSET-DISABILITY-DT;
  else
    H2-SDX-SSI-BNFDTL.DSBLD-ONSET-DT = "0001-01-01";
  end
  H2-SDX-SSI-BNFDTL.SSI-DNIAL-CD = SR-Q22IP-REC.TRE-DENIAL-CD;

  /* CONVERT TRE-DENIAL-DT TO DB2 FORMAT*/

  /* PTR 5715 CHANGES  *** START *****/
  if (SR-Q22IP-REC.TRE-DENIAL-DT == 000000)
    H2-SDX-SSI-BNFDTL.SSI-DNIAL-DT = "9999-12-31";
  else
  /* PTR 5715 CHANGES  ***  END  *****/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-DENIAL-MO;
    AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-DENIAL-DY;
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-DENIAL-YR;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-DENIAL-CC;
    /* IF AIN22W.WS-NUM1-YY > 90;*/
    /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
    /* ELSE;*/
    /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
    /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
    AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
    AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
    AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
    AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
    AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
    AIN22W.WS-SYS1-F1 = "-";
    AIN22W.WS-SYS1-F2 = "-";
    H2-SDX-SSI-BNFDTL.SSI-DNIAL-DT = AIN22W.WS-SYS1-DATE;
  end
  H2-SDX-SSI-BNFDTL.EARND-INCM-AMT = SR-Q22IP-REC.TRE-EARNED-INC-WAGE-EST;
  H2-SDX-SSI-BNFDTL.SSI-PD-AMT = SR-Q22IP-REC.TRE-SSI-MONTHLY-ASSIST-AMT;
  H2-SDX-SSI-BNFDTL.SSI-ELIG-AMT = SR-Q22IP-REC.TRE-SSI-GROSS-PAYABLE-AMT;
  H2-SDX-SSI-BNFDTL.UERND-INCM-AMT = AIN22W.WS-UERND-INCM-AMT;
  H2-SDX-SSI-BNFDTL.SUP-PD-AMT = SR-Q22IP-REC.TRE-STATE-SUPPLEMENT-AMT;
  H2-SDX-SSI-BNFDTL.SUP-ELIG-AMT = SR-Q22IP-REC.TRE-STATE-SUPPLEMENT-GROSS-PAY;
  H2-SDX-SSI-BNFDTL.EXCLD-INCM-AMT = SR-Q22IP-REC.TRE-EARNED-INC-EXCLUSION;
  AIN22W.WS-NUM1-DATE1 = SR-Q22IP-REC.TRE-BIRTH-DT;
  AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
  AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
  AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
  AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
  AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
  AIN22W.WS-SYS1-F1 = "-";
  AIN22W.WS-SYS1-F2 = "-";
  H2-SDX-SSI-BNFDTL.DT-OF-BIRTH = AIN22W.WS-SYS1-DATE;
  H2-SDX-SSI-BNFDTL.SEX = SR-Q22IP-REC.TRE-SEX;

  /* CONVERT TRE-DATE-OF-DEATH TO DB2 FORMAT*/
  /* CHECK INCLUDED FOR THE CONDITION WHEN THE DEATH DATE FOR A SSN*/
  /* IS ZERO IN THE SDX-INPUT-FILE.  HIGH VALUES ARE INSERTED IN*/
  /* THE TABLE FOR THIS DEATH DATE.*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
  if (((SR-Q22IP-REC.TRE-MONTH-OF-DEATH != 0) && 
  (SR-Q22IP-REC.TRE-DAY-OF-DEATH != 0) && 
  (SR-Q22IP-REC.TRE-YEAR-OF-DEATH != 0)))
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-MONTH-OF-DEATH;
    AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-DAY-OF-DEATH;
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-YEAR-OF-DEATH;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-CC-OF-DEATH;
    /* IF AIN22W.WS-NUM1-YY > 90;*/
    /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
    /* ELSE;*/
    /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
    /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
    AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
    AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
    AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
    AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
    AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
    AIN22W.WS-SYS1-F1 = "-";
    AIN22W.WS-SYS1-F2 = "-";
    H2-SDX-SSI-BNFDTL.DTH-DT = AIN22W.WS-SYS1-DATE;
  else
    H2-SDX-SSI-BNFDTL.DTH-DT = "9999-12-31";
  end
  H2-SDX-SSI-BNFDTL.SDX-TRN-CD = SR-Q22IP-REC.TRE-TRAN-CODE;

  /* CONVERT TRE-LAST-TRANS-DT TO DB2 FORMAT*/

  /* PTR 5715 CHANGES  *** START *****/
  if (SR-Q22IP-REC.TRE-LAST-TRANS-DT == 000000)
    H2-SDX-SSI-BNFDTL.SDX-TRN-DT = "9999-12-31";
  else
  /* PTR 5715 CHANGES  ***  END  *****/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-LAST-TRANS-MO;
    AIN22W.WS-NUM1-DD = SR-Q22IP-REC.TRE-LAST-TRANS-DY;
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-LAST-TRANS-YR;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-LAST-TRANS-CC;
    /* IF AIN22W.WS-NUM1-YY > 90;*/
    /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
    /* ELSE;*/
    /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
    /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
    AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
    AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
    AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
    AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
    AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
    AIN22W.WS-SYS1-F1 = "-";
    AIN22W.WS-SYS1-F2 = "-";
    H2-SDX-SSI-BNFDTL.SDX-TRN-DT = AIN22W.WS-SYS1-DATE;
  end
  H2-SDX-SSI-BNFDTL.SDX-TRN-TYP = SR-Q22IP-REC.TRE-LAST-TRANS-TYPE;
  H2-SDX-SSI-BNFDTL.REC-ID = SR-Q22IP-REC.TRE-ID-CODE;
  H2-SDX-SSI-BNFDTL.REP-PYEE-TYP-CD = SR-Q22IP-REC.TRE-TYPE-OF-PAYEE-CD;
  H2-SDX-SSI-BNFDTL.T30-REACC-CD = SR-Q22IP-REC.TRE-REACCRETION-INDICATOR;
  AIN22W.WS-CROSS-REF-IND = SR-Q22IP-REC.TRE-SSN-CROSS-REF-IND;
  H2-SDX-SSI-BNFDTL.SSN-XREF-NUM = AIN22W.WS-CROSS1-REF-IND;
  H2-SDX-SSI-BNFDTL.CNDTL-PYMT-CD = SR-Q22IP-REC.TRE-CONDITIONAL-PAY-IND;
  /* ** start wi 21582 ***/
  /* MOVE AIN22W.WS-PAY-STATUS-CD TO H2-SDX-SSI-BNFDTL.PYMT-STS-CD;*/
  /* ** start wi 21582 ***/
  H2-SDX-SSI-BNFDTL.DRGAL-ADDCT-CD = SR-Q22IP-REC.TRE-DRUG-ADDICT-ALCOH-ID-CD;
  H2-SDX-SSI-BNFDTL.FED-SSI-ELIG-STAT = SR-Q22IP-REC.TRE-FED-ELIG-CD;
  H2-SDX-SSI-BNFDTL.ST-MAND-ELIG-CD = SR-Q22IP-REC.TRE-MANDATORY-ELIG-CD;
  H2-SDX-SSI-BNFDTL.REIMB-ST-CNTY-CD = SR-Q22IP-REC.TRE-STATE-REIMBURSE-CD;

  /* CODE REMOVED FROM THIS POINT*/
  /* CODE PASTED AGAIN*/

  /* CODE PASTED FROM THE CUT POINT*/
  if (SR-Q22IP-REC.TRE-EARNED-INC-PERIOD == "  ")
    H2-SDX-SSI-BNFDTL.YR-OF-EARND-INC = 9999;
    H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 12;
  else
    AIN22W.WS-EARNED-PER = SR-Q22IP-REC.TRE-EARNED-INC-PERIOD;
    if (AIN22W.WS-EARNED1-PER == "A")
      H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 01;
    else
      if (AIN22W.WS-EARNED1-PER == "B")
        H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 02;
      else
        if (AIN22W.WS-EARNED1-PER == "C")
          H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 03;
        else
          if (AIN22W.WS-EARNED1-PER == "D")
            H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 04;
          else
            if (AIN22W.WS-EARNED1-PER == "E")
              H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 05;
            else
              if (AIN22W.WS-EARNED1-PER == "F")
                H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 06;
              else
                if (AIN22W.WS-EARNED1-PER == "G")
                  H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 07;
                else
                  if (AIN22W.WS-EARNED1-PER == "H")
                    H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 08;
                  else
                    if (AIN22W.WS-EARNED1-PER == "I")
                      H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 09;
                    else
                      if (AIN22W.WS-EARNED1-PER == "J")
                        H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 10;
                      else
                        if (AIN22W.WS-EARNED1-PER == "K")
                          H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 11;
                        else
                          if (AIN22W.WS-EARNED1-PER == "L")
                            H2-SDX-SSI-BNFDTL.MTH-OF-EARND-INC = 12;
                          end
                        end
                      end
                    end
                  end
                end
              end
            end
          end
        end
      end
    end
  /* PTR3143 BEGIN*/
  /* CALL DATEAPP GDW,VDBCONTROL,VMESSAGE (NOMAPS;*/
  /* MOVE GDW.DTLC TO AIN22W.WS-SYS-DATE;*/
  /* MOVE AIN22W.WS-SYS-YR TO AIN22W.WS-CUR-YR;*/
    H2-SDX-SSI-BNFDTL.YR-OF-EARND-INC = AIN22W.WS-NOMADS-PROCESS-CCYY;
  end
  /* PTR3143 END*/
  H2-SDX-SSI-BNFDTL.SELF-EMP-EST-AMT = SR-Q22IP-REC.TRE-EARNED-INC-NET-SELF-EMP-TEST;
  H2-SDX-SSI-BNFDTL.SELF-SUPL-EXCL-AMT = SR-Q22IP-REC.TRE-EARNED-INC-EXCLUSION;
  H2-SDX-SSI-BNFDTL.COMP-MTH-EARND-INC = SR-Q22IP-REC.TRE-EARNED-INC-NET-CT-AMT;
  H2-SDX-SSI-BNFDTL.COMP-MTH-UERND-INC = SR-Q22IP-REC.TRE-UNEARNED-INC-NET-CT-AMT;
  H2-SDX-SSI-BNFDTL.COMP-MTH-DEEMD-INC = SR-Q22IP-REC.TRE-DEEMED-INC-AMT;
  H2-SDX-SSI-BNFDTL.BDGT-MTH-EARND-INC = SR-Q22IP-REC.TRE-EARN-INC-RETRO-NET-CT-AMT;
  H2-SDX-SSI-BNFDTL.BDGT-MTH-UERND-INC = SR-Q22IP-REC.TRE-UNEARN-INC-RET-NET-CT-AMT;
  H2-SDX-SSI-BNFDTL.BDGT-MTH-DEEMD-INC = SR-Q22IP-REC.TRE-DEEMED-INC-RETRO-AMT;

  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
  /* PTR 5715 CHANGES  *** START *****/
  if (SR-Q22IP-REC.TRE-ALIEN-YR == 00)
    H2-SDX-SSI-BNFDTL.ALN-RES-DT = "9999-12-31";
  else
  /* PTR 5715 CHANGES  ***  END  *****/
    AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-ALIEN-YR;
    AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-ALIEN-CC;
  /* ptr 11316 change century date cutoff ------- 05/19/97 ------*/
    /* IF AIN22W.WS-NUM1-YY > 50;*/
    /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
    /* ELSE;*/
    /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
    /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
    AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-ALIEN-MO;
    AIN22W.WS-NUM1-DD = 01;
    AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
    AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
    AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
    AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
    AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
    AIN22W.WS-SYS1-F1 = "-";
    AIN22W.WS-SYS1-F2 = "-";
    H2-SDX-SSI-BNFDTL.ALN-RES-DT = AIN22W.WS-SYS1-DATE;
  end
  H2-SDX-SSI-BNFDTL.ORG-CNTRY-CD = SR-Q22IP-REC.TRE-COUNTRY-OF-ORIGIN;
  H2-SDX-SSI-BNFDTL.CNCUR-ELIG-STS = SR-Q22IP-REC.TRE-CONCURRENT-STATE-PAY-CD;
  H2-SDX-SSI-BNFDTL.STDNT-IND = SR-Q22IP-REC.TRE-STUDENT-IND;
  H2-SDX-SSI-BNFDTL.SSI-LVAR-COMP-MOCD = AIN22W.WS-FED-LIVING-ARR-CD;
  H2-SDX-SSI-BNFDTL.BUDGT-MTH-CD = SR-Q22IP-REC.TRE-FED-LIV-ARR-CD-BUDGET-MO;
  H2-SDX-SSI-BNFDTL.HOUSE-RSRCS = SR-Q22IP-REC.TRE-HOUSE-RESOURCE-CD;
  H2-SDX-SSI-BNFDTL.PRPTY-RSRCS = SR-Q22IP-REC.TRE-INC-PROD-PROP-RESOURCE-CD;
  H2-SDX-SSI-BNFDTL.VHCLE-RSRCS = SR-Q22IP-REC.TRE-VEHICLE-RESOURCE-CD;
  H2-SDX-SSI-BNFDTL.CHILD-RSRCS = SR-Q22IP-REC.TRE-OTHER-RESOURCE-CD;
  H2-SDX-SSI-BNFDTL.INSU-RSRCS = SR-Q22IP-REC.TRE-LIFE-INSURE-RESOURCE-CD;
  H2-SDX-SSI-BNFDTL.SEX-ERR-IND = AIN22W.WS-ERR-SEX;
  H2-SDX-SSI-BNFDTL.DOB-ERR-IND = AIN22W.WS-ERR-DT-OF-BIRTH;
  H2-SDX-SSI-BNFDTL.ZIP-CD-ERR-IND = AIN22W.WS-ERR-ZIP-CD;
  H2-SDX-SSI-BNFDTL.PYMT-STSCD-ERR-IND = AIN22W.WS-ERR-PYMT-STS-CD;
  H2-SDX-SSI-BNFDTL.PBLIC-LAW-ERR-IND = AIN22W.WS-ERR-PB-LAW-CD;
  H2-SDX-SSI-BNFDTL.UERND-INCM-ERR-IND = AIN22W.WS-ERR-UERND-INC-AMT;
  /*  */
  /* -------CHANGES DUE TO PHASE III REWORK START--------*/

   /* *** changes due to ptr2849 begin  *** */
  H2-SDX-SSI-BNFDTL.FS-EFF-DT = "9999-12-31";
   /* *** changes due to ptr2849 end    *** */
  H2-SDX-SSI-BNFDTL.DOB = H2-2-CMH-PER.DOB;
  AIN22P9-QUERY-I04();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /* --------CHANGES DUE TO PHASE III REWORK END---------*/
  /* END OF CODED PASTED*/


  /* FOR INSERTION OF DATA INTO TWNSDX_UERND_INCM TABLE*/

  AIN22W.WS-INDEX = 1;
  H2-SDXI-UERND-INCM.UPI = H2-2-CMH-PER.UPI;

  /* *** MOVE CURRENT DATE TO H2-SDXI-UERND-INCM.PROCESS-DT ****/
  /* PTR 5715 CHANGES TO USE NOMADS DATE NOT SYSTEM DATE **START***/
  /* CALL DATEAPP GDW,VDBCONTROL,VMESSAGE (NOMAPS;*/
  /* MOVE GDW.DTLC TO AIN22W.WS-SYS-DATE;*/
  /* MOVE AIN22W.WS-SYS-MM TO AIN22W.WS-SYS1-MM;*/
  /* MOVE AIN22W.WS-SYS-DD TO AIN22W.WS-SYS1-DD;*/
  /* MOVE AIN22W.WS-SYS-YY TO AIN22W.WS-SYS1-YY;*/
  /* MOVE AIN22W.WS-SYS-CC TO AIN22W.WS-SYS1-CC;*/
  /* MOVE AIN22W.WS-SYS1-DATE TO H2-SDXI-UERND-INCM.PROCESS-DT;*/
  /*  */
  H2-SDXI-UERND-INCM.PROCESS-DT = AIN22W.WS-NOMADS-PROCESS-DATE;
  /*  */
  /* PTR 5715 CHANGES TO USE NOMADS DATE NOT SYSTEM DATE **END***/
  /* changes due to ptr# 2830 begin*/
  if (SR-Q22IP-REC.TRE-UNEARN-INC-NBR-OF-ENTRIES > 0)
  /* changes due to ptr# 2830 end*/

  /* the sdx_uernd_incm_dtl should be created even if there exists*/
  /* a single unearn-inc-nbr-of-entries.*/
  /*  */
  /* WI 14932  -  09/17/98  D.KOON    **BEGIN***/
  /* IF START DATE IS NOT VALID SKIP THE RECORD*/
  /*  */
    while ((AIN22W.WS-INDEX <= 
    SR-Q22IP-REC.TRE-UNEARN-INC-NBR-OF-ENTRIES))
      if (SR-Q22IP-REC.TRE-UNEARNED-INC-START-DT[WS-INDEX] > 0)
  /*  */
        H2-SDXI-UERND-INCM.CLM-ID = SR-Q22IP-REC.TRE-CLAIM-ID-NBR[WS-INDEX];
        H2-SDXI-UERND-INCM.PYMT-FREQ = SR-Q22IP-REC.TRE-UNEARNED-INC-FREQ[WS-INDEX];
        H2-SDXI-UERND-INCM.UERND-INCM-TYP = SR-Q22IP-REC.TRE-UNEARNED-INC-TYPE-CD[WS-INDEX];

  /* MOVE 01 TO DATE OF TRE-UNEARNED-INC-START-DT TO DETERMINE*/
  /* START DATE AND CONVERT INTO DB2 FORMAT*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/

        AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-UNEARNED-INC-START-YR[WS-INDEX];
        AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-UNEARNED-INC-START-CC[WS-INDEX];
  /* ptr 11316 change century date cutoff  ------ 05/19/97 --------*/
      /* IF AIN22W.WS-NUM1-YY > 50;*/
      /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
      /* ELSE;*/
      /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
      /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
        AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-UNEARNED-INC-START-MO[WS-INDEX];
        AIN22W.WS-NUM1-DD = 01;
        AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
        AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
        AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
        AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
        AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
        AIN22W.WS-SYS1-F1 = "-";
        AIN22W.WS-SYS1-F2 = "-";
        H2-SDXI-UERND-INCM.UERND-INC-BEG-DT = AIN22W.WS-SYS1-DATE;

  /* USE TRE-UNEARNED-INC-STOP-DT TO DETERMINE*/
  /* THE LAST DATE OF THE MONTH*/
  /* IF TRE-UNEARNED-INC-STOP-DT IS ZEROS SET TO HI-DATE*/

        if (SR-Q22IP-REC.TRE-UNEARNED-INC-STOP-DT[WS-INDEX] == 0000)
          H2-SDXI-UERND-INCM.UERND-INC-END-DT = "9999-12-31";
        else
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- BEGIN*/
          AIN22W.WS-NUM1-YY = SR-Q22IP-REC.TRE-UNEARNED-INC-STOP-YR[WS-INDEX];
          AIN22W.WS-NUM1-CC = SR-Q22IP-REC.TRE-UNEARNED-INC-STOP-CC[WS-INDEX];
        /* IF AIN22W.WS-NUM1-YY > 90;*/
        /* MOVE 19 TO AIN22W.WS-NUM1-CC;*/
        /* ELSE;*/
        /* MOVE 20 TO AIN22W.WS-NUM1-CC;*/
        /* END;*/
  /* WI 13211 ADDS CENTURY TO INPUT -- 04/20/98 -- KEM -- END*/
          AIN22W.WS-ARRAY1[1] = 01;
          AIN22W.WS-ARRAY1[2] = 03;
          AIN22W.WS-ARRAY1[3] = 05;
          AIN22W.WS-ARRAY1[4] = 07;
          AIN22W.WS-ARRAY1[5] = 08;
          AIN22W.WS-ARRAY1[6] = 10;
          AIN22W.WS-ARRAY1[7] = 12;
          AIN22W.WS-ARRAY2[1] = 04;
          AIN22W.WS-ARRAY2[2] = 06;
          AIN22W.WS-ARRAY2[3] = 09;
          AIN22W.WS-ARRAY2[4] = 11;

          AIN22W.WS-NUM1-MM = SR-Q22IP-REC.TRE-UNEARNED-INC-STOP-MO[WS-INDEX];
          if (AIN22W.WS-NUM1-MM in AIN22W.WS-ARRAY1)
            AIN22W.WS-NUM1-DD = 31;
          else
            if (AIN22W.WS-NUM1-MM in AIN22W.WS-ARRAY2)
              AIN22W.WS-NUM1-DD = 30;
            else
              AIN22W.WS-REM1 = AIN22W.WS-NUM1-YR % 4;
              AIN22W.WS-REM2 = AIN22W.WS-NUM1-YR % 100;
              AIN22W.WS-REM3 = AIN22W.WS-NUM1-YR % 400;
              if (AIN22W.WS-REM1 != 0)
                AIN22W.WS-NUM1-DD = 28;
              else
                if (AIN22W.WS-REM2 == 0)
                  if (AIN22W.WS-REM3 == 0)
                    AIN22W.WS-NUM1-DD = 29;
                  else
                    AIN22W.WS-NUM1-DD = 28;
                  end
                else
                  AIN22W.WS-NUM1-DD = 29;
                end
              end
            end
          end
          AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
          AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
          AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
          AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
          AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
          AIN22W.WS-SYS1-F1 = "-";
          AIN22W.WS-SYS1-F2 = "-";
          H2-SDXI-UERND-INCM.UERND-INC-END-DT = AIN22W.WS-SYS1-DATE;
        end
        H2-SDXI-UERND-INCM.UERND-INC-AMT = SR-Q22IP-REC.TRE-UNEARNED-INC-AMT[WS-INDEX];
        H2-SDXI-UERND-INCM.VERF-CD = SR-Q22IP-REC.TRE-UNEARNED-INC-VERIFY-CD[WS-INDEX];
        AIN22P9-QUERY-I05();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
      end
  /* WI 14932  -- 09/17/98 -- D.KOON --- ***END****/
  /*  */
      AIN22W.WS-INDEX = AIN22W.WS-INDEX + 1;
    end
  end
  /* CBSI END*/
end // end AIN22P9-SDX-SSI


// SET CURSOR FOR PUBLIC LAW INQ
Function AIN22P9-SETINQ12()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/07/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-SDX-SSI-BNFDTL";
  VDBCONTROL.UPROC-OBJ = "H2-SDX-SSI-BNFDTL";
  VDBCONTROL.UPROC-NM = "AIN22P9-SETINQ12";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  try
    open AIN22P9-SETINQ12_RSI01
      with #sql{
        select PB_LAW_CD,   -- NEW SQL ADDED DUE TO CHANGES IN PHASE IV MAABD
            PROCESS_DT
        from TWNSDX_SSI_BNFDTL T1
        WHERE
            UPI = :UPI AND
            PROCESS_DT < :PROCESS-DT
        ORDER BY PROCESS_DT FOR FETCH ONLY
      }      
      into PB-LAW-CD,
           PROCESS-DT
      for H2-SDX-SSI-BNFDTL ;
  end
  /* CBSI END*/
end // end AIN22P9-SETINQ12


// SET CURSOR FOR ALTERNATE SSN
Function AIN22P9-SETINQ16()
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN22A";
  VDBCOMMON.USQLREC = "H2-ALTERNATE-SSN";
  VDBCONTROL.UPROC-OBJ = "H2-ALTERNATE-SSN";
  VDBCONTROL.UPROC-NM = "AIN22P9-SETINQ16";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  try
    open AIN22P9-SETINQ16_RSI01
      with #sql{
        select UPI
        from twnalternate_ssn T1
        WHERE ALT_SSN = :ALT-SSN
                FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into UPI
      for H2-ALTERNATE-SSN ;
  end
  /*  */
  VDBCOMMON.UNRF = "1";
  VDBCOMMON.UDUP = "N";
  /*  */
  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
end // end AIN22P9-SETINQ16


// SET CURSOR FOR UERND-INCM-DTL
Function AIN22P9-SETINQ3()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-NM = "AIN22P9-SETINQ3";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  try
    open AIN22P9-SETINQ3_RSI01
      with #sql{
        select UPI, PRD_BEG_DT, UERND_INC_TYPE_CD,
          INCM_SQ_NMB, SSI_RSDI_RCVD_MTH, RSDI_CLM_NUM,
          PB_LAW_RSDI_CI_AMT, UERND_INC_RCVD_DT,
          UERND_INC_FREQ, UERND_INC_AMT, MA_EXCLD_AMT,
          SSI_RSDI_RCVD_YR, PREV_AMT, BNFTS_APLD_IND,
          AFDC_CNTBL_IND, FS_CNTBL_IND, MA_CNTBL_CD,
          PRD_END_DT, CHNG_ENTRY_DT, UNE_INC_VERF_CD,
          UNE_INC_VERF_BY, UNE_INC_VERF_DT, MAINT_CD,
          RCVD_DT, RPRTD_DT, RCPT_DT, INVO_MND_DEDN_AMT,
          RECUR_IND, PBLIC_RSDI_CLM_NUM,
          PBLIC_RSDI_STRT_DT, FS_CNTBL_AMT,
          UERND_INCM_CD, IVE_NONIVE_IND, CHAP_CNTBL_IND
        from TWNUERND_INCM_DTL T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE UPI = :UPI AND
              UERND_INC_TYPE_CD = :UERND-INC-TYPE-CD AND
              :PRD-BEG-DT < PRD_END_DT
        FOR UPDATE OF
                     PRD_END_DT
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into UPI, PRD-BEG-DT, UERND-INC-TYPE-CD,
           INCM-SQ-NMB, SSI-RSDI-RCVD-MTH, RSDI-CLM-NUM,
           PB-LAW-RSDI-CI-AMT, UERND-INC-RCVD-DT,
           UERND-INC-FREQ, UERND-INC-AMT, MA-EXCLD-AMT,
           SSI-RSDI-RCVD-YR, PREV-AMT, BNFTS-APLD-IND,
           AFDC-CNTBL-IND, FS-CNTBL-IND, MA-CNTBL-CD,
           PRD-END-DT, CHNG-ENTRY-DT, UNE-INC-VERF-CD,
           UNE-INC-VERF-BY, UNE-INC-VERF-DT, MAINT-CD,
           RCVD-DT, RPRTD-DT, RCPT-DT, INVO-MND-DEDN-AMT,
           RECUR-IND, PBLIC-RSDI-CLM-NUM,
           PBLIC-RSDI-STRT-DT, FS-CNTBL-AMT,
           UERND-INCM-CD, IVE-NONIVE-IND, CHAP-CNTBL-IND
      for H2-UERND-INCM-DTL ;
  end
  /* CBSI END*/
end // end AIN22P9-SETINQ3


// SET CURSOR FOR CASE-MEM-HST
Function AIN22P9-SETINQ4()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-CASE-MEMBER-HST";
  VDBCONTROL.UPROC-OBJ = "H2-CASE-MEMBER-HST";
  VDBCONTROL.UPROC-NM = "AIN22P9-SETINQ4";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  try
    open AIN22P9-SETINQ4_RSI01
      with #sql{
        select ICI
        from TWNCASE_MEMBER_HST T1
        WHERE UPI = :UPI AND
              PRD_END_DT = :PRD-END-DT
              FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into ICI
      for H2-CASE-MEMBER-HST ;
  end

  /* CBSI END*/
end // end AIN22P9-SETINQ4


// SETUP INQ/CRSR CASE-MEM-HST
Function AIN22P9-SETINQ6()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/07/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-3-CMH-FAC-SPT";
  VDBCONTROL.UPROC-OBJ = "H2-3-CMH-FAC-SPT";
  VDBCONTROL.UPROC-NM = "AIN22P9-SETINQ6";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  try
    open AIN22P9-SETINQ6_RSI01
      with #sql{
        select ICI,
            PRD_BEG_DT
        from TWNCASE_MEMBER_HST T1
        WHERE
                UPI = :UPI
            AND PRD_END_DT = :PRD-END-DT
            AND T1.HH_LEFT_DT = '9999-12-31'
                FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into ICI,
           PRD-BEG-DT
      for H2-CASE-MEMBER-HST ;
  end
  /* CBSI END*/
end // end AIN22P9-SETINQ6


// SETUP INQ/CRSR CMH-FCH
Function AIN22P9-SETINQ8()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-2-CMH-FCH";
  VDBCONTROL.UPROC-OBJ = "H2-2-CMH-FCH";
  VDBCONTROL.UPROC-NM = "AIN22P9-SETINQ8";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  try
    open AIN22P9-SETINQ8_RSI01
      with #sql{
        select DISTINCT(T1.ICI)
        from TWNCASE_MEMBER_HST T1,
             TWNFAM_CASE_HSTRY T2
        WHERE
           t1.UPI = :UPI AND
           T1.ICI =T2.ICI AND
           T1.PRD_BEG_DT <= :T2-PRD-END-DT AND
           T1.PRD_END_DT >= :T2-PRD-END-DT AND
           T2.PRD_BEG_DT <= :T2-PRD-END-DT AND
           T2.PRD_END_DT >= :T2-PRD-END-DT AND
           T2.CASE_STS IN ('O','P')  AND
         --** wi 21582 ***/
           T1.HH_LEFT_DT = '9999-12-31'
         --** wi 21582 ***/
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into ICI
      for H2-2-CMH-FCH ;
  end
  /* CBSI END*/
end // end AIN22P9-SETINQ8


// SET CURSOR UERND-INCM-DTL
Function AIN22P9-SETUPD9()
  /* DATE      PGR.       DESCRIPTION*/
  /* --------- ---------- -----------*/
  /* 03/08/95  TBST195     CREATION*/
  /*  */
  /* CBSI START*/
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";
  VDBCONTROL.UPROC-NM = "AIN22P9-SETUPD9";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    open AIN22P9-SETUPD9_RSI01 forUpdate
      with #sql{
        select UPI, PRD_BEG_DT, UERND_INC_TYPE_CD,
          INCM_SQ_NMB, SSI_RSDI_RCVD_MTH, RSDI_CLM_NUM,
          PB_LAW_RSDI_CI_AMT, UERND_INC_RCVD_DT,
          UERND_INC_FREQ, UERND_INC_AMT, MA_EXCLD_AMT,
          SSI_RSDI_RCVD_YR, PREV_AMT, BNFTS_APLD_IND,
          AFDC_CNTBL_IND, FS_CNTBL_IND, MA_CNTBL_CD,
          PRD_END_DT, CHNG_ENTRY_DT, UNE_INC_VERF_CD,
          UNE_INC_VERF_BY, UNE_INC_VERF_DT, MAINT_CD,
          RCVD_DT, RPRTD_DT, RCPT_DT, INVO_MND_DEDN_AMT,
          RECUR_IND, PBLIC_RSDI_CLM_NUM,
          PBLIC_RSDI_STRT_DT, FS_CNTBL_AMT,
          UERND_INCM_CD, IVE_NONIVE_IND, CHAP_CNTBL_IND
        from TWNUERND_INCM_DTL T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE UPI = :UPI AND
              UERND_INC_TYPE_CD = :UERND-INC-TYPE-CD AND
              :PRD-BEG-DT < PRD_END_DT
        for update of UERND_INC_AMT,
  PRD_END_DT,
  UNE_INC_VERF_BY
      }
      into UPI, PRD-BEG-DT, UERND-INC-TYPE-CD,
           INCM-SQ-NMB, SSI-RSDI-RCVD-MTH, RSDI-CLM-NUM,
           PB-LAW-RSDI-CI-AMT, UERND-INC-RCVD-DT,
           UERND-INC-FREQ, UERND-INC-AMT, MA-EXCLD-AMT,
           SSI-RSDI-RCVD-YR, PREV-AMT, BNFTS-APLD-IND,
           AFDC-CNTBL-IND, FS-CNTBL-IND, MA-CNTBL-CD,
           PRD-END-DT, CHNG-ENTRY-DT, UNE-INC-VERF-CD,
           UNE-INC-VERF-BY, UNE-INC-VERF-DT, MAINT-CD,
           RCVD-DT, RPRTD-DT, RCPT-DT, INVO-MND-DEDN-AMT,
           RECUR-IND, PBLIC-RSDI-CLM-NUM,
           PBLIC-RSDI-STRT-DT, FS-CNTBL-AMT,
           UERND-INCM-CD, IVE-NONIVE-IND, CHAP-CNTBL-IND
      for H2-UERND-INCM-DTL ;
  end
  /* CBSI END*/
end // end AIN22P9-SETUPD9


// CHECK-SEX-DOB
Function AIN22P9-SEX-DOB()
  /* CBSI START*/
  /* IF THE SEX CODE AND DATE OF BIRTH DO NOT MATCH WITH THE INTERFACE*/
  /* DATA THEN AN ALERT INDICATOR IS SET TO TRUE*/

  AIN22W.WS-ERR-SEX = "F";
  if (H2-2-CMH-PER.SEX-CD != SR-Q22IP-REC.TRE-SEX)
    AIN22W.WS-ERR-SEX = "T";
    AIN22W.WS-ALERT-FLAG = "T";
  end
  AIN22W.WS-ERR-DT-OF-BIRTH = "F";
  AIN22W.WS-NUM1-DATE1 = SR-Q22IP-REC.TRE-BIRTH-DT;
  AIN22W.WS-CHA-DATE = AIN22W.WS-NUM-DATE;
  AIN22W.WS-SYS1-MM = AIN22W.WS-CHA-MM;
  AIN22W.WS-SYS1-DD = AIN22W.WS-CHA-DD;
  AIN22W.WS-SYS1-YY = AIN22W.WS-CHA-YY;
  AIN22W.WS-SYS1-CC = AIN22W.WS-CHA-CC;
  AIN22W.WS-SYS1-F1 = "-";
  AIN22W.WS-SYS1-F2 = "-";
  if (H2-2-CMH-PER.DOB != AIN22W.WS-SYS1-DATE)
    AIN22W.WS-ERR-DT-OF-BIRTH = "T";
    AIN22W.WS-ALERT-FLAG = "T";
  end
  /* CBSI END*/
end // end AIN22P9-SEX-DOB


// CHECK-SSI-AMT
Function AIN22P9-SSI-AMT()
  /* CBSI START*/
  AIN22W.WS-INTERFACE-SSI-AMT = 0;
  AIN22W.WS-NOMADS-SSI-AMT = 0;
  /* ** START WI21582 ***/
  AIN22W.WS-UNIN-MORE-REC = " ";
  AIN22W.WS-UNIN-FREQ-FLAG = " ";
  AIN22W.WS-UNIN-UPDATED = " ";
  AIN22W.WS-NO-UNIN-REC = " ";
  /* ** END WI21582 ***/
  /* CHANGE DUE TO PTR 5892*/
  /* CHANGE 7068  BEGIN*/
  AIN22W.WS-INTERFACE-SSI-AMT = 0.00;
  if (SR-Q22IP-REC.TRE-PAY-STATUS-CD[1] == "C01" || 
  SR-Q22IP-REC.TRE-MEDICAID-ELIG-CD[1] == "G")
    AIN22W.WS-INTERFACE-SSI-AMT = SR-Q22IP-REC.TRE-SSI-GROSS-PAYABLE-AMT     + SR-Q22IP-REC.TRE-STATE-SUPPLEMENT-GROSS-PAY;
  else
    AIN22W.WS-INTERFACE-SSI-AMT = 0.00;
  end
  /* CHANGE 7068  END*/
  AIN22W.WS-UERND-REC-EXIST = "F";
  set H2-UERND-INCM-DTL empty;
  H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
  H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
  /* MOVE AIN22W.WS-PROCESS-DATE-CC TO AIN22W.WS-NUM1-CC;*/
  /* MOVE AIN22W.WS-PROCESS-DATE-YR TO AIN22W.WS-NUM1-YY;*/
  /* MOVE AIN22W.WS-PROCESS-DATE-MO TO AIN22W.WS-NUM1-MM;*/
  /* MOVE AIN22W.WS-PROCESS-DATE-DT TO AIN22W.WS-NUM1-DD;*/

  /* MOVE AIN22W.WS-NUM-DATE TO AIN22W.WS-CHA-DATE;*/
  /* MOVE AIN22W.WS-CHA-MM TO AIN22W.WS-SYS1-MM;*/
  /* MOVE AIN22W.WS-CHA-DD TO AIN22W.WS-SYS1-DD;*/
  /* MOVE AIN22W.WS-CHA-YY TO AIN22W.WS-SYS1-YY;*/
  /* MOVE AIN22W.WS-CHA-CC TO AIN22W.WS-SYS1-CC;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F1;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F2;*/
  /* MOVE AIN22W.WS-SYS1-DATE TO H2-UERND-INCM-DTL.PRD-BEG-DT;*/
  H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-EFF-DATE;

  /* THE NUMBER OF RECORDS IN TWNUERND_INCM_DTL FOR THE UPI FOR A MONTH*/
  /* MUST BE 1. IF THE NUMBER OF RECORDS IS GREATER THAN 1, THEN NO UPDATES*/
  /* WILL BE DONE ON THE UNEARNED INCOME TABLE. THE WORKER WILL ONLY BE*/
  /* ALERTED. IF ONLY ONE RECORD EXIST AND THE DIFFERENCE BETWEEN THE*/
  /* NOMADS*/
  /* AMOUNT AND INTERFACE AMOUNT IS BEYOND THE TOLERANCE LIMIT, THEN THE*/
  /* INTERFACE SSI AMOUNT IS MOVED TO THE UNEARNED INCOME AMOUNT AND THE*/
  /* OLD UNEARNED INCOME AMOUNT IS MOVED TO PREV AMOUNT*/

  AIN22W.WS-TOLERANCE-LIMIT-FLAG = "T";
  AIN22P9-QUERY-S03();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  AIN22W.WS-NUMBER-OF-RECS = 0;
  while (sysVar.sqlData.sqlcode == 0)
    AIN22W.WS-UERND-REC-EXIST = "T";
    AIN22W.WS-NUMBER-OF-RECS = AIN22W.WS-NUMBER-OF-RECS + 1;
    AIN22P9-PAY-STS();
  /* CHANGES DUE TO PTR# AIN22001 BEGIN*/
  /* IF AIN22W.WS-TERMINATION-STATUS = 'T';*/
  /* MOVE H2-UERND-INCM-DTL.UERND-INC-AMT TO AIN22W.WS-PREV-AMT;*/
  /* MOVE 0 TO AIN22W.WS-UERND-INCM-AMT;*/
  /* EZERTN;*/
  /* END;*/
  /* CHANGES DUE TO PTR# AIN22001 END*/

  /* THE UNEARNED INCOME REPORTED BY INTERFACE IS ON MONTHLY BASIS.IF THE*/
  /* BENEFICIARY HAS NOT REPORTED THE UNEARNED INCOME ON MONTHLY BASIS,*/
  /* THEN THE INCOME REPORTED IS ACCORDINGLY PRORATED.*/
  /* PTR 7067 ALLOW ALSO ' ' AS MONTHLY*/
    if (H2-UERND-INCM-DTL.UERND-INC-FREQ != "M" && 
    H2-UERND-INCM-DTL.UERND-INC-FREQ != " ")
      AIN22W.WS-NUMBER-OF-RECS = 2;
      AIN22W.WS-ALERT-FLAG = "T";
  /* START WI 21582 */
      AIN22W.WS-UNIN-FREQ-FLAG = "T";
      AIN22W.WS-TOLERANCE-LIMIT-FLAG = "F";
  /* CHANGES DUE TO PTR# AIN22001 BEGIN*/
  /* MOVE H2-UERND-INCM-DTL.UERND-INC-FREQ TO AIN22W.WS-FREQ;*/
  /* CHANGES DUE TO PTR# AIN22001 END*/
  /* PERFORM AIN22P9-CON-FCT;*/
  /* AIN22W.WS-CONVERSION-AMOUNT =*/
  /* H2-UERND-INCM-DTL.UERND-INC-AMT * AIN22W.WS-FACTOR;*/
  /* MOVE AIN22W.WS-CONVERSION-AMOUNT TO AIN22W.WS-NOMADS-SSI-AMT;*/
  /* CHANGES DUE TO PTR# 8186  --------- BEGIN*/
  /* END WI 21582 */
    else
      AIN22W.WS-NOMADS-SSI-AMT = AIN22W.WS-NOMADS-SSI-AMT +       H2-UERND-INCM-DTL.UERND-INC-AMT -       H2-UERND-INCM-DTL.INVO-MND-DEDN-AMT;
    end
  /* CHANGES DUE TO PTR# 8186  --------- END*/
    AIN22W.WS-SEQ-NMBR = H2-UERND-INCM-DTL.INCM-SQ-NMB;
    AIN22W.WS-PRD-BEG-DT = H2-UERND-INCM-DTL.PRD-BEG-DT;
    AIN22W.WS-PRD-END-DT = H2-UERND-INCM-DTL.PRD-END-DT;
    AIN22P9-SCAN3();
  end
  AIN22W.WS-UERND-INCM-AMT = 0;
  AIN22W.WS-PREV-AMT = 0;
  if (VDBCONTROL.UROWR == 0)
    AIN22W.WS-TRIGGER-ELIGIBILITY = "T";
    AIN22W.WS-NO-UNIN-REC = "T";
    /* MOVE 'T' TO AIN22W.WS-ALERT-FLAG;*/
    AIN22W.WS-UERND-INCM-AMT = AIN22W.WS-INTERFACE-SSI-AMT;
  end

  if (AIN22W.WS-NUMBER-OF-RECS == 1)
    AIN22W.WS-UERND-INCM-AMT = AIN22W.WS-INTERFACE-SSI-AMT;
    AIN22W.WS-PREV-AMT = AIN22W.WS-NOMADS-SSI-AMT;

  /* COMPUTE THE INCREMENTAL TOLERANCE AMOUNT WITH NOMADS SSI INCOME AS*/
  /* BASE. THE TOLERANCE LIMIT WILL THEREFORE BE NOMADS AMOUNT MULTIPLIED*/
  /* BY THE PERCENTAGE.IF NOMADS AMOUNT IS 50 AND THE MASS CHANGE PERCENT*/
  /* IS 10, THE TOLERANCE LIMIT WILL BE 50 * 0.10 = 5. THE INTERFACE*/
  /* AMOUNT HAS TO BE BETWEEN 45 AND 55. IF IT IS BEYOND THIS RANGE THE*/
  /* EXISTING UNEARNED AMOUNT WILL BE MOVED TO PREVIOUS AMOUNT AND THE*/
  /* INTERFACE AMOUNT WILL BE MOVED TO UNEARNED INCOME AMOUNT*/

  /* THIS PART OF CODE HAS BEEN INSERTED AFTER HAVING RAISED ISSUES*/
  /* IN AIN22S1*/
    AIN22W.WS-PRD-BEG-DT = H2-UERND-INCM-DTL.PRD-BEG-DT;
  /* CONDITIONAL CHECK INCLUDED FOR SETTING ELIGIBILITY*/
    if (AIN22W.WS-TRIGGER-ELIGIBILITY != "T")
      AIN22W.WS-TRIGGER-ELIGIBILITY = "F";
    end
    if (AIN22W.WS-UERND-REC-EXIST == "T")
      AIN22W.WS-TOLERANCE-AMT = AIN22W.WS-NOMADS-SSI-AMT *       AIN22W.WS-PERCENT;
      if (AIN22W.WS-NOMADS-SSI-AMT > AIN22W.WS-INTERFACE-SSI-AMT)
        AIN22W.WS-SSI-TOL-DIF = AIN22W.WS-NOMADS-SSI-AMT -         AIN22W.WS-TOLERANCE-AMT;
        if (AIN22W.WS-SSI-TOL-DIF > AIN22W.WS-INTERFACE-SSI-AMT)
          AIN22W.WS-PREV-AMT = AIN22W.WS-NOMADS-SSI-AMT;
          AIN22W.WS-UERND-INCM-AMT = AIN22W.WS-INTERFACE-SSI-AMT;
          AIN22W.WS-TOLERANCE-LIMIT-FLAG = "F";
          /* MOVE 'T' TO AIN22W.WS-ALERT-FLAG;*/
          AIN22W.WS-TRIGGER-ELIGIBILITY = "T";
        end
      end
      if (AIN22W.WS-INTERFACE-SSI-AMT > AIN22W.WS-NOMADS-SSI-AMT)
        AIN22W.WS-SSI-TOL-ADD = AIN22W.WS-NOMADS-SSI-AMT + AIN22W.WS-TOLERANCE-AMT;
        if (AIN22W.WS-SSI-TOL-ADD < AIN22W.WS-INTERFACE-SSI-AMT)
          AIN22W.WS-PREV-AMT = AIN22W.WS-NOMADS-SSI-AMT;
          AIN22W.WS-UERND-INCM-AMT = AIN22W.WS-INTERFACE-SSI-AMT;
          AIN22W.WS-TOLERANCE-LIMIT-FLAG = "F";
          /* MOVE 'T' TO AIN22W.WS-ALERT-FLAG;*/
          AIN22W.WS-TRIGGER-ELIGIBILITY = "T";
        end
      end
    end
    AIN22W.WS-UNIN-UPDATED = "Y";
  else
    if (AIN22W.WS-NUMBER-OF-RECS > 1)
      AIN22W.WS-UNIN-MORE-REC = "T";
      AIN22W.WS-ALERT-FLAG = "T";
    end
  end
  /* WI21582 START*/
  AIN22W.WS-LSUM-ADDED = " ";
  /* WI21582 END*/
  if (SR-Q22IP-REC.TRE-SSI-MONTHLY-ASSIST-AMT > 
  SR-Q22IP-REC.TRE-SSI-GROSS-PAYABLE-AMT && 
  SR-Q22IP-REC.TRE-MEDICAID-ELIG-CD[1] != "G" && 
  AIN22W.WS-CASE-OPEN == "Y")
    AIN22P9-BILD-LSUM();
  end
  /* CBSI END*/
end // end AIN22P9-SSI-AMT


// TERMINATE SDX INCOME&DISBLTY
Function AIN22P9-TERM-SSI()
  AIN22W.WS-NUMBER-OF-RECS = 0;

  set H2-UERND-INCM-DTL empty;
  H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
  H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
  /* MOVE AIN22W.WS-NOMADS-PROCESS-CC TO AIN22W.WS-NUM1-CC;*/
  /* MOVE AIN22W.WS-NOMADS-PROCESS-YY TO AIN22W.WS-NUM1-YY;*/
  /* MOVE AIN22W.WS-NOMADS-PROCESS-MM TO AIN22W.WS-NUM1-MM;*/
  /* MOVE AIN22W.WS-NOMADS-PROCESS-DD TO AIN22W.WS-NUM1-DD;*/

  /* MOVE AIN22W.WS-NUM-DATE TO AIN22W.WS-CHA-DATE;*/
  /* MOVE AIN22W.WS-CHA-MM TO AIN22W.WS-SYS1-MM;*/
  /* MOVE AIN22W.WS-CHA-DD TO AIN22W.WS-SYS1-DD;*/
  /* MOVE AIN22W.WS-CHA-YY TO AIN22W.WS-SYS1-YY;*/
  /* MOVE AIN22W.WS-CHA-CC TO AIN22W.WS-SYS1-CC;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F1;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F2;*/
  /* MOVE AIN22W.WS-SYS1-DATE TO H2-UERND-INCM-DTL.PRD-BEG-DT;*/
  H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-EFF-DATE;

  AIN22P9-QUERY1-S09();

  if (sysVar.sqlData.sqlcode == 0)
    AIN22P9-SCAN9();
    while (sysVar.sqlData.sqlcode == 0)
      AIN22W.WS-NUMBER-OF-RECS = AIN22W.WS-NUMBER-OF-RECS + 1;
      AIN22W.WS-NOMADS-SSI-AMT = AIN22W.WS-NOMADS-SSI-AMT +       H2-UERND-INCM-DTL.UERND-INC-AMT;
      AIN22P9-SCAN9();
    end
  end
   /*  */
   /* Set error control flags*/
   /* UNRF - No record found flag (Y,N,1)*/
   /* UDUP - Duplicate key flag (Y,N)*/
  VDBCOMMON.UNRF = "1";
  VDBCOMMON.UDUP = "N";
   /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  AIN22W.WS-INTERFACE-SSI-AMT = 0.00;
  /* MOVE 0.00 TO H2-UERND-INCM-DTL.UERND-INC-AMT;*/
  if (AIN22W.WS-NUMBER-OF-RECS == 1)
    AIN22P9-TERM-UNIN();
    AIN22W.WS-END-SEARCH = "F";
  /* WI 15549 USE BDATE AS CHECK    -------- 11/30/98 ----------*/
  /* IF PIIN-SDX-PROCESS.PIIN-SDX-PROCESS-YY <*/
  /* IF AIN22W.WS-NOMADS-PROCESS-CCYY <*/
  /* SR-Q22IP-REC.TRE-MONTH-CHANGE-CY(1) OR*/
  /* (AIN22W.WS-NOMADS-PROCESS-CCYY =*/
  /* SR-Q22IP-REC.TRE-MONTH-CHANGE-CY(1) AND*/
  /* AIN22W.WS-NOMADS-PROCESS-MM <*/
  /* SR-Q22IP-REC.TRE-MONTH-CHANGE-MO(1));*/
  /* IF H2-UERND-INCM-DTL.PRD-END-DT NE '9999-12-31';*/
  /* /*MOVE 'T' TO AIN22W.WS-ALERT-FLAG;*/
  /* EZERTN;*/
  /* END;*/
  /* MOVE 'T' TO AIN22W.WS-TRIGGER-ELIGIBILITY;*/
  /* MOVE 'T' TO AIN22W.WS-ALERT-FLAG;*/
  /* IF SR-Q22IP-REC.TRE-MONTH-CHANGE-MO(1) > 01;*/
  /* AIN22W2.WS-DATE-MM = SR-Q22IP-REC.TRE-MONTH-CHANGE-MO(1) - 01;*/
  /* MOVE SR-Q22IP-REC.TRE-MONTH-CHANGE-YR(1) TO AIN22W2.WS-DATE-YY;*/
  /* ELSE;*/
  /* AIN22W2.WS-DATE-YY = SR-Q22IP-REC.TRE-MONTH-CHANGE-YR(1) - 01;*/
  /* AIN22W2.WS-DATE-MM = 12;*/
  /* END;*/
  /* PERFORM AIN22P9-LAST-DAY;*/
  /* MOVE AIN22W2.WS-PREV-DATE TO H2-UERND-INCM-DTL.PRD-END-DT;*/
  /* MOVE H2-UERND-INCM-DTL.PRD-BEG-DT TO AIN22W.WS-SYS1-DATE;*/
  /* MOVE SR-Q22IP-REC.TRE-MONTH-CHANGE-YR(1) TO AIN22W.WS-DUM-YR;*/
  /* MOVE SR-Q22IP-REC.TRE-MONTH-CHANGE-MO(1) TO AIN22W.WS-DUM-MM;*/
  /* MOVE AIN22W.WS-NUM-DATE TO AIN22W.WS-CHA-DATE;*/
  /* MOVE AIN22W.WS-CHA-MM TO AIN22W.WS-SYS1-MM;*/
  /* MOVE AIN22W.WS-CHA-DD TO AIN22W.WS-SYS1-DD;*/
  /* MOVE AIN22W.WS-CHA-YY TO AIN22W.WS-SYS1-YY;*/
  /* MOVE AIN22W.WS-CHA-CC TO AIN22W.WS-SYS1-CC;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F1;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F2;*/
  /* IF (AIN22W.WS-SYS1-MM => AIN22W.WS-DUM-MM AND*/
  /* AIN22W.WS-SYS1-YR = AIN22W.WS-DUM-YR) OR*/
  /* (AIN22W.WS-SYS1-YR > AIN22W.WS-DUM-YR);*/
  /* WI 15549  CHECK BEG-DT PRIOR TO END-DT   **** 12/01/98  *****/
  /* IF H2-UERND-INCM-DTL.PRD-END-DT < H2-UERND-INCM-DTL.PRD-BEG-DT;*/
  /* MOVE H2-UERND-INCM-DTL.PRD-BEG-DT TO AIN22W.WS-PREV-DATE;*/
  /* MOVE AIN22W.WS-PREV-YY TO AIN22W2.WS-DATE-YY;*/
  /* MOVE AIN22W.WS-PREV-MM TO AIN22W2.WS-DATE-MM;*/
   /* PERFORM AIN22P9-LAST-DAY;*/
   /* MOVE AIN22W2.WS-PREV-DATE TO H2-UERND-INCM-DTL.PRD-END-DT;*/
   /* END;*/
  /* WI 15549  END                             *** 12/01/98  *****/
  /* PERFORM AIN22P9-UPD-UNIN;*/
    AIN22W.WS-END-SEARCH = "T";
    AIN22W.WS-ERR-PYMT-STS-CD = "T";
    AIN22W.WS-ALERT-FLAG = "T";
  /* ELSE;*/
  /* END;*/
  else
    AIN22W.WS-ALERT-FLAG = "T";
    AIN22W.WS-UNIN-MORE-REC = "T";
  end
end // end AIN22P9-TERM-SSI


Function AIN22P9-TERM-UNIN()
  /* This process is called by AIN22P9-TERM-SSI after performing*/
  /* AIN22P9-QUERY1-S09 which performs AIN22P9-SETUPD9.*/
  /*  */
  AIN22W.WS-UNIN-BEG-DT = H2-UERND-INCM-DTL.PRD-BEG-DT;
  AIN22W.WS-UNIN-END-DT = H2-UERND-INCM-DTL.PRD-END-DT;
  if (AIN22W.WS-NUMBER-OF-RECS == 1)

    set AIN22W-UNIN-NEW empty; /* WI 27488*/
    set AIN22W-UNIN-OLD empty; /* WI 27488*/
    AIN22P9-UNIN-OLD(); /* WI 27488*/

  /* ** start wi 23393 ***/
    if ((SR-Q22IP-REC.TRE-MONTH-CHANGE-MO[1] >= AIN22W.WS-NOMADS-PROCESS-MM
     && SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1] == 
    AIN22W.WS-NOMADS-PROCESS-CCYY)
     || SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1] > 
    AIN22W.WS-NOMADS-PROCESS-CCYY)
  /* ** end wi 23393 ***/
      if ((AIN22W.WS-MTH-UNIN-BEG-DT >= SR-Q22IP-REC.TRE-MONTH-CHANGE-MO[1]
       && 
      AIN22W.WS-YEAR-UNIN-BEG-DT == SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1])
       || 
      AIN22W.WS-YEAR-UNIN-BEG-DT > SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1])
        if (AIN22W.WS-UNIN-END-DT != "9999-12-31")
          AIN22W.WS-ALERT-FLAG = "T";
          return;
        end
        if ((AIN22W.WS-MTH-UNIN-BEG-DT == SR-Q22IP-REC.TRE-MONTH-CHANGE-MO[1]
         && 
        AIN22W.WS-YEAR-UNIN-BEG-DT == SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1])
        )
          H2-UERND-INCM-DTL.PREV-AMT = H2-UERND-INCM-DTL.UERND-INC-AMT;
          H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
          H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-UNIN-BEG-DT;
          H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
          H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";
          AIN22W.WS-ERR-UERND-INC-AMT = "T";
          AIN22W2.WS-DATE-CCYY = SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1];
          AIN22W2.WS-DATE-MM = SR-Q22IP-REC.TRE-MONTH-CHANGE-MO[1];
          H2-UERND-INCM-DTL.UERND-INC-AMT = 0.00;
          AIN22P9-LAST-DAY();
          H2-UERND-INCM-DTL.PRD-END-DT = AIN22W2.WS-PREV-DATE;
          H2-UERND-INCM-DTL.UNE-INC-VERF-BY = "SDX"; /* WI 27488*/
          AIN22P9-UPD1();

  /* ****************** WI 27488:WNMLS:2005-09-01 START *******************/
          if (sysVar.sqlData.sqlcode == 0)
            AIN22P9-UNIN-NEW();
            AIN22P9-UNIN-SLOG();
            AIN22P9-INSUID-FSL();
          end
  /* ****************** WI 27488:WNMLS:2005-09-01 END *********************/

          H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
          H2-UERND-INCM-DTL.UERND-INC-AMT = 0.00;
          H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
          H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";
          AIN22W.WS-ERR-UERND-INC-AMT = "T";
          AIN22W.WS-SYS2-YR = SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1];
          AIN22W.WS-SYS2-MM = SR-Q22IP-REC.TRE-MONTH-CHANGE-MO[1];
          AIN22W.WS-SYS2-DD = "01";
          AIN22W.WS-SYS2-F1 = "-";
          AIN22W.WS-SYS2-F2 = "-";
          if (AIN22W.WS-SYS2-MM == 12)
            AIN22W.WS-SYS2-MM = 01;
            AIN22W.WS-SYS2-YR = AIN22W.WS-SYS2-YR + 1;
          else
            AIN22W.WS-SYS2-MM = AIN22W.WS-SYS2-MM + 1;
          end
          H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-SYS2-DATE;
          AIN22P9-GET-MAX-SQ();
          H2-UERND-INCM-DTL.INCM-SQ-NMB = AIN22W.WS-MAX-SQ-NMB;
          H2-UERND-INCM-DTL.PRD-END-DT = "9999-12-31";
          H2-UERND-INCM-DTL.PREV-AMT = 0.00;
          H2-UERND-INCM-DTL.UNE-INC-VERF-BY = "SDX"; /* WI 27488*/
          AIN22P9-INS2();

  /* ****************** WI 27488:WNMLS:2005-09-01 START *******************/
          if (sysVar.sqlData.sqlcode == 0)
            AIN22P9-UNIN-NEW();
            AIN22P9-UNIN-SLOG();
            AIN22P9-INSUID-FSL();
          end
  /* ****************** WI 27488:WNMLS:2005-09-01 END *********************/

        else
          H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
          H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-UNIN-BEG-DT;
          H2-UERND-INCM-DTL.PREV-AMT = H2-UERND-INCM-DTL.UERND-INC-AMT;
          H2-UERND-INCM-DTL.UERND-INC-AMT = 0.00;
          H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
          H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";
          AIN22W.WS-ERR-UERND-INC-AMT = "T";
          H2-UERND-INCM-DTL.PRD-END-DT = AIN22W.WS-UNIN-END-DT;
          H2-UERND-INCM-DTL.UNE-INC-VERF-BY = "SDX"; /* WI 27488*/
          AIN22P9-UPD1();

  /* ****************** WI 27488:WNMLS:2005-09-01 START *******************/
          if (sysVar.sqlData.sqlcode == 0)
            AIN22P9-UNIN-NEW();
            AIN22P9-UNIN-SLOG();
            AIN22P9-INSUID-FSL();
          end
  /* ****************** WI 27488:WNMLS:2005-09-01 END *********************/

  /* ** start wi 23393 ***/
  /* MOVE H2-UERND-INCM-DTL.UERND-INC-AMT TO*/
  /* H2-UERND-INCM-DTL.PREV-AMT;*/
  /* MOVE 0.00 TO H2-UERND-INCM-DTL.PREV-AMT;*/
  /* MOVE 0.00 TO*/
  /* H2-UERND-INCM-DTL.UERND-INC-AMT;*/
  /* MOVE 'M' TO H2-UERND-INCM-DTL.UERND-INC-FREQ;*/
  /* MOVE AIN22W.WS-UPI TO H2-UERND-INCM-DTL.UPI;*/
  /* MOVE '42' TO H2-UERND-INCM-DTL.UERND-INC-TYPE-CD;*/
  /* MOVE 'T' TO AIN22W.WS-ERR-UERND-INC-AMT;*/
  /* MOVE AIN22W.WS-UNIN-BEG-DT TO H2-UERND-INCM-DTL.PRD-BEG-DT;*/
  /* MOVE AIN22W.WS-UNIN-END-DT TO H2-UERND-INCM-DTL.PRD-END-DT;*/
  /* MOVE H2-UERND-INCM-DTL.PRD-BEG-DT TO AIN22W2.WS-DATE;*/
  /* MOVE AIN22W.WS-MTH-UNIN-BEG-DT TO AIN22W2.WS-DATE-MM;*/
  /* MOVE AIN22W.WS-YEAR-UNIN-BEG-DT TO AIN22W2.WS-DATE-CCYY;*/
  /* MOVE 01 TO AIN22W2.WS-DATE-DD;*/
  /* MOVE SR-Q22IP-REC.TRE-MONTH-CHANGE-cy(1) TO AIN22W2.WS-DATE-MM;*/
  /* MOVE SR-Q22IP-REC.TRE-MONTH-CHANGE-MO(1) TO AIN22W2.WS-DATE-YY;*/
  /* PERFORM AIN22P9-LAST-DATE;*/
  /* MOVE SR-Q22IP-REC.TRE-MONTH-CHANGE-CY(1) TO AIN22W.WS-SYS1-YR;*/
  /* MOVE SR-Q22IP-REC.TRE-MONTH-CHANGE-MO(1) TO AIN22W.WS-SYS1-MM;*/
  /* MOVE '01' TO AIN22W.WS-SYS1-DD;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F1;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F2;*/
  /* MOVE AIN22W.WS-SYS1-DATE TO H2-UERND-INCM-DTL.PRD-BEG-DT;*/
  /* PERFORM AIN22P9-GET-MAX-SQ;*/
  /* MOVE AIN22W.WS-MAX-SQ-NMB TO H2-UERND-INCM-DTL.INCM-SQ-NMB;*/
  /* MOVE AIN22W2.WS-PREV-DATE TO H2-UERND-INCM-DTL.PRD-END-DT;*/
  /* PERFORM AIN22P9-INS2;*/
  /* ** end wi 23393 ***/
        end
      else
        if (AIN22W.WS-UNIN-END-DT != "9999-12-31")
          AIN22W.WS-ALERT-FLAG = "T";
          return;
        end
        H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
        H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
        H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-UNIN-BEG-DT;
        H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";
        H2-UERND-INCM-DTL.FS-CNTBL-IND = "Y";
        H2-UERND-INCM-DTL.AFDC-CNTBL-IND = "N";
        H2-UERND-INCM-DTL.MA-CNTBL-CD = "N";
        AIN22W.WS-ERR-UERND-INC-AMT = "T";
        H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
        H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
        H2-UERND-INCM-DTL.INVO-MND-DEDN-AMT = AIN22W.WS-RECOVER-AMOUNT;
        H2-UERND-INCM-DTL.PRD-END-DT = "9999-12-31";

        AIN22P9-QUERY-S09();
        if (VDBCONTROL.URC > 104)
          WCM00P2-TO-CEP01A();
        end
        if (sysVar.sqlData.sqlcode == 0)

          set AIN22W-UNIN-NEW empty; /* WI 27488*/
          set AIN22W-UNIN-OLD empty; /* WI 27488*/
          AIN22P9-UNIN-OLD(); /* WI 27488*/

          AIN22W.WS-SYS1-YR = SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1];
          AIN22W.WS-SYS1-MM = SR-Q22IP-REC.TRE-MONTH-CHANGE-MO[1];
          AIN22W.WS-SYS1-DD = "01";
          AIN22W.WS-SYS1-F1 = "-";
          AIN22W.WS-SYS1-F2 = "-";
          AIN22W2.WS-DATE-DD = AIN22W.WS-SYS1-DD;
          AIN22W2.WS-DATE-MM = AIN22W.WS-SYS1-MM;
          AIN22W2.WS-DATE-CCYY = AIN22W.WS-SYS1-YR;
          AIN22P9-LAST-DATE();
          H2-UERND-INCM-DTL.PRD-END-DT = AIN22W2.WS-PREV-DATE;
          AIN22W.WS-PREV-AMT = H2-UERND-INCM-DTL.UERND-INC-AMT;
          H2-UERND-INCM-DTL.UNE-INC-VERF-BY = "SDX"; /* WI 27488*/
          AIN22P9-UPD4();
          if (VDBCONTROL.URC > 104)
            WCM00P2-TO-CEP01A();
          end

  /* ****************** WI 27488:WNMLS:2005-09-01 START *******************/
          if (sysVar.sqlData.sqlcode == 0)
            AIN22P9-UNIN-NEW();
            AIN22P9-UNIN-SLOG();
            AIN22P9-INSUID-FSL();
          end
  /* ****************** WI 27488:WNMLS:2005-09-01 END *********************/

          H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
          H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
          AIN22W.WS-SYS1-YR = SR-Q22IP-REC.TRE-MONTH-CHANGE-CY[1];
          AIN22W.WS-SYS1-MM = SR-Q22IP-REC.TRE-MONTH-CHANGE-MO[1];
          AIN22W.WS-SYS1-DD = "01";
          AIN22W.WS-SYS1-F1 = "-";
          AIN22W.WS-SYS1-F2 = "-";
          H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-SYS1-DATE;
          AIN22P9-GET-MAX-SQ();
          H2-UERND-INCM-DTL.INCM-SQ-NMB = AIN22W.WS-MAX-SQ-NMB;
          H2-UERND-INCM-DTL.UERND-INC-AMT = 0.00;
          H2-UERND-INCM-DTL.PREV-AMT = 0.00;
          H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";
          H2-UERND-INCM-DTL.PRD-END-DT = "9999-12-31";
          H2-UERND-INCM-DTL.UNE-INC-VERF-BY = "SDX"; /* WI 27488*/
          AIN22P9-INS2();
          if (VDBCONTROL.URC > 104)
            WCM00P2-TO-CEP01A();
          end

  /* ****************** WI 27488:WNMLS:2005-09-01 START *******************/
          if (sysVar.sqlData.sqlcode == 0)
            AIN22P9-UNIN-NEW();
            AIN22P9-UNIN-SLOG();
            AIN22P9-INSUID-FSL();
          end
  /* ****************** WI 27488:WNMLS:2005-09-01 END *********************/

          AIN22W.WS-ERR-UERND-INC-AMT = "T";
        end
      end
    end
    AIN22W.WS-ERR-UERND-INC-AMT = "T";
    AIN22W.WS-UNIN-UPDATED = "T";
    AIN22W.WS-TRIGGER-ELIGIBILITY = "T";
    AIN22W.WS-ALERT-FLAG = "T";
  end
  /*  */
end // end AIN22P9-TERM-UNIN


// TRIGGER-ELIGIBILITY
Function AIN22P9-TRI-ELI()
  /* CBSI START*/
  /* ELIGIBILITY IS TRIGGERED ONLY IF THE UNEARNED INCOME FIELDS HAVE*/
  /* UNDERGONE A CHANGE OR A NEW RECORD IS INSERTED IN THE UNEARNED INCOME*/
  /* FILE. THIS IS DONE BY CREATING A RECORD IN TWNBG_TRN.THE*/
  /* WS-TRIGGER-ELIGIBILITY FLAG IS CHECKED TO DETERMINE A CHANGE IN*/
  /* THE UNEARNED INCOME*/
  /*  */

  /* DETERMINE THE FIRST DATE OF THE MONTH*/

  if (AIN22W.WS-TRIGGER-ELIGIBILITY == "T")

    AIN22P9-ENROL-DT();
    AIN22W.WS-SYS-MM = AIN22W.WS-VALID-ENROL-MM;
    AIN22W.WS-SYS-YR = AIN22W.WS-VALID-ENROL-YY;
    if (AIN22W.WS-SYS-MM == "02")
      AIN22W.WS-REM1 = AIN22W.WS-SYS-NUM-YR % 4;
      AIN22W.WS-REM2 = AIN22W.WS-SYS-NUM-YR % 100;
      AIN22W.WS-REM3 = AIN22W.WS-SYS-NUM-YR % 400;
      if (AIN22W.WS-REM1 != 0)
        AIN22W.WS-SYS-DD = "28";
      else
        if (AIN22W.WS-REM2 == 0)
          if (AIN22W.WS-REM3 == 0)
            AIN22W.WS-SYS-DD = "29";
          else
            AIN22W.WS-SYS-DD = "28";
          end
        else
          AIN22W.WS-SYS-DD = "28";
        end
      end
    else
      if (AIN22W.WS-SYS-MM == "04" || 
      AIN22W.WS-SYS-MM == "06" || 
      AIN22W.WS-SYS-MM == "09" || 
      AIN22W.WS-SYS-MM == "11")
        AIN22W.WS-SYS-DD = "30";
      else
        if (AIN22W.WS-SYS-MM == "01" || 
        AIN22W.WS-SYS-MM == "03" || 
        AIN22W.WS-SYS-MM == "05" || 
        AIN22W.WS-SYS-MM == "07" || 
        AIN22W.WS-SYS-MM == "08" || 
        AIN22W.WS-SYS-MM == "10" || 
        AIN22W.WS-SYS-MM == "12")
          AIN22W.WS-SYS-DD = "31";
  /* MOVE AIN22W.WS-SYS-MM TO AIN22W.WS-TEMP-MM;*/
  /* AIN22W.WS-TEMP1-MM = AIN22W.WS-TEMP1-MM + 1;*/
  /* MOVE AIN22W.WS-TEMP-MM TO AIN22W.WS-SYS-MM;*/
        end
      end
    end
    AIN22W.WS-SYS1-DD = AIN22W.WS-SYS-DD;
    AIN22W.WS-SYS1-MM = AIN22W.WS-SYS-MM;
    AIN22W.WS-SYS1-YY = AIN22W.WS-SYS-YY;
    AIN22W.WS-SYS1-CC = AIN22W.WS-SYS-CC;
    AIN22W.WS-END-DATE = AIN22W.WS-SYS1-DATE;

  /* -----------CHANGES DUE TO PHASE III IMPACT END------------*/

  /* TRIGGER ELIGIBILITY BY CREATING A RECORD IN TWNBG-TRN*/
    set H2-2-CMH-FCH empty;
    H2-2-CMH-FCH.UPI = AIN22W.WS-UPI;
    H2-2-CMH-FCH.T2-PRD-END-DT = AIN22W.WS-VALID-ENROL-DT;

    AIN22P9-QUERY-S08();
    if (VDBCONTROL.URC > 104)
      WCM00P2-TO-CEP01A();
    end

    set H2-BG-TRN empty;
    while (sysVar.sqlData.sqlcode == 0)
      H2-BG-TRN.ICI = H2-2-CMH-FCH.ICI;
      AIN22W.WS-ICI = H2-2-CMH-FCH.ICI;
      H2-BG-TRN.TRAN-PRD-FM-DT = AIN22W.WS-VALID-ENROL-DT;
      H2-BG-TRN.TRAN-PRD-TO-DT = AIN22W.WS-END-DATE;
      H2-BG-TRN.TRAN-STS-CD = "PE";
      H2-BG-TRN.TRAN-PRTY = 0;
      H2-BG-TRN.TRAN-TYPE = "DI";
      H2-BG-TRN.POSTING-TYPE = "A";
      AIN22P9-QUERY-I01();
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
  /* ** start wi 21582 ***/
  /* PERFORM AIN22P9-CASELOG;*/
  /* ** end wi 21582 ***/
      AIN22P9-SCAN8();
      WDB00PE-SQLERR();
      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end
    end
  end
end // end AIN22P9-TRI-ELI


// EDITS FOR UERND-INCM-DTL DATA
Function AIN22P9-UNIN()
  /* CHANGES DUE TO PTR# AIN22001 BEGIN*/
  AIN22W.WS-NUMBER-OF-RECS = 0;

  set H2-UERND-INCM-DTL empty;
  H2-UERND-INCM-DTL.UPI = AIN22W.WS-UPI;
  H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "42";
  /* MOVE AIN22W.WS-PROCESS-DATE-CC TO AIN22W.WS-NUM1-CC;*/
  /* MOVE AIN22W.WS-PROCESS-DATE-YR TO AIN22W.WS-NUM1-YY;*/
  /* MOVE AIN22W.WS-PROCESS-DATE-MO TO AIN22W.WS-NUM1-MM;*/
  /* MOVE AIN22W.WS-PROCESS-DATE-DT TO AIN22W.WS-NUM1-DD;*/

  /* MOVE AIN22W.WS-NUM-DATE TO AIN22W.WS-CHA-DATE;*/
  /* MOVE AIN22W.WS-CHA-MM TO AIN22W.WS-SYS1-MM;*/
  /* MOVE AIN22W.WS-CHA-DD TO AIN22W.WS-SYS1-DD;*/
  /* MOVE AIN22W.WS-CHA-YY TO AIN22W.WS-SYS1-YY;*/
  /* MOVE AIN22W.WS-CHA-CC TO AIN22W.WS-SYS1-CC;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F1;*/
  /* MOVE '-' TO AIN22W.WS-SYS1-F2;*/
  /* MOVE AIN22W.WS-SYS1-DATE TO H2-UERND-INCM-DTL.PRD-BEG-DT;*/
  H2-UERND-INCM-DTL.PRD-BEG-DT = AIN22W.WS-EFF-DATE;


  AIN22P9-QUERY1-S09();
  if (sysVar.sqlData.sqlcode == 0)
    AIN22P9-SCAN9();
    while (sysVar.sqlData.sqlcode == 0)
      AIN22W.WS-NUMBER-OF-RECS = AIN22W.WS-NUMBER-OF-RECS + 1;
      AIN22P9-SCAN9();
    end
  end
   /*  */
   /* Set error control flags*/
   /* UNRF - No record found flag (Y,N,1)*/
   /* UDUP - Duplicate key flag (Y,N)*/
  VDBCOMMON.UNRF = "1";
  VDBCOMMON.UDUP = "N";
   /*  */
   /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /* CHANGE 7068  BEGIN*/
  if (SR-Q22IP-REC.TRE-PAY-STATUS-CD[1] == "C01" || 
  SR-Q22IP-REC.TRE-MEDICAID-ELIG-CD[1] == "G")
  /* ** wi24400 use paid amount instead of eligible amount*/
    AIN22W.WS-INTERFACE-SSI-AMT = SR-Q22IP-REC.TRE-SSI-MONTHLY-ASSIST-AMT;
  else
    AIN22W.WS-INTERFACE-SSI-AMT = 0.00;
  end
  /* CHANGE 7068  END*/
  if (AIN22W.WS-NUMBER-OF-RECS == 1)

    set AIN22W-UNIN-NEW empty; /* WI 27488*/
    set AIN22W-UNIN-OLD empty; /* WI 27488*/
    AIN22P9-UNIN-OLD(); /* WI 27488*/

    H2-UERND-INCM-DTL.UNE-INC-VERF-BY = "SDX"; /* WI 27488*/
    AIN22P9-UPD1();
    if (VDBCONTROL.URC > 104)
      WCM00P2-TO-CEP01A();
    end
    H2-UERND-INCM-DTL.BNFTS-APLD-IND = "Y";

  /* ****************** WI 27488:WNMLS:2005-09-01 START *******************/
    if (sysVar.sqlData.sqlcode == 0)
      AIN22P9-UNIN-NEW();
      AIN22P9-UNIN-SLOG();
      AIN22P9-INSUID-FSL();
    end
  /* ****************** WI 27488:WNMLS:2005-09-01 END *********************/

  else
    AIN22W.WS-ALERT-FLAG = "T";
  end
end // end AIN22P9-UNIN