private static String upNZ(String s) { return s == null ? "" : s.toUpperCase(); }

private static String padRight(String s, int n) {
    String t = upNZ(s);
    if (t.length() >= n) return t.substring(0, n);   // truncate if longer (e.g., AID "0001" -> "000")
    StringBuilder sb = new StringBuilder(t);
    while (sb.length() < n) sb.append(' ');          // CHAR semantics (space padded)
    return sb.toString();
}


private static String normKey(String ofc, String casld, String aid) {
    // Emulate AMA46A CHAR fields: OFC(2) + CASLD(5) + AID(3)
    return padRight(ofc, 2) + "|" + padRight(casld, 5) + "|" + padRight(aid, 3);
}

LOG.info("SANITY >>> famDistinct={}, pceDistinct={}, expectedMissing={}",
         famDistinct.size(), pceDistinct.size(), expectedMissing.size());
