// INQUIRY ON TWNIVD_CASE



function CIN05P9-IDC-S01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-IVD-CASE";

    VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";

    VDBCONTROL.UPROC-OPT = "SETINQ";

    VDBCONTROL.UPROC-NM = "CIN05P9-IDC-S01";

    /*  */

    try

        open CIN05P9-IDC-S01_RSI01

                with #sql{

        select CASE_SUFX, CASE_TYPE, SRVC_LVL, CST_NED_MEDINS_IND

        from TWNIVD_CASE T1

        WHERE NCP_UPI = :NCP-UPI

        AND   CASE_STS <> 'C'

        AND CASE_TYPE <> 'D'         

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into CASE-SUFX, CASE-TYPE, SRVC-LVL, CST-NED-MEDINS-IND

                for H2-IVD-CASE;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-IDC-S01



// INQUIRY TWNIVD_CASE



function CIN05P9-IDC-S02()

    WDB00PI();

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCOMMON.USQLREC = "H2-IVD-CASE";

    VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";

    VDBCONTROL.UPROC-NM = "CIN05P9-IDC-S02";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    try

        get H2-IVD-CASE singleRow

                with #sql{

        select NCP_UPI

        from TWNIVD_CASE T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE NCP_UPI   = :NCP-UPI

        AND   CASE_SUFX = :CASE-SUFX

        AND   (CASE_STS  = 'C'

             or CASE_TYPE = 'D')

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into NCP-UPI;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "N";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-IDC-S02





function CIN05P9-IDC-SCAN()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-IVD-CASE";

    VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";

    VDBCONTROL.UPROC-NM = "CIN05P9-IDC-SCAN";

    VDBCONTROL.UPROC-OPT = "SCAN";

    /*  */

    try

        get next H2-IVD-CASE;

    end

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end



    VDBCOMMON.UNRF = 1;

    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();

end // end CIN05P9-IDC-SCAN



// INITIALIZE PROCESS





function CIN05P9-INIT()

    set CIN05W empty;



    call "DATEAPP"(GDW, VDBCONTROL, VMESSAGE){isNoRefresh = yes};

    CIN05W1.WS-CRTD-TS = GDW.TS;

    /*  */

    WCM00P3-FETCHBDTS();

    /*  */

    CIN05W1.WS-PROC-DT-CC = BDATE-PROCESS-DATE-CC;

    CIN05W1.WS-PROC-DT-YY = BDATE-PROCESS-DATE-YY;

    CIN05W1.WS-PROC-DT-SEP-1 = "-";

    CIN05W1.WS-PROC-DT-MM = BDATE-PROCESS-DATE-MM;

    CIN05W1.WS-PROC-DT-SEP-2 = "-";

    CIN05W1.WS-PROC-DT-DD = BDATE-PROCESS-DATE-DD;

    CIN05W1.WS-CRTD-DT = CIN05W1.WS-PROCESS-DT;



    CIN05W.WS-FIRST = "N";

    CIN05W.WS-FIRST-IND = "Y";

    CIN05W.WS-SQL-FILL1 = "-";

    CIN05W.WS-SQL-FILL2 = "-";

    CIN05W.WS-DB-FILL1 = "-";

    CIN05W.WS-DB-FILL2 = "-";



    CIN05W.TCON-LITERAL1 = "ESD HAS RESPONDED ON THE FOLLOWING NCP: ";

    CIN05W.TCON-LITERAL2 = "1. NAME PER NOMADS - ";

    CIN05W.TCON-NNAME-COMMA = ", ";

    CIN05W.TCON-LITERAL3 = "2. NAME PER ESD - ";

    CIN05W.TCON-ENAME-COMMA = ", ";

    CIN05W.TCON-LITERAL4 = "3. SSN PER NOMADS - ";

    CIN05W.TCON-NSSN-COMMA = ", ";

    CIN05W.TCON-LITERAL5 = "4. INTERFACE SSN REPORTED BY ESD - ";

    /*  */

    CIN05P9-SCANPARMS();

    /*  */

    if(sysVar.errorCode == "00000000")

        CIN05W3.PCIN05-PGM-PARMS = SR-CIN05-PARMS.PARM-DATA;

    end

end // end CIN05P9-INIT



// ADD Data



function CIN05P9-ISS-I01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-ESD-ISSUE";

    VDBCONTROL.UPROC-OBJ = "H2-ESD-ISSUE";

    VDBCONTROL.UPROC-OPT = "ADD";

    VDBCONTROL.UPROC-NM = "CIN05P9-ISS-I01";

    /*  */

    try

        add H2-ESD-ISSUE;

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();

end // end CIN05P9-ISS-I01



// INQUIRY issue rec



function CIN05P9-ISS-S01()

    WDB00PI();

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H3-ESD-ISSUE";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-ISS-S01";

    VDBCOMMON.USQLREC = "H3-ESD-ISSUE";

    /*  */

    try

        get H3-ESD-ISSUE singleRow

                with #sql{

        select UI_DISQ_BEG_DT, UI_DISQ_END_DT, ISSUE_DETERM

        from TWNESD_ISSUE T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE INTRFC_SSN = :INTRFC-SSN

        AND   BNFT_YR_END_DT = :BNFT-YR-END-DT

        AND   ISSUE_SQ_NMB = :ISSUE-SQ-NMB

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UI-DISQ-BEG-DT, UI-DISQ-END-DT, ISSUE-DETERM;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-ISS-S01



// UPDATE TWNESD_ISSUE



function CIN05P9-ISS-U01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H2-ESD-ISSUE";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-ISS-U01";

    VDBCOMMON.USQLREC = "H2-ESD-ISSUE";

    /* WI 4063 - Start */

    /*  */

    try

        execute update 

                #sql{

        UPDATE

          TWNESD_ISSUE

        SET

          UI_DISQ_BEG_DT = :UI-DISQ-BEG-DT,

          UI_DISQ_END_DT = :UI-DISQ-END-DT,

          ISSUE_DETERM = :ISSUE-DETERM,

          UIB_CLM_NMB = :UIB-CLM-NMB

        WHERE

          INTRFC_SSN = :INTRFC-SSN AND

          BNFT_YR_END_DT = :BNFT-YR-END-DT AND

          ISSUE_SQ_NMB = :ISSUE-SQ-NMB

      }

                for H2-ESD-ISSUE; // model = update

    end

    /* WI 4063 - end  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-ISS-U01



function CIN05P9-ISSUE()

	/* This routine intentionally ignores the disqualification begin and

       end dates in TWNUIB_DTLS because those columns are not being used */

    set H2-ESD-ISSUE empty;

    H2-ESD-ISSUE.INTRFC-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    if(CIN05W.WS-ISS-BYE-DT == "00000000" || CIN05W.WS-ISS-BYE-DT ==

                    "99999999")

        H2-ESD-ISSUE.BNFT-YR-END-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-ISS-BYE-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-ISS-BYE-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-ISS-BYE-DD;

        H2-ESD-ISSUE.BNFT-YR-END-DT = CIN05W.WS-DB-DATE;

    end

    H2-ESD-ISSUE.ISSUE-SQ-NMB = CIN05W.WS-ISS-SQ-NMB;

    if(CIN05W.WS-ISS-DISQ-BEG-DT == "00000000" || CIN05W.WS-ISS-DISQ-BEG-DT ==

                    "99999999")

        /* WI 4063 - start */            	

        H2-ESD-ISSUE.UI-DISQ-BEG-DT = "0001-01-01";

        /* WI 4063 - end */

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-ISS-DBD-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-ISS-DBD-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-ISS-DBD-DD;

        H2-ESD-ISSUE.UI-DISQ-BEG-DT = CIN05W.WS-DB-DATE;

    end

    /* WI 4063 - start */

    if(CIN05W.WS-ISS-DISQ-END-DT == "00000000" || CIN05W.WS-ISS-DISQ-END-DT == "99999999")

        H2-ESD-ISSUE.UI-DISQ-END-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-ISS-DED-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-ISS-DED-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-ISS-DED-DD;

        H2-ESD-ISSUE.UI-DISQ-END-DT = CIN05W.WS-DB-DATE;

    end

    H2-ESD-ISSUE.ISSUE-DETERM = CIN05W.WS-ISS-ISSUE-DETERM;

    H2-ESD-ISSUE.UIB-CLM-NMB = CIN05W.WS-ISS-CLM-ID;

    H2-ESD-ISSUE.PROCESS-DT = CIN05W1.WS-PROCESS-DT;

    /* WI 4063 - end */

    set H3-ESD-ISSUE empty;

    H3-ESD-ISSUE.INTRFC-SSN = H2-ESD-ISSUE.INTRFC-SSN;

    H3-ESD-ISSUE.BNFT-YR-END-DT = H2-ESD-ISSUE.BNFT-YR-END-DT;

    H3-ESD-ISSUE.ISSUE-SQ-NMB = H2-ESD-ISSUE.ISSUE-SQ-NMB;

    CIN05P9-ISS-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(sysVar.sqlData.sqlcode == 0)

        CIN05P9-ISS-U01();

    else

        CIN05P9-ISS-I01();

    end

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

end // end CIN05P9-ISSUE



// ADD Data



function CIN05P9-JHS-I01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-JOB-HISTORY";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H2-JOB-HISTORY";

    VDBCONTROL.UPROC-OPT = "ADD";

    VDBCONTROL.UPROC-NM = "CIN05P9-JHS-I01";

    /*  */

    try

        add H2-JOB-HISTORY;

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();

end // end CIN05P9-JHS-I01



// INQUIRY



function CIN05P9-JHS-S01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H2-JOB-HISTORY";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-JHS-S01";

    VDBCOMMON.USQLREC = "H2-JOB-HISTORY";

    /*  */

    try

        get H2-JOB-HISTORY

                with #sql{

        select vrfn_sts, crtn_dt, job_end_dt, vrfd_dt

        from TWNJOB_HISTORY T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI        = :UPI

        AND   EMPLR_ID   = :EMPLR-ID

        order by crtn_dt desc, vrfn_sts

         --AND   JOB_END_DT = :JOB-END-DT

         --** INSERT ORDER BY CLAUSE HERE **

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into VRFN-STS, CRTN-DT, JOB-END-DT, VRFD-DT;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-JHS-S01



// SET INQUIRY ON TWNJOB_INCM_DTL



function CIN05P9-JID-S01()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-JID-S01";

    VDBCONTROL.UPROC-OBJ = "H2-JOB-INCM-DTLS";

    VDBCONTROL.UPROC-OPT = "SETINQ";

    VDBCOMMON.USQLREC = "H2-JOB-INCM-DTLS";

    try

        open CIN05P9-JID-S01_RSI01

                with #sql{

        select UPI,INCM_SQ_NMB,PRD_BEG_DT,PAY_FREQ,HRLY_RATE_AMT,

             TIPS_COMSN_FREQ,AFDC_CNTBL_IND,FS_CNTBL_IND,MA_CNTBL_CD,

             PRD_END_DT,MAINT_CD,OVRD_433_IND,ERND_INCM_TYPE,EMPLR_ID

        from TWNJOB_INCM_DTLS T1

        WHERE(UPI = :UPI    AND

              EMPLR_ID = :EMPLR-ID AND

              MAINT_CD <> :MAINT-CD)

        AND  :PRD-BEG-DT BETWEEN PRD_BEG_DT AND PRD_END_DT

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UPI, INCM-SQ-NMB, PRD-BEG-DT, PAY-FREQ, HRLY-RATE-AMT, TIPS-COMSN-FREQ, AFDC-CNTBL-IND, FS-CNTBL-IND, MA-CNTBL-CD, PRD-END-DT, MAINT-CD, 

                     OVRD-433-IND, ERND-INCM-TYPE, EMPLR-ID

                for H2-JOB-INCM-DTLS;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

        CIN05W.WS-FLAG = "Y";

    else

        CIN05W.WS-FLAG = "N";

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-JID-S01



// READ THE TABLE TWNJOB_INCM_DTL



function CIN05P9-JID-S02()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-JID-S02";

    VDBCONTROL.UPROC-OBJ = "H2-JOB-INCM-DTLS";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCOMMON.USQLREC = "H2-JOB-INCM-DTLS";

    try

        get H2-JOB-INCM-DTLS

                with #sql{

        select UPI,INCM_SQ_NMB,PRD_BEG_DT,PAY_FREQ,HRLY_RATE_AMT,

             TIPS_COMSN_FREQ,AFDC_CNTBL_IND,FS_CNTBL_IND,MA_CNTBL_CD,

             PRD_END_DT,MAINT_CD,OVRD_433_IND,ERND_INCM_TYPE,EMPLR_ID

        from TWNJOB_INCM_DTLS T1

        WHERE  (UPI = :UPI    AND

               MAINT_CD <> :MAINT-CD)

        AND   :PRD-BEG-DT BETWEEN PRD_BEG_DT AND PRD_END_DT

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UPI, INCM-SQ-NMB, PRD-BEG-DT, PAY-FREQ, HRLY-RATE-AMT, TIPS-COMSN-FREQ, AFDC-CNTBL-IND, FS-CNTBL-IND, MA-CNTBL-CD, PRD-END-DT, MAINT-CD, 

                OVRD-433-IND, ERND-INCM-TYPE, EMPLR-ID;

    end



    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

        CIN05W.WS-UPD-JINC = "F";

        CIN05W.WS-ALERT-FG = "T";

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-JID-S02



// SCAN ROWS FROM TWNJOB_INCM_DTL



function CIN05P9-JID-SCAN()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-JID-SCAN";

    VDBCONTROL.UPROC-OBJ = "H2-JOB-INCM-DTLS";

    VDBCONTROL.UPROC-OPT = "SCAN";

    VDBCOMMON.USQLREC = "H2-JOB-INCM-DTLS";

    try

        get next H2-JOB-INCM-DTLS;

    end



    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

        CIN05W.WS-FLAG = "Y";

    else

        CIN05W.WS-FLAG = "N";

    end

    /*  */

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-JID-SCAN



// INITIALIZE PROCESS



function CIN05P9-MAIN()

    CIN05P9-INIT();



    while(SR-CIN05-RECIN not endOfFile)

        CIN05P9-SCAN-INPUT();

        if(sysVar.errorCode == "00000000")

        	/* WI 4063 - start */

            CIN05W.WS-INPUT-REC-CNT = CIN05W.WS-INPUT-REC-CNT + 1;

            CIN05P9-TRAC-PROC();

            /* WI 4063 - end */

            CIN05P9-PROC-DATA();

        end

    end



    CIN05P9-CLOSE();

end // end CIN05P9-MAIN



// INQUIRY ON MASS_CHNG_PARMS



function CIN05P9-MCH-S01()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-MCH-S01";

    VDBCONTROL.UPROC-OBJ = "H2-MASS-CHNG-PARMS";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCOMMON.USQLREC = "H2-MASS-CHNG-PARMS";

    try

        get H2-MASS-CHNG-PARMS singleRow

                with #sql{

        select MASS_CHNG_PCT, FACTOR

        from TWNMASS_CHNG_PARMS T1

        WHERE MASS_CHNG_TYPE = :MASS-CHNG-TYPE

        AND PRGM_TYPE = :PRGM-TYPE

        AND :EFF-FR-DT BETWEEN EFF_FR_DT AND EFF_TO_DT

        AND MASS_CHNG_DATA_TYP = 'P'

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into MASS-CHNG-PCT, FACTOR;

    end

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end



    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /* ** perform the process for sql error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-MCH-S01



function CIN05P9-PER-CLM()

    set H2-UIB-DTLS empty;

    H2-UIB-DTLS.UPI = CIN05W.WS-UPI;

    H2-UIB-DTLS.PROCESS-DT = CIN05W1.WS-PROCESS-DT;

    if(CIN05W.WS-PERCLM-CLM-BEG-DT == "00000000" ||

            CIN05W.WS-PERCLM-CLM-BEG-DT == "99999999")

        H2-UIB-DTLS.CLM-BEG-DT = "0001-01-01";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-PERCLM-CBD-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-PERCLM-CBD-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-PERCLM-CBD-DD;

        H2-UIB-DTLS.CLM-BEG-DT = CIN05W.WS-DB-DATE;

    end

    if(CIN05W.WS-PERCLM-UI-BYE-DT == "00000000" ||

            CIN05W.WS-PERCLM-UI-BYE-DT == "99999999")

        H2-UIB-DTLS.CLM-END-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-PERCLM-BYE-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-PERCLM-BYE-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-PERCLM-BYE-DD;

        H2-UIB-DTLS.CLM-END-DT = CIN05W.WS-DB-DATE;

    end

    CIN05W.WS-FRST-INIT = CIN05W.WS-PERCLM-FRST-INIT;

    CIN05W.WS-MID-INIT = CIN05W.WS-PERCLM-MID-INIT;

    CIN05W.WS-LST-NM = CIN05W.WS-PERCLM-LST-NM;

    H2-UIB-DTLS.EMPL-NM-IN-ESD-REC = CIN05W.WS-PACKED-NM;

    H2-UIB-DTLS.EMPL-ADLN1 = CIN05W.WS-PERCLM-MA-LN1;

    H2-UIB-DTLS.EMPL-ADLN2 = CIN05W.WS-PERCLM-MA-LN2;

    H2-UIB-DTLS.CTY = CIN05W.WS-PERCLM-MA-CITY;

    H2-UIB-DTLS.ST-CD = CIN05W.WS-PERCLM-MA-ST;

    H2-UIB-DTLS.ZIP-CD = CIN05W.WS-PERCLM-MA-ZIP-CD;

    if(CIN05W.WS-PERCLM-DOB == "00000000" || CIN05W.WS-PERCLM-DOB ==

                    "99999999")

        H2-UIB-DTLS.CLNTS-DOB = "0001-01-01";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-PERCLM-DOB-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-PERCLM-DOB-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-PERCLM-DOB-DD;

        H2-UIB-DTLS.CLNTS-DOB = CIN05W.WS-DB-DATE;

    end

    H2-UIB-DTLS.UIB-APPL-STS = CIN05W.WS-PERCLM-UI-CLM-STS;

    H2-UIB-DTLS.INTRFC-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    H2-UIB-DTLS.AGNT-ST = CIN05W.WS-PERCLM-AGNT-ST;

    H2-UIB-DTLS.LIBL-ST = CIN05W.WS-PERCLM-LIBL-ST;

    H2-UIB-DTLS.RES-ADLN1 = CIN05W.WS-PERCLM-RA-LN1;

    H2-UIB-DTLS.RES-ADLN2 = CIN05W.WS-PERCLM-RA-LN2;

    H2-UIB-DTLS.RES-CITY = CIN05W.WS-PERCLM-RA-CITY;

    H2-UIB-DTLS.RES-ST = CIN05W.WS-PERCLM-RA-ST;

    H2-UIB-DTLS.RES-ZIP-CD = CIN05W.WS-PERCLM-RA-ZIP-CD;

    H2-UIB-DTLS.LST-NM = CIN05W.WS-PERCLM-LST-NM;

    H2-UIB-DTLS.FRST-NM = CIN05W.WS-PERCLM-FRST-NM;

    H2-UIB-DTLS.MID-INIT = CIN05W.WS-PERCLM-MID-INIT;

    H2-UIB-DTLS.AKA-LST-NM = CIN05W.WS-PERCLM-AKA-LST-NM;

    H2-UIB-DTLS.AKA-FRST-NM = CIN05W.WS-PERCLM-AKA-FRST-NM;

    H2-UIB-DTLS.AKA-MID-INIT = CIN05W.WS-PERCLM-AKA-MID-INIT;

    if(CIN05W.WS-PERCLM-UI-APPL-DT == "00000000" ||

            CIN05W.WS-PERCLM-UI-APPL-DT == "99999999")

        H2-UIB-DTLS.UI-APPL-DT = "0001-01-01";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-PERCLM-UIA-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-PERCLM-UIA-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-PERCLM-UIA-DD;

        H2-UIB-DTLS.UI-APPL-DT = CIN05W.WS-DB-DATE;

    end

    /* WI 4063 - start */

    H2-UIB-DTLS.UIB-CLM-NMB = CIN05W.WS-PERCLM-CLM-ID;

    /* WI 4063 - end */

    /* Check for partial record created by P9-CHECK earlier in this batch*/

    set H3-UIB-DTLS empty;

    H3-UIB-DTLS.UPI = CIN05W.WS-UPI;

    H3-UIB-DTLS.PROCESS-DT = CIN05W1.WS-PROCESS-DT;

    H3-UIB-DTLS.CLM-BEG-DT = H2-UIB-DTLS.CLM-BEG-DT;

    H3-UIB-DTLS.CLM-END-DT = H2-UIB-DTLS.CLM-END-DT;

    H3-UIB-DTLS.UIB-APPL-STS = H2-UIB-DTLS.UIB-APPL-STS;

    H3-UIB-DTLS.INTRFC-SSN = H2-UIB-DTLS.INTRFC-SSN;

    /* WI 4063 - start */

    H3-UIB-DTLS.UIB-CLM-NMB = CIN05W.WS-PERCLM-CLM-ID;

    /* WI 4063 - end */

    

    CIN05P9-UIB-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end



    /* WI 4063 - start - move selected columns to H4 for possible delete */

    H4-UIB-DTLS.UPI = H3-UIB-DTLS.UPI;

    H4-UIB-DTLS.CLM-BEG-DT = H3-UIB-DTLS.CLM-BEG-DT;

    H4-UIB-DTLS.CLM-END-DT = H3-UIB-DTLS.CLM-END-DT;

    H4-UIB-DTLS.INTRFC-SSN = H3-UIB-DTLS.INTRFC-SSN;

    H4-UIB-DTLS.UIB-CLM-NMB = H3-UIB-DTLS.UIB-CLM-NMB;

    /* WI 4063 - end */

    

    if(sysVar.sqlData.sqlcode == 0)

        /* If address has changed (ignore ADLN2 for IV-D), send alert*/

        if(H2-UIB-DTLS.EMPL-ADLN1 != H3-UIB-DTLS.EMPL-ADLN1 ||

                H2-UIB-DTLS.CTY != H3-UIB-DTLS.CTY || H2-UIB-DTLS.ST-CD !=

                        H3-UIB-DTLS.ST-CD || H2-UIB-DTLS.ZIP-CD !=

                        H3-UIB-DTLS.ZIP-CD)

            set PCALINP empty;

            if(CIN05W.WS-PRIM-OR-ALT == "P")

                PCALINP.PAL-ALERT-CD = 320006;

            else

                PCALINP.PAL-ALERT-CD = 320114;

            end

            PCALINP.PAL-UPI = CIN05W.WS-UPI;

            PCALINP.PAL-SUFFIX = "9";

            PCALINP.PAL-ALERT-ACTION = "C";

            PCALINP.PAL-PROCESS-DT = CIN05W1.WS-PROCESS-DT;

            /*  */

            if(CIN05W3.PI1-ALERT == "NOALERT" && CIN05W3.PI1-ALERT-FLAG == "N")

                /*  */

                call "CAL11A"(VDBCONTROL, VMESSAGE,

                        PCALINP){isNoRefresh = yes};

            /*  */

            end

            /*  */

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

        end



        /* WI 4063 - start */

        if (H3-UIB-DTLS.CLM-BEG-DT == H2-UIB-DTLS.CLM-BEG-DT)

          CIN05P9-UIB-U01();

          if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

          end

        else

          /* delete old row and insert replacement with different clm-beg-dt */

          CIN05P9-UIB-D01();

          if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

          end

          H2-UIB-DTLS.ESD-OFC-CD = H3-UIB-DTLS.ESD-OFC-CD;

          H2-UIB-DTLS.UIB-BAL-AMT = H3-UIB-DTLS.UIB-BAL-AMT;

          H2-UIB-DTLS.DISQL-BEG-DT = H3-UIB-DTLS.DISQL-BEG-DT;

          H2-UIB-DTLS.DISQL-END-DT = H3-UIB-DTLS.DISQL-END-DT;

          H2-UIB-DTLS.NO-UIB-RSN-CD = H3-UIB-DTLS.NO-UIB-RSN-CD;

          H2-UIB-DTLS.CLM-EFF-DT = H3-UIB-DTLS.CLM-EFF-DT;

          H2-UIB-DTLS.CLM-CMPTD-DT = H3-UIB-DTLS.CLM-CMPTD-DT;

          H2-UIB-DTLS.OFC-CD = H3-UIB-DTLS.OFC-CD;

          H2-UIB-DTLS.CSI-AMT = H3-UIB-DTLS.CSI-AMT;

          H2-UIB-DTLS.WK-BNFT-AMT = H3-UIB-DTLS.WK-BNFT-AMT;

          H2-UIB-DTLS.MTH-BNFT-AMT = H3-UIB-DTLS.MTH-BNFT-AMT;

          H2-UIB-DTLS.MAX-BNFT-AMT = H3-UIB-DTLS.MAX-BNFT-AMT;

          H2-UIB-DTLS.CHK-DT = H3-UIB-DTLS.CHK-DT;

          H2-UIB-DTLS.BASE-PRD-ERN-AMT = H3-UIB-DTLS.BASE-PRD-ERN-AMT;

          CIN05P9-UIB-I01();

          if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

          end   

        end 

        /* WI 4063 - end */  

    else

        H2-UIB-DTLS.DISQL-BEG-DT = "0001-01-01";

        H2-UIB-DTLS.DISQL-END-DT = "9999-12-31";

        H2-UIB-DTLS.CLM-EFF-DT = "0001-01-01";

        H2-UIB-DTLS.CLM-CMPTD-DT = "0001-01-01";

        H2-UIB-DTLS.CHK-DT = "0001-01-01";



        CIN05P9-UIB-I01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    end

end // end CIN05P9-PER-CLM



// Find UPI by SSN



function CIN05P9-PER-S01()

    WDB00PI();

    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.USQLREC = "H2-PERSON";

    VDBCONTROL.UPROC-NM = "CIN05P9-PER-S01";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-OBJ = "H2-PERSON";

    try

        get H2-PERSON singleRow

                with #sql{

        select UPI, IVA_CASE_MBR_FG, LST_NM, FRST_NM, MID_NM

        from TWNPERSON T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE SSN = :SSN

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UPI, IVA-CASE-MBR-FG, CIN05W.WS-NOM-LST-NM, CIN05W.WS-NOM-FRST-NM, CIN05W.WS-NOM-MID-NM;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-PER-S01



// Find Name by UPI



function CIN05P9-PER-S02()

    WDB00PI();

    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.USQLREC = "H2-PERSON";

    VDBCONTROL.UPROC-NM = "CIN05P9-PER-S02";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-OBJ = "H2-PERSON";

    try

        get H2-PERSON singleRow

                with #sql{

        select SSN, IVA_CASE_MBR_FG, LST_NM, FRST_NM, MID_NM

        from TWNPERSON T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI = :UPI

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into CIN05W.WS-PRIM-SSN, IVA-CASE-MBR-FG, CIN05W.WS-NOM-LST-NM, CIN05W.WS-NOM-FRST-NM, CIN05W.WS-NOM-MID-NM;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-PER-S02



function CIN05P9-PROC-DATA()

    CIN05W.WS-GOOD-REC = "N";

    CIN05W.WS-ALERT-FG = "F";

    /* Get UPI, Name*/

    set H2-PERSON empty;

    H2-PERSON.SSN = SR-CIN05-RECIN.INTRFC-SSN;

    CIN05P9-PER-S01();

    if(sysVar.sqlData.sqlcode == 0)

        CIN05W.WS-UPI = H2-PERSON.UPI;

        CIN05W.WS-PRIM-OR-ALT = "P";

        CIN05W.WS-GOOD-REC = "Y";

    else

        set H2-ALTERNATE-SSN empty;

        H2-ALTERNATE-SSN.ALT-SSN = SR-CIN05-RECIN.INTRFC-SSN;

        /* Check ALT-SSN table*/

        CIN05P9-ALS-S01();

        if(sysVar.sqlData.sqlcode == 0)

            CIN05W.WS-UPI = H2-ALTERNATE-SSN.UPI;

            set H2-PERSON empty;

            H2-PERSON.UPI = H2-ALTERNATE-SSN.UPI;

            /* Get Primary SSN, Name*/

            CIN05P9-PER-S02();

            CIN05W.WS-PRIM-OR-ALT = "A";

            CIN05W.WS-GOOD-REC = "Y";

        end

    end

    /*  */

    if(CIN05W.WS-GOOD-REC == "Y")

        /*  */

        if(SR-CIN05-RECIN.REC-TYPE == "1")

            CIN05W.WS-PER-CLM-DATA = SR-CIN05-RECIN.TYPE-SPECIFIC-DATA;

            CIN05P9-PER-CLM();

        else

            if(SR-CIN05-RECIN.REC-TYPE == "2")

                CIN05W.WS-WAGE-DATA = SR-CIN05-RECIN.TYPE-SPECIFIC-DATA;

                if(CIN05W.WS-WAGE-EMPLR-NM != " " &&

                        CIN05W.WS-WAGE-EMPLR-ADLN != " " &&

                        CIN05W.WS-WAGE-EMPLR-CITY != " " &&

                        CIN05W.WS-WAGE-EMPLR-ST != " ")

                    CIN05P9-WAGE();

                else

                    CIN05W.WS-GOOD-REC = "N";

                end

            else

                if(SR-CIN05-RECIN.REC-TYPE == "4")

                    CIN05W.WS-ISSUE-DATA = SR-CIN05-RECIN.TYPE-SPECIFIC-DATA;

                    CIN05P9-ISSUE();

                else

                    if(SR-CIN05-RECIN.REC-TYPE == "5")

                        CIN05W.WS-CHECK-DATA = SR-CIN05-RECIN.TYPE-SPECIFIC-DATA;

                        if(CIN05W.WS-CHK-CHK-DT != "00000000" &&

                                CIN05W.WS-CHK-BNFT-WK-END-DT != "00000000" &&

                                CIN05W.WS-CHK-UI-BYE-DT != "00000000"

                                /* WI 2632 - start */

                                && CIN05W.WS-CHK-CLM-BEG-DT != "00000000")

                                /* WI 2632 - end */

                            CIN05P9-CHECK();

                        else

                            CIN05W.WS-GOOD-REC = "N";

                        end

                    else

                        CIN05W.WS-GOOD-REC = "N";

                    end

                end

            end

        end

    /*  */

    end

    /*  */

    if(CIN05W.WS-GOOD-REC == "Y")

        CIN05P9-UPD-LCA();

        CIN05P9-UPD-CON();

    end



    if(CIN05W.WS-ALERT-FG == "T")

        CIN05P9-ALERT-WOR();

    end

end // end CIN05P9-PROC-DATA



// PROCESS UNIN DATA



function CIN05P9-PRUNIN-DTA()

/* process unin data*/

    CIN05P9-GET-UNIN();



    if(CIN05W.WS-UNIN-REC-CNT == 0)

        /* key-setting*/

        H2-UERND-INCM-DTL.UPI = CIN05W.WS-UPI;

        H2-UERND-INCM-DTL.PRD-BEG-DT = CIN05W.WS-PRD-BEG-DT;

        /* end key-setting*/

        /*  */

        CIN05W.WS-MAX-SEQ-NMB = 0;

        CIN05P9-UID-S03();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

        /*  */

        CIN05W.WS-MAX-SEQ-NMB = CIN05W.WS-MAX-SEQ-NMB + 1;

        H2-UERND-INCM-DTL.INCM-SQ-NMB = CIN05W.WS-MAX-SEQ-NMB;

        /* key-setting*/

        H2-UERND-INCM-DTL.UPI = CIN05W.WS-UPI;

        H2-UERND-INCM-DTL.PRD-BEG-DT = CIN05W.WS-PRD-BEG-DT;



        /* MOVE PRD-END-DT IN UNLESS PRD-BEG-DT IS = CURRENT FOOTER MONTH*/

        if(CIN05W.WS-UNIN-REC-CNT-F > 0)

            CIN05W.WS-PRD-END-DT = CIN05W.WS-PRD-BEG-DT-F;

            /*  */

            if(CIN05W.WS-PRD-END-MM == 1)

                CIN05W.WS-PRD-END-MM = 12;

                CIN05W.WS-PRD-END-CCYY = CIN05W.WS-PRD-END-CCYY - 1;

            else

                CIN05W.WS-PRD-END-MM = CIN05W.WS-PRD-END-MM - 1;

            end

            /*  */

            CIN05P9-DET-END-DD();

            /*  */

            H2-UERND-INCM-DTL.PRD-END-DT = CIN05W.WS-PRD-END-DT;

            H2-UERND-INCM-DTL.RECUR-IND = "N";

        else

            H2-UERND-INCM-DTL.RECUR-IND = "Y";

            H2-UERND-INCM-DTL.PRD-END-DT = "9999-12-31";

        end



        /*  */

        H2-UERND-INCM-DTL.UERND-INC-TYPE-CD = "45";



        set H2-CASE-MEMBER-HST empty;

        H2-CASE-MEMBER-HST.UPI = CIN05W.WS-UPI;

        H2-CASE-MEMBER-HST.PRD-END-DT = H2-UERND-INCM-DTL.PRD-END-DT;



        CIN05P9-CMH-S02();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

        if(sysVar.sqlData.sqlcode == 0)

            if(H2-CASE-MEMBER-HST.AFDC-ASST-IND == "Y")

                H2-UERND-INCM-DTL.AFDC-CNTBL-IND = "Y";

            else

                H2-UERND-INCM-DTL.FS-CNTBL-IND = "N";

                H2-UERND-INCM-DTL.MA-CNTBL-CD = "N";

                H2-UERND-INCM-DTL.AFDC-CNTBL-IND = "N";

            end

            if(H2-CASE-MEMBER-HST.FS-ASST-IND == "Y")

                H2-UERND-INCM-DTL.FS-CNTBL-IND = "Y";

            end

            if(H2-CASE-MEMBER-HST.MA-ASST-IND == "Y")

                H2-UERND-INCM-DTL.MA-CNTBL-CD = "Y";

            end

        end

        if(sysVar.sqlData.sqlcode == 100)

            H2-UERND-INCM-DTL.AFDC-CNTBL-IND = "?";

            H2-UERND-INCM-DTL.FS-CNTBL-IND = "?";

            H2-UERND-INCM-DTL.MA-CNTBL-CD = "?";

            H2-UERND-INCM-DTL.BNFTS-APLD-IND = "?";

        end



        H2-UERND-INCM-DTL.CHNG-ENTRY-DT = GDW.DTCD;

        H2-UERND-INCM-DTL.UNE-INC-VERF-CD = "?";

        H2-UERND-INCM-DTL.SSI-RSDI-RCVD-YR = 9999;

        H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";

        H2-UERND-INCM-DTL.UERND-INC-RCVD-DT = GDW.DTCD;

        H2-UERND-INCM-DTL.SSI-RSDI-RCVD-MTH = 12;

        H2-UERND-INCM-DTL.BNFTS-APLD-IND = "N";

        H2-UERND-INCM-DTL.UERND-INC-AMT = CIN05W.WS-INTERFACE-AMT;

        H2-UERND-INCM-DTL.PREV-AMT = 0;

        H2-UERND-INCM-DTL.PBLIC-RSDI-STRT-DT = null;

        H2-UERND-INCM-DTL.UNE-INC-VERF-DT = GDW.DTCD;

        H2-UERND-INCM-DTL.RCVD-DT = GDW.DTCD;

        H2-UERND-INCM-DTL.RPRTD-DT = GDW.DTCD;

        H2-UERND-INCM-DTL.RCPT-DT = GDW.DTCD;

        /*  */

        /* perform the process to insert a record into the table*/

        /* TWNUERND_INCM_DTL*/

        /*  */

        CIN05P9-UID-I01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

        /*  */

        /* set the alert flag*/

        CIN05W.WS-ALERT-FG = "T";

    else

        /*  */

        /* if a record is found, and if the difference between the unin amt*/

        /* and the interface amt exceeds the tolerance limit, and if the*/

        /* number of unin records found is equal to 1, update the record*/

        /* and alert the worker*/

        /*  */

        /* If the interface amount is*/

        /* greater than or less than the UNIN amount update the record and*/

        /* alert the worker.*/

        /*  */

        /* if the difference in amount is beyond the tolerance limit*/

        /*  */

        /* if the number of unin records found is 1,*/

        /* update the unin record with the interface amt*/

        if(CIN05W.WS-UNIN-REC-CNT == 1)



            if(CIN05W.WS-PRD-BEG-DT == H2-UERND-INCM-DTL.PRD-BEG-DT)



                /* if the interface amount is not equal to the UNIN amount*/

                if(CIN05W.WS-UNIN-AMT != CIN05W.WS-INTERFACE-AMT)

                    H2-UERND-INCM-DTL.UNE-INC-VERF-CD = "?";

                    H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";

                    H2-UERND-INCM-DTL.PREV-AMT = CIN05W.WS-UNIN-AMT;

                    H2-UERND-INCM-DTL.UERND-INC-AMT = CIN05W.WS-INTERFACE-AMT;

                    if(H2-UERND-INCM-DTL.PRD-END-DT == "9999-12-31")

                        H2-UERND-INCM-DTL.RECUR-IND = "Y";

                    else

                        if(CIN05W.WS-UNIN-REC-CNT-F == 0)

                            H2-UERND-INCM-DTL.PRD-END-DT = "9999-12-31";

                            H2-UERND-INCM-DTL.RECUR-IND = "Y";

                        else

                            H2-UERND-INCM-DTL.RECUR-IND = "N";

                        end

                    end



                    CIN05P9-UID-U02();

                    if(VDBCONTROL.URC > 104)

                        WCM00P2-TO-CEP01A();

                    end

                end /* if amts are not equal and only one*/

            /* record-->update*/

            else /* if prd-beg-dt is not same as*/

                /* interface beg-dt*/

                /* If the unin screen starts before the interface record */

                /* UPDATE the UNIN screen with the prd-end-dt, then      */

                /* Create UNIN screens for the records after the UNIN    */

                /* end date.                                             */



                if(CIN05W.WS-PRD-BEG-DT > H2-UERND-INCM-DTL.PRD-BEG-DT)

                    CIN05W.WS-PRD-END-DT2 = H2-UERND-INCM-DTL.PRD-END-DT;



                    /* if the interface amount is not equal to the UNIN amount*/

                    if(CIN05W.WS-UNIN-AMT != CIN05W.WS-INTERFACE-AMT)



                        if(CIN05W.WS-PRD-END-MM == 1)

                            CIN05W.WS-PRD-END-MM = 12;

                            CIN05W.WS-PRD-END-CCYY = CIN05W.WS-PRD-END-CCYY -

                                    1;

                        else

                            CIN05W.WS-PRD-END-MM = CIN05W.WS-PRD-END-MM - 1;

                        end

                        /*  */

                        CIN05P9-DET-END-DD();

                        /*  */



                        H2-UERND-INCM-DTL.PRD-END-DT = CIN05W.WS-PRD-END-DT;

                        H2-UERND-INCM-DTL.UERND-INC-AMT = CIN05W.WS-UNIN-AMT;

                        H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";

                        if(CIN05W.WS-PRD-END-DT == "9999-12-31")

                            H2-UERND-INCM-DTL.RECUR-IND = "Y";

                        else

                            H2-UERND-INCM-DTL.RECUR-IND = "N";

                        end



                        CIN05P9-UID-U02();

                        if(VDBCONTROL.URC > 104)

                            WCM00P2-TO-CEP01A();

                        end



                        H2-UERND-INCM-DTL.UPI = CIN05W.WS-UPI;

                        H2-UERND-INCM-DTL.PRD-BEG-DT = CIN05W.WS-PRD-BEG-DT;

                        CIN05W.WS-MAX-SEQ-NMB = 0;

                        CIN05P9-UID-S03();

                        if(VDBCONTROL.URC > 104)

                            WCM00P2-TO-CEP01A();

                        end

                        CIN05W.WS-MAX-SEQ-NMB = CIN05W.WS-MAX-SEQ-NMB + 1;

                        H2-UERND-INCM-DTL.INCM-SQ-NMB = CIN05W.WS-MAX-SEQ-NMB;



                        H2-UERND-INCM-DTL.CHNG-ENTRY-DT = GDW.DTCD;

                        H2-UERND-INCM-DTL.UNE-INC-VERF-CD = "?";

                        H2-UERND-INCM-DTL.SSI-RSDI-RCVD-YR = 9999;

                        H2-UERND-INCM-DTL.UERND-INC-FREQ = "M";

                        H2-UERND-INCM-DTL.UERND-INC-RCVD-DT = GDW.DTCD;

                        H2-UERND-INCM-DTL.SSI-RSDI-RCVD-MTH = 12;

                        H2-UERND-INCM-DTL.BNFTS-APLD-IND = "N";

                        H2-UERND-INCM-DTL.UERND-INC-AMT = CIN05W.WS-INTERFACE-AMT;

                        H2-UERND-INCM-DTL.PREV-AMT = CIN05W.WS-UNIN-AMT;

                        H2-UERND-INCM-DTL.PRD-END-DT = CIN05W.WS-PRD-END-DT2;



                        if(CIN05W.WS-PRD-END-DT2 == "9999-12-31")

                            H2-UERND-INCM-DTL.RECUR-IND = "Y";

                        else

                            H2-UERND-INCM-DTL.RECUR-IND = "N";

                        end

                        H2-UERND-INCM-DTL.PBLIC-RSDI-STRT-DT = null;

                        H2-UERND-INCM-DTL.UNE-INC-VERF-DT = GDW.DTCD;

                        H2-UERND-INCM-DTL.RCVD-DT = GDW.DTCD;

                        H2-UERND-INCM-DTL.RPRTD-DT = GDW.DTCD;

                        H2-UERND-INCM-DTL.RCPT-DT = GDW.DTCD;



                        CIN05P9-UID-I01();

                        if(VDBCONTROL.URC > 104)

                            WCM00P2-TO-CEP01A();

                        end

                    end

                end

            end

            CIN05W.WS-ALERT-FG = "T";

        end /* if only one record found*/

    end /* end check for record found*/

end // end CIN05P9-PRUNIN-DTA



// DECLARE CURSOR FOR TWNPAY_DTLS



function CIN05P9-PYD-S01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";



    VDBCONTROL.UPROC-NM = "CIN05P9-PYD-S01";

    VDBCONTROL.UPROC-OBJ = "H2-PAY-DTLS";

    VDBCONTROL.UPROC-OPT = "SETINQ";

    VDBCOMMON.USQLREC = "H2-PAY-DTLS";

    try

        open CIN05P9-PYD-S01_RSI01

                with #sql{

        select UPI, INCM_SQ_NMB, PRD_BEG_DT, PAID_DT, GRS_WGS_AMT, HOURS_WRKD,

            TIPS_COMSN_AMT, WGE_DEDN_AMT, DSREG_30_1_3_IND

        from TWNPAY_DTLS T1

        WHERE UPI = :UPI

        AND INCM_SQ_NMB = :INCM-SQ-NMB

        AND PRD_BEG_DT = :PRD-BEG-DT

        AND PAID_DT BETWEEN :WS-PRD-BEG-DT AND :WS-PRD-END-DT

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UPI, INCM-SQ-NMB, PRD-BEG-DT, PAID-DT, GRS-WGS-AMT, HOURS-WRKD, TIPS-COMSN-AMT, WGE-DEDN-AMT, DSREG-30-1-3-IND

                for H2-PAY-DTLS;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-PYD-S01



// FETCH ROWS FROM TWNPAY_DTLS



function CIN05P9-PYD-SCAN()

    WDB00PI();

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";



    VDBCONTROL.UPROC-NM = "CIN05P9-PYD-SCAN";

    VDBCONTROL.UPROC-OBJ = "H2-PAY-DTLS";

    VDBCONTROL.UPROC-OPT = "SCAN";

    VDBCOMMON.USQLREC = "H2-PAY-DTLS";

    try

        get next H2-PAY-DTLS;

    end

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

        CIN05W.WS-FLAG = "Y";

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-PYD-SCAN



// READ TWNSYS_PARAMETERS



function CIN05P9-RD-SYS-PAR()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-OBJ = "H2-SYS-PARAMETERS";

    VDBCOMMON.USQLREC = "H2-SYS-PARAMETERS";

    VDBCONTROL.UPROC-NM = "CIN05P9-RD-SYS-PAR";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    try

        get H2-SYS-PARAMETERS singleRow

                with #sql{

        select INTF_TOL_LMT_PCT

        from TWNSYS_PARAMETERS T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into INTF-TOL-LMT-PCT;

    end



    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end



    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /* ** perform the process for sql error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-RD-SYS-PAR



// INQUIRY ON TWNRESP_PRSN_DBTR



function CIN05P9-RPD-S01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UPROC-NM = "CIN05P9-RPD-S01";

    VDBCONTROL.UPROC-OBJ = "H2-RESP-PRSN-DBTR";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCOMMON.USQLREC = "H2-RESP-PRSN-DBTR";

    try

        get H2-RESP-PRSN-DBTR singleRow

                with #sql{

        select DSGNT_DBTR_IND

        from TWNRESP_PRSN_DBTR T1

        WHERE DBTR_SSN = :DBTR-SSN

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into DSGNT-DBTR-IND;

    end

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-RPD-S01



// Selection process



function CIN05P9-S01()

/* -------------------------------------------------------------*/

/* This process inquires IVD_CASELD_CASE table and gets case county   */

/* -------------------------------------------------------------*/

    WDB00PI();



    VDBCOMMON.USQLREC = "H2-IVD-CASELD-CASE";

    VDBCONTROL.UPROC-OBJ = "H2-IVD-CASELD-CASE";

    VDBCONTROL.UPROC-NM = "CIN05P9-S01";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    try

        get H2-IVD-CASELD-CASE

                with #sql{

        select OFC_CD

        from twnivd_caseld_case T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI = :UPI

        AND CASE_SUFX = :CASE-SUFX

        AND CASELD_IND = 'N'

         --** INSERT ORDER BY CLAUSE HERE **

        FOR FETCH ONLY

      }

                into OFC-CD;

    end

    VDBCOMMON.UNRF = "N";

    VDBCOMMON.UDUP = "N";



    WDB00PE-SQLERR();

end // end CIN05P9-S01



// READ RECORDS


