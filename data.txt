package IVD_Batch;
import egl.core.deleteafteruse;
import CommonMigratedParts.*;
import DataItems.*;
import DataTables.*;

//*** PROGRAM=DFM08A ****
// COMPONENT NAME: DFM08A
// ===============
// 
// DESCRIPTION:
// ============
// This application is the main application in forms
// generation.
// All the requests will bw routed thru this application. It
// builds
// the standard parameters and additional parameters. Also it
// constructs SIB (STANDARD INTERFACE BLOCK) type 1 and starts
// the
// ASF(APPLICATION SUPPORT FACILITY) to generate the
// documents. When
// control comes back, this application checks the return
// code. If
// the code is zero, the process is successful transaction.
// Otherwise
// it handles the error using the WCM00P2-TO-CEP02A
// 06/2005 - WHEN FORM IS GENERATED TO THE SERVER
// THIS APPLICATION WILL NOW CALL DFM35A
// ***********************
Program DFM08A type basicProgram //VAGen Info - called batch program
  (
   VDBCONTROL VDBCONTROL, // record
   VMESSAGE VMESSAGE, // record
   DFMBTCH-XFER DFMBTCH-XFER // record
  )
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes
  }

  // Data Declarations
  CEP01W CEP01W; // record
  DFC03W1 DFC03W1; // record
  DFC49W1 DFC49W1; // record
  DFE01W DFE01W; // record
  DFM08W DFM08W; // record
  DFM08W-FLESIB0 DFM08W-FLESIB0; // record
  DFM08W-PO1-SIB0 DFM08W-PO1-SIB0; // record
  DFM08W1 DFM08W1; // record
  DFM08W2 DFM08W2; // record
  DFM08W3 DFM08W3; // record
  DFM08W4 DFM08W4; // record
  DFMPOP-TRANSFER DFMPOP-TRANSFER; // record
  GDW GDW; // record
  H2-2-IDC-PER H2-2-IDC-PER; // record
  H2-4-DCCNMU-SPTURE H2-4-DCCNMU-SPTURE; // record
  H2-BTCH-FRM-KDTA H2-BTCH-FRM-KDTA; // record
  H2-CNTY-FRM H2-CNTY-FRM; // record
  H2-FORM-POPUP H2-FORM-POPUP; // record
  H2-IVD-CASE H2-IVD-CASE; // record
  H2-IVD-CASELD-CASE H2-IVD-CASELD-CASE; // record
  H2-OFFICE H2-OFFICE; // record
  H2-PARA-VER H2-PARA-VER; // record
  H2-PCKT H2-PCKT; // record
  H2-PERSON H2-PERSON; // record
  PCAL16A-INP PCAL16A-INP; // record
  VDBCOMMON VDBCOMMON; // record
  VSTRREC VSTRREC; // record
  VSTRREC4 VSTRREC4; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use VDB00T1 {deleteAfterUse = yes}; // table

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    DFM08P9-MAIN: DFM08P9-MAIN();
  end // end main
end // end DFM08A


// PROCESS ADDITIONAL PARMS
Function DFM08P9-ADLN-PRM()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date         Pgr      Description*/
  /* ---          ---      -----------*/
  /* 02 Feb 1995  TBST178  Creation*/
  /* 10/10/96     WNMAR    CHANGES FOR PTR #7820*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the additional parameters     */
  /* ------------------------------------------------------*/
  DFM08W.WS-INDEX-2 = 1;
  DFM08W.WS-INDEX-SAVE = DFM08W.WS-INDEX;
  while (DFM08W.WS-INDEX-2 <= DFMBTCH-XFER.PIO-PARM-NMB)
    DFM08W.WS-ADD-PARM[WS-INDEX-2] = DFMBTCH-XFER.PIO-POP-PARM[WS-INDEX-2];
    /* START CHANGES FOR PTR #7820*/
    VSTRREC.USTRING = DFM08W.WS-ADD-PARM[WS-INDEX-2];
    DFM08W.WS-ADDLPARM = DFM08W.WS-ADD-PARM[WS-INDEX-2];
    if (DFM08W.WS-ADD-PARM[WS-INDEX-2] != " ") /* if not spaces*/
      call "WST15A" (VSTRREC) {isNoRefresh = yes}; /* finds length of string*/
      DFM08W.WS-INDEX-3 = VSTRREC.USTRLEN;
    else
      DFM08W.WS-INDEX-3 = 1;
    end
    if (DFM08W.WS-INDEX-2 != 1)
      DFM08W.WS-STRING[WS-INDEX] = ";";
      DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
    end
    DFM08W.WS-INDEX-4 = 1;
    while (DFM08W.WS-INDEX-4 <= DFM08W.WS-INDEX-3)
      DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-ADD-PARM-X[WS-INDEX-4];
      DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
      DFM08W.WS-INDEX-4 = DFM08W.WS-INDEX-4 + 1;
    end /* end while*/
    /* END;                           /* end if*/
    /* END   CHANGES FOR PTR #7820*/
    DFM08W.WS-INDEX-2 = DFM08W.WS-INDEX-2 + 1;
  end /* end while*/
end // end DFM08P9-ADLN-PRM


// Call Forms Pop-up Applications
Function DFM08P9-CALL-POP()
  /* -----------------------------------------------------------------------*/
  /*  */
  /* For the following calls remember, a record to record move results in:*/
  /* The data items within the source record move to the corresponding*/
  /* data items, with the same name, within the target record.*/
  /*  */
  /* -----------------------------------------------------------------------*/

  move DFMBTCH-XFER to DFE01W withV60Compat;
  DFE01W.PIO-LST-SQ-NMB = DFMBTCH-XFER.PIO-DCKT-SQ-NMB;
  VMESSAGE.UMSGCODE = " ";

  if (H2-FORM-POPUP.APPL-ID == "DFE01A")
    call "DFE01A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    DFM08W.CST-NCP-IND = "C";
    DFM08W.PARM-NUM = H2-FORM-POPUP.PARM-NMB;
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE02A")
    call "DFE02A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    DFM08W.CST-NCP-IND = "N";
    DFM08W.PARM-NUM = H2-FORM-POPUP.PARM-NMB;
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE03A")
    call "DFE03A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE04A")
    call "DFE04A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE05A")
    DFM08W.WS-INDEX = DFMBTCH-XFER.PIO-PARM-NMB;
    DFE01W.PIO-POP-PARM[WS-INDEX] = DFM08W.WS-OFC-CD;
    call "DFE05A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE06A")
  	call "DFE06A" (VSTRREC4) {isNoRefresh = yes};
//    call "DFE06A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};  //ClearBlade - replace with line above
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE07A")
    call "DFE07A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE08A")
    call "DFE08A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    return;
  end

  if (H2-FORM-POPUP.APPL-ID == "DFE09A")
    call "DFE09A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (VMESSAGE.UMSGCODE != " ")
      exit program;
    end
    return;
  end
end // end DFM08P9-CALL-POP


// MOVE CASE NUMBER
Function DFM08P9-CASENMB()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the casenumber                */
  /* ------------------------------------------------------*/
  DFM08W.WS-CASENUM = DFMBTCH-XFER.PIO-CASE-NUM;
  DFM08W.WS-INDEX-2 = 10;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-CASE-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-CASENMB


// BUILD SIB RECORD
Function DFM08P9-CNSTRT-SIB()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date         Pgr      Description*/
  /* ---          ---      -----------*/
  /* 02 Feb 1995  TBST178  Creation*/
  /* 06/21/97     WNMAR    CHANGES FOR PTR #12002*/
  /* ---------------------------*/
  /* ------------------------------------------------------------*/
  /* This process constructs SIB type 0                         */
  /* ------------------------------------------------------------*/
  DFM08W.WS-STRING[WS-INDEX] = ")";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = " ";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = "%";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = "R";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = "1";
  /* DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;*/
  /* header part of sib0*/
  DFM08W-PO1-SIB0.PO1-SIB-ASF-VER = 1;
  DFM08W-PO1-SIB0.PO1-SIB-USER-NAME = "FORMDEV";
  DFM08W-PO1-SIB0.PO1-SIB-USER-PSWD = " ";
  DFM08W-PO1-SIB0.PO1-SIB-PGRM-NAME = " ";
  DFM08W-PO1-SIB0.PO1-SIB-SEC-SUPPR = "1";
  DFM08W-PO1-SIB0.PO1-SIB-LANG-IND = "ENU";
  DFM08W-PO1-SIB0.PO1-SIB-REC-ID = DFM08W.WS-LTD-NAME;
  DFM08W-PO1-SIB0.PO1-SIB-1ST-ASF-CALL = "0";
  DFM08W-PO1-SIB0.PO1-SIB-MSG-REDEF = "0";
  DFM08W-PO1-SIB0.PO1-SIB-DATA-XFER = 0;
  DFM08W-PO1-SIB0.PO1-SIB-ASF-FNCT = "LCF";
  /* START CHANGES FOR PTR #12002*/
  /* MOVE ' ' TO DFM08W-PO1-SIB0.PO1-SIB-USER-COMA;*/
  set DFM08W2 empty;
  DFM08W.WS-PACKET = DFMBTCH-XFER.WS-PCKT;
  DFM08W2.WS-PCKT-FLAG = DFMBTCH-XFER.WS-PCKT-FLAG;
  DFM08W2.WS-PCKT = DFM08W.WS-PCKT;
  DFM08W-PO1-SIB0.PO1-SIB-USER-COMA = DFM08W2.WS-SIB-USER-COMA;
  /* END   CHANGES FOR PTR #12002*/
  DFM08W-PO1-SIB0.PO1-SIB-TOTAL-LTH = DFM08W.WS-SIB-LTH;
  DFM08W-PO1-SIB0.PO1-SIB-TYPE = "0";
  DFM08W-PO1-SIB0.PO1-SIB-MSG-TEXT = " ";
  DFM08W-PO1-SIB0.PO1-SIB-MSG-CODE = 0;
  DFM08W-PO1-SIB0.PO1-SIB-ERR-FLD = " ";
  DFM08W-PO1-SIB0.PO1-SIB-APPEND-TEXT = DFM08W.WS-APP-TXT;
end // end DFM08P9-CNSTRT-SIB


// Selects county form
Function DFM08P9-CNTY-FRM()
  WDB00PI();
  VDBCOMMON.UAPPLNAM = "DFM08A";
  VDBCOMMON.USQLREC = "H2-CNTY-FRM";
  VDBCONTROL.UPROC-OBJ = "H2-CNTY-FRM";
  VDBCONTROL.UPROC-NM = "DFM08P9-CNTY-FRM";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    get H2-CNTY-FRM
      with #sql{
        select CNTY_CD, FRM_ID, SRVC_MTHD, AUDIT_TS,
          AUDIT_USRID, END_DT, FRM_EFF_DT, SRVC_REQD_IND,
          CNTMPT_IND, FORM_DESCRIPTION,
          NOMADS_FORM_IND, PRNT_IND
        from twncnty_frm T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE CNTY_CD = :CNTY-CD AND FRM_ID = :FRM-ID
         --** INSERT ORDER BY CLAUSE HERE **
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into CNTY-CD, FRM-ID, SRVC-MTHD, AUDIT-TS,
           AUDIT-USRID, END-DT, FRM-EFF-DT, SRVC-REQD-IND,
           CNTMPT-IND, FORM-DESCRIPTION,
           NOMADS-FORM-IND, PRNT-IND ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
    DFM08W3.WS-SQLCODE = sysVar.sqlData.sqlcode;
  end

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    exit program;
  end
end // end DFM08P9-CNTY-FRM


// PROCESS COMMON PARMS
Function DFM08P9-COMM-PARM()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date         Pgr      Description*/
  /* ---          ---      -----------*/
  /* 02 Feb 1995  TBST178  Creation*/
  /* 03/06/97     WNMAR    CHANGES FOR PTR #9139*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the common parameter portion */
  /* of the SIB type 0                                    */
  /* ------------------------------------------------------*/
  DFM08W.WS-INDEX = 1;
  DFM08P9-PARAGRPH(); /* Paragraph Name*/
  DFM08P9-CASENMB(); /* Case number*/
  DFM08P9-FORMNMB(); /* Form id*/
  DFM08P9-NCPNAME(); /* NCP name*/
  DFM08P9-NCPSSN(); /* NCP ssn*/
  DFM08P9-CSTNAME(); /* CST name*/
  DFM08P9-CSTSSN(); /* CST ssn*/
  DFM08P9-WKRNAME(); /* Worker name*/
  DFM08P9-WRKTITLE(); /* Worker title*/
  DFM08P9-COUNTYCD(); /* County code*/
  DFM08P9-DCKT-NMB(); /* Docket number*/
  DFM08P9-DCKT-SQN(); /* Docket sequence number*/
  DFM08P9-OFFICECD(); /* Office code*/
  DFM08P9-ADLN-PRM(); /* Additional parm*/
  /* START CHANGES FOR PTR #9139*/
  DFM08P9-SERV-PROC();
  /* END   CHANGES FOR PTR #9139*/
end // end DFM08P9-COMM-PARM


// MOVE COUNTY CODE
Function DFM08P9-COUNTYCD()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date         Pgr     Description*/
  /* ---          ---     -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* 01/20/97     WNMAR   CHANGES FOR PTR #9307*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the county code               */
  /* ------------------------------------------------------*/
  /* START CHANGES FOR PTR #9307*/
  DFM08W.WS-CNTYCD = DFM08W.WS-CNTY-CD;
  DFM08W.WS-INDEX-2 = 2;
  /* END   CHANGES FOR PTR #9307*/
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-CNTY-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-COUNTYCD


// Gets NCP & CST names
Function DFM08P9-CST-NM()
  WDB00PI();
  VDBCOMMON.UAPPLNAM = "DFM08A";
  VDBCOMMON.USQLREC = "H2-2-IDC-PER";
  VDBCONTROL.UPROC-OBJ = "H2-2-IDC-PER";
  VDBCONTROL.UPROC-NM = "DFM08P9-CST-NM";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    get H2-2-IDC-PER
      with #sql{
        select T2.LST_NM,
          T2.FRST_NM, T2.MID_NM, T1.CST_UPI
        from TWNIVD_CASE T1,
             TWNPERSON T2
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.NCP_UPI = :NCP-UPI
          AND T1.CASE_SUFX = :CASE-SUFX
          AND T1.CST_UPI = T2.UPI
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into LST-NM, FRST-NM, MID-NM, CST-UPI ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
    DFM08W3.WS-SQLCODE = sysVar.sqlData.sqlcode;
  end

  VDBCOMMON.UNRF = 1;
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    exit program;
  end
end // end DFM08P9-CST-NM


// MOVE CST NAME
Function DFM08P9-CSTNAME()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the cst name                  */
  /* ------------------------------------------------------*/
  DFM08W.WS-CSTNAME = DFMBTCH-XFER.PIO-CST-NAME;
  VSTRREC.USTRING = DFMBTCH-XFER.PIO-CST-NAME;
  call "WST15A" (VSTRREC) {isNoRefresh = yes}; /* find length of string*/
  DFM08W.WS-INDEX-2 = VSTRREC.USTRLEN;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-CSTN-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-CSTNAME


// MOVE CST SSN
Function DFM08P9-CSTSSN()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/

  /* ------------------------------------------------------*/
  /* This process constructs the cst ssn                   */
  /* ------------------------------------------------------*/
  DFM08W.WS-CSTSSN = DFMBTCH-XFER.PIO-CST-SSN;
  DFM08W.WS-INDEX-2 = 9;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-CSTS-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-CSTSSN


// MOVE DOCKET NUMBER
Function DFM08P9-DCKT-NMB()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the docket nmb                */
  /* ------------------------------------------------------*/
  if (DFMBTCH-XFER.PIO-DCKT-NMB == 0)
    DFM08W.WS-DCKE-X[1] = 0;
    DFM08W.WS-DCKE-X[2] = 0;
    DFM08W.WS-DCKE-X[3] = 0;
    DFM08W.WS-DCKE-X[4] = 0;
    DFM08W.WS-DCKE-X[5] = 0;
    DFM08W.WS-DCKE-X[6] = 0;
    DFM08W.WS-DCKE-X[7] = 0;
    DFM08W.WS-DCKE-X[8] = 0;
    DFM08W.WS-DCKE-X[9] = 0;
    DFM08W.WS-INDEX-2 = 9;
  else

    DFM08W.WS-DCKETNUM = DFMBTCH-XFER.PIO-DCKT-NMB;
    VSTRREC.USTRING = DFM08W.WS-DCKETNUM;
    call "WST15A" (VSTRREC) {isNoRefresh = yes};
    DFM08W.WS-INDEX-2 = VSTRREC.USTRLEN;
  end /* End if*/
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-DCKE-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-DCKT-NMB


// MOVE DOCKER SEQUENCE NUMBER
Function DFM08P9-DCKT-SQN()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the docket sequence nmb       */
  /* ------------------------------------------------------*/
  if (DFMBTCH-XFER.PIO-DCKT-SQ-NMB == 0) /* If blank*/
    DFM08W.WS-DKTS-X[1] = 0;
    DFM08W.WS-DKTS-X[2] = 0;
    DFM08W.WS-DKTS-X[3] = 0;
    DFM08W.WS-DKTS-X[4] = 0;
    /* VE 0000 TO DFM08W.WS-DKTSQNUM;*/
    DFM08W.WS-INDEX-2 = 4;
  else

    DFM08W.WS-DKTSQNUM = DFMBTCH-XFER.PIO-DCKT-SQ-NMB;
    VSTRREC.USTRING = DFM08W.WS-DKTSQNUM;
    call "WST15A" (VSTRREC) {isNoRefresh = yes};
    DFM08W.WS-INDEX-2 = VSTRREC.USTRLEN;
  end /* endif*/
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-DKTS-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = "N";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-DCKT-SQN


// First-Pass process
Function DFM08P9-FIRST-PASS()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date         Pgr     Description*/
  /* ---          ---     -----------*/
  /* 02 Feb 1995  TBST178 creation*/
  /* 04 Aug 1995  CBS484  To get ncp and cst's ssn,name.County code also.*/
  /* 01/20/97     WNMAR   CHANGES FOR PTR #9307*/
  /* 03/28/97     WNMAR   CHANGES FOR PTR #10575*/
  /* 12/01/98     WNMKK   Changes for WI15120.*/
  /* ------------------------------------------------*/
  /*  */

  /* Changes start 08/04/95*/
  DFM08W.WS-PIO-UPI = DFMBTCH-XFER.PIO-UPI;
  DFM08W4.WS-NCP-UPI = DFMBTCH-XFER.PIO-UPI;
  /* To get ncp'ssn and his name*/
  DFM08P9-GET-NCP();
  if (VDBCONTROL.URC > 104)
    exit program;
  end
  /*  */
  /* To get cst ssn and his name*/
  /*  */
  /* START CHANGES FOR PTR #10575*/
  if (DFMBTCH-XFER.PIO-CST-NAME == " " || 
  DFMBTCH-XFER.PIO-CST-SSN == " ")
    DFM08P9-GET-CST();
    if (VDBCONTROL.URC > 104)
      exit program;
    end
  end
  /* END   CHANGES FOR PTR #10575*/
  /*  */
  /* Chages end;*/
  /* Change made on 11-11-95*/
  /* To get the worker name and title*/
  DFM08P9-GET-WRKR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end
  /* Change end*/
  /*  */
  /* START CHANGES FOR PTR #9307*/
  /* To get county code for the case and the county code for the worker.*/
  /*  */
  DFM08P9-GET-C-CNTY();
  if (VDBCONTROL.URC > 104)
    exit program;
  end
  /*  */
  DFM08P9-GET-W-CNTY();
  if (VDBCONTROL.URC > 104)
    exit program;
  end

  DFM08P9-POP-TAB(); /* Execute popups according to table*/
                                   /* TWN_FORM_POP.*/

  DFM08P9-COMM-PARM(); /* perform common parmeter process*/

  set H2-CNTY-FRM empty;
  if (DFM08W.WS-C-CNTY != " ")
    H2-CNTY-FRM.CNTY-CD = DFM08W.WS-C-CNTY;
  else
    H2-CNTY-FRM.CNTY-CD = DFM08W.WS-OFC-CD;
  end

  if (DFMBTCH-XFER.PIO-FORM-ID != " ")
    H2-CNTY-FRM.FRM-ID = DFMBTCH-XFER.PIO-FORM-ID;
    DFM08W.WS-FORMID = DFMBTCH-XFER.PIO-FORM-ID;
  else
    H2-CNTY-FRM.FRM-ID = DFMBTCH-XFER.WS-PCKT;
    DFM08W.WS-FORMID = DFMBTCH-XFER.WS-PCKT;
  end

  DFM08P9-CNTY-FRM();
  if (H2-CNTY-FRM is noRecordFound)
    H2-CNTY-FRM.CNTY-CD = "XX";
    DFM08P9-CNTY-FRM();
  end

  if (H2-CNTY-FRM is noRecordFound)
    H2-CNTY-FRM.PRNT-IND = "N";
  end

  H2-BTCH-FRM-KDTA.NCP-UPI = DFMBTCH-XFER.PIO-UPI;
  H2-BTCH-FRM-KDTA.CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
  DFM08W.WS-DCKETNUM = DFMBTCH-XFER.PIO-DCKT-NMB;
  DFM08W.WS-DKTSQNUM = DFMBTCH-XFER.PIO-DCKT-SQ-NMB;

  /* Based on FORM-ID, get other parameters from DFMBTCH-XFER.PIO-POP-PARM*/
  if (DFMBTCH-XFER.PIO-FORM-ID == "GN0092")
    DFM08W4.WS-EMPLR-NMB = DFMBTCH-XFER.PIO-POP-PARM[8];
  end
  if (DFMBTCH-XFER.PIO-FORM-ID == "GN0050"
   || DFMBTCH-XFER.PIO-FORM-ID == "GN0083"
   || DFMBTCH-XFER.PIO-FORM-ID == "GN0088")
    DFM08W4.WS-EMPLR-NMB = DFMBTCH-XFER.PIO-POP-PARM[1];
  end
  /* Formatting SSN of NCP and CST*/
  DFM08W1.NCP-SSN = DFMBTCH-XFER.PIO-NCP-SSN;
  DFM08W4.WS-NCP-SSN-THREE = DFM08W1.NCP-SSN-1;
  DFM08W4.WS-NCP-SSN-FILL1 = "-";
  DFM08W4.WS-NCP-SSN-TWO = DFM08W1.NCP-SSN-2;
  DFM08W4.WS-NCP-SSN-FILL2 = "-";
  DFM08W4.WS-NCP-SSN-FOUR = DFM08W1.NCP-SSN-3;

  DFM08W1.CST-SSN = DFMBTCH-XFER.PIO-CST-SSN;
  DFM08W4.WS-CST-SSN-THREE = DFM08W1.CST-SSN-1;
  DFM08W4.WS-CST-SSN-FILL1 = "-";
  DFM08W4.WS-CST-SSN-TWO = DFM08W1.CST-SSN-2;
  DFM08W4.WS-CST-SSN-FILL2 = "-";
  DFM08W4.WS-CST-SSN-FOUR = DFM08W1.CST-SSN-3;

  /* Clearing data of H2-PERSON*/
  set H2-PERSON empty;
  H2-PERSON.UPI = DFMBTCH-XFER.PIO-UPI;
  /* Getting NCP name*/
  DFM08P9-NCP-NM();
  /* Formatting NCP name*/
  VSTRREC4.USTRING = H2-PERSON.LST-NM;
  VSTRREC4.UCONCAT = H2-PERSON.FRST-NM;
  VSTRREC4.UCONCAT2 = H2-PERSON.MID-NM;
  VSTRREC4.USTRLEN = 21;
  VSTRREC4.UCONLEN = 1;
  VSTRREC4.UCONLEN2 = 1;
  call "WST50A" (VSTRREC4) {isNoRefresh = yes};
  DFM08W4.WS-NCP-NAME = VSTRREC4.USTRING;

  set H2-2-IDC-PER empty;
  H2-2-IDC-PER.NCP-UPI = DFMBTCH-XFER.PIO-UPI;
  H2-2-IDC-PER.CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
  /* Getting CST name*/
  DFM08P9-CST-NM();
  DFM08W4.WS-CST-UPI = H2-2-IDC-PER.CST-UPI;
  /* Formatting CST name*/
  VSTRREC4.USTRING = H2-2-IDC-PER.LST-NM;
  VSTRREC4.UCONCAT = H2-2-IDC-PER.FRST-NM;
  VSTRREC4.UCONCAT2 = H2-2-IDC-PER.MID-NM;
  VSTRREC4.USTRLEN = 21;
  VSTRREC4.UCONLEN = 1;
  VSTRREC4.UCONLEN2 = 1;
  call "WST50A" (VSTRREC4) {isNoRefresh = yes};
  DFM08W4.WS-CST-NAME = VSTRREC4.USTRING;

  DFM08W4.WS-USRID = "BATCH";
  /* Gets NCP Jrsdt code*/
  DFM08P9-NCP-JRSDT();
  DFM08W4.WS-OFC-CNTY-CD = H2-IVD-CASE.NCP-JRSDT-CD;
  H2-BTCH-FRM-KDTA.DOWNLD-IND = "N";
  DFM08W4.WS-NCP-UPI = DFMBTCH-XFER.PIO-UPI;
  DFM08W4.WS-CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
  if (DFMBTCH-XFER.PIO-FORM-ID != " ")
    DFM08W4.WS-FORM[1] = DFMBTCH-XFER.PIO-FORM-ID;
  else
    DFM08W4.WS-FORM[1] = DFMBTCH-XFER.WS-PCKT;
  end
  DFM08W4.WS-DCKT-NMB = DFMBTCH-XFER.PIO-DCKT-NMB;
  DFM08W4.WS-LST-SQNC-NMB = DFMBTCH-XFER.PIO-DCKT-SQ-NMB;
  DFM08W4.WS-CRNT-DATE = GDW.DTCD;

  /* Inserts data to twnbtch_frm_kdta*/
  H2-BTCH-FRM-KDTA.FORM-KEY-PARM = DFM08W4.WS-FORM-KEY-PARM;
  DFM08P9-KDTA-TRKNG();

  if (H2-CNTY-FRM.PRNT-IND == "Y")
  /* Continue ...*/
  else
    if (H2-CNTY-FRM.PRNT-IND == "N")
  /* Creating an alert*/
      PCAL16A-INP.PCAL16A-ALERT-CD = 390086;
      PCAL16A-INP.PCAL16A-ALERT-INS-PARM-1 = DFMBTCH-XFER.PIO-FORM-ID;
      PCAL16A-INP.PCAL16A-UPI = DFMBTCH-XFER.PIO-UPI;
      PCAL16A-INP.PCAL16A-CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
      PCAL16A-INP.PCAL16A-PROCESS-DT = GDW.DTCD;
      PCAL16A-INP.PCAL16A-ALERT-ACTION = "C";
      call "CAL16A" (VDBCONTROL, VMESSAGE, PCAL16A-INP) {isNoRefresh = yes};
  /* **********************************************************************/
  /* Removed 08/12/2002 - Louis F : DFM24A will pic up the KDATA entry.*/
  /* It will then generate it as flexi form. This process does create*/
  /* tracking.*/
  /* PERFORM DFM08P9-DTA-TRKNG;*/
  /* IF VDBCONTROL.URC >= 104;*/
  /* EZECLOS;                   /* Exit DFM08A appl.*/
  /* END;*/
  /* **********************************************************************/
      exit program; /* Exit DFM08A appl.*/
    end
  end

  /* WI 15120 END ...*/
  DFM08P9-CNSTRT-SIB(); /* constructs sib type 0*/

  /* ---------------------------------------------------------*/
  /* Form Destination from TWNPARA_VER                      */
  /* M = Mainframe                                 */
  /* S = Server                                    */
  /* B = Both                                      */
  /* ---------------------------------------------------------*/
  if (H2-PARA-VER.FORM-DEST == "S" || 
  H2-PARA-VER.FORM-DEST == "B")
  /* PERFORM DFM08P9-SERVR-FORM;*/
  /* CALL DFM35A-this program will build the trigger records for the notice*/
  /* wi27446,26702,CMcK,06/2005*/
    call "DFM35A" (VDBCONTROL, VMESSAGE, DFMPOP-TRANSFER, DFMBTCH-XFER) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end

  end
  if (H2-PARA-VER.FORM-DEST == "M" || 
  H2-PARA-VER.FORM-DEST == "B")
    DFM08P9-WRITESIB();
  end

  /* -- If form were addressed to the NCP or CST and the NCP or CST*/
  /* -- has an attorney, copy the attorney. See WI 25000*/
  if (DFM08W.CST-NCP-IND == "C" || DFM08W.CST-NCP-IND == "N")
    DFM08W.WS-PARM-NMB = DFMBTCH-XFER.PIO-PARM-NMB;
    DFMBTCH-XFER.PIO-PARM-NMB = DFM08W.PARM-NUM;
    DFMBTCH-XFER.PIO-POP-PARM[PARM-NUM] = DFM08W.CST-NCP-IND;
    move DFMBTCH-XFER to DFE01W withV60Compat;
    call "DFE07A" (VDBCONTROL, VMESSAGE, DFE01W) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
    move DFE01W to DFMBTCH-XFER withV60Compat;
    if (DFMBTCH-XFER.PIO-PARM-NMB < DFM08W.WS-PARM-NMB)
      DFMBTCH-XFER.PIO-PARM-NMB = DFM08W.WS-PARM-NMB;
    end
    if (DFMBTCH-XFER.PIO-POP-PARM[PARM-NUM] != " ")
      DFM08W.WS-INDEX = DFM08W.WS-INDEX-SAVE;
      DFM08P9-ADLN-PRM();
      DFM08P9-CNSTRT-SIB(); /* constructs sib type 0*/

  /* ---------------------------------------------------------*/
  /* Form Destination from TWNPARA_VER                      */
  /* M = Mainframe                                 */
  /* S = Server                                    */
  /* B = Both                                      */
  /* ---------------------------------------------------------*/
      if (H2-PARA-VER.FORM-DEST == "S" || 
      H2-PARA-VER.FORM-DEST == "B")
  /* PERFORM DFM08P9-SERVR-FORM;*/
  /* wi27446,26702,CMcK,06/2005*/
        call "DFM35A" (VDBCONTROL, VMESSAGE, DFMPOP-TRANSFER, DFMBTCH-XFER) {isNoRefresh = yes};
        if (VDBCONTROL.URC > 104)
          exit program;
        end
      end
      if (H2-PARA-VER.FORM-DEST == "M" || 
      H2-PARA-VER.FORM-DEST == "B")
        DFM08P9-WRITESIB();
      end

    end
  end
  /*  */
end // end DFM08P9-FIRST-PASS


// MOVE FORM NUMBER
Function DFM08P9-FORMNMB()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the form nmb                  */
  /* ------------------------------------------------------*/
  DFM08W.WS-FORMID = DFMBTCH-XFER.PIO-FORM-ID;
  DFM08W.WS-INDEX-2 = 6;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-FORM-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-FORMNMB


// PROCESS FIRST PASS FOR FAME
Function DFM08P9-FRST-PS-A()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date      Pgr    Description*/
  /* ---       ---    -----------*/
  /* 10/10/96  WNMAR  CHANGES FOR PTR #7820*/
  /* ------------------------------------------------*/
  /*  */
  /* PROCESSING FOR IVA BATCH FORMS*/
  /*  */
  DFM08W.WS-INDEX = 1;
  DFM08P9-PARAGRPH();
  DFM08P9-FORMNMB();
  /*  */
  /* ADD IVA CASE TRACKING INDICATOR*/
  DFM08W.WS-STRING[WS-INDEX] = "N";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  /*  */
  DFM08P9-ADLN-PRM();
  DFM08P9-CNSTRT-SIB();

  /* ---------------------------------------------------------*/
  /* Form Destination from TWNPARA_VER                      */
  /* M = Mainframe                                 */
  /* S = Server                                    */
  /* B = Both                                      */
  /* ---------------------------------------------------------*/
  if (H2-PARA-VER.FORM-DEST == "S" || 
  H2-PARA-VER.FORM-DEST == "B")
  /* PERFORM DFM08P9-SERVR-FORM;*/
  /* CALL DFM35A-this program will build the trigger records for the notice*/
  /* wi27446,26702,CMcK,06/2005*/
    call "DFM35A" (VDBCONTROL, VMESSAGE, DFMPOP-TRANSFER, DFMBTCH-XFER) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end

  end
  if (H2-PARA-VER.FORM-DEST == "M" || 
  H2-PARA-VER.FORM-DEST == "B")
    DFM08P9-WRITESIB();
  end
  /* -----------------------------------------------------------*/
end // end DFM08P9-FRST-PS-A


// Selection process
Function DFM08P9-GET-C-CNTY()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date     Pgr     Description*/
  /* ---      ---     -----------*/
  /* 01/16/97 WNMAR   CREATED FOR PTR #9307*/
  /* ---------------------------*/
  /* -------------------------------------------------------------*/
  /* This process inquires IVD_CASELD_CASE table and gets case county   */
  /* -------------------------------------------------------------*/

  VDBCOMMON.USQLREC = "H2-IVD-CASELD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASELD-CASE";
  VDBCONTROL.UPROC-NM = "DFM08P9-GET-C-CNTY";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  set H2-IVD-CASELD-CASE empty;
  H2-IVD-CASELD-CASE.CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
  H2-IVD-CASELD-CASE.UPI = DFMBTCH-XFER.PIO-UPI;
  try
    get H2-IVD-CASELD-CASE
      with #sql{
        select RSP_CNTY, OFC_CD
        from twnivd_caseld_case T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE UPI = :UPI AND CASE_SUFX = :CASE-SUFX
              AND CASELD_IND = 'N'
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into RSP-CNTY, OFC-CD ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    DFMBTCH-XFER.PIO-COUNTY-CD = H2-IVD-CASELD-CASE.RSP-CNTY;
    DFM08W.WS-C-CNTY = H2-IVD-CASELD-CASE.RSP-CNTY;
  /* WI 15120...*/
    DFMBTCH-XFER.PIO-OFC-CNTY-CD = H2-IVD-CASELD-CASE.OFC-CD;
    DFM08W.WS-OFC-CD = H2-IVD-CASELD-CASE.OFC-CD;
  else
    DFMBTCH-XFER.PIO-COUNTY-CD = " ";
    DFM08W.WS-C-CNTY = " ";
    DFMBTCH-XFER.PIO-OFC-CNTY-CD = " ";
    DFM08W.WS-OFC-CD = " ";
  end
  WDB00PE-SQLERR();
end // end DFM08P9-GET-C-CNTY


// GET CST DATA
Function DFM08P9-GET-CST()

  VDBCOMMON.USQLREC = "H2-2-IDC-PER";
  VDBCONTROL.UPROC-OBJ = "H2-2-IDC-PER";
  VDBCONTROL.UPROC-NM = "DFM08P9-GET-CST";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    get H2-2-IDC-PER
      with #sql{
        select T2.SSN,T2.FRST_NM,T2.MID_NM,T2.LST_NM,T2.MODFR
        from TWNIVD_CASE T1,
             TWNPERSON T2
        WHERE T2.UPI = T1.CST_UPI AND
         T1.NCP_UPI = :DFM08W.WS-PIO-UPI
        AND CASE_SUFX = :DFMBTCH-XFER.PIO-CASE-SUFX
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into SSN,FRST-NM,MID-NM,LST-NM,MODFR ;
  end

  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end

  if (sysVar.sqlData.sqlcode == 0)
    DFC03W1.PIO-STR-1 = H2-2-IDC-PER.FRST-NM;
    DFC03W1.PIO-STR-2 = H2-2-IDC-PER.MID-NM;
    DFC03W1.PIO-STR-3 = H2-2-IDC-PER.LST-NM;
    DFC03W1.PIO-STR-4 = H2-2-IDC-PER.MODFR;
    DFC03W1.PIO-STR-5 = " ";
       /*  */
    call "DFC03A" (DFC03W1) {isNoRefresh = yes};
       /*  */
    DFMBTCH-XFER.PIO-CST-NAME = DFC03W1.PIO-STR-CHAR;
    DFMBTCH-XFER.PIO-CST-SSN = H2-2-IDC-PER.SSN;
       /*  */
  end
end // end DFM08P9-GET-CST


// To get ncp ssn,name
Function DFM08P9-GET-NCP()

  VDBCOMMON.USQLREC = "H2-PERSON";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCONTROL.UPROC-NM = "DFM08P9-GET-NCP";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    get H2-PERSON
      with #sql{
        select MODFR, MID_NM, FRST_NM,
          LST_NM,SSN
        from TWNPERSON T1
        WHERE UPI = :DFM08W.WS-PIO-UPI
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into MODFR, MID-NM,FRST-NM,LST-NM,SSN ;
  end

  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end

  if (sysVar.sqlData.sqlcode == 0)
    DFC03W1.PIO-STR-1 = H2-PERSON.FRST-NM;
    DFC03W1.PIO-STR-2 = H2-PERSON.MID-NM;
    DFC03W1.PIO-STR-3 = H2-PERSON.LST-NM;
    DFC03W1.PIO-STR-4 = H2-PERSON.MODFR;
    DFC03W1.PIO-STR-5 = " ";
      /*  */
    call "DFC03A" (DFC03W1) {isNoRefresh = yes};
      /*  */
    DFMBTCH-XFER.PIO-NCP-NAME = DFC03W1.PIO-STR-CHAR;
    DFMBTCH-XFER.PIO-NCP-SSN = H2-PERSON.SSN;
      /*  */
  end
end // end DFM08P9-GET-NCP


// Selction process
Function DFM08P9-GET-W-CNTY()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date     Pgr     Description*/
  /* ---      ---     -----------*/
  /* 01/16/97 WNMAR   CREATED FOR PTR #9307*/
  /* ---------------------------*/
  /* -------------------------------------------------------------*/
  /* This process inquires TWNOFFICE table and gets worker county   */
  /* -------------------------------------------------------------*/

  VDBCOMMON.USQLREC = "H2-OFFICE";
  VDBCONTROL.UPROC-OBJ = "H2-OFFICE";
  VDBCONTROL.UPROC-NM = "DFM08P9-GET-W-CNTY";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  set H2-OFFICE empty;
  H2-OFFICE.OFC-CD = H2-4-DCCNMU-SPTURE.OFC-CD;
  try
    get H2-OFFICE
      with #sql{
        select CNTY_CD
        from TWNOFFICE T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE OFC_CD = :OFC-CD
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into CNTY-CD ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    DFM08W.WS-W-CNTY = H2-OFFICE.CNTY-CD;
  else
    DFM08W.WS-W-CNTY = " ";
  end
  WDB00PE-SQLERR();
end // end DFM08P9-GET-W-CNTY


// get wrkr name,title
Function DFM08P9-GET-WRKR()
  /* Get the worker name and title*/
  VDBCOMMON.USQLREC = "H2-4-DCCNMU-SPTURE";
  VDBCONTROL.UPROC-OBJ = "H2-4-DCCNMU-SPTURE";
  VDBCONTROL.UPROC-NM = "DFM08P9-GET-WRKR";
  VDBCONTROL.UPROC-OPT = "INQUIRY";

  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  try
    get H2-4-DCCNMU-SPTURE
      with #sql{
        select T2.FRST_NM,T2.LST_NM,T2.MID_NM,T2.MODFR,T4.ROLE_DESC,T2.OFC_CD,
          T2.NOMADS_USRID
        from TWNIVD_CASELD_CASE T1,
             TWNNOmADS_USER T2,
             TWNSUP_UNT_POS_HST T3,
             TWNUSR_ROLE T4
        WHERE
                     T1.UPI=:DFM08W.WS-PIO-UPI AND
                     T1.CASE_SUFX=:DFMBTCH-XFER.PIO-CASE-SUFX AND
                     T1.CASELD_IND = 'N' AND
                     T1.OFC_CD = T3.OFC_CD AND
                     T1.PRGM_OFC_TYPE = T3.PRGM_OFC_TYPE AND
                     T1.SPRVS_UNIT = T3.SPRVS_UNIT AND
                     T1.PSN_NMB = T3.PSN_NMB AND
                     T3.ASMNT_BEG_DT <= :GDW.DTCD AND
                     T3.ASMNT_END_DT >= :GDW.DTCD AND
         --  (:GDW.DTCD BETWEEN T3.ASMNT_BEG_DT AND        T3.ASMNT_END_DT) AND
                      T3.NOMADS_USRID = T2.NOMADS_USRID AND
                      T2.ROLE_ID = T4.ROLE_ID
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into FRST-NM,LST-NM,MID-NM,MODFR,ROLE-DESC,OFC-CD,
           NOMADS-USRID ;
  end

  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end

  if (sysVar.sqlData.sqlcode == 0)
    DFC03W1.PIO-STR-1 = H2-4-DCCNMU-SPTURE.FRST-NM;
    DFC03W1.PIO-STR-2 = H2-4-DCCNMU-SPTURE.MID-NM;
    DFC03W1.PIO-STR-3 = H2-4-DCCNMU-SPTURE.LST-NM;
    DFC03W1.PIO-STR-4 = H2-4-DCCNMU-SPTURE.MODFR;
    DFC03W1.PIO-STR-5 = " ";
       /*  */
    call "DFC03A" (DFC03W1) {isNoRefresh = yes};
       /*  */
    DFM08W.WS-WKRNM = DFC03W1.PIO-STR-CHAR;
    DFM08W.WS-WKRTTL = H2-4-DCCNMU-SPTURE.ROLE-DESC;
  end
end // end DFM08P9-GET-WRKR


// Initialization Routine
Function DFM08P9-INIT-PROC()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ----------------------------------------*/
  /* Initialize process                      */
  /* ----------------------------------------*/
  set DFM08W empty; /* Init record*/
  DFM08W.WS-STR-OFF-FLAG = "N";
end // end DFM08P9-INIT-PROC


// For form to call dfc49
Function DFM08P9-INQ-FORM()
  /* ----------------------------------------------------*/
  /* This process checks the county form table whether the service require*/
  /* indicator is set to 'y'. If so, it calls dfc49 to insert infor.*/
  /* ----------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* Date          Pgr    Description*/
  /* ---           ---    -----------*/
  /* 14 Feb 1996  cbs484  Creation*/
  /* 03/03/97     WNMAR   CREATED FOR PTR #9139*/
  /* -------------------------------------------------------*/
  DFM08P9-S06();
  if (H2-CNTY-FRM is ioError && H2-CNTY-FRM not noRecordFound) /* if hard error*/
    exit program; /* error handling*/
  end /* end if*/
   /*  */
  if (H2-CNTY-FRM.SRVC-REQD-IND == "Y" && DFMBTCH-XFER.PIO-DCKT-NMB > 0)
    DFC49W1.PI1-FRM-PCKT-ID = DFMBTCH-XFER.PIO-FORM-ID;
    DFC49W1.PI1-DCKT-NMB = DFMBTCH-XFER.PIO-DCKT-NMB;
    DFC49W1.PI1-SQNC-NMB = DFMBTCH-XFER.PIO-DCKT-SQ-NMB;
    DFC49W1.PI1-CNTY-CD = DFMBTCH-XFER.PIO-COUNTY-CD;
    DFC49W1.PI1-NCP-UPI = DFMBTCH-XFER.PIO-UPI;
    DFC49W1.PI1-CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
    DFC49W1.PI1-SRVC-MTHD = H2-CNTY-FRM.SRVC-MTHD;
    call "DFC49A" (VDBCONTROL, VMESSAGE, DFC49W1) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
  end
  /* ptr 2837 change end*/
end // end DFM08P9-INQ-FORM


// For packet to call dfc49
Function DFM08P9-INQ-PCKT()
  /* ----------------------------------------------------*/
  /* This process checks the packet table whether the service require*/
  /* indicator is set to 'y'. If so, it calls dfc49 to insert infor.*/
  /* ----------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* Date          Pgr    Description*/
  /* ---           ---    -----------*/
  /* 03/06/96     WNMAR   CREATED FOR PTR #9139*/
  /* -------------------------------------------------------*/
  /* MOVE 'PCK' TO DFM01W.WS-PCKT-HDR;*/
  /* MOVE DFM01W-SIB0.WS-PCKT TO DFM01W.WS-PCKT-TRL;*/
  /* MOVE DFMBTCH-XFER.WS-PCKT TO H2-PCKT.PCKT-ID;*/
    /*  */
  DFM08P9-S05();
  if (H2-PCKT is ioError && H2-PCKT not noRecordFound) /* if hard error*/
    exit program; /* error handling*/
  end /* end if*/
   /*  */
  if (H2-PCKT.SRVC-REQD-IND == "Y" && DFMBTCH-XFER.PIO-DCKT-NMB > 0)
    DFC49W1.PI1-FRM-PCKT-ID = DFMBTCH-XFER.WS-PCKT;
    DFC49W1.PI1-DCKT-NMB = DFMBTCH-XFER.PIO-DCKT-NMB;
    DFC49W1.PI1-SQNC-NMB = DFMBTCH-XFER.PIO-DCKT-SQ-NMB;
    DFC49W1.PI1-CNTY-CD = DFMBTCH-XFER.PIO-COUNTY-CD;
    DFC49W1.PI1-NCP-UPI = DFMBTCH-XFER.PIO-UPI;
    DFC49W1.PI1-CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
    /* START CHANGES FOR PTR #6567*/
    DFC49W1.PI1-LEGAL-MTHD = H2-PCKT.SOP-LEGAL-MTHD;
    DFC49W1.PI1-SRVC-MTHD = H2-PCKT.SRVC-MTHD;
    /* END   CHANGES FOR PTR #6567*/
    call "DFC49A" (VDBCONTROL, VMESSAGE, DFC49W1) {isNoRefresh = yes};
    if (VDBCONTROL.URC > 104)
      exit program;
    end
  end
  /* ptr 2837 change end*/
end // end DFM08P9-INQ-PCKT


// Inserts values
Function DFM08P9-KDTA-TRKNG()
  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  H2-BTCH-FRM-KDTA.CRTN-TS = GDW.TS;

  WDB00PI();
  VDBCOMMON.UAPPLNAM = "DFM08A";
  VDBCOMMON.USQLREC = "H2-BTCH-FRM-KDTA";
  VDBCONTROL.UPROC-OBJ = "H2-BTCH-FRM-KDTA";
  VDBCONTROL.UPROC-NM = "DFM08P9-KDTA-TRKNG";
  VDBCONTROL.UPROC-OPT = "ADD";
  try
    add H2-BTCH-FRM-KDTA ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
    DFM08W3.WS-SQLCODE = sysVar.sqlData.sqlcode;
  end

  VDBCOMMON.UNRF = 1;
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    exit program;
  end
end // end DFM08P9-KDTA-TRKNG


// Applications main process
Function DFM08P9-MAIN()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date           Pgr     Description*/
  /* ---            ---     -----------*/
  /* 23 APRIL 1995  TBST312 Creation*/
  /* 10/10/96       WNMAR   CHANGES FOR PTR #7820*/
  /* ---------------------------*/
  /* -----------------------------------------------*/
  /* Initializes the records and performs first or  */
  /* second pass process depending on the sib type  */
  /* -----------------------------------------------*/

  /* This process intializes the records*/
  DFM08P9-INIT-PROC();

  /* determine if processing batch form for IVA or IVD*/
  if (DFMBTCH-XFER.PIO-MODE-IND == "A")
    DFM08P9-FRST-PS-A();
  else
    H2-IVD-CASE.NCP-UPI = DFMBTCH-XFER.PIO-UPI;
    H2-IVD-CASE.CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
    DFM08P9-S08(); /* Bypass for Case Type 'D'*/
    if (sysVar.sqlData.sqlcode == 0)
      if (DFMBTCH-XFER.PIO-FORM-ID != "GN0154")
        ;
      else
        DFM08P9-FIRST-PASS(); /* first pass process*/
      end
    else
      DFM08P9-FIRST-PASS(); /* first pass process*/
    end
  end
end // end DFM08P9-MAIN


// Gets NCP JRSDT Code
Function DFM08P9-NCP-JRSDT()
  WDB00PI();
  VDBCOMMON.UAPPLNAM = "DFM08A";
  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "DFM08P9-NCP-JRSDT";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    get H2-IVD-CASE
      with #sql{
        select NCP_JRSDT_CD, FUNC_AREA_CD
        from TWNIVD_CASE T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE NCP_UPI = :NCP-UPI AND CASE_SUFX = :CASE-SUFX
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into NCP-JRSDT-CD, FUNC-AREA-CD ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
    DFM08W3.WS-SQLCODE = sysVar.sqlData.sqlcode;
  end

  VDBCOMMON.UNRF = 1;
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    exit program;
  end
end // end DFM08P9-NCP-JRSDT


// Gets NCP name
Function DFM08P9-NCP-NM()
  WDB00PI();
  VDBCOMMON.UAPPLNAM = "DFM08A";
  VDBCOMMON.USQLREC = "H2-PERSON";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCONTROL.UPROC-NM = "DFM08P9-NCP-NM";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  try
    get H2-PERSON
      with #sql{
        select LST_NM, FRST_NM, MID_NM
        from TWNPERSON T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE UPI = :UPI
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into LST-NM, FRST-NM, MID-NM ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
    DFM08W3.WS-SQLCODE = sysVar.sqlData.sqlcode;
  end

  VDBCOMMON.UNRF = 1;
  VDBCOMMON.UDUP = "N";
  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    exit program;
  end
end // end DFM08P9-NCP-NM


// MOVE NCP NAME
Function DFM08P9-NCPNAME()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the ncp name                  */
  /* ------------------------------------------------------*/
  DFM08W.WS-NCPNAME = DFMBTCH-XFER.PIO-NCP-NAME;
  VSTRREC.USTRING = DFMBTCH-XFER.PIO-NCP-NAME;
  call "WST15A" (VSTRREC) {isNoRefresh = yes}; /* find length of string*/
  DFM08W.WS-INDEX-2 = VSTRREC.USTRLEN;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-NCPN-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-NCPNAME


// MOVE NCP SSN
Function DFM08P9-NCPSSN()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the ncp ssn                   */
  /* ------------------------------------------------------*/
  DFM08W.WS-NCPSSN = DFMBTCH-XFER.PIO-NCP-SSN;
  DFM08W.WS-INDEX-2 = 9;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-NCPS-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-NCPSSN


// Construct County Code
Function DFM08P9-OFFICECD()
  /* -------------------------------------------*/
  /* */
  /* This process constructs the office code    */
  /* */
  /* -------------------------------------------*/
  /*  */
  DFM08P9-S01(); /* get office code*/
  if (VDBCONTROL.URC > 104)
    exit program;
  end
  /*  */
  DFM08W.WS-OFC-CD = H2-IVD-CASE.NCP-JRSDT-CD;
  /*  */
  DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-OFC-CD-X[1];
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-OFC-CD-X[2];
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-OFFICECD


// MOVE PARAGRAPH NAME AND LTD
Function DFM08P9-PARAGRPH()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* ------------------------------------------------------*/
  /* This process constructs the paragraph                 */
  /* */
  /* ------------------------------------------------------*/
  DFM08W.WS-INDEX-2 = 1;
  set H2-PARA-VER empty;
  H2-PARA-VER.FRM-ID = DFMBTCH-XFER.PIO-FORM-ID;
  DFM08P9-S07();
  if (VDBCONTROL.URC > 104)
    exit program; /* Terminate the application*/
  end /* end If*/
  DFM08W.WS-LTD-NAME = H2-PARA-VER.LTD-NAME;
  DFM08W.WS-PARA-NAME = H2-PARA-VER.PARA-NAME;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= 16 && DFM08W.WS-STR-OFF-FLAG == "N")
    if (DFM08W.WS-PARA-NAME-X[WS-INDEX-3] == " ")
      DFM08W.WS-STR-OFF-FLAG = "Y";
    else
      DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-PARA-NAME-X[WS-INDEX-3];
      DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
      DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    end /* endif*/
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = "(";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-PARAGRPH


// Execute Pop-Ups defined by Tab
Function DFM08P9-POP-TAB()
  DFM08P9-S09();
  DFM08P9-SCAN();
  while (sysVar.sqlData.sqlcode == 0)
    DFM08W.WS-PARM-NMB = DFMBTCH-XFER.PIO-PARM-NMB;
    DFMBTCH-XFER.PIO-PARM-NMB = H2-FORM-POPUP.PARM-NMB;
    if (H2-FORM-POPUP.CONDITION-PARM == 0 || 
    DFMBTCH-XFER.PIO-POP-PARM[CONDITION-PARM] == 
    H2-FORM-POPUP.CONDITION-VALUE)
      DFM08P9-CALL-POP();
    end
    if (DFMBTCH-XFER.PIO-PARM-NMB < DFM08W.WS-PARM-NMB)
      DFMBTCH-XFER.PIO-PARM-NMB = DFM08W.WS-PARM-NMB;
    end
    DFM08P9-SCAN();
  end
end // end DFM08P9-POP-TAB


// Selction process
Function DFM08P9-S01()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date     Pgr     Description*/
  /* ---      ---     -----------*/
  /* ---------------------------*/
  /* -------------------------------------------------------------*/
  /* This process inquires TWNIVD_CASE table and gets case county   */
  /* -------------------------------------------------------------*/

  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "DFM08P9-S01";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  set H2-IVD-CASE empty;
  H2-IVD-CASE.CASE-SUFX = DFMBTCH-XFER.PIO-CASE-SUFX;
  H2-IVD-CASE.NCP-UPI = DFMBTCH-XFER.PIO-UPI;
  try
    get H2-IVD-CASE singleRow
      with #sql{
        select NCP_JRSDT_CD
        from TWNIVD_CASE T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE NCP_UPI = :NCP-UPI AND CASE_SUFX = :CASE-SUFX
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into NCP-JRSDT-CD ;
  end
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  WDB00PE-SQLERR();
end // end DFM08P9-S01


// Selection process
Function DFM08P9-S05()
  ;
  /* ------------------------------------------------------*/
  /* This process gets the service required indicator     */
  /* for given packet-id from TWNPCKT table               */
  /* ------------------------------------------------------*/
  ;
  set H2-PCKT empty; /* Initialize the record*/
  H2-PCKT.PCKT-ID = DFMBTCH-XFER.WS-PCKT; /* Move the key*/
  ;
  VDBCOMMON.USQLREC = "H2-PCKT";
  VDBCONTROL.UPROC-OBJ = "H2-PCKT";
  VDBCONTROL.UPROC-NM = "DFM08P9-S05";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  ;
  try
    get H2-PCKT
      with #sql{
        select SRVC_REQD_IND, SOP_LEGAL_MTHD, SRVC_MTHD
        from TWNPCKT T1
        where pckt_id = :PCKT-ID
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into SRVC-REQD-IND, SOP-LEGAL-MTHD, SRVC-MTHD ;
  end
  ;
  if (sysVar.sqlData.sqlcode == 0) /* If SQL code is zero*/
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1; /* Increment the row*/
  end /* End if*/
end // end DFM08P9-S05


// Selction process
Function DFM08P9-S06()
  ;
  /* --------------------------------------------------*/
  /* This process fetches the service required indica */
  /* from TWNCNTY_FRM table.                          */
  /* -------------------------------------------------*/
  ;
  VDBCOMMON.USQLREC = "H2-CNTY-FRM";
  VDBCONTROL.UPROC-OBJ = "H2-CNTY-FRM";
  VDBCONTROL.UPROC-NM = "DFM08P9-S06";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  ;
  set H2-CNTY-FRM empty;
  H2-CNTY-FRM.FRM-ID = DFMBTCH-XFER.PIO-FORM-ID;
  H2-CNTY-FRM.CNTY-CD = DFMBTCH-XFER.PIO-COUNTY-CD;
  try
    get H2-CNTY-FRM singleRow
      with #sql{
        select SRVC_REQD_IND,  SRVC_MTHD
        from twncnty_frm T1
        WHERE CNTY_CD=:CNTY-CD
        AND   FRM_ID =:FRM-ID
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into SRVC-REQD-IND,  SRVC-MTHD ;
  end

  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end

  if (sysVar.sqlData.sqlcode == 0) /* If sql code = 0*/
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1; /* Increment the recrd count*/
  end /* End if sql code =0*/
end // end DFM08P9-S06


// INQUIRY FOR S07
Function DFM08P9-S07()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ---------------------------*/
  /* -------------------------------------------------------------*/
  /* This process inquires PARA_VER table and gets ltd name      */
  /* where effective date < current date and end-date > curr date*/
  /* -------------------------------------------------------------*/

  VDBCOMMON.USQLREC = "H2-PARA-VER";
  VDBCONTROL.UPROC-OBJ = "H2-PARA-VER";
  VDBCONTROL.UPROC-NM = "DFM08P9-S07";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  try
    get H2-PARA-VER
      with #sql{
        select LTD_NAME, PARA_NAME, FORM_DEST
        from TWNPARA_VER T1
        WHERE FRM_ID = :FRM-ID
         AND EFF_DT <= :GDW.DTCD
         AND END_DT >= :GDW.DTCD
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into LTD-NAME, PARA-NAME, FORM-DEST ;
  end
  if (sysVar.sqlData.sqlcode == 0) /* If return code is zer*/
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end /* End if*/
  WDB00PE-SQLERR(); /* Determine URC*/
end // end DFM08P9-S07


// READ
Function DFM08P9-S08()
  /* _______________________________________________________________________*/
  /* Description :*/
  /* This process gets record form twnofc_server.*/
  /*  */
  /* Change History :*/
  /* Date       Usrid  WI     Description*/
  /* ---------  -----  -----  -----------*/
  /* 20Nov1998  WNMAA  15120  CREATION*/
  /*  */
  /* _______________________________________________________________________*/
  /*  */
  /*  */
  WDB00PI();

  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "DFM08A";

  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCONTROL.UPROC-NM = "DFM08P9-S08";
  try
    get H2-IVD-CASE
      with #sql{
        select CASE_TYPE
        from TWNIVD_CASE T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.NCP_UPI   = :NCP-UPI
          AND T1.CASE_SUFX = :CASE-SUFX
          AND T1.CASE_TYPE = 'D'
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into CASE-TYPE ;
  end

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "Y";
  /*  */
  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end

  /*  */
  /* Nomads End*/
  /*  */
end // end DFM08P9-S08


// Get pop-up list
Function DFM08P9-S09()
  WDB00PI();

  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "DFM08A";

  VDBCOMMON.USQLREC = "H2-FORM-POPUP";
  VDBCONTROL.UPROC-OBJ = "H2-FORM-POPUP";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-NM = "DFM08P9-S09";
  H2-FORM-POPUP.FRM-ID = DFMBTCH-XFER.PIO-FORM-ID;
  H2-FORM-POPUP.PIO-MODE = "B";
  try
    open DFM08P9-S09_RSI01
      with #sql{
        select APPL_ID,
          PARM_NMB, CONDITION_PARM, CONDITION_VALUE
        from TWNFORM_POPUP T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE
          FRM_ID = :FRM-ID           AND
          PIO_MODE = :PIO-MODE
        ORDER BY
          POP_SQ_NMB
        FOR FETCH ONLY
      }      
      into APPL-ID,
           PARM-NMB, CONDITION-PARM, CONDITION-VALUE
      for H2-FORM-POPUP ;
  end

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "Y";

  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end
end // end DFM08P9-S09


// Scan pop-up list
Function DFM08P9-SCAN()
  WDB00PI();

  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "DFM08A";

  VDBCOMMON.USQLREC = "H2-FORM-POPUP";
  VDBCONTROL.UPROC-OBJ = "H2-FORM-POPUP";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-NM = "DFM08P9-SCAN";
  try
    get next H2-FORM-POPUP ;
  end

  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "Y";

  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    exit program;
  end
end // end DFM08P9-SCAN


// To insert a record(serv-proc)
Function DFM08P9-SERV-PROC()
  /* ----------------------------------------------------*/
  /* This process checks if it a packet/form. If packet it calls dfc49*/
  /* to insert the packet info. and if it a form it inserts form info.*/
  /* in service of process activity table.*/
  /* ----------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* Date         Pgr      Description*/
  /* ---          ---      -----------*/
  /* 03/06/97     WNMAR    CREATED FOR PTR #9139*/
  /* -------------------------------------------------------*/
  /* ptr 2837 change start*/
  if (DFMBTCH-XFER.WS-PCKT-FLAG == "C")
    DFM08P9-INQ-PCKT();
  else
    if (DFMBTCH-XFER.WS-PCKT-FLAG != "Y")
      DFM08P9-INQ-FORM();
    end
  end
  /* ptr 2837 change end*/
end // end DFM08P9-SERV-PROC


// MOVE WORKER NAME
Function DFM08P9-WKRNAME()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ------------------------------------------------------*/
  /* This process constructs the worker name               */
  /* ------------------------------------------------------*/
  VSTRREC.USTRING = DFM08W.WS-WKRNM;
  call "WST15A" (VSTRREC) {isNoRefresh = yes}; /* find length of string*/
  DFM08W.WS-INDEX-2 = VSTRREC.USTRLEN;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-WKRN-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-WKRNAME


// Write into serial file
Function DFM08P9-WRITESIB()
  DFM08W.WS-REC-LTH = DFM08W.WS-INDEX + 182;
  DFM08W-FLESIB0.WS-LGL-LTH = DFM08W.WS-REC-LTH;
  DFM08W-PO1-SIB0.PO1-SIB-TOTAL-LTH = DFM08W.WS-REC-LTH - 2;
  DFM08W-FLESIB0.WS-HEADER = DFM08W-PO1-SIB0.PO1-HEADER;
  VDBCONTROL.UPROC-NM = "DFM08P9-WRITESIB";
  VDBCONTROL.UPROC-OPT = "ADD";
  VDBCOMMON.USQLREC = "DFM08W-FLESIB0";
  VDBCONTROL.UPROC-OBJ = "DFM08W-FLESIB0";
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  try
    add DFM08W-FLESIB0 ;
  end

  if (DFM08W-FLESIB0 is ioError)

    VDBCONTROL.UPROC-NM = "DFM08P9-WRITESIB";
    VDBCONTROL.UPROC-OBJ = "DFM08W-FLESIB0";
    VDBCONTROL.UPROC-OPT = "ADD";

    WEZERT8-TO-URC();

    VMESSAGE.UMSGCODE = VDBCONTROL.URC;
    exit program;
  end /* End if*/
end // end DFM08P9-WRITESIB


// MOVE WORKER TITLE
Function DFM08P9-WRKTITLE()
  /*  */
  /* Change History*/
  /* ==============*/
  /* Date    Pgr    Description*/
  /* ---     ---    -----------*/
  /* 02 Feb 1995  TBST178 Creation*/
  /* ------------------------------------------------------*/
  /* This process constructs the worker title              */
  /* ------------------------------------------------------*/
  VSTRREC.USTRING = DFM08W.WS-WKRTTL;
  call "WST15A" (VSTRREC) {isNoRefresh = yes}; /* find length of string*/
  DFM08W.WS-INDEX-2 = VSTRREC.USTRLEN;
  DFM08W.WS-INDEX-3 = 1;
  while (DFM08W.WS-INDEX-3 <= DFM08W.WS-INDEX-2)
    DFM08W.WS-STRING[WS-INDEX] = DFM08W.WS-WKRT-X[WS-INDEX-3];
    DFM08W.WS-INDEX-3 = DFM08W.WS-INDEX-3 + 1;
    DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
  end /* end while*/
  DFM08W.WS-STRING[WS-INDEX] = ";";
  DFM08W.WS-INDEX = DFM08W.WS-INDEX + 1;
end // end DFM08P9-WRKTITLE


Record DFM08W type basicRecord
  10 WS-TERM-ID char(7) ; 
  10 WS-PRINT-ID char(4) ; 
    15 WS-PRINT-X char(1) [4] ; 
  10 WS-APPENDAGE char(2000) ; 
    15 WS-APPEND-PAGE char(2000) ; 
  10 WS-APP-TXT char(2000) ; 
    15 WS-STRING char(1) [2000] ; 
  10 WS-COMMON-PARMS char(569) ; 
    15 WS-PARA-NAME char(16) ; 
      20 WS-PARA-NAME-X char(1) [16] ; 
    15 WS-CASENUM char(60) ; 
      20 WS-CASE-X char(1) [60] ; 
    15 WS-FORMID char(60) ; 
      20 WS-FORM-X char(1) [60] ; 
    15 WS-NCPNAME char(60) ; 
      20 WS-NCPN-X char(1) [60] ; 
    15 WS-NCPSSN char(60) ; 
      20 WS-NCPS-X char(1) [60] ; 
    15 WS-CSTNAME char(60) ; 
      20 WS-CSTN-X char(1) [60] ; 
    15 WS-CSTSSN char(60) ; 
      20 WS-CSTS-X char(1) [60] ; 
    15 WS-WKRNM char(60) ; 
      20 WS-WKRN-X char(1) [60] ; 
    15 WS-WKRTTL char(60) ; 
      20 WS-WKRT-X char(1) [60] ; 
    15 WS-CNTYCD char(60) ; 
      20 WS-CNTY-X char(1) [60] ; 
    15 WS-DCKETNUM num(9) ; 
      20 WS-DCKE-X char(1) [9] ; 
    15 WS-DKTSQNUM num(4) ; 
      20 WS-DKTS-X char(1) [4] ; 
  10 WS-ADDL-PARMS char(12000) ; 
    15 WS-ADD-PARM char(60) [200] ; 
  10 WS-ADDLPARM char(60) ; 
    15 WS-ADD-PARM-X char(1) [60] ; 
  10 WS-INP-FORM-PKT char(6) ; 
  10 WS-PKT-FRM-ID char(1) ; 
  10 WS-CASE-NUM char(10) ; 
    15 WS-UPI num(9) ; 
    15 WS-CASE-SUFX char(1) ; 
  10 WS-NMB-COPIES num(2) ; 
    15 WS-COPIES-X num(1) [2] ; 
  10 WS-SIB-LTH num(4) ; 
  10 WS-RECRD-CNT num(2) ; 
  10 WS-LTD-NAME char(16) ; 
  10 WS-INDEX num(4) ; 
  10 WS-INDEX-2 num(3) ; 
  10 WS-INDEX-3 num(3) ; 
  10 WS-INDEX-4 num(3) ; 
  10 WS-STR-OFF-FLAG char(1) ; 
  10 WS-USER char(5) ; 
    15 WS-USER-01 char(1) ; 
    15 WS-USER-02 char(2) ; 
    15 WS-USER-03 char(2) ; 
  10 WS-TS-ID char(7) ; 
    15 WS-TS-ID-01 char(1) ; 
    15 WS-TS-ID-02 char(2) ; 
    15 WS-TS-TERM-ID char(4) ; 
  10 WS-REC-LTH smallint ; 
  10 WS-PIO-UPI int ; 
  10 WS-CNTY-CD char(4) ; 
    15 WS-C-CNTY char(2) ; 
    15 WS-W-CNTY char(2) ; 
  10 WS-OFC-CD char(2) ; 
    15 WS-OFC-CD-X char(1) [2] ; 
  10 WS-PACKET char(6) ; 
    15 WS-PCKT-FILLER char(3) ; 
    15 WS-PCKT char(3) ; 
  10 WS-PARM-NMB num(3) ; 
  10 CST-NCP-IND char(1) ; 
  10 PARM-NUM smallint ; 
  10 WS-INDEX-SAVE num(4) ; 
end // end DFM08W


Record DFM08W-FLESIB0 type serialRecord  {
  fileName = "SIBZERO", lengthItem = WS-REC-LTH
  }
  5 WS-LGL-LTH smallint ; 
  5 WS-HEADER char(7178) ; 
    10 WS-FILLER char(7178) ; 
end // end DFM08W-FLESIB0


Record DFM08W-PO1-SIB0 type basicRecord
  5 PO1-HEADER char(7180) ; 
    10 PO1-SIB-HEADER char(180) ; // SIB Header information
      20 PO1-SIB-ASF-VER smallint ; // ASF Version
      20 PO1-SIB-USER-NAME char(8) ; // User Name
      20 PO1-SIB-USER-PSWD char(8) ; // User Password
      20 PO1-SIB-PGRM-NAME char(8) ; // Return Program
      20 PO1-SIB-SEC-SUPPR char(1) ; // Suppression Password
      20 PO1-SIB-LANG-IND char(3) ; // Selected Language indicator
      20 PO1-SIB-REC-ID char(16) ; // Record Idendifier
      20 PO1-SIB-1ST-ASF-CALL char(1) ; // ASF call on 1st Level
      20 PO1-SIB-MSG-REDEF char(1) ; // Message Text Redefined
      20 PO1-SIB-DATA-XFER smallint ; // Data Xfer thrh. Appln.connecti
      20 PO1-SIB-ASF-FNCT char(4) ; // Requested  Function
      20 PO1-SIB-USER-COMA char(32) ; // User Communication Area
      20 PO1-SIB-TOTAL-LTH smallint ; // Total Length of SIB
      20 PO1-SIB-TYPE char(1) ; // SIB Type indicator
      20 PO1-SIB-MSG-TEXT char(79) ; // Returned Message Text
      20 PO1-SIB-MSG-CODE smallint ; // Return Code
      20 PO1-SIB-ERR-FLD char(10) ; // Parameter in Error
    10 PO1-SIB-APPENDAGE char(7000) ; // SIB appendage
      15 PO1-SIB-APPEND-TEXT char(7000) ; // Appendage string
end // end DFM08W-PO1-SIB0


Record DFM08W1 type basicRecord
  5 NCP-SSN char(9) ; 
    10 NCP-SSN-1 char(3) ; 
    10 NCP-SSN-2 char(2) ; 
    10 NCP-SSN-3 char(4) ; 
  5 CST-SSN char(9) ; 
    10 CST-SSN-1 char(3) ; 
    10 CST-SSN-2 char(2) ; 
    10 CST-SSN-3 char(4) ; 
end // end DFM08W1


Record DFM08W2 type basicRecord
  5 WS-SIB-USER-COMA char(32) ; 
    10 WS-SSN char(10) ; 
      15 WS-NCPSSN char(9) ; 
        20 WS-NCPSSN-N num(9) ; 
      15 WS-CASESUFX char(1) ; 
    10 WS-MODE char(1) ; 
    10 WS-PRNTR-ID char(17) ; 
      15 WS-TERM-ID char(4) ; 
      15 WS-FORM-ID char(6) ; 
      15 WS-CNTY-CD char(2) ; 
      15 WS-JRSDT-DTL num(1) ; 
      15 WS-DCKT-NMB int ; 
    10 WS-PCKT char(3) ; 
    10 WS-PCKT-FLAG char(1) ; 
end // end DFM08W2


Record DFM08W3 type basicRecord
  10 WS-IN-DATA char(80) ; 
    15 WS-DOWNLD-IND char(1) ; 
    15 WS-FILLER char(79) ; 
  10 WS-CRTD-TS char(26) ; 
    15 WS-CRTD-DT char(10) ; 
      20 WS-CRTD-DT-CCYY char(4) ; 
        25 WS-CRTD-DT-CC char(2) ; 
        25 WS-CRTD-DT-YY char(2) ; 
      20 WS-CRTD-DT-SEP-1 char(1) ; 
      20 WS-CRTD-DT-MM char(2) ; 
      20 WS-CRTD-DT-SEP-2 char(1) ; 
      20 WS-CRTD-DT-DD char(2) ; 
    15 WS-TIME-STAMP char(16) ; 
  10 WS-PROCESS-DT char(10) ; 
    15 WS-PROC-DT-CCYY char(4) ; 
      20 WS-PROC-DT-CC char(2) ; 
      20 WS-PROC-DT-YY char(2) ; 
    15 WS-PROC-DT-SEP-1 char(1) ; 
    15 WS-PROC-DT-MM char(2) ; 
    15 WS-PROC-DT-SEP-2 char(1) ; 
    15 WS-PROC-DT-DD char(2) ; 
  10 WS-ERR-CD char(8) ; 
    15 WS-ERR-FIRST-FOUR char(4) ; 
    15 WS-ERR-LAST-FOUR char(4) ; 
  10 WS-NCP-UPI int ; // NCP_UPI
  10 WS-CASE-SUFX char(1) ; // CASE_SUFX
  10 WS-CRTN-TS char(26) ; // CRTN-TS
  10 WS-SQLCODE int ; 
end // end DFM08W3


Record DFM08W4 type basicRecord
  3 WS-FORM-KEY-PARM char(320) ; 
    5 WS-RECORD-1 char(80) ; 
      10 WS-NCP-UPI num(9) ; 
      10 WS-CASE-SUFX char(1) ; 
      10 WS-NCP-NAME char(25) ; // lstnm blnk fstint blnk midint
      10 WS-NCP-SSN char(11) ; 
        15 WS-NCP-SSN-THREE char(3) ; 
        15 WS-NCP-SSN-FILL1 char(1) ; 
        15 WS-NCP-SSN-TWO char(2) ; 
        15 WS-NCP-SSN-FILL2 char(1) ; 
        15 WS-NCP-SSN-FOUR char(4) ; 
      10 WS-FILLER1 char(34) ; 
    5 WS-RECORD-2 char(80) ; 
      10 WS-CST-UPI num(9) ; 
      10 WS-CST-NAME char(25) ; // lstnm blnk fstint blnk midint
      10 WS-CST-SSN char(11) ; 
        15 WS-CST-SSN-THREE char(3) ; 
        15 WS-CST-SSN-FILL1 char(1) ; 
        15 WS-CST-SSN-TWO char(2) ; 
        15 WS-CST-SSN-FILL2 char(1) ; 
        15 WS-CST-SSN-FOUR char(4) ; 
      10 WS-FILLER2 char(35) ; 
    5 WS-RECORD-3 char(80) ; 
      10 WS-DCKT-NMB num(9) ; 
      10 WS-LST-SQNC-NMB num(4) ; 
      10 WS-EMPLR-NMB char(10) ; 
      10 WS-EMPLR-CRTN-DT char(10) ; 
      10 WS-SOPR-PCKT-ID char(6) ; 
      10 WS-SOPR-RFRL-DT char(10) ; 
      10 WS-CRNT-DATE char(10) ; 
      10 WS-FILLER3 char(21) ; // filler for - sign
    5 WS-RECORD-4 char(80) ; 
      10 WS-USRID char(8) ; 
      10 WS-TERMID char(4) ; 
      10 WS-OFC-CNTY-CD char(2) ; 
      10 WS-FORM char(6) [10] ; 
      10 WS-FILLER4 char(6) ; 
end // end DFM08W4


