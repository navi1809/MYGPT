<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<%/*
********************************************************************************************
Name: [DCHMAAutorizedRepresentative.jsp]Created By: [Haridarshan Singh]	Created on: [05/14/2002]
Purpose: [YOUR PURPOSE]
Modification Logs:
Modified By 			Date				Reason & description
[MODIFIED NAME]		    [MM/DD/YYYY]		[REASON FOR CHANGE]
Modified By - Ashok R Pulagum			Date	12/20/06			Reason & description - Added Print Functionality
Rahul Asar				08/10/2007			BRGUS00044504 - Addition of Relationship to Individual dropdown
Susmitha Arakala        10/09/2007          BRGUS00073573  
********************************************************************************************
*/%>

<%/* NOT EDITABLE - FW Page Directive, Imports, and URIs */%>
<%@ include file = "/fwincludes/directives.jsp" %>
<%
indicators.put("skipClosingForm","true");
indicators.put("w3c","true");
%> 
<%/* EDITABLE - Page Specific Imports and URIs (You can add code to this section) */%>
<%@ include file = "/includes/ArDirectives.jsp" %>
<%@ include file = "/includes/DcDirectives.jsp" %>
<%
indicators.put("skipClosingForm","true");
indicators.put("w3c","true"); 
%>
<%/* EDITABLE - Page Specific Imports and URIs (You can add code to this section) */%>
<%@ page import="gov.illinois.fw.management.referencetables.ReferenceTableManager"%>
<%/* EDITABLE - Page Specific useBean tags(You can add code to this section) */%>
<jsp:useBean id="prefixName" class="gov.illinois.ies.presentation.view.pageelements.PrefixName" scope="application"/>
<jsp:useBean id="requiredFirstName" class="gov.illinois.ies.presentation.view.pageelements.RequiredFirstName" scope="application"/>
<jsp:useBean id="middleName" class="gov.illinois.ies.presentation.view.pageelements.MiddleName" scope="application"/>
<jsp:useBean id="requiredLastName" class="gov.illinois.ies.presentation.view.pageelements.RequiredLastName" scope="application"/>
<jsp:useBean id="suffixName" class="gov.illinois.ies.presentation.view.pageelements.SuffixName" scope="application"/>
<jsp:useBean id="phoneNumber" class="gov.illinois.ies.presentation.view.pageelements.PhoneNumber" scope="application"/>
<jsp:useBean id="authRepAddrCargo" class="gov.illinois.ies.business.entities.cases.DcCaseAddressesCargo" scope="request"/>
<jsp:useBean id="dcCasesCargo" class="gov.illinois.ies.business.entities.cases.DcCasesCargo" scope="request"/>
<!-- Commented as per ILIES-62498:sravi -->
<%-- <jsp:useBean id="authRepVrf" class="gov.illinois.ies.presentation.view.pageelements.AuthRepVrf" scope="application"/> --%>
<jsp:useBean id="cin" class="gov.illinois.ies.presentation.view.pageelements.Cin" scope="application"/>
<jsp:useBean id="nameGroup" class="gov.illinois.ies.presentation.view.pageelements.NameGroup" scope="application"/>
<jsp:useBean id="addressGroup" class="gov.illinois.ies.presentation.view.pageelements.AddressGroup" scope="application"/>
<jsp:useBean id="addressValidation" class="gov.illinois.ies.presentation.view.pageelements.AddressValidation" scope="application"/>
<jsp:useBean id="organization" class="gov.illinois.ies.presentation.view.pageelements.Organization" scope="application"/>
<%--FO774 - Addition of field for TDD / Other Contact Phone # --%>
<jsp:useBean id="tDDOtherPhoneNumber" class="gov.illinois.ies.presentation.view.pageelements.TDDOtherPhoneNumber" scope="application"/>
<%//BRGUS00044504-RA-Addtion of Relationship to Individual Dropdown%>
<jsp:useBean id="relationshipToIndividual" class="gov.illinois.ies.presentation.view.pageelements.RelationshipToIndividual" scope="application"/>
<jsp:useBean id="action" class="gov.illinois.ies.presentation.view.pageelements.ActionCd" scope="application"/> 
<jsp:useBean id="dynaLoad" class="gov.illinois.ies.presentation.view.pageelements.DynaLoad" scope="application"/>

<% //FO510
String addressValidationSw1 = "BLANK";
			if(authRepAddrCargo != null && authRepAddrCargo.getAddrValidatedSw()!=0){
			
				addressValidationSw1 = ""+authRepAddrCargo.getAddrValidatedSw();
			}
			
	java.util.ArrayList repDynaList = new java.util.ArrayList();
	if (request.getAttribute("repDynaList")!=null){
		repDynaList = (java.util.ArrayList)request.getAttribute("repDynaList");
	}
 %>


<%/* NOT EDITABLE - Head Tag Include */%>
<%@ include file = "/fwincludes/headTag.jsp" %>

<%/* EDITABLE WITH PERMISSION (You can add code to this section) - Body and Form Tags */%> 
<TL:FWBodyTag security="<%=securityAttr.getPermission()%>" mode="<%= pageMode%>" other="onLoad=\"checkAddValidation();\""/>

<%/* EDITABLE - Page specific .js or .css files (You can add code to this section) */%>
<script src="/js/ar.js" type="text/javascript"></script>
<script src="/js/dc.js" type="text/javascript"></script>

<script type="text/javascript">
	  var dyna_table_accessibility='Y';
	  var dyna_table_ambiguous_links='Y';
</script>
<script src="/js/dynaTable.js" type="text/javascript"></script>
<script type="text/javascript">
	var city;
	var county;
	
	var zipCode5;
	var zipCode4;
	var displayRules = new Array(2);
	displayRules[0] = '~prefixName~ ~firstName~ ~middleName~ ~lastName~ ~suffixName~';
	displayRules[1] = 'relationshipToIndividual';
	dyna_table_accessibility='Y';
	
function checkAddValidation(){
<%-- 
var a='<%=addressValidationSw1%>';
if(a=='BLANK'){
form2.addressValidation.value='Y';
form2.addressValidation.disabled = true;
}
else{
form2.addressValidation.disabled =false;
} --%>
}

function checkSpecialChar(){
	var field= document.form2.city.value;
    var iChars = "~`!#$%^&*+=-[]\\\';,/{}|\":<>?";

    for (var i = 0; i < field.length; i++) {
       if (iChars.indexOf(field.charAt(i)) != -1) {
           alertMe('AR3125');
           return false;
       }
    }
    return true;
}

 /* syeramareddy: ILIES 121572  */
function validateAddress()
	{
		var city = document.form2.city;
  		var zip4 = document.form2.zipCode4;
  		var zip5 = document.form2.zipCode5;
  		var check = true;
 		
  		var search = "[^A-Za-z\s]+";
  		var result = city.value.match( search );
  		
  		if ( result != null && result != " " )
  		{
  			alertMe( 'GL006', city, city );
  			check = false;
  		}
  		if(zip5 != null & zip5 != "undefined"){
  			if(zip5.value.trim() == ""){
  				alertMe( 'GL003', zip5, zip5 );
  				check = false;
  			}
  		}
  		if(city != null & city != "undefined"){
  			if(city.value.trim() == ""){
  				alertMe( 'GL003', city, city );
  				check = false;
  			}
  		}
 		if ( checkZipCodeDchma( zip5, zip4 ) == false )
    	{
    		check = false;
    	}

   		if ( check == false )
   		{
   			return false;
   		}
   		
		return true;
  		}
 function checkZipCodeDchma(field1,field2){
	if(isZero(field1)){
		if(isZero(field2)){
			if(isMaxSetDchma(field1)){
				return isMaxSetDchma(field2);
			}
			else return false;
		}
		else return false;
	}
	else return false;
}		

function isMaxSetDchma(field){
	var val=field.value;
	if(val==null || val.length <= 0) return true;
	var maxLen=field.maxLength;
	if(val.length < maxLen){
		alertMe('GL008',field,field);
		return false;
	}
	return true;
}

function checkZipCodeForAllZeroes(){
	var field= document.form2.zipCode5.value;
       if (field==='00000') {
           alertMe('AR3126');
           return false;
       }
    return true;
}

function isMaxSet(field){
	var val=field.value;
	if(val==null || val.length <= 0) return true;
	var maxLen=field.maxLength;
	if(val.length < maxLen){
		alertMe('GL008',field,field);
		return false;
	}
	return true;
}	
 /* syeramareddy: ILIES 121572  */

//ILIES-198422
function validateButton()
{
	if(document.getElementById("ACTION") != null && document.getElementById("ACTION").value == 'Previous')
	{
		document.getElementById("dynaTableValidate").value = "N";
	}
	else
	{
		document.getElementById("dynaTableValidate").value = "Y";
	}
	
	return true;
}
</script>


<%      
	String addressValidationSw = "";
	//BRGUS00044504
	String relationshipIndv = ""; 
	String authRepInd = null;
	String rtFilter="ARFILTER";
	
	if(authRepAddrCargo != null){
		addressValidationSw = authRepAddrCargo.getAddrValidatedSw()+"";
	}

	String phone =  null;
	if (dcCasesCargo != null){
		if ( dcCasesCargo.getAuthrepPhNum() != null){
			phone = dcCasesCargo.getAuthrepPhNum().toString();	
		}
		
		//BRGUS00044504-RA-Addition of Relationship to Individual field
		if ( dcCasesCargo.getRelationshipIndvCd() != null){
			relationshipIndv = dcCasesCargo.getRelationshipIndvCd();
		}

		//BRGUS00044504-RA-Filter based on Filing/SER Auth Rep.
		authRepInd = Character.toString(dcCasesCargo.getAuthRepInd());
		if(authRepInd  != null && authRepInd.equals("S")){
			rtFilter = "SERFILTER";
		}
	}

	if (phone == null){
		phone = "";	
	}
	
%>
<%/* NOT EDITABLE - Top of Page Include */%>
<%@ include file = "/fwincludes/tabs.jsp" %>
<%	
    	String caseNum = dcCasesCargo.getCaseNum() + "";
%>
<%/*	Removed DcTagLibrary:Comments */%>
<%/* EDITABLE - Page Level Icon Includes (You can add code to this section) */%>

<%/* NOT EDITABLE - Spacer Images */%>
<%@ include file = "/fwincludes/spacing.jsp" %>   
<form name="form2" action="/ControllerServlet">

<%/* NOT EDITABLE - Framework Hidden Fields */%>
<%-- <%@ include file = "/fwincludes/hiddenFields.jsp" %> --%>

<%/* EDITABLE - Page Specific Hidden Fields (You can add code to this section) */%>
<%-- BRGUS00158265 -- padmanabhunip --%>
<!-- Fix for ILIES-194470 -->
<input type="hidden" name = "cityCountyZip" id = "cityCountyZip" validate ="voidValidationsCountyOptional(this.form2,this.form2.residencyCounty,'County');">
<input type="hidden"  name="streetValidate" id="streetValidate" validate = "validateStreetName(this.form2);">
<input type="hidden" name ="streetNumberVal" id = "streetNumberVal" validate ="validateStreetNumber(form2);">
<input type="hidden" name="checkSpecialChar" id="checkSpecialChar" validate="checkSpecialChar()">
<input type="hidden" name="checkZipCodeForAllZeroes" id="checkZipCodeForAllZeroes" validate="checkZipCodeForAllZeroes()">
    
<!--  syeramareddy:ILIES 121572 -->
<input type="hidden" name="validateAddress" id="validateAddress" validate="validateAddress();validateCounty();">
<!--  syeramareddy:ILIES 121572 -->
    <!-- For Dyna Table -->
    <input type="hidden" name="caseNum" id="caseNum" value="<%=caseNum%>">
    <input type="hidden" name="caseAddrSeq" id="caseAddrSeq">
    <input type="hidden" name="repSeqNum" id="repSeqNum">
	<input type="hidden" name="addrType" id="addrType" value="AA">
	<input type="hidden" name="authHistSeq" id="authHistSeq">
	<input type="hidden" name="addrHistSeq" id="addrHistSeq">
	<input type="hidden" name="effBeginDt" id="effBeginDt">
	<input type="hidden" name="createUser" id="createUser">
	<input type="hidden" name="createDt" id="createDt">


<%/* EDITABLE - Additional JSP Scriplets (You can add code to this section)*/%> 

<div id="MainHeader" repeat="N">
<!-- End of activity 10857 -->                   

<%/* EDITABLE - Page Header Include (You can change this include.) */%>
<%@ include file = "/includes/ArDcHeader.jsp" %> 
<%/* NOT EDITABLE - Begin Outter HTML Table  and  messages file*/%>
<%@ include file="/fwincludes/messageDisplay.jsp" %>

<!-- Added by Ashok R Pulagum for print functionality and button positioning for dev activity 10857 - 19958 -->

<%/* EDITABLE - Comments (You can add code to this section) */%>	
<%@ include file = "/includes/Comments.jsp" %> 	


<%/* EDITABLE - Action Buttons (You can change this include.) */%>	 

<jsp:include page= "/fwdynamicinclude/actionButtonRPN.jsp" >
<jsp:param name="fw_buttonOnTop" value="true" />
</jsp:include>   
  <%/* EDITABLE (You can add code to this section) - Page Specific Table(s) - This is each developers area for coding the presentation. */%>	   
		<table width="723" border="0" cellspacing="0" cellpadding="0" class="bodyDividerTable" role="presentation">
          <td> 
             <h2 class="bodyDividerTableHeader">Approved Representative Details</h2> <%--ILIES-122227 --%>
          </td>
          <tr><td></td></tr>
        </table>
                
    	<table width="723" role="presentation" border="0" class="bodyFormLabels" title="Approved Representative">
		  <tr> 
			<td>
			</td>
		  </tr>
		  <tr>
			<td>
			<TL:FWGroupNameTag nameGroupBeanId="nameGroup"  mandatoryMarker="N"  
				prefixName ="" 
				firstName=""			
				firstNameScript="validateName(document.form2.firstName)"
				middleName="" 
				middleNameScript="validateName(document.form2.middleName)"
				lastName=""
				lastNameScript="validateName(document.form2.lastName)" 
				suffixName ="" 
				 
				formName="form2"/>
			</td>
		  </tr>
		 </table>
		<%
				/* String authRepVrfCd =  "";
				if (dcCasesCargo != null){
					if ( dcCasesCargo.getAuthrepIndvIdVrfCd() != null){  
						authRepVrfCd = dcCasesCargo.getAuthrepIndvIdVrfCd(); 
					}
				} */
				String authOrg = "";
				if (dcCasesCargo != null){
					if ( dcCasesCargo.getAuthrepOrgName() != null){  
						authOrg = dcCasesCargo.getAuthrepOrgName(); 
					}
				}
		%>
		<table width="723" role="presentation" border="0" class="bodyFormLabels" title="Approved Representative">
		<tr>
		<td width="250" > <TL:FWLabelTag bean="<%=organization%>" /> </td>
		
		<td width="750" > <TL:FWTextTag bean="<%=organization%>"  maxlength="30" value="" other="validate=\"isOrganiztionDCHMAA(document.form2.firstName,document.form2.lastName,document.form2.organization)\""/> </td>
		</tr>
			<% if(dcCasesCargo.getAuthRepInd() == 'S'){ %>
			<tr>
			<td width="160"><TL:FWLabelTag bean="<%=relationshipToIndividual%>" />
			</td>			
			<td width="200"><TL:FWRTSelectTag referenceTableName="ARAUTHREPRELATIONSHIP" filter="YES" 
			filterColumn="<%=rtFilter%>" filterValue="Y" bean="<%=relationshipToIndividual%>" size="40" 
			emptySpace="Y" selected=""  multiple="N" show="1"
			other="validate=\"isComplete(document.form2.relationshipToIndividual)\""/>
			</td>
			</tr>
			<%}else{ %>
			<tr>
			<td width="160"><TL:FWLabelTag bean="<%=relationshipToIndividual%>" />
			</td>	
			<td width="200"><TL:FWRTSelectTag referenceTableName="ARAUTHREPRELATIONSHIP" filter="YES" 
			filterColumn="<%=rtFilter%>" filterValue="Y" bean="<%=relationshipToIndividual%>" size="40" 
			emptySpace="Y" selected=""  multiple="N" show="1"/>
			</td>
			</tr>
			<%} %>
	    
	    </table> 
        <br>
        
		<table width="723" border="0" cellspacing="0" cellpadding="0" class="bodyDividerTable" role="presentation">
          <td> 
            <h2 class="bodyDividerTableHeader">Address Information</h2>
          </td>
          <tr><td></td></tr>
        </table>
		  
		  <table width="722" role="presentation" border="0" class="bodyFormLabels" title="Address Information">
           <tr height="27"> 
            <td width="43" > 
            <TL:FWARDCGroupAddressTag beanId="authRepAddrCargo" packageName="cases" addressGroupBeanId="addressGroup" formName="form2"  county="Y" region="Y" isRequired ="Y" isCountyRequired ="N" isCityOrZipRequired="N" attnCareOfFlag="N" />
 		    </td>
		   </tr>	
		 </table>	
		 	
        <table width="722" title="Address Information" border="0" class="bodyFormLabels">
          <tr height="27"> 
            <td width="111" height="26"  > <%-- <img src="<%=DcConstants.BULLET_REQUIRED_IMG%>"> --%>
			<TL:FWLabelTag bean="<%=addressValidation%>" colon="N" required="Y" />
              
            </td>
            <td width="531" height="26"  >
			<TL:FWRTSelectTag referenceTableName="YESNO" bean="<%=addressValidation%>"  emptySpace="N" selected="Y"  multiple="N" show="1" style="form50" />
			 
            </td>
          </tr>
        </table>
		<br>	
        <table width="723" border="0" cellspacing="0" cellpadding="0" class="bodyDividerTable" role="presentation">
          <td> 
            <h2 class="bodyDividerTableHeader">Contact Information</h2>
          </td>
        </table>
        
		<table width="723" title="Contact Information" border="0" class="bodyFormLabels" role="presentation">		 
          <tr> 
            <td height="28" width="60"> 
				<TL:FWGroupPhoneTag beanId = "phoneNumber" pageMode = "1" phone = ""  formName="form2"/>			
            </td>
			 <%--FO774 - Addition of field for TDD / Other Contact Phone # --%>
            <%      
				String otherPhoneNumber =  null;
				if (dcCasesCargo != null){
					if ( dcCasesCargo.getAuthrepOtherNum() != null){
						otherPhoneNumber = dcCasesCargo.getAuthrepOtherNum().toString();	
					}
				}
			
				if (otherPhoneNumber == null){
					otherPhoneNumber = "";	
				}
			%>
			 
            <td height="28" width="69"> 
				<TL:FWGroupPhoneTag beanId = "tDDOtherPhoneNumber" pageMode = "1" phone = ""  formName="form2"/> 
            </td>
            <%--End of FO774 --%>
          </tr>
        </table>
        <DIV id="ResultsTable" rows="10">
	<%if(repDynaList==null || repDynaList.size()==0){
	List<String> list = new ArrayList<String>();
	list.add("");%>
  <TL:FWSelectTag  bean="<%=dynaLoad%>" id="dynaLoad" size="5" multiple="Y" value="<%=list%>" display="<%=list%>" />   
  <script>
document.getElementById("dynaLoad").options.length=0;
</script>
<%}else{%>
  <TL:FWSelectTag  bean="<%=dynaLoad%>" id="dynaLoad" size="5" multiple="Y" value="<%=repDynaList%>" display="<%=repDynaList%>" />   
<%} %>  	

      	</DIV>
 <%@ include file = "/fwincludes/dynaTableButton.jsp" %> 
 <script>
	  document.getElementById("dynaResetButton").alt = 'Reset Approved Representative Details';
	
   </script> 
 <table width="723" class="bodytitleArea" role="presentation">
  <tr><td><H2 class="bodytitleArea">
 Approved Representative Summary</H2>
 </td></tr>
 </table>
<table width="723"  border="0" cellspacing="0" cellpadding="0" class="bodyDividerTable searchResultsBody" id="resultTableHeader" title="Approved Representative Summary" summary="Approved Representative Summary">
	<thead>
		<tr class="bodyDividerTableHeader" id="headerRow"> 
      		<th scope="col" class="bodyDividerTableResultsHeader rowHeader" width="300" 
      			dyntable-rowindex-decorator=" data ~">
      			<A href="" onkeyup="if((event.keyCode || event.charCode) == 32)return sortDynaTable(resultTableHeader,0)" onClick="javascript: return sortDynaTable(resultTableHeader,0)"><img src="/images/bulletRotated.gif" alt="Sort Representative Name Descending" title="Sort Representative Name Descending" align="absmiddle" border="0" name="sortImage0" dataType="AI"></A>
      			Representative Name
      		</th>
      		<th scope="col" class="bodyDividerTableResultsHeader" width="273"><A href="" onkeyup="if((event.keyCode || event.charCode) == 32)return sortDynaTable(resultTableHeader,1)" onClick="javascript: return sortDynaTable(resultTableHeader,1)"><img src="/images/bulletRotated.gif" alt="Sort Relationship to Individual Descending" title="Sort Relationship to Individual Descending" align="absmiddle" border="0" name="sortImage1" dataType="AI"></A>Relationship to Individual</th>     
      		<th scope="col" width="150">&nbsp;<TL:FWLabelTag bean="<%=action%>" colon="N"/></th>
		</tr>
  </thead>
  <tbody>
	    <tr><td></td></tr>
 </tbody>
</table>
<BR>
<table width="723" border="0" cellspacing="0" cellpadding="0">      
	<tr>
		<td>
        	<div align="right">
        	<!--  Removed button id's for ILIES-151863  -->
        	    <TL:FWButtonTag button="RESET_BUTTON"   name="actionButton3" other="onclick=\"doReset(document.form2);return false;\"" />
          	    <TL:FWButtonTag button="PREVIOUS_BUTTON"  name="actionButton4" />
           	    <TL:FWButtonTag button="NEXT_BUTTON"   name="submit" />              
	        </div>
		</td>
	</tr>
</table>
</DIV>
</form> 
<script>
	$("input[name='actionButton1']").click(function(){
		doReset(document.form2);
		return false;
	});
</script>
<%@ include file = "/fwincludes/dynaTable.jsp" %>
<%--ILIES-198422 When Authorized Rep is not being added in App reg process and in data collection, if the auth rep question answered "Yes" in Household Information page and 
no information to provide in Representative page, user can go back to Household page by clicking previous - for this, the validation is removed for previous button--%>
<input type="hidden" name="dynaTableValidate" id="dynaTableValidate" validate="validateButton();" value="">
<%/* EDITABLE - Action Buttons (You can change this include.) */%>	     

<TL:FWUpdateUserTag cargo="<%=dcCasesCargo%>" />         
<%/* NOT EDITABLE - End Outer HTML Table */%>	            
<%@ include file = "/fwincludes/dynaTableEnd.jsp" %>   
