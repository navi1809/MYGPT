if (SR-AIN23-RECIN.AIN22A-01-REPORT-DIFF != 0)
    AIN23W.WS-DIFF-SIGN-FLAG = "N";
    if (SR-AIN23-RECIN.AIN22A-01-REPORT-DIFF < 0)
      AIN23W.WS-TEMP-DIFF-AMT = -1 * SR-AIN23-RECIN.AIN22A-01-REPORT-DIFF;
      AIN23W.WS-DIFF-SIGN-FLAG = "Y";
    else
      AIN23W.WS-TEMP-DIFF-AMT = SR-AIN23-RECIN.AIN22A-01-REPORT-DIFF;
    end
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AIN23W.WS-TEMP-DIFF-AMT;
    FORMATW.DEC-COUNT = 2;
    FORMATW.LENGTH = 8;
    FORMATW.FORMAT-FLAG = "N";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AIN23W-DET.S-DIFF-AMT = FORMATW.OUTPUT-CHAR;
    if (AIN23W.WS-DIFF-SIGN-FLAG == "N")
      AIN23W-DET.S-DIFF-AMT-SIGN = " ";
    else
      AIN23W-DET.S-DIFF-AMT-SIGN = "-";
    end
  else
    AIN23W-DET.S-DIFF-AMT = "    0.00";
    AIN23W-DET.S-DIFF-AMT-SIGN = " ";
  end
  
  
  
  
Function REPP9-FORMAT-PROC()
  FORMATW.OUTPUT-CHAR = " ";
  FORMATW.COUNT1 = 18;
  FORMATW.COUNT2 = 18;
  if (FORMATW.DEC-COUNT != 0)
    FORMATW.COUNT1 = FORMATW.COUNT1 - (4 - FORMATW.DEC-COUNT);
    FORMATW.VAGen_INDEX = FORMATW.COUNT2 - FORMATW.DEC-COUNT;
    FORMATW.OP-ARRAY[VAGen_INDEX] = ".";
    FORMATW.LOOP = 0;
    while ((FORMATW.LOOP < FORMATW.DEC-COUNT))
      FORMATW.OP-ARRAY[COUNT2] = FORMATW.IP-ARRAY[COUNT1];
      FORMATW.COUNT1 = FORMATW.COUNT1 - 1;
      FORMATW.COUNT2 = FORMATW.COUNT2 - 1;
      FORMATW.LOOP = FORMATW.LOOP + 1;
    end
    FORMATW.LOOP = FORMATW.DEC-COUNT + 1;
    FORMATW.COUNT2 = FORMATW.COUNT2 - 1;
  else
    FORMATW.LOOP = 0;
    FORMATW.COUNT1 = FORMATW.COUNT1 - 4;
  end
  if ((FORMATW.INPUT-NUMBER < 1 && FORMATW.INPUT-NUMBER > -1))
    FORMATW.OP-ARRAY[COUNT2] = "0";
    FORMATW.LOOP = FORMATW.COUNT2;
    FORMATW.COUNT1 = FORMATW.LENGTH - (18 - FORMATW.LOOP);
  else
    FORMATW.VAGen_POSITION = 0;
    while ((FORMATW.LOOP < 18 && FORMATW.COUNT1 > 0
     && FORMATW.COUNT2 > 0))
      FORMATW.OP-ARRAY[COUNT2] = FORMATW.IP-ARRAY[COUNT1];
      FORMATW.VAGen_POSITION = FORMATW.VAGen_POSITION + 1;
      FORMATW.COUNT1 = FORMATW.COUNT1 - 1;
      FORMATW.COUNT2 = FORMATW.COUNT2 - 1;
      FORMATW.LOOP = FORMATW.LOOP + 1;
      if ((FORMATW.FORMAT-FLAG == "Y" && FORMATW.COUNT1 > 0
       && FORMATW.COUNT2 > 0))
        if ((FORMATW.VAGen_POSITION == 3))
          FORMATW.OP-ARRAY[COUNT2] = ",";
          FORMATW.COUNT2 = FORMATW.COUNT2 - 1;
          FORMATW.LOOP = FORMATW.LOOP + 1;
          FORMATW.VAGen_POSITION = 0;
        end
      end
    end
    while (FORMATW.COUNT1 > 0)
      if (IP-ARRAY[COUNT1] != "0")
        OUTPUT-CHAR = "ERR";
        return;
      end
      FORMATW.COUNT1 = FORMATW.COUNT1 - 1;
    end
    FORMATW.LOOP = 1;
    while ((FORMATW.OP-ARRAY[LOOP] == " ") || (FORMATW.OP-ARRAY[LOOP] == ",")
     || 
    FORMATW.OP-ARRAY[LOOP] == "0")
      FORMATW.LOOP = FORMATW.LOOP + 1;
    end
    FORMATW.COUNT1 = FORMATW.LENGTH - (18 - FORMATW.LOOP);
  end
  if ((FORMATW.COUNT1 <= 0))
    OUTPUT-CHAR = "ERR";
    return;
  end
  if ((FORMATW.COUNT1 <= 1 && (FORMATW.DOLLAR-FLAG == "Y" || 
  FORMATW.DOLLAR-FLAG == "S")))
    OUTPUT-CHAR = "ERR";
    return;
  end
  if ((FORMATW.DOLLAR-FLAG == "Y"))
    FORMATW.COUNT1 = FORMATW.COUNT1 - 1;
    FORMATW.OP1-ARRAY[COUNT1] = "$";
    FORMATW.COUNT1 = FORMATW.COUNT1 + 1;
  end
  if ((FORMATW.DOLLAR-FLAG == "S"))
    FORMATW.COUNT1 = FORMATW.COUNT1 - 1;
    FORMATW.OP1-ARRAY[COUNT1] = "-";
    FORMATW.COUNT1 = FORMATW.COUNT1 + 1;
  end
  while ((LOOP <= 18))
    FORMATW.OP1-ARRAY[COUNT1] = FORMATW.OP-ARRAY[LOOP];
    LOOP = LOOP + 1;
    COUNT1 = COUNT1 + 1;
  end
end // end REPP9-FORMAT-PROC