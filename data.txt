package IVA_Batch;
import egl.core.*;
import CommonMigratedParts.*;
import DataTables.*;
//*** PROGRAM=AMA03A ****
// COMPONENT NAME: AMA03A Intake Monthly Trans Summary - Total
// MAABD by Ca===============
// 
// DESCRIPTION:
// ============
// Statistical report of intake MAABD
// cases with details by aid code and intake
// activity
// 
// 
// 
// ***********************
Program AMA03A type basicProgram //VAGen Info - main batch program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes
  }

  // Data Declarations
  AMA03W AMA03W; // record
  AMA03W-DET AMA03W-DET; // record
  AMA03W-FOOTER AMA03W-FOOTER; // record
  AMA03W-HEAD AMA03W-HEAD; // record
  AMA03W-SUBH AMA03W-SUBH; // record
  CEP01W CEP01W; // record
  FORMATW FORMATW; // record
  GDW GDW; // record
  REP-COMMON REP-COMMON; // record
  REP-DATE REP-DATE; // record
  REP-EOFNOF REP-EOFNOF; // record
  SR-132REP-RECOUT SR-132REP-RECOUT; // record
  SR-AMA03-RECIN SR-AMA03-RECIN; // record
  SR-AMA44-RECIN SR-AMA44-RECIN; // record
  VDBCOMMON VDBCOMMON; // record
  VDBCONTROL VDBCONTROL; // record
  VMESSAGE VMESSAGE; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use VDB00T1 {deleteAfterUse = yes}; // table

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    AMA03P9-MAIN: AMA03P9-MAIN();
  end // end main
end // end AMA03A


// ADD UP TOTALS
Function AMA03P9-ACUM-DET()
  /* total*/
   /* start wi # 15116*/
  AMA03W.WS-DNL-CNT-TOTAL = AMA03W.WS-DNL-CNT-HBW + AMA03W.WS-DNL-CNT-QMB +   AMA03W.WS-DNL-CNT-SSI + AMA03W.WS-DNL-CNT-STA-INS +   AMA03W.WS-DNL-CNT-KB + AMA03W.WS-DNL-CNT-GCW +   AMA03W.WS-DNL-CNT-SLMB + AMA03W.WS-DNL-CNT-RETARD +   AMA03W.WS-DNL-CNT-QDWI + AMA03W.WS-DNL-CNT-PUB-LAW +   AMA03W.WS-DNL-CNT-EME-MED + AMA03W.WS-DNL-CNT-QI1 +   AMA03W.WS-DNL-CNT-QI2;
  /* end wi # 15116*/

  /* TOTAL FOR FOOTER*/
  AMA03W.WS-DNL-CNT-AC-TOT-HBW = AMA03W.WS-DNL-CNT-AC-TOT-HBW   + AMA03W.WS-DNL-CNT-HBW;
  AMA03W.WS-DNL-CNT-AC-TOT-QMB = AMA03W.WS-DNL-CNT-AC-TOT-QMB   + AMA03W.WS-DNL-CNT-QMB;
  AMA03W.WS-DNL-CNT-AC-TOT-SSI = AMA03W.WS-DNL-CNT-AC-TOT-SSI   + AMA03W.WS-DNL-CNT-SSI;
  AMA03W.WS-DNL-CNT-AC-TOT-STA-INS = AMA03W.WS-DNL-CNT-AC-TOT-STA-INS   + AMA03W.WS-DNL-CNT-STA-INS;
  AMA03W.WS-DNL-CNT-AC-TOT-KB = AMA03W.WS-DNL-CNT-AC-TOT-KB   + AMA03W.WS-DNL-CNT-KB;
  AMA03W.WS-DNL-CNT-AC-TOT-GCW = AMA03W.WS-DNL-CNT-AC-TOT-GCW   + AMA03W.WS-DNL-CNT-GCW;
  AMA03W.WS-DNL-CNT-AC-TOT-SLMB = AMA03W.WS-DNL-CNT-AC-TOT-SLMB   + AMA03W.WS-DNL-CNT-SLMB;
  AMA03W.WS-DNL-CNT-AC-TOT-RETARD = AMA03W.WS-DNL-CNT-AC-TOT-RETARD   + AMA03W.WS-DNL-CNT-RETARD;
  AMA03W.WS-DNL-CNT-AC-TOT-QDWI = AMA03W.WS-DNL-CNT-AC-TOT-QDWI   + AMA03W.WS-DNL-CNT-QDWI;
  AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW = AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW   + AMA03W.WS-DNL-CNT-PUB-LAW;
  AMA03W.WS-DNL-CNT-AC-TOT-EME-MED = AMA03W.WS-DNL-CNT-AC-TOT-EME-MED   + AMA03W.WS-DNL-CNT-EME-MED;
  /* start wi # 15116*/
  AMA03W.WS-DNL-CNT-AC-TOT-QI1 = AMA03W.WS-DNL-CNT-AC-TOT-QI1   + AMA03W.WS-DNL-CNT-QI1;
  AMA03W.WS-DNL-CNT-AC-TOT-QI2 = AMA03W.WS-DNL-CNT-AC-TOT-QI2   + AMA03W.WS-DNL-CNT-QI2;
  /* end wi # 15116*/
  AMA03W.WS-DNL-CNT-AC-TOT-TOTAL = AMA03W.WS-DNL-CNT-AC-TOT-TOTAL   + AMA03W.WS-DNL-CNT-TOTAL;
end // end AMA03P9-ACUM-DET


// ADD UP STATEWIDE FIGURES
Function AMA03P9-ACUM-OFF()
  /* CBSI start;*/
  /* accumulate figures for office wise report*/
  if (AMA03W.WS-PREV-CLSRE-RSN-CD == "1")
    AMA03W.WS-AMA03-INDEX = 1;
    AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
    AMA03W.WS-ST-REC-FND = "Y";
  else
    if (AMA03W.WS-PREV-CLSRE-RSN-CD == "2")
      AMA03W.WS-AMA03-INDEX = 2;
      AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
      AMA03W.WS-ST-REC-FND = "Y";
    else
      if (AMA03W.WS-PREV-CLSRE-RSN-CD == "3")
        AMA03W.WS-AMA03-INDEX = 3;
        AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
        AMA03W.WS-ST-REC-FND = "Y";
      else
        if (AMA03W.WS-PREV-CLSRE-RSN-CD == "4")
          AMA03W.WS-AMA03-INDEX = 4;
          AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
          AMA03W.WS-ST-REC-FND = "Y";
        else
          if (AMA03W.WS-PREV-CLSRE-RSN-CD == "5")
            AMA03W.WS-AMA03-INDEX = 5;
            AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
            AMA03W.WS-ST-REC-FND = "Y";
          else
            if (AMA03W.WS-PREV-CLSRE-RSN-CD == "6")
              AMA03W.WS-AMA03-INDEX = 6;
              AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
              AMA03W.WS-ST-REC-FND = "Y";
            else
              if (AMA03W.WS-PREV-CLSRE-RSN-CD == "7")
                AMA03W.WS-AMA03-INDEX = 7;
                AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
                AMA03W.WS-ST-REC-FND = "Y";
              else
                if (AMA03W.WS-PREV-CLSRE-RSN-CD == "8")
                  AMA03W.WS-AMA03-INDEX = 8;
                  AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
                  AMA03W.WS-ST-REC-FND = "Y";
                else
                  if (AMA03W.WS-PREV-CLSRE-RSN-CD == "9")
                    AMA03W.WS-AMA03-INDEX = 9;
                    AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
                    AMA03W.WS-ST-REC-FND = "Y";
                  end
                end
              end
            end
          end
        end
      end
    end
  end
  if (AMA03W.WS-ST-REC-FND == "Y")
    AMA03W.WS-ST-REC-FND = "N";
    AMA03W.WS-OF-DEN-RSN[WS-AMA03-INDEX] = AMA03W.WS-DEN-RSN-TRUNC;
    AMA03W.WS-OF-DNL-CNT-HBW[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-HBW[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-HBW;
    AMA03W.WS-OF-DNL-CNT-QMB[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-QMB[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QMB;
    AMA03W.WS-OF-DNL-CNT-SSI[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-SSI[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-SSI;
    AMA03W.WS-OF-DNL-CNT-STA-INS[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-STA-INS[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-STA-INS;
    AMA03W.WS-OF-DNL-CNT-KB[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-KB[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-KB;
    AMA03W.WS-OF-DNL-CNT-GCW[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-GCW[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-GCW;
    AMA03W.WS-OF-DNL-CNT-SLMB[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-SLMB[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-SLMB;
    AMA03W.WS-OF-DNL-CNT-RETARD[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-RETARD[WS-AMA03-INDEX]     + AMA03W.WS-DNL-CNT-RETARD;
    AMA03W.WS-OF-DNL-CNT-QDWI[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-QDWI[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QDWI;
    AMA03W.WS-OF-DNL-CNT-PUB-LAW[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-PUB-LAW[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-PUB-LAW;
    AMA03W.WS-OF-DNL-CNT-EME-MED[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-EME-MED[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-EME-MED;
    AMA03W.WS-OF-DNL-CNT-QI1[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-QI1[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QI1;
    AMA03W.WS-OF-DNL-CNT-QI2[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-QI2[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QI2;
    AMA03W.WS-OF-DNL-CNT-TOTAL[WS-AMA03-INDEX] = AMA03W.WS-OF-DNL-CNT-TOTAL[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-TOTAL;
    AMA03W.WS-AMA03-INDEX = 0;
  end
  /* CBSI end;*/
end // end AMA03P9-ACUM-OFF


// ADD UP DENIAL COLUMNS
Function AMA03P9-ACUM-OFFOT()
  /* CBSI start;*/
  AMA03W.WS-AMA03-INDEX = 1;
  while (AMA03W.WS-AMA03-INDEX <= 9)
    if (AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] == "Y")
      AMA03W.WS-DNL-CNT-AC-TOT-HBW = AMA03W.WS-DNL-CNT-AC-TOT-HBW       + AMA03W.WS-OF-DNL-CNT-HBW[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-QMB = AMA03W.WS-DNL-CNT-AC-TOT-QMB       + AMA03W.WS-OF-DNL-CNT-QMB[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-SSI = AMA03W.WS-DNL-CNT-AC-TOT-SSI       + AMA03W.WS-OF-DNL-CNT-SSI[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-STA-INS = AMA03W.WS-DNL-CNT-AC-TOT-STA-INS       + AMA03W.WS-OF-DNL-CNT-STA-INS[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-KB = AMA03W.WS-DNL-CNT-AC-TOT-KB       + AMA03W.WS-OF-DNL-CNT-KB[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-GCW = AMA03W.WS-DNL-CNT-AC-TOT-GCW       + AMA03W.WS-OF-DNL-CNT-GCW[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-SLMB = AMA03W.WS-DNL-CNT-AC-TOT-SLMB       + AMA03W.WS-OF-DNL-CNT-SLMB[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-RETARD = AMA03W.WS-DNL-CNT-AC-TOT-RETARD       + AMA03W.WS-OF-DNL-CNT-RETARD[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-QDWI = AMA03W.WS-DNL-CNT-AC-TOT-QDWI       + AMA03W.WS-OF-DNL-CNT-QDWI[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW = AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW       + AMA03W.WS-OF-DNL-CNT-PUB-LAW[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-EME-MED = AMA03W.WS-DNL-CNT-AC-TOT-EME-MED       + AMA03W.WS-OF-DNL-CNT-EME-MED[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-QI1 = AMA03W.WS-DNL-CNT-AC-TOT-QI1       + AMA03W.WS-OF-DNL-CNT-QI1[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-QI2 = AMA03W.WS-DNL-CNT-AC-TOT-QI2       + AMA03W.WS-OF-DNL-CNT-QI2[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-TOTAL = AMA03W.WS-DNL-CNT-AC-TOT-TOTAL       + AMA03W.WS-OF-DNL-CNT-TOTAL[WS-AMA03-INDEX];
    end
    AMA03W.WS-AMA03-INDEX = AMA03W.WS-AMA03-INDEX + 1;
  end
  /* CBSI end;*/
end // end AMA03P9-ACUM-OFFOT


// ADD UP STATEWIDE FIGURES
Function AMA03P9-ACUM-ST()
  /* Rework due to PTR# 10480, all ARX04A changed to AMA44A*/
  /* no longer using H2-OFFICEOR H2-CODE.*/
  /* accumulate figures for state wide report*/

  if (AMA03W.WS-PREV-CLSRE-RSN-CD == "1")
    AMA03W.WS-AMA03-INDEX = 1;
    AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
    AMA03W.WS-ST-REC-FND = "Y";
  else
    if (AMA03W.WS-PREV-CLSRE-RSN-CD == "2")
      AMA03W.WS-AMA03-INDEX = 2;
      AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
      AMA03W.WS-ST-REC-FND = "Y";
    else
      if (AMA03W.WS-PREV-CLSRE-RSN-CD == "3")
        AMA03W.WS-AMA03-INDEX = 3;
        AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
        AMA03W.WS-ST-REC-FND = "Y";
      else
        if (AMA03W.WS-PREV-CLSRE-RSN-CD == "4")
          AMA03W.WS-AMA03-INDEX = 4;
          AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
          AMA03W.WS-ST-REC-FND = "Y";
        else
          if (AMA03W.WS-PREV-CLSRE-RSN-CD == "5")
            AMA03W.WS-AMA03-INDEX = 5;
            AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
            AMA03W.WS-ST-REC-FND = "Y";
          else
            if (AMA03W.WS-PREV-CLSRE-RSN-CD == "6")
              AMA03W.WS-AMA03-INDEX = 6;
              AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
              AMA03W.WS-ST-REC-FND = "Y";
            else
              if (AMA03W.WS-PREV-CLSRE-RSN-CD == "7")
                AMA03W.WS-AMA03-INDEX = 7;
                AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
                AMA03W.WS-ST-REC-FND = "Y";
              else
                if (AMA03W.WS-PREV-CLSRE-RSN-CD == "8")
                  AMA03W.WS-AMA03-INDEX = 8;
                  AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
                  AMA03W.WS-ST-REC-FND = "Y";
                else
                  if (AMA03W.WS-PREV-CLSRE-RSN-CD == "9")
                    AMA03W.WS-AMA03-INDEX = 9;
                    AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] = "Y";
                    AMA03W.WS-ST-REC-FND = "Y";
                  end
                end
              end
            end
          end
        end
      end
    end
  end
  if (AMA03W.WS-ST-REC-FND == "Y")
    AMA03W.WS-ST-REC-FND = "N";
    AMA03W.WS-ST-DEN-RSN[WS-AMA03-INDEX] = AMA03W.WS-DEN-RSN-TRUNC;
    AMA03W.WS-ST-DNL-CNT-HBW[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-HBW[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-HBW;
    AMA03W.WS-ST-DNL-CNT-QMB[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-QMB[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QMB;
    AMA03W.WS-ST-DNL-CNT-SSI[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-SSI[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-SSI;
    AMA03W.WS-ST-DNL-CNT-STA-INS[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-STA-INS[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-STA-INS;
    AMA03W.WS-ST-DNL-CNT-KB[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-KB[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-KB;
    AMA03W.WS-ST-DNL-CNT-GCW[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-GCW[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-GCW;
    AMA03W.WS-ST-DNL-CNT-SLMB[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-SLMB[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-SLMB;
    AMA03W.WS-ST-DNL-CNT-RETARD[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-RETARD[WS-AMA03-INDEX]     + AMA03W.WS-DNL-CNT-RETARD;
    AMA03W.WS-ST-DNL-CNT-QDWI[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-QDWI[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QDWI;
    AMA03W.WS-ST-DNL-CNT-PUB-LAW[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-PUB-LAW[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-PUB-LAW;
    AMA03W.WS-ST-DNL-CNT-EME-MED[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-EME-MED[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-EME-MED;
  /* start wi # 15116*/
    AMA03W.WS-ST-DNL-CNT-QI1[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-QI1[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QI1;
    AMA03W.WS-ST-DNL-CNT-QI2[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-QI2[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-QI2;
  /* end  wi # 15116*/
    AMA03W.WS-ST-DNL-CNT-TOTAL[WS-AMA03-INDEX] = AMA03W.WS-ST-DNL-CNT-TOTAL[WS-AMA03-INDEX] +     AMA03W.WS-DNL-CNT-TOTAL;
    AMA03W.WS-AMA03-INDEX = 0;
  end
end // end AMA03P9-ACUM-ST


// ADD UP DENIAL COLUMNS
Function AMA03P9-ACUM-STFOT()
  /* Rework due to PTR# 10480, all ARX04A changed to AMA44A*/
  /* no longer using H2-OFFICEOR H2-CODE.*/
  AMA03W.WS-AMA03-INDEX = 1;
  while (AMA03W.WS-AMA03-INDEX <= 9)
    if (AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] == "Y")
      AMA03W.WS-DNL-CNT-AC-TOT-HBW = AMA03W.WS-DNL-CNT-AC-TOT-HBW       + AMA03W.WS-ST-DNL-CNT-HBW[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-QMB = AMA03W.WS-DNL-CNT-AC-TOT-QMB       + AMA03W.WS-ST-DNL-CNT-QMB[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-SSI = AMA03W.WS-DNL-CNT-AC-TOT-SSI       + AMA03W.WS-ST-DNL-CNT-SSI[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-STA-INS = AMA03W.WS-DNL-CNT-AC-TOT-STA-INS       + AMA03W.WS-ST-DNL-CNT-STA-INS[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-KB = AMA03W.WS-DNL-CNT-AC-TOT-KB       + AMA03W.WS-ST-DNL-CNT-KB[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-GCW = AMA03W.WS-DNL-CNT-AC-TOT-GCW       + AMA03W.WS-ST-DNL-CNT-GCW[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-SLMB = AMA03W.WS-DNL-CNT-AC-TOT-SLMB       + AMA03W.WS-ST-DNL-CNT-SLMB[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-RETARD = AMA03W.WS-DNL-CNT-AC-TOT-RETARD       + AMA03W.WS-ST-DNL-CNT-RETARD[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-QDWI = AMA03W.WS-DNL-CNT-AC-TOT-QDWI       + AMA03W.WS-ST-DNL-CNT-QDWI[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW = AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW       + AMA03W.WS-ST-DNL-CNT-PUB-LAW[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-EME-MED = AMA03W.WS-DNL-CNT-AC-TOT-EME-MED       + AMA03W.WS-ST-DNL-CNT-EME-MED[WS-AMA03-INDEX];
  /* start wi # 15116*/
      AMA03W.WS-DNL-CNT-AC-TOT-QI1 = AMA03W.WS-DNL-CNT-AC-TOT-QI1       + AMA03W.WS-ST-DNL-CNT-QI1[WS-AMA03-INDEX];
      AMA03W.WS-DNL-CNT-AC-TOT-QI2 = AMA03W.WS-DNL-CNT-AC-TOT-QI2       + AMA03W.WS-ST-DNL-CNT-QI2[WS-AMA03-INDEX];
  /* end wi # 15116*/
      AMA03W.WS-DNL-CNT-AC-TOT-TOTAL = AMA03W.WS-DNL-CNT-AC-TOT-TOTAL       + AMA03W.WS-ST-DNL-CNT-TOTAL[WS-AMA03-INDEX];
    end
    AMA03W.WS-AMA03-INDEX = AMA03W.WS-AMA03-INDEX + 1;
  end
end // end AMA03P9-ACUM-STFOT


// APPL   ADDITIONAL PROCESSING
Function AMA03P9-APPLSPEC()
  /* cbsi start*/
  /* Rework due to PTR# 10480, all ARX04A changed to AMA44A*/
  /* no longer using H2-OFFICE OR H2-CODE.*/
  /* control break check*/
  if ((AMA03W.WS-PREV-OFC-CD != SR-AMA44-RECIN.PCE-OFC-CD))
    if (AMA03W.WS-CLSRE-REC-FND == "Y")
    /* AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;*/
      AMA03W.WS-PREV-AID-CD = SR-AMA44-RECIN.PCE-AID-CD;
      AMA03P9-ACUM-DET();
    /* modification for getting office totals - WI#16615  -  start;*/
      AMA03P9-ACUM-OFF();
    /* modification for getting office totals - WI#16615  -  end;*/
      AMA03P9-ACUM-ST();
      AMA03P9-POP-DET();
    /* perform process to print the details*/
      AMA03P9-PRN-DETAIL();
      AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;
      AMA03W.WS-CLSRE-REC-FND = "N";
    end
    if (AMA03W.WS-PB-REC-FND == "Y")
      AMA03P9-POP-FOOTER();
      AMA03P9-PRN-FOOTER();
      AMA03W.WS-PB-REC-FND = "N";
    end
    /* reset all total variables*/
    AMA03P9-INIT-TOT();
    AMA03P9-INIT-FOTOT();
    /* modification for getting office totals - WI#16615  -  start;*/
    AMA03P9-OF-PRN();
    AMA03P9-INIT-FOTOT();
    AMA03P9-INIT-OFFIC();
    /* modification for getting office totals - WI#16615  -  end;*/
    AMA03W.WS-PREV-OFC-CD = SR-AMA44-RECIN.PCE-OFC-CD;
    AMA03W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
    AMA03W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
    AMA03W.WS-OFC-NM = SR-AMA44-RECIN.PCE-OFC-NM;
    REP-COMMON.WS-NEW-PAGE = "Y";
  else
    if ((AMA03W.WS-PREV-CASLD-ID != SR-AMA44-RECIN.PCE-CASLD-ID))
      if (AMA03W.WS-CLSRE-REC-FND == "Y")
      /* AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;*/
        AMA03P9-ACUM-DET();
      /* modification for getting office totals - WI#16615  -  start;*/
        AMA03P9-ACUM-OFF();
      /* modification for getting office totals - WI#16615  -  end;*/
        AMA03P9-ACUM-ST();
        AMA03P9-POP-DET();
      /* perform process to print the details*/
        AMA03P9-PRN-DETAIL();
        AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;
        AMA03W.WS-CLSRE-REC-FND = "N";
      end
      if (AMA03W.WS-PB-REC-FND == "Y")
        AMA03P9-POP-FOOTER();
        AMA03P9-PRN-FOOTER();
        AMA03W.WS-PB-REC-FND = "N";
      end
    /* reset all total variables*/
      AMA03P9-INIT-TOT();
      AMA03P9-INIT-FOTOT();
      AMA03W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
      AMA03W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
      REP-COMMON.WS-NEW-PAGE = "Y";
    else
      if ((AMA03W.WS-PREV-CLSRE-RSN-CD != SR-AMA44-RECIN.PCE-RSN-CD))
        if (AMA03W.WS-CLSRE-REC-FND == "Y")
          AMA03P9-ACUM-DET();
          /* modification for getting office totals - WI#16615  -  start;*/
          AMA03P9-ACUM-OFF();
          /* modification for getting office totals - WI#16615  -  end;*/
          AMA03P9-ACUM-ST();
          AMA03P9-POP-DET();
          /* perform process to print the details*/
          AMA03P9-PRN-DETAIL();
          AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;
          AMA03W.WS-CLSRE-REC-FND = "N";
        end
        AMA03P9-INIT-TOT();
        AMA03W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
      end
    end
  end

  AMA03P9-CHK-AIDCD();

  if (AMA03W.WS-CLSRE-REC-FND == "Y")
    AMA03W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
    AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;
  end

  /* cbsi end*/
end // end AMA03P9-APPLSPEC


// ADD UP AID CODES
Function AMA03P9-CHK-AIDCD()
  /* Rework due to PTR# 10480, all ARX04A changed to AMA44A*/
  /* no longer using H2-OFFICE OR H2-CODE.*/
  if (SR-AMA44-RECIN.PCE-AID-CD == "HC1" || 
  SR-AMA44-RECIN.PCE-AID-CD == "HD3" || 
  SR-AMA44-RECIN.PCE-AID-CD == "HD5" || 
  SR-AMA44-RECIN.PCE-AID-CD == "HD9")
    AMA03W.WS-DNL-CNT-HBW = AMA03W.WS-DNL-CNT-HBW + 1;
    AMA03W.WS-REC-FOUND = "Y";
    AMA03W.WS-CLSRE-REC-FND = "Y";
    AMA03W.WS-PB-REC-FND = "Y";
  else
    if (SR-AMA44-RECIN.PCE-AID-CD == "QM1" || 
    SR-AMA44-RECIN.PCE-AID-CD == "QM3" || 
    SR-AMA44-RECIN.PCE-AID-CD == "QM5" || 
    SR-AMA44-RECIN.PCE-AID-CD == "QM9")
      AMA03W.WS-DNL-CNT-QMB = AMA03W.WS-DNL-CNT-QMB + 1;
      AMA03W.WS-REC-FOUND = "Y";
      AMA03W.WS-CLSRE-REC-FND = "Y";
      AMA03W.WS-PB-REC-FND = "Y";
    else
      if (SR-AMA44-RECIN.PCE-AID-CD == "GC1" || 
      SR-AMA44-RECIN.PCE-AID-CD == "GC3" || 
      SR-AMA44-RECIN.PCE-AID-CD == "GC5" || 
      SR-AMA44-RECIN.PCE-AID-CD == "GC9" || 
      SR-AMA44-RECIN.PCE-AID-CD == "SS1" || 
      SR-AMA44-RECIN.PCE-AID-CD == "SS3" || 
      SR-AMA44-RECIN.PCE-AID-CD == "SS5" || 
      SR-AMA44-RECIN.PCE-AID-CD == "SS9" || 
      SR-AMA44-RECIN.PCE-AID-CD == "IN1" || 
      SR-AMA44-RECIN.PCE-AID-CD == "IN3" || 
      SR-AMA44-RECIN.PCE-AID-CD == "IN5" || 
      SR-AMA44-RECIN.PCE-AID-CD == "IN9")
        AMA03W.WS-DNL-CNT-SSI = AMA03W.WS-DNL-CNT-SSI + 1;
        AMA03W.WS-REC-FOUND = "Y";
        AMA03W.WS-CLSRE-REC-FND = "Y";
        AMA03W.WS-PB-REC-FND = "Y";
      else
        if (SR-AMA44-RECIN.PCE-AID-CD == "CM1" || 
        SR-AMA44-RECIN.PCE-AID-CD == "CM3" || 
        SR-AMA44-RECIN.PCE-AID-CD == "CM5" || 
        SR-AMA44-RECIN.PCE-AID-CD == "CM9" || 
        SR-AMA44-RECIN.PCE-AID-CD == "WB1" || 
        SR-AMA44-RECIN.PCE-AID-CD == "WB3" || 
        SR-AMA44-RECIN.PCE-AID-CD == "WB5" || 
        SR-AMA44-RECIN.PCE-AID-CD == "WB9" || 
        SR-AMA44-RECIN.PCE-AID-CD == "SI1" || 
        SR-AMA44-RECIN.PCE-AID-CD == "SI3" || 
        SR-AMA44-RECIN.PCE-AID-CD == "SI5" || 
        SR-AMA44-RECIN.PCE-AID-CD == "SI9")
          AMA03W.WS-DNL-CNT-STA-INS = AMA03W.WS-DNL-CNT-STA-INS + 1;
          AMA03W.WS-REC-FOUND = "Y";
          AMA03W.WS-CLSRE-REC-FND = "Y";
          AMA03W.WS-PB-REC-FND = "Y";
        else
          if (SR-AMA44-RECIN.PCE-AID-CD == "KB3" || 
          SR-AMA44-RECIN.PCE-AID-CD == "KB5" || 
          SR-AMA44-RECIN.PCE-AID-CD == "KB9")
            AMA03W.WS-DNL-CNT-KB = AMA03W.WS-DNL-CNT-KB + 1;
            AMA03W.WS-REC-FOUND = "Y";
            AMA03W.WS-CLSRE-REC-FND = "Y";
            AMA03W.WS-PB-REC-FND = "Y";
          else
            if (SR-AMA44-RECIN.PCE-AID-CD == "SL1" || 
            SR-AMA44-RECIN.PCE-AID-CD == "SL3" || 
            SR-AMA44-RECIN.PCE-AID-CD == "SL5" || 
            SR-AMA44-RECIN.PCE-AID-CD == "SL9")
              AMA03W.WS-DNL-CNT-SLMB = AMA03W.WS-DNL-CNT-SLMB + 1;
              AMA03W.WS-REC-FOUND = "Y";
              AMA03W.WS-CLSRE-REC-FND = "Y";
              AMA03W.WS-PB-REC-FND = "Y";
            end
          end
        end
      end
    end
  end

  if (SR-AMA44-RECIN.PCE-AID-CD == "HG1" || 
  SR-AMA44-RECIN.PCE-AID-CD == "HG3" || 
  SR-AMA44-RECIN.PCE-AID-CD == "HG5" || 
  SR-AMA44-RECIN.PCE-AID-CD == "HG9")
    AMA03W.WS-DNL-CNT-GCW = AMA03W.WS-DNL-CNT-GCW + 1;
    AMA03W.WS-REC-FOUND = "Y";
    AMA03W.WS-CLSRE-REC-FND = "Y";
    AMA03W.WS-PB-REC-FND = "Y";
  else
    if (SR-AMA44-RECIN.PCE-AID-CD == "HR9" || 
    SR-AMA44-RECIN.PCE-AID-CD == "HR5")
      AMA03W.WS-DNL-CNT-RETARD = AMA03W.WS-DNL-CNT-RETARD + 1;
      AMA03W.WS-REC-FOUND = "Y";
      AMA03W.WS-CLSRE-REC-FND = "Y";
      AMA03W.WS-PB-REC-FND = "Y";
    end
  end

  if (SR-AMA44-RECIN.PCE-AID-CD == "QD3" || 
  SR-AMA44-RECIN.PCE-AID-CD == "QD5" || 
  SR-AMA44-RECIN.PCE-AID-CD == "QD9")
    AMA03W.WS-DNL-CNT-QDWI = AMA03W.WS-DNL-CNT-QDWI + 1;
    AMA03W.WS-REC-FOUND = "Y";
    AMA03W.WS-CLSRE-REC-FND = "Y";
    AMA03W.WS-PB-REC-FND = "Y";
  else
    if (SR-AMA44-RECIN.PCE-AID-CD in AMA03W.WS-PUB-LAW-ARRY)
      AMA03W.WS-DNL-CNT-PUB-LAW = AMA03W.WS-DNL-CNT-PUB-LAW + 1;
      AMA03W.WS-REC-FOUND = "Y";
      AMA03W.WS-CLSRE-REC-FND = "Y";
      AMA03W.WS-PB-REC-FND = "Y";
    else
      if (SR-AMA44-RECIN.PCE-AID-CD == "EM1" || 
      SR-AMA44-RECIN.PCE-AID-CD == "EM3" || 
      SR-AMA44-RECIN.PCE-AID-CD == "EM9")
        AMA03W.WS-DNL-CNT-EME-MED = AMA03W.WS-DNL-CNT-EME-MED + 1;
        AMA03W.WS-REC-FOUND = "Y";
        AMA03W.WS-CLSRE-REC-FND = "Y";
        AMA03W.WS-PB-REC-FND = "Y";
      else
  /* start wi # 15116*/
        if (SR-AMA44-RECIN.PCE-AID-CD == "QI1" || 
        SR-AMA44-RECIN.PCE-AID-CD == "QI3" || 
        SR-AMA44-RECIN.PCE-AID-CD == "QI9")
          AMA03W.WS-DNL-CNT-QI1 = AMA03W.WS-DNL-CNT-QI1 + 1;
          AMA03W.WS-REC-FOUND = "Y";
          AMA03W.WS-CLSRE-REC-FND = "Y";
          AMA03W.WS-PB-REC-FND = "Y";
        else
          if (SR-AMA44-RECIN.PCE-AID-CD == "QJ1" || 
          SR-AMA44-RECIN.PCE-AID-CD == "QJ3" || 
          SR-AMA44-RECIN.PCE-AID-CD == "QJ9")
            AMA03W.WS-DNL-CNT-QI2 = AMA03W.WS-DNL-CNT-QI2 + 1;
            AMA03W.WS-REC-FOUND = "Y";
            AMA03W.WS-CLSRE-REC-FND = "Y";
            AMA03W.WS-PB-REC-FND = "Y";
          end
        end
  /* end wi # 15116*/
      end
    end
  end
end // end AMA03P9-CHK-AIDCD


// CLOSE PROCESS
Function AMA03P9-CLOS-PARA()
  /* cbsi start*/
  exit program;
  /* cbsi end*/
end // end AMA03P9-CLOS-PARA


// FORMAT PROCESS
Function AMA03P9-FORMAT4()
  FORMATW.LENGTH = 4;
  FORMATW.DEC-COUNT = 0;
  FORMATW.FORMAT-FLAG = "N";
  FORMATW.DOLLAR-FLAG = "N";
  REPP9-FORMAT-PROC();
end // end AMA03P9-FORMAT4


// FORMAT PROCESS
Function AMA03P9-FORMAT5()
  FORMATW.LENGTH = 5;
  FORMATW.DEC-COUNT = 0;
  FORMATW.FORMAT-FLAG = "N";
  FORMATW.DOLLAR-FLAG = "N";
  REPP9-FORMAT-PROC();
end // end AMA03P9-FORMAT5


// INITIALIZE FOOTER TOTALS
Function AMA03P9-INIT-FOTOT()
  AMA03W.WS-DNL-CNT-AC-TOT-HBW = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-QMB = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-SSI = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-STA-INS = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-KB = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-GCW = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-SLMB = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-RETARD = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-QDWI = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-EME-MED = 0;
  /* start wi # 15116*/
  AMA03W.WS-DNL-CNT-AC-TOT-QI1 = 0;
  AMA03W.WS-DNL-CNT-AC-TOT-QI2 = 0;
  /* end wi # 15116*/
  AMA03W.WS-DNL-CNT-AC-TOT-TOTAL = 0;
end // end AMA03P9-INIT-FOTOT


// INITIALIZE REASON TOTALS
Function AMA03P9-INIT-OFFIC()
  AMA03W.WS-OF-DNL-CNT-HBW = 0;
  AMA03W.WS-OF-DNL-CNT-QMB = 0;
  AMA03W.WS-OF-DNL-CNT-SSI = 0;
  AMA03W.WS-OF-DNL-CNT-STA-INS = 0;
  AMA03W.WS-OF-DNL-CNT-KB = 0;
  AMA03W.WS-OF-DNL-CNT-GCW = 0;
  AMA03W.WS-OF-DNL-CNT-SLMB = 0;
  AMA03W.WS-OF-DNL-CNT-RETARD = 0;
  AMA03W.WS-OF-DNL-CNT-QDWI = 0;
  AMA03W.WS-OF-DNL-CNT-PUB-LAW = 0;
  AMA03W.WS-OF-DNL-CNT-EME-MED = 0;
  AMA03W.WS-OF-DNL-CNT-QI1 = 0;
  AMA03W.WS-OF-DNL-CNT-QI2 = 0;
  AMA03W.WS-OF-DNL-CNT-TOTAL = 0;
end // end AMA03P9-INIT-OFFIC


// initialize additional recoRDS
Function AMA03P9-INIT-PARA()
  /* cbsi start*/
  /* perform process to initialize all additional records*/
  AMA03P9-SET-EMPTY();
  /* set all report variables to initial values*/
  /* ws-page-no      - current printing page number*/
  /* ws-line-no      - current page line no*/
  /* ws-new-page     - a new page indicator*/
  /* ws-max-no-lines - lineage for a standard report frame*/

  REP-COMMON.WS-PAGE-NO = 0;
  REP-COMMON.WS-LINE-NO = 1;
  REP-COMMON.WS-NEW-PAGE = "Y";
  AMA03W.WS-FIRST-TM-IND = "Y";
  AMA03W.WS-REC-FOUND = "N";
  REP-COMMON.WS-MAX-NO-LINES = 56;

  /* set standard header variables*/

  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  REP-COMMON.WS-DT = GDW.DTL; /* current date*/
  REP-COMMON.WS-YEAR = REP-COMMON.WS-YY;
  REP-COMMON.WS-MONTH = REP-COMMON.WS-MM;
  REP-COMMON.WS-DAY = REP-COMMON.WS-DD;
  REP-COMMON.WS-F1 = "/";
  REP-COMMON.WS-F2 = "/";
  AMA03W-HEAD.UDATE = REP-COMMON.WS-DATE; /* report date*/
  AMA03W-HEAD.UTIME = VGVar.currentFormattedTime; /* current time*/
  AMA03W-HEAD.UAPPL = "AMA03A"; /* report name*/

  /* perform process to initialize constants*/

  AMA03P9-INITCON();

  /* perform process to read input parameter file*/
  /* validate date parameters, mandatory fields for*/
  /* input records*/
  AMA03P9-READIP();

  /* perform  process for validation of input parameters*/
  AMA03P9-VALIDATE();


  /* populate application specific header*/
  AMA03W-HEAD.S-REPYR = AMA03W.WS-RPT-DT-CCYY;

  /* populate  header variables*/

  if ((AMA03W.WS-RPT-MONTH-MM == 01))
    AMA03W-HEAD.S-REPMTH = "   JANUARY,";
  else
    if ((AMA03W.WS-RPT-MONTH-MM == 02))
      AMA03W-HEAD.S-REPMTH = "  FEBRUARY,";
    else
      if ((AMA03W.WS-RPT-MONTH-MM == 03))
        AMA03W-HEAD.S-REPMTH = "     MARCH,";
      else
        if ((AMA03W.WS-RPT-MONTH-MM == 04))
          AMA03W-HEAD.S-REPMTH = "     APRIL,";
        else
          if ((AMA03W.WS-RPT-MONTH-MM == 05))
            AMA03W-HEAD.S-REPMTH = "       MAY,";
          else
            if ((AMA03W.WS-RPT-MONTH-MM == 06))
              AMA03W-HEAD.S-REPMTH = "      JUNE,";
            else
              if ((AMA03W.WS-RPT-MONTH-MM == 07))
                AMA03W-HEAD.S-REPMTH = "      JULY,";
              else
                if ((AMA03W.WS-RPT-MONTH-MM == 08))
                  AMA03W-HEAD.S-REPMTH = "    AUGUST,";
                else
                  if ((AMA03W.WS-RPT-MONTH-MM == 09))
                    AMA03W-HEAD.S-REPMTH = " SEPTEMBER,";
                  else
                    if ((AMA03W.WS-RPT-MONTH-MM == 10))
                      AMA03W-HEAD.S-REPMTH = "   OCTOBER,";
                    else
                      if ((AMA03W.WS-RPT-MONTH-MM == 11))
                        AMA03W-HEAD.S-REPMTH = "  NOVEMBER,";
                      else
                        if ((AMA03W.WS-RPT-MONTH-MM == 12))
                          AMA03W-HEAD.S-REPMTH = "  DECEMBER,";
                        end /* end of if rpt-month = 12*/
                      end /* end of if rpt-month = 11*/
                    end /* end of if rpt-month = 10*/
                  end /* end of if rpt-month = 09*/
                end /* end of if rpt-month = 08*/
              end /* end of if rpt-month = 07*/
            end /* end of if rpt-month = 06*/
          end /* end of if rpt-month = 05*/
        end /* end of if rpt-month = 04*/
      end /* end of if rpt-month = 03*/
    end /* end of if rpt-month = 02*/
  end /* end of if rpt-month = 01*/
  AMA03P9-INIT-VAR();
  /* cbsi end*/
end // end AMA03P9-INIT-PARA


// INITIALIZE REASON TOTALS
Function AMA03P9-INIT-TOT()
  AMA03W.WS-DNL-CNT-HBW = 0;
  AMA03W.WS-DNL-CNT-QMB = 0;
  AMA03W.WS-DNL-CNT-SSI = 0;
  AMA03W.WS-DNL-CNT-STA-INS = 0;
  AMA03W.WS-DNL-CNT-KB = 0;
  AMA03W.WS-DNL-CNT-GCW = 0;
  AMA03W.WS-DNL-CNT-SLMB = 0;
  AMA03W.WS-DNL-CNT-RETARD = 0;
  AMA03W.WS-DNL-CNT-QDWI = 0;
  AMA03W.WS-DNL-CNT-PUB-LAW = 0;
  AMA03W.WS-DNL-CNT-EME-MED = 0;
  /* start wi # 15116*/
  AMA03W.WS-DNL-CNT-QI1 = 0;
  AMA03W.WS-DNL-CNT-QI2 = 0;
  /* end wi # 15116*/
  AMA03W.WS-DNL-CNT-TOTAL = 0;
end // end AMA03P9-INIT-TOT


// INITIALIZE PULIC LAW ARRAY
Function AMA03P9-INIT-VAR()
  AMA03W.WS-PUB-LAW-ARRY[1] = "AD1";
  AMA03W.WS-PUB-LAW-ARRY[2] = "AD3";
  AMA03W.WS-PUB-LAW-ARRY[3] = "AD5";
  AMA03W.WS-PUB-LAW-ARRY[4] = "AD9";
  AMA03W.WS-PUB-LAW-ARRY[5] = "SU1";
  AMA03W.WS-PUB-LAW-ARRY[6] = "SU3";
  AMA03W.WS-PUB-LAW-ARRY[7] = "SU5";
  AMA03W.WS-PUB-LAW-ARRY[8] = "SU9";
  AMA03W.WS-PUB-LAW-ARRY[9] = "WS3";
  AMA03W.WS-PUB-LAW-ARRY[10] = "WS5";
  AMA03W.WS-PUB-LAW-ARRY[11] = "WS9";
  AMA03W.WS-PUB-LAW-ARRY[12] = "WW3";
  AMA03W.WS-PUB-LAW-ARRY[13] = "WW5";
  AMA03W.WS-PUB-LAW-ARRY[14] = "WW9";
  AMA03W.WS-PUB-LAW-ARRY[15] = "PK1";
  AMA03W.WS-PUB-LAW-ARRY[16] = "PK3";
  AMA03W.WS-PUB-LAW-ARRY[17] = "PK5";
  AMA03W.WS-PUB-LAW-ARRY[18] = "PK9";
  /* *******************************************************************/
  /* WDS;04-19-2000;WI#18063 --- ADD NEW PUBLIC-LAW AID CODE 'NO9'*/
  /* *******************************************************************/
  AMA03W.WS-PUB-LAW-ARRY[19] = "NO9";
end // end AMA03P9-INIT-VAR


// INITIALISE CONSTANTS
Function AMA03P9-INITCON()
  /* this process intialises all the reports constants*/
  AMA03W-HEAD.CONSTANT1 = "PAGE-NBR";
  AMA03W-HEAD.CONSTANT2 = "STATE";
  AMA03W-HEAD.CONSTANT3 = "OF";
  AMA03W-HEAD.CONSTANT4 = "NEVADA";
  AMA03W-HEAD.CONSTANT5 = "DATE";
  AMA03W-HEAD.CONSTANT6 = "INTAKE";
  AMA03W-HEAD.CONSTANT7 = "DENIAL/WITHDRAWAL";
  AMA03W-HEAD.CONSTANT8 = "REASON";
  AMA03W-HEAD.CONSTANT9 = "STATISTICS";
  AMA03W-HEAD.CONSTANT10 = "-";
  AMA03W-HEAD.CONSTANT11 = "TOTAL";
  AMA03W-HEAD.CONSTANT12 = "MAABD";
  AMA03W-HEAD.CONSTANT13 = "BY";
  AMA03W-HEAD.CONSTANT14 = "CASE";
  AMA03W-HEAD.CONSTANT15 = "TYPE";
  AMA03W-HEAD.CONSTANT16 = "TIME";
  AMA03W-HEAD.CONSTANT17 = "MONTH";
  AMA03W-HEAD.CONSTANT18 = "OF";
  AMA03W-HEAD.CONSTANT19 = ":";
  AMA03W-SUBH.CONSTANT1 = "LEVEL";
  AMA03W-SUBH.CONSTANT2 = "REASON";
  AMA03W-SUBH.CONSTANT3 = "<-----------------------------------";
  AMA03W-SUBH.CONSTANT4 = "---TOTAL----------------------------";
  AMA03W-SUBH.CONSTANT5 = "------------------------>";
  AMA03W-SUBH.CONSTANT6 = "STATE";
  AMA03W-SUBH.CONSTANT7 = "GRP";
  AMA03W-SUBH.CONSTANT8 = "CARE";
  AMA03W-SUBH.CONSTANT9 = "PUBLIC";
  AMA03W-SUBH.CONSTANT10 = "EMERGENCY";
  AMA03W-SUBH.CONSTANT11 = "HBW";
  AMA03W-SUBH.CONSTANT12 = "QMB";
  AMA03W-SUBH.CONSTANT13 = "SSI";
  AMA03W-SUBH.CONSTANT14 = "INSTIT";
  AMA03W-SUBH.CONSTANT15 = "KB";
  AMA03W-SUBH.CONSTANT16 = "WAIVER";
  AMA03W-SUBH.CONSTANT17 = "SLMB";
  AMA03W-SUBH.CONSTANT18 = "RETARDED";
  AMA03W-SUBH.CONSTANT19 = "QDWI";
  AMA03W-SUBH.CONSTANT20 = "LAW";
  AMA03W-SUBH.CONSTANT21 = "MEDICAL";
  /* start wi # 15116*/
  AMA03W-SUBH.CONSTANT22 = "QI-1";
  AMA03W-SUBH.CONSTANT23 = "QI-2";
  /* end wi # 15116*/
  AMA03W-SUBH.CONSTANT24 = "TOTAL";
  AMA03W-FOOTER.CONSTANT1 = "------------------------------------";
  AMA03W-FOOTER.CONSTANT2 = "------------------------------------";
  AMA03W-FOOTER.CONSTANT3 = "----------------------------------------------";
  AMA03W-FOOTER.CONSTANT4 = "***";
  AMA03W-FOOTER.CONSTANT5 = "TOTAL";
end // end AMA03P9-INITCON


// REPORTS MAIN PARA
Function AMA03P9-MAIN()
  /* cbsi start*/

  /* perform process to initialize variables*/
  AMA03P9-INIT-PARA();

  /* perform process to print the report*/
  AMA03P9-PRINT-PARA();

  /* perform process to close the application*/
  AMA03P9-CLOS-PARA();

  /* cbsi end*/
end // end AMA03P9-MAIN


// POPULATE STATEWIDE DETAILS
Function AMA03P9-OF-POP-DET()
  /* cbsi start;*/
  AMA03W-DET.S-DEN-RSN = AMA03W.WS-OF-DEN-RSN[WS-AMA03-INDEX];
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-HBW[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-HBW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-QMB[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-SSI[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-SSI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-STA-INS[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-STA-INS = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-KB[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-KB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-GCW[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-GCW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-SLMB[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-SLMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-RETARD[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-RETARD = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-QDWI[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QDWI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-PUB-LAW[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-PUB-LAW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-EME-MED[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-EME-MED = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-QI1[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-QI2[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QI2 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-OF-DNL-CNT-TOTAL[WS-AMA03-INDEX];
  AMA03P9-FORMAT5();
  AMA03W-DET.S-DNL-CNT-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA03P9-OF-POP-DET


// PRINT PROCESS
Function AMA03P9-OF-PRN()
  /* CBSI start;*/
  AMA03P9-ACUM-OFFOT();
  AMA03P9-PRN-HEAD(); /* print the header details*/
  AMA03W.WS-OFC-NM-TEMP = AMA03W.WS-OFC-NM;
  AMA03W.WS-PREV-CASLD-ID = AMA03W.WS-OFC-NM-TRUNC-TEMP;
  AMA03W.WS-OFC-NM-TRUNC = AMA03W.WS-OFC-NM-TEMP1;
  AMA03P9-PRN-SUBH();
  AMA03W.WS-AMA03-INDEX = 1;
  while (AMA03W.WS-AMA03-INDEX <= 38)
    if (AMA03W.WS-OF-CLSRE-RSN-FND[WS-AMA03-INDEX] == "Y")
      AMA03P9-OF-POP-DET();
      AMA03P9-PRN-DETAIL();
    end
    AMA03W.WS-AMA03-INDEX = AMA03W.WS-AMA03-INDEX + 1;
  end
  AMA03P9-POP-FOOTER();
  AMA03P9-PRN-FOOTER();
  /* CBSI end;*/
end // end AMA03P9-OF-PRN


// POPULATING REPORTS DETAILS
Function AMA03P9-POP-DET()
  /* cbsi start*/
  /* move retrieved variables to output record*/
  AMA03W-DET.S-DEN-RSN = AMA03W.WS-DEN-RSN-TRUNC;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-HBW;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-HBW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-QMB;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-SSI;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-SSI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-STA-INS;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-STA-INS = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-KB;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-KB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-GCW;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-GCW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-SLMB;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-SLMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-RETARD;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-RETARD = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-QDWI;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QDWI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-PUB-LAW;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-PUB-LAW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-EME-MED;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-EME-MED = FORMATW.OUTPUT-CHAR;
  /* start wi # 15116*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-QI1;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-QI2;
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QI2 = FORMATW.OUTPUT-CHAR;
  /* end wi # 15116*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-TOTAL;
  AMA03P9-FORMAT5();
  AMA03W-DET.S-DNL-CNT-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA03P9-POP-DET


// POPULATE FOOTER VARIABLES
Function AMA03P9-POP-FOOTER()
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-HBW;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-HBW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-QMB;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-QMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-SSI;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-SSI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-STA-INS;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-STA-INS = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-KB;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-KB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-GCW;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-GCW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-SLMB;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-SLMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-RETARD;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-RETARD = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-QDWI;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-QDWI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-PUB-LAW;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-PUB-LAW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-EME-MED;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-EME-MED = FORMATW.OUTPUT-CHAR;
  /* start wi # 15116*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-QI1;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-QI2;
  AMA03P9-FORMAT4();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-QI2 = FORMATW.OUTPUT-CHAR;
  /* end wi # 15116*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-DNL-CNT-AC-TOT-TOTAL;
  AMA03P9-FORMAT5();
  AMA03W-FOOTER.S-DNL-CNT-AC-TOT-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA03P9-POP-FOOTER


// PROCESS TO PRINT THE REPORT
Function AMA03P9-PRINT-PARA()
  /* cbsi start*/
  /* Rework due to PTR# 10480, all ARX04A changed to AMA44A*/
  /* no longer using H2-OFFICE OR H2-CODE.*/
  AMA03P9-SCAN();

  if (SR-AMA44-RECIN is ioError)
    AMA03P9-PRN-HEAD();
    REP132P9-NRF-PROC();
    AMA03P9-CLOS-PARA();
  end

  /* print all the details retrieved from the data base*/
  while (SR-AMA44-RECIN not ioError)

    if (SR-AMA44-RECIN.PCE-PRGM-CASE-STS == "D")
      if (AMA03W.WS-FIRST-TM-IND == "Y")
        AMA03W.WS-PREV-OFC-CD = SR-AMA44-RECIN.PCE-OFC-CD;
        AMA03W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
        AMA03W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
        AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;
        AMA03W.WS-OFC-NM = SR-AMA44-RECIN.PCE-OFC-NM;
        AMA03W.WS-FIRST-TM-IND = "N";
      end
      if ((REP-COMMON.WS-NEW-PAGE == "Y"))
        AMA03P9-PRN-HEAD(); /* print the header details*/
        AMA03P9-PRN-SUBH(); /* print the subheader*/
        REP-COMMON.WS-NEW-PAGE = "N"; /* reset new page  indicator*/
      end
    /* perform processing specific to the application*/
      AMA03P9-APPLSPEC();

    end
    /* perform process to scan the cursor*/
    AMA03P9-SCAN();
  end /* end of while loop*/

  if (AMA03W.WS-REC-FOUND == "Y")
    AMA03W.WS-DEN-RSN = SR-AMA44-RECIN.PCE-RSN;
    AMA03W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
    if ((REP-COMMON.WS-NEW-PAGE == "Y"))
      AMA03P9-PRN-HEAD(); /* print the header details*/
      AMA03P9-PRN-SUBH(); /* print the subheader*/
      REP-COMMON.WS-NEW-PAGE = "N"; /* reset new page  indicator*/
    end
    AMA03P9-ACUM-DET();
  /* modificaton  for  getting  office totals  -  WI# 16615 - start;*/
    AMA03P9-ACUM-OFF();
  /* modificaton  for  getting  office totals  -  WI# 16615 - end;*/
    AMA03P9-ACUM-ST();
  /* print details for last record*/
  /* perform process to populate the details*/
    AMA03P9-POP-DET();
  /* perform process to print detail screen*/
    AMA03P9-PRN-DETAIL();
    AMA03P9-POP-FOOTER();
    AMA03P9-PRN-FOOTER();
    AMA03P9-INIT-TOT();
    AMA03P9-INIT-FOTOT();
  /* modificaton  for  getting  office totals  -  WI# 16615 - start;*/
    AMA03P9-OF-PRN();
    AMA03P9-INIT-FOTOT();
    AMA03P9-INIT-OFFIC();
  /* modificaton  for  getting  office totals  -  WI# 16615 - end;*/
    AMA03P9-ST-PRN();

  /* check if footer and end of report line can fit in the same page*/
    AMA03W.WS-REM-LINES = REP-COMMON.WS-MAX-NO-LINES -     REP-COMMON.WS-LINE-NO;

    if ((AMA03W.WS-REM-LINES < 2))
    /* set print control character to form feed*/
      AMA03P9-PRN-HEAD(); /* print header details*/
    end
  /* print end of report*/
    REP132P9-EOR-PROC();
  /* perform termination process*/
    AMA03P9-CLOS-PARA();
  end

  AMA03P9-PRN-HEAD();
  REP132P9-NRF-PROC();
  /* cbsi end*/
end // end AMA03P9-PRINT-PARA


// PRINTS  DETAIL LINES
Function AMA03P9-PRN-DETAIL()
  /* cbsi start*/
  if (REP-COMMON.WS-LINE-NO > REP-COMMON.WS-MAX-NO-LINES)
    AMA03P9-PRN-HEAD();
    AMA03P9-PRN-SUBH();
  end
  SR-132REP-RECOUT.UFIELD = AMA03W-DET.LINE1;
  WR-132REP-OUT-FILE();
  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";
  /* cbsi end*/
end // end AMA03P9-PRN-DETAIL


// PRINTS FOOTER
Function AMA03P9-PRN-FOOTER()
  /* cbsi start*/
  REP-COMMON.WS-REM1 = REP-COMMON.WS-MAX-NO-LINES - REP-COMMON.WS-LINE-NO;
  if (REP-COMMON.WS-REM1 < 2)
    AMA03P9-PRN-HEAD();
    AMA03P9-PRN-SUBH();
  end
  SR-132REP-RECOUT.PRNT-CC = " ";
  SR-132REP-RECOUT.UFIELD = AMA03W-FOOTER.LINE1;
  WR-132REP-OUT-FILE();
  /* leave 1 line before printing curr line*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA03W-FOOTER.LINE2;
  WR-132REP-OUT-FILE();
  /* cbsi end*/
end // end AMA03P9-PRN-FOOTER


// PRINTS HEADER
Function AMA03P9-PRN-HEAD()
  /* cbsi start*/
  /* increment page-no*/
  REP-COMMON.WS-PAGE-NO = REP-COMMON.WS-PAGE-NO + 1;

  if (REP-COMMON.WS-PAGE-NO > 1)
    SR-132REP-RECOUT.PRNT-CC = "1";
  end
  /* move page-no to header variable*/
  AMA03W-HEAD.UPAGE = REP-COMMON.WS-PAGE-NO-3-4;

  /* move each line of header to map and print*/
  SR-132REP-RECOUT.UFIELD = AMA03W-HEAD.LINE1;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AMA03W-HEAD.LINE2;
  WR-132REP-OUT-FILE();
  if (AMA03W-HEAD.LINE3 != " ")
    SR-132REP-RECOUT.UFIELD = AMA03W-HEAD.LINE3;
    WR-132REP-OUT-FILE();
  end
  /* cbsi end*/
end // end AMA03P9-PRN-HEAD


// PRINTING THE REPORT'S SUB-HEAD
Function AMA03P9-PRN-SUBH()
  /* cbsi start*/
  AMA03W.WS-LEVEL-OFC-NM = AMA03W.WS-OFC-NM-TRUNC;
  AMA03W.WS-LEVEL-CASLD-ID = AMA03W.WS-PREV-CASLD-ID;
  AMA03W-SUBH.S-LEVEL = AMA03W.WS-LEVEL;
  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA03W-SUBH.LINE1;
  WR-132REP-OUT-FILE();

  /* set control character to skip one line before printing curr line*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA03W-SUBH.LINE2;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";
  SR-132REP-RECOUT.UFIELD = AMA03W-SUBH.LINE3;
  WR-132REP-OUT-FILE();

  SR-132REP-RECOUT.UFIELD = AMA03W-SUBH.LINE4;
  WR-132REP-OUT-FILE();

  SR-132REP-RECOUT.PRNT-CC = "0";
  /* cbsi end*/
end // end AMA03P9-PRN-SUBH


// PROCESS TO READ INPUT FILE
Function AMA03P9-READIP()
  /* cbsi start*/
  VDBCONTROL.UPROC-NM = "AMA03P9-READIP";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "SR-AMA03-RECIN";
  try
    get next SR-AMA03-RECIN ;
  end
  /* check if any i/o error has occured*/
  if (SR-AMA03-RECIN is ioError && SR-AMA03-RECIN not endOfFile)
  /* -------------------------PTR # 11419----------------------START*/
    VMESSAGE.UMSGINS[2] = "AMA03A";
    AMA03W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA03W.WS-ERR-LAST-FOUR;
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    WCM00P2-TO-CEP01A();
  end
  if (SR-AMA03-RECIN is endOfFile)
    VMESSAGE.UMSGINS[2] = "AMA03A";
    AMA03W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA03W.WS-ERR-LAST-FOUR;
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    WCM00P2-TO-CEP01A();
  end
  /* -------------------------PTR # 11419----------------------END*/
  /* cbsi end*/
end // end AMA03P9-READIP


// FILE SCAN
Function AMA03P9-SCAN()
  /* cbsi start*/
  /* Rework due to PTR# 10480, all ARX04A changed to AMA44A*/
  /* no longer using H2-OFFICE OR H2-CODE.*/
  VDBCONTROL.UPROC-NM = "AMA03P9-SCAN";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "SR-AMA44-RECIN";
  try
    get next SR-AMA44-RECIN ;
  end
  /* check if any i/o error has occured*/
  if (SR-AMA44-RECIN is ioError && SR-AMA44-RECIN not endOfFile)
  /* -------------------------PTR # 11419----------------------START*/
    VMESSAGE.UMSGINS[2] = "AMA03A";
    AMA03W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA03W.WS-ERR-LAST-FOUR;
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    WCM00P2-TO-CEP01A();
  /* -------------------------PTR # 11419----------------------END*/
  end
end // end AMA03P9-SCAN


// INITIALIZE ALL RECORDS
Function AMA03P9-SET-EMPTY()
  /* cbsi start*/
  /* Rework due to PTR# 10480, all ARX04A changed to AMA44A*/
  /* no longer using H2-OFFICE OR H2-CODE.*/
  set REP-COMMON empty;
  set REP-EOFNOF empty;
  set REP-DATE empty;
  set AMA03W-DET empty;
  set AMA03W-HEAD empty;
  set AMA03W-SUBH empty;
  set AMA03W-FOOTER empty;
  set VMESSAGE empty;
  set CEP01W empty;
  set VDBCONTROL empty;
  set VDBCOMMON empty;
  set FORMATW empty;
  set AMA03W empty;
  set SR-AMA03-RECIN empty;
  set SR-132REP-RECOUT empty;
  set SR-AMA44-RECIN empty;
  /* cbsi end*/
end // end AMA03P9-SET-EMPTY


// POPULATE STATEWIDE DETAILS
Function AMA03P9-ST-POP-DET()
  AMA03W-DET.S-DEN-RSN = AMA03W.WS-ST-DEN-RSN[WS-AMA03-INDEX];
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-HBW[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-HBW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-QMB[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-SSI[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-SSI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-STA-INS[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-STA-INS = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-KB[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-KB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-GCW[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-GCW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-SLMB[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-SLMB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-RETARD[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-RETARD = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-QDWI[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QDWI = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-PUB-LAW[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-PUB-LAW = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-EME-MED[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-EME-MED = FORMATW.OUTPUT-CHAR;
  /* start wi # 15116*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-QI1[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-QI2[WS-AMA03-INDEX];
  AMA03P9-FORMAT4();
  AMA03W-DET.S-DNL-CNT-QI2 = FORMATW.OUTPUT-CHAR;
  /* end wi # 15116*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA03W.WS-ST-DNL-CNT-TOTAL[WS-AMA03-INDEX];
  AMA03P9-FORMAT5();
  AMA03W-DET.S-DNL-CNT-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA03P9-ST-POP-DET


// PRINT PROCESS
Function AMA03P9-ST-PRN()
  AMA03P9-ACUM-STFOT();
  AMA03P9-PRN-HEAD(); /* print the header details*/
  AMA03W.WS-PREV-CASLD-ID = "STATE";
  AMA03W.WS-OFC-NM = "WIDE";
  AMA03P9-PRN-SUBH();
  AMA03W.WS-AMA03-INDEX = 1;
  while (AMA03W.WS-AMA03-INDEX <= 38)
    if (AMA03W.WS-CLSRE-RSN-FND[WS-AMA03-INDEX] == "Y")
      AMA03P9-ST-POP-DET();
      AMA03P9-PRN-DETAIL();
    end
    AMA03W.WS-AMA03-INDEX = AMA03W.WS-AMA03-INDEX + 1;
  end
  AMA03P9-POP-FOOTER();
  AMA03P9-PRN-FOOTER();
end // end AMA03P9-ST-PRN


// VALIDATES  INPUT  PARAMETERS
Function AMA03P9-VALIDATE()
  if (SR-AMA03-RECIN.RPT-DT not numeric)
  /* -------------------------PTR # 11419----------------------START*/
    VMESSAGE.UMSGCODE = "ARX0402E";
    VMESSAGE.UMSGINS[2] = "AMA03A";
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    WCM00P2-TO-CEP01A();
    exit program;
  end
  /* -------------------------PTR # 11419----------------------END*/

  AMA03W.WS-TOPREC = SR-AMA03-RECIN.TOPREC;
  /* validation of input month & calculation of start and end date*/
  REP-DATE.WS-IN-RPT-MM = AMA03W.WS-RPT-MONTH-MM;
  REP-DATE.WS-IN-RPT-CCYY = AMA03W.WS-RPT-DT-CCYY;
  REP-DATE.WS-FLAG = "M";
  REPP9-DATE-PARA();
  if (REP-DATE.WS-DATE-FLAG == 1)
  /* -------------------------PTR # 11419----------------------START*/
    VMESSAGE.UMSGCODE = "ARX0402E";
    VMESSAGE.UMSGINS[2] = "AMA03A";
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    WCM00P2-TO-CEP01A();
    exit program;
  end
  /* -------------------------PTR # 11419----------------------END*/

  /* move start and end calculate days to your local storage*/
  AMA03W.WS-RPT-BEG-DT = REP-DATE.WS-START-DATE;
  AMA03W.WS-RPT-END-DT = REP-DATE.WS-END-DATE;
  AMA03W.WS-RPT-YEAR = AMA03W.WS-RPT-BEG-DT-CCYY;
  AMA03W.WS-RPT-MNTH = AMA03W.WS-RPT-BEG-DT-MM;
end // end AMA03P9-VALIDATE


Record AMA03W type basicRecord
  10 WS-REM-LINES num(3) ; 
  10 WS-TOPREC char(80) ; 
    15 WS-RPT-DT num(6) ; 
      20 WS-RPT-DT-CCYY num(4) ; 
      20 WS-RPT-MONTH-MM num(2) ; 
    15 * char(74) ; 
  10 WS-RPT-BEG-DT char(10) ; 
    15 WS-RPT-BEG-DT-CCYY num(4) ; 
    15 WS-RPT-BEG-DT-F1 char(1) ; 
    15 WS-RPT-BEG-DT-MM num(2) ; 
    15 WS-RPT-BEG-DT-F2 char(1) ; 
    15 WS-RPT-BEG-DT-DD num(2) ; 
  10 WS-RPT-END-DT char(10) ; 
    15 WS-RPT-END-DT-CCYY num(4) ; 
    15 WS-RPT-END-DT-F1 char(1) ; 
    15 WS-RPT-END-DT-MM num(2) ; 
    15 WS-RPT-END-DT-F2 char(1) ; 
    15 WS-RPT-END-DT-DD num(2) ; 
  10 WS-RPT-YEAR smallint ; 
  10 WS-RPT-MNTH smallint ; 
  10 WS-PREV-OFC-CD char(2) ; 
  10 WS-PREV-CASLD-ID char(5) ; 
  10 WS-PREV-CLSRE-RSN-CD char(1) ; 
  10 WS-PREV-AID-CD char(3) ; 
  10 WS-OFC-NM char(32) ; 
    15 WS-OFC-NM-TRUNC char(15) ; 
    15 WS-OFC-NM-F1 char(17) ; 
  10 WS-OFC-NM-TEMP char(32) ; 
    15 WS-OFC-NM-TRUNC-TEMP char(5) ; 
    15 WS-OFC-NM-TEMP1 char(15) ; 
    15 WS-OFC-NM-TEMP2 char(12) ; 
  10 WS-DEN-RSN char(50) ; 
    15 WS-DEN-RSN-TRUNC char(19) ; 
    15 WS-DEN-RSN-F1 char(31) ; 
  10 WS-LEVEL char(20) ; 
    15 WS-LEVEL-CASLD-ID char(5) ; 
    15 WS-LEVEL-OFC-NM char(15) ; 
  10 WS-FIRST-TM-IND char(1) ; 
  10 WS-AMA03-INDEX num(3) ; 
  10 WS-REC-FOUND char(1) ; 
  10 WS-CLSRE-REC-FND char(1) ; 
  10 WS-PB-REC-FND char(1) ; 
  10 WS-ST-REC-FND char(1) ; 
  10 WS-PUB-LAW-ARRY char(3) [19] ; 
  10 WS-DET char(57) ; 
    15 WS-DNL-CNT-HBW num(4) ; 
    15 WS-DNL-CNT-QMB num(4) ; 
    15 WS-DNL-CNT-SSI num(4) ; 
    15 WS-DNL-CNT-STA-INS num(4) ; 
    15 WS-DNL-CNT-KB num(4) ; 
    15 WS-DNL-CNT-GCW num(4) ; 
    15 WS-DNL-CNT-SLMB num(4) ; 
    15 WS-DNL-CNT-RETARD num(4) ; 
    15 WS-DNL-CNT-QDWI num(4) ; 
    15 WS-DNL-CNT-PUB-LAW num(4) ; 
    15 WS-DNL-CNT-EME-MED num(4) ; 
    15 WS-DNL-CNT-QI1 num(4) ; 
    15 WS-DNL-CNT-QI2 num(4) ; 
    15 WS-DNL-CNT-TOTAL num(5) ; 
  10 WS-FO-DET char(57) ; 
    15 WS-DNL-CNT-AC-TOT-HBW num(4) ; 
    15 WS-DNL-CNT-AC-TOT-QMB num(4) ; 
    15 WS-DNL-CNT-AC-TOT-SSI num(4) ; 
    15 WS-DNL-CNT-AC-TOT-STA-INS num(4) ; 
    15 WS-DNL-CNT-AC-TOT-KB num(4) ; 
    15 WS-DNL-CNT-AC-TOT-GCW num(4) ; 
    15 WS-DNL-CNT-AC-TOT-SLMB num(4) ; 
    15 WS-DNL-CNT-AC-TOT-RETARD num(4) ; 
    15 WS-DNL-CNT-AC-TOT-QDWI num(4) ; 
    15 WS-DNL-CNT-AC-TOT-PUB-LAW num(4) ; 
    15 WS-DNL-CNT-AC-TOT-EME-MED num(4) ; 
    15 WS-DNL-CNT-AC-TOT-QI1 num(4) ; 
    15 WS-DNL-CNT-AC-TOT-QI2 num(4) ; 
    15 WS-DNL-CNT-AC-TOT-TOTAL num(5) ; 
  10 WS-ST-DET char(77) [38] ; 
    15 WS-ST-DEN-RSN char(19) ; 
    15 WS-CLSRE-RSN-FND char(1) ; 
    15 WS-ST-DNL-CNT-HBW num(4) ; 
    15 WS-ST-DNL-CNT-QMB num(4) ; 
    15 WS-ST-DNL-CNT-SSI num(4) ; 
    15 WS-ST-DNL-CNT-STA-INS num(4) ; 
    15 WS-ST-DNL-CNT-KB num(4) ; 
    15 WS-ST-DNL-CNT-GCW num(4) ; 
    15 WS-ST-DNL-CNT-SLMB num(4) ; 
    15 WS-ST-DNL-CNT-RETARD num(4) ; 
    15 WS-ST-DNL-CNT-QDWI num(4) ; 
    15 WS-ST-DNL-CNT-PUB-LAW num(4) ; 
    15 WS-ST-DNL-CNT-EME-MED num(4) ; 
    15 WS-ST-DNL-CNT-QI1 num(4) ; 
    15 WS-ST-DNL-CNT-QI2 num(4) ; 
    15 WS-ST-DNL-CNT-TOTAL num(5) ; 
  10 WS-OF-DET char(77) [38] ; 
    15 WS-OF-DEN-RSN char(19) ; 
    15 WS-OF-CLSRE-RSN-FND char(1) ; 
    15 WS-OF-DNL-CNT-HBW num(4) ; 
    15 WS-OF-DNL-CNT-QMB num(4) ; 
    15 WS-OF-DNL-CNT-SSI num(4) ; 
    15 WS-OF-DNL-CNT-STA-INS num(4) ; 
    15 WS-OF-DNL-CNT-KB num(4) ; 
    15 WS-OF-DNL-CNT-GCW num(4) ; 
    15 WS-OF-DNL-CNT-SLMB num(4) ; 
    15 WS-OF-DNL-CNT-RETARD num(4) ; 
    15 WS-OF-DNL-CNT-QDWI num(4) ; 
    15 WS-OF-DNL-CNT-PUB-LAW num(4) ; 
    15 WS-OF-DNL-CNT-EME-MED num(4) ; 
    15 WS-OF-DNL-CNT-QI1 num(4) ; 
    15 WS-OF-DNL-CNT-QI2 num(4) ; 
    15 WS-OF-DNL-CNT-TOTAL num(5) ; 
  10 WS-ERR-CD num(8) ; 
    15 WS-ERR-FIRST-FOUR char(4) ; 
    15 WS-ERR-LAST-FOUR char(4) ; 
end // end AMA03W


Record AMA03W-DET type basicRecord
  10 LINE1 char(132) ; 
    15 S-DEN-RSN char(19) ; 
    15 FILLER1 char(2) ; 
    15 S-DNL-CNT-HBW char(4) ; 
    15 FILLER2 char(2) ; 
    15 S-DNL-CNT-QMB char(4) ; 
    15 FILLER3 char(2) ; 
    15 S-DNL-CNT-SSI char(4) ; 
    15 FILLER4 char(2) ; 
    15 S-DNL-CNT-STA-INS char(4) ; 
    15 FILLER5 char(3) ; 
    15 S-DNL-CNT-KB char(4) ; 
    15 FILLER6 char(3) ; 
    15 S-DNL-CNT-GCW char(4) ; 
    15 FILLER7 char(4) ; 
    15 S-DNL-CNT-SLMB char(4) ; 
    15 FILLER8 char(4) ; 
    15 S-DNL-CNT-RETARD char(4) ; 
    15 FILLER9 char(3) ; 
    15 S-DNL-CNT-QDWI char(4) ; 
    15 FILLER10 char(2) ; 
    15 S-DNL-CNT-PUB-LAW char(4) ; 
    15 FILLER11 char(3) ; 
    15 S-DNL-CNT-EME-MED char(4) ; 
    15 FILLER12 char(5) ; 
    15 S-DNL-CNT-QI1 char(4) ; 
    15 FILLER13 char(3) ; 
    15 S-DNL-CNT-QI2 char(4) ; 
    15 FILLER14 char(3) ; 
    15 S-DNL-CNT-TOTAL char(5) ; 
    15 FILLER15 char(15) ; 
end // end AMA03W-DET


Record AMA03W-FOOTER type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(36) ; 
    15 CONSTANT2 char(36) ; 
    15 CONSTANT3 char(50) ; 
    15 FILLER1 char(10) ; 
  10 LINE2 char(132) ; 
    15 FILLER2 char(3) ; 
    15 CONSTANT4 char(3) ; 
    15 FILLER3 char(1) ; 
    15 CONSTANT5 char(5) ; 
    15 FILLER4 char(9) ; 
    15 S-DNL-CNT-AC-TOT-HBW char(4) ; 
    15 FILLER5 char(2) ; 
    15 S-DNL-CNT-AC-TOT-QMB char(4) ; 
    15 FILLER6 char(2) ; 
    15 S-DNL-CNT-AC-TOT-SSI char(4) ; 
    15 FILLER7 char(2) ; 
    15 S-DNL-CNT-AC-TOT-STA-INS char(4) ; 
    15 FILLER8 char(3) ; 
    15 S-DNL-CNT-AC-TOT-KB char(4) ; 
    15 FILLER9 char(3) ; 
    15 S-DNL-CNT-AC-TOT-GCW char(4) ; 
    15 FILLER10 char(4) ; 
    15 S-DNL-CNT-AC-TOT-SLMB char(4) ; 
    15 FILLER11 char(4) ; 
    15 S-DNL-CNT-AC-TOT-RETARD char(4) ; 
    15 FILLER12 char(3) ; 
    15 S-DNL-CNT-AC-TOT-QDWI char(4) ; 
    15 FILLER13 char(2) ; 
    15 S-DNL-CNT-AC-TOT-PUB-LAW char(4) ; 
    15 FILLER14 char(3) ; 
    15 S-DNL-CNT-AC-TOT-EME-MED char(4) ; 
    15 FILLER15 char(5) ; 
    15 S-DNL-CNT-AC-TOT-QI1 char(4) ; 
    15 FILLER16 char(3) ; 
    15 S-DNL-CNT-AC-TOT-QI2 char(4) ; 
    15 FILLER17 char(3) ; 
    15 S-DNL-CNT-AC-TOT-TOTAL char(5) ; 
    15 FILLER18 char(15) ; 
end // end AMA03W-FOOTER


Record AMA03W-HEAD type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(8) ; 
    15 FILLER1 char(1) ; 
    15 UPAGE char(4) ; 
    15 FILLER2 char(46) ; 
    15 CONSTANT2 char(5) ; 
    15 FILLER3 char(1) ; 
    15 CONSTANT3 char(2) ; 
    15 FILLER4 char(1) ; 
    15 CONSTANT4 char(6) ; 
    15 FILLER5 char(43) ; 
    15 CONSTANT5 char(4) ; 
    15 FILLER6 char(3) ; 
    15 UDATE char(8) ; 
  10 LINE2 char(132) ; 
    15 UAPPL char(8) ; 
    15 FILLER7 char(24) ; 
    15 CONSTANT6 char(6) ; 
    15 FILLER8 char(1) ; 
    15 CONSTANT7 char(17) ; 
    15 FILLER9 char(1) ; 
    15 CONSTANT8 char(6) ; 
    15 FILLER10 char(1) ; 
    15 CONSTANT9 char(10) ; 
    15 FILLER11 char(1) ; 
    15 CONSTANT10 char(1) ; 
    15 FILLER12 char(1) ; 
    15 CONSTANT11 char(5) ; 
    15 FILLER13 char(1) ; 
    15 CONSTANT12 char(5) ; 
    15 FILLER14 char(1) ; 
    15 CONSTANT13 char(2) ; 
    15 FILLER15 char(1) ; 
    15 CONSTANT14 char(4) ; 
    15 FILLER16 char(1) ; 
    15 CONSTANT15 char(4) ; 
    15 FILLER17 char(16) ; 
    15 CONSTANT16 char(4) ; 
    15 FILLER18 char(3) ; 
    15 UTIME char(8) ; 
  10 LINE3 char(132) ; 
    15 FILLER19 char(53) ; 
    15 CONSTANT17 char(5) ; 
    15 FILLER20 char(1) ; 
    15 CONSTANT18 char(2) ; 
    15 FILLER21 char(1) ; 
    15 CONSTANT19 char(1) ; 
    15 FILLER22 char(1) ; 
    15 S-REPMTH char(11) ; 
    15 FILLER23 char(1) ; 
    15 S-REPYR char(4) ; 
    15 FILLER24 char(52) ; 
end // end AMA03W-HEAD


Record AMA03W-SUBH type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(5) ; 
    15 FILLER1 char(1) ; 
    15 S-LEVEL char(20) ; 
    15 FILLER2 char(106) ; 
  10 LINE2 char(132) ; 
    15 CONSTANT2 char(6) ; 
    15 FILLER3 char(15) ; 
    15 CONSTANT3 char(36) ; 
    15 CONSTANT4 char(36) ; 
    15 CONSTANT5 char(29) ; 
    15 FILLER4 char(10) ; 
  10 LINE3 char(132) ; 
    15 FILLER5 char(39) ; 
    15 CONSTANT6 char(5) ; 
    15 FILLER6 char(7) ; 
    15 CONSTANT7 char(3) ; 
    15 FILLER7 char(1) ; 
    15 CONSTANT8 char(4) ; 
    15 FILLER8 char(22) ; 
    15 CONSTANT9 char(6) ; 
    15 FILLER9 char(1) ; 
    15 CONSTANT10 char(9) ; 
    15 FILLER10 char(35) ; 
  10 LINE4 char(132) ; 
    15 FILLER11 char(22) ; 
    15 CONSTANT11 char(3) ; 
    15 FILLER12 char(3) ; 
    15 CONSTANT12 char(3) ; 
    15 FILLER13 char(3) ; 
    15 CONSTANT13 char(3) ; 
    15 FILLER14 char(2) ; 
    15 CONSTANT14 char(6) ; 
    15 FILLER15 char(2) ; 
    15 CONSTANT15 char(2) ; 
    15 FILLER16 char(3) ; 
    15 CONSTANT16 char(6) ; 
    15 FILLER17 char(3) ; 
    15 CONSTANT17 char(4) ; 
    15 FILLER18 char(2) ; 
    15 CONSTANT18 char(8) ; 
    15 FILLER19 char(1) ; 
    15 CONSTANT19 char(4) ; 
    15 FILLER20 char(2) ; 
    15 CONSTANT20 char(3) ; 
    15 FILLER21 char(4) ; 
    15 CONSTANT21 char(7) ; 
    15 FILLER22 char(2) ; 
    15 CONSTANT22 char(4) ; 
    15 FILLER23 char(3) ; 
    15 CONSTANT23 char(4) ; 
    15 FILLER24 char(3) ; 
    15 CONSTANT24 char(5) ; 
    15 FILLER25 char(15) ; 
end // end AMA03W-SUBH


