package gov.illinois.access.business.rules;

import gov.illinois.access.business.customEntities.INDIVIDUAL_Custom_Cargo;
import gov.illinois.access.business.customEntities.INDIVIDUAL_Custom_Collection;
import gov.illinois.access.business.entities.APP_ABS_PRNT_Cargo;
import gov.illinois.access.business.entities.APP_ABS_PRNT_Collection;
import gov.illinois.access.business.entities.APP_INDV_Cargo;
import gov.illinois.access.business.entities.APP_INDV_Collection;
import gov.illinois.access.business.entities.APP_IN_ABSNP_Cargo;
import gov.illinois.access.business.entities.APP_IN_ABSNP_Collection;
import gov.illinois.access.business.entities.APP_IN_DABL_Cargo;
import gov.illinois.access.business.entities.APP_IN_DABL_Collection;
import gov.illinois.access.business.entities.APP_IN_PREG_Collection;
import gov.illinois.access.business.entities.APP_IN_PRFL_Cargo;
import gov.illinois.access.business.entities.APP_IN_PRFL_Collection;
import gov.illinois.access.business.entities.APP_MED_INS_Cargo;
import gov.illinois.access.business.entities.APP_MED_INS_Collection;
import gov.illinois.access.business.entities.APP_NURSING_ADDRESS_Cargo;
import gov.illinois.access.business.entities.APP_NURSING_ADDRESS_Collection;
import gov.illinois.access.business.entities.APP_PGM_RQST_Cargo;
import gov.illinois.access.business.entities.APP_PGM_RQST_Collection;
import gov.illinois.access.business.entities.APP_RQST_Cargo;
import gov.illinois.access.business.entities.APP_RQST_Collection;
import gov.illinois.access.business.entities.RMC_INDV_ID_Cargo;
import gov.illinois.access.business.entities.RMC_INDV_ID_Collection;
import gov.illinois.access.business.rules.household.DisabilityBO;
import gov.illinois.access.business.rules.household.PregnancyBO;
import gov.illinois.access.management.applications.ApplicationManager;
import gov.illinois.access.management.applications.IApplicationManager;
import gov.illinois.access.management.constants.AppConstants;
import gov.illinois.access.management.individuals.PeopleHandler;
import gov.illinois.access.management.util.IndividualAge;
import gov.illinois.framework.business.entities.FwTransaction;
import gov.illinois.framework.exceptions.FwException;
import gov.illinois.framework.management.constants.FwConstants;
import gov.illinois.framework.management.messages.FwMessageList;
import gov.illinois.framework.management.messages.FwMessageTextLabel;
import gov.illinois.framework.management.util.FwDataCriteria;
import gov.illinois.framework.management.util.FwMessageFormatter;
import gov.illinois.framework.management.logging.ILog;

import java.sql.Date;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Calendar;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import gov.illinois.access.business.utility.StringUtils;

/**
* ABHouseholdMemberBO - Business Object
* skeleton auto generated - Architecture Team
* @Creation Date :Tue Dec 27 11:22:35 CST 2005
* Modified By:
* Modified on:
*/
public class ABHouseHoldMemberBO extends AFBBO  {

	/**
	* Constructor
	*/
	 public ABHouseHoldMemberBO() {}

	/**
	* Method description here
	*/
	public void storeHouseholdMemberDetail(String appNumber, String peopleCount) {
		FwDataCriteria[] criteria = null;
		try {
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1001");
			criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("HSHL_INDV_CT");
			criteria[0].setColumn_value(peopleCount);
			criteria[0].setData_type(FwConstants.SHORT);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("APP_NUM");
			criteria[1].setColumn_value(appNumber);
			criteria[1].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "storeHouseholdMemberDetail", e);
			throw fe;
		}
	}
	
	/**
	* Method description here
	* ILIES-311729
	*/
	public void storeHouseholdMemberCounts(String appNumber, String peopleCount, String inCount, String outCount) {
		FwDataCriteria[] criteria = null;
		try {
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1155");
			criteria = new FwDataCriteria[4];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("HSHL_INDV_CT");
			criteria[0].setColumn_value(peopleCount);
			criteria[0].setData_type(FwConstants.SHORT);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("HSHL_INDV_IN_CNT");
			criteria[1].setColumn_value(inCount);
			criteria[1].setData_type(FwConstants.SHORT);
			criteria[2] = new FwDataCriteria();
			criteria[2].setColumn_name("HSHL_INDV_OUT_CNT");
			criteria[2].setColumn_value(outCount);
			criteria[2].setData_type(FwConstants.SHORT);
			criteria[3] = new FwDataCriteria();
			criteria[3].setColumn_name("APP_NUM");
			criteria[3].setColumn_value(appNumber);
			criteria[3].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "storeHouseholdMemberCounts", e);
			throw fe;
		}
	}
	/**
	 * ILIES-311795
	 * @param appNumber
	 * @param peopleCount
	 * @param taxFile
	 * @param peopleLiveInYourHome
	 * @param taxDependent
	 */
	public void storeHouseholdMemberDetailForTax(String appNumber, String peopleInYourHome,String peopleCount,String taxFile ,String taxDependent) {
		FwDataCriteria[] criteria = null;
		try {
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-795");
			criteria = new FwDataCriteria[5];
			
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("HSHL_INDV_CT");
			criteria[0].setColumn_value(peopleCount);
			criteria[0].setData_type(FwConstants.SHORT);
			
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("HSHL_INDV_IN_CNT");
			criteria[1].setColumn_value(peopleInYourHome);
			criteria[1].setData_type(FwConstants.SHORT);
			
			criteria[2] = new FwDataCriteria();
			criteria[2].setColumn_name("HSHL_INDV_OUT_CNT");
			criteria[2].setColumn_value(taxFile);
			criteria[2].setData_type(FwConstants.SHORT);
			
			criteria[3] = new FwDataCriteria();
			criteria[3].setColumn_name("TAX_CLAIM_DEP_CNT");
			criteria[3].setColumn_value(taxDependent);
			criteria[3].setData_type(FwConstants.SHORT);
			
			criteria[4] = new FwDataCriteria();
			criteria[4].setColumn_name("APP_NUM");
			criteria[4].setColumn_value(appNumber);
			criteria[4].setData_type(FwConstants.STRING);
			
			sqlMap.put(FwConstants.CRITERIA, criteria);
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "storeHouseholdMemberDetailForTax", e);
			throw fe;
		}
	}
	
	/**
	* Method description here
	*/
	public void storeChildOutofHomeDetail(String appNumber, String childCount) {
		FwDataCriteria[] criteria = null;
		try {
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1069");
			criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("CHLD_OUT_HOME_CT");
			criteria[0].setColumn_value(childCount);
			criteria[0].setData_type(FwConstants.SHORT);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("APP_NUM");
			criteria[1].setColumn_value(appNumber);
			criteria[1].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "storeChildOutofHomeDetail", e);
			throw fe;
		}
	}

	
	/**
	 * Method for validating inHomePeople
	 * 
	 * @param inHomePeople
	 * @return true if inHomePeople is a valid integer and not blank
	 */
	public boolean peopleInHomeValidation(String inHomePeople){
		return (appMgr.isInteger(inHomePeople) && !(appMgr.isFieldEmpty(inHomePeople)));
	}
	
	/**
	 * This method is used to validate the household member details
	 * changed by Uma for BRGUS00287916
	 * @param appIndvCargo
	 * @param peopleInHome
	 * @param peopleOutOfHome
	 * @param currentPageStatus
	 * @param indvSeqNum
	 * @param appIndvBeforeColl
	 * @param beforeColl
	 * @param childrenAtHome
	 * @param peopleAlongWithSpouse
	 * @param nursingFlag
	 * @param appNursingCargo
	 * @return FwMessageList
	 */
	
	//Added appIndvCargo_indv1 into method arguments for ILIES -299721 
	public FwMessageList validateHouseholdMemberDetail(FwTransaction txnBean, APP_INDV_Cargo appIndvCargo,APP_INDV_Cargo appIndvCargo_indv1,String peopleInHome, 
			String peopleOutOfHome, int currentPageStatus,String indvSeqNum, 
			APP_INDV_Collection appIndvBeforeColl, Map beforeColl,String childrenAtHome,String peopleAlongWithSpouse,boolean nursingFlag,APP_NURSING_ADDRESS_Cargo appNursingCargo,
			APP_IN_PRFL_Cargo appInPrflCargo,String isHpe, short[] programKey){
		Map session = txnBean.getSession();
		Map request = txnBean.getRequest();
		char [] specialChars = {'#','/','\'','-','(',')','@','_',',','.',' '};
		String strFMA_Ind  		= null;
		String strFile_Tax_Sw  	= null;
		try {
			boolean childOutRes = false;
			SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy");
			int peopleCount = 0;
			
			boolean providerFlow = false;
			boolean docValid = false;
			boolean projValidDate = true;
			String projectedDisDate = null;
			if (null != appIndvCargo) {
				projectedDisDate = appIndvCargo.getProj_discharge_dt();
				log(ILog.DEBUG, "Entered::validateHouseholdMemberDetail::projectedDisDate::" + projectedDisDate);
				docValid = addDocValidationForInmateFacility(appIndvCargo, peopleInHome, session, providerFlow,docValid);
			}
			boolean docMhProvider = null != session.get(AppConstants.DOC_MH_PROVIDER) && AppConstants.YES.equalsIgnoreCase((String)session.get(AppConstants.DOC_MH_PROVIDER)) ? true : false;
			projValidDate = getProjValidateDate(dateFormat, docValid, projValidDate, projectedDisDate);
			log(ILog.DEBUG, "::validateHouseholdMemberDetail::docValid::"+docValid+"::projValidDate::"+projValidDate);
			
			if(indvSeqNum.equals(AppConstants.ONE) && peopleInHome != null){
				//validating the numbe of people in the house hold.
				if(appMgr.isFieldEmpty(peopleInHome)){
					//PCR 30814 - Changed the error message when number of people is not entered.					
					Object error[] = new Object[] { new FwMessageTextLabel("32123")};
					this.addMessageWithFieldValues("30112", error);
				}
				else if(!appMgr.isInteger(peopleInHome)){
					Object error[] = new Object[] { new FwMessageTextLabel("32123")};
					this.addMessageWithFieldValues("10010", error);
					//peopleInHome=indvSeqNum;
				}
				else {
					peopleCount += Integer.parseInt(peopleInHome);
				}
				if (peopleOutOfHome != null){
					//validating the numbe of people out of the house hold.
					if(appMgr.isFieldEmpty(peopleOutOfHome)){
						//PCR 30814 - Changed the error message when number of people is not entered.					
						Object error[] = new Object[] { new FwMessageTextLabel("28733")};
						this.addMessageWithFieldValues("30112", error);
					}
					else if(!appMgr.isInteger(peopleOutOfHome)){
						Object error[] = new Object[] { new FwMessageTextLabel("28733")};
						this.addMessageWithFieldValues("10010", error);
					}
					else {
						peopleCount += Integer.parseInt(peopleOutOfHome);
					}
					
				}
				
				if(peopleInHome.equals("0") || appMgr.isFieldEmpty(peopleInHome)){
					this.addMessageCode("10021");
				}
				else if(peopleCount > 18){
					Object error[] = new Object[] { new FwMessageTextLabel("30555")};
					this.addMessageWithFieldValues("20029", error);
					//prevents age validation from showing too
					//peopleCount = 0;
				}
				else if(currentPageStatus == FwConstants.DRIVER_REQUIRED )
				{
					if(Integer.parseInt(indvSeqNum)<=peopleCount || (!appMgr.isInteger(peopleInHome)))
						childOutRes = false;
					else
						childOutRes = true;
				}else if(currentPageStatus == FwConstants.DRIVER_COMPLETE || currentPageStatus == FwConstants.DRIVER_VISIT_AGAIN)
				{
					childOutRes=appIndvBeforeColl.getCargo(0).getChld_out_home_resp().equals("Y");
					
				}else if(currentPageStatus == FwConstants.DRIVER_ADD_NEW && beforeColl.get(AppConstants.PERSON_ADD)!=null )
				{
					String addCheck=(String)beforeColl.get(AppConstants.PERSON_ADD);
					if(addCheck.equals("I"))
						childOutRes = false;
					else
						childOutRes = true;
					
					//childOutRes=appIndvCargo.getChld_out_home_resp().equals("Y");
					//appIndvCargo.setChld_out_home_resp(childOutRes);
				}
			}
			//Added by Uma patil for Nursing Facility
			else if(indvSeqNum.equals(AppConstants.ONE) && nursingFlag){
			if(appIndvCargo.getMrtl_stat_cd()!=null && appIndvCargo.getMrtl_stat_cd().equalsIgnoreCase(AppConstants.YES)&&(peopleAlongWithSpouse==null || peopleAlongWithSpouse.trim().equals("")||(peopleAlongWithSpouse!=null &&!peopleAlongWithSpouse.trim().equals("")&& peopleAlongWithSpouse.trim().length()>0 && childrenAtHome!=null && !childrenAtHome.trim().equals("") && childrenAtHome.trim().length()>0))){
				this.addMessageCode("90466");
			}//Added by uma for Nursing Facility BRGUS00287916
			if(appIndvCargo.getMrtl_stat_cd()!=null && appIndvCargo.getMrtl_stat_cd().equalsIgnoreCase(AppConstants.YES)&&(peopleAlongWithSpouse!=null && peopleAlongWithSpouse.trim().length()>0 && Integer.parseInt(peopleAlongWithSpouse)==0)){
				this.addMessageCode("90480");
			}
			if(appIndvCargo.getMrtl_stat_cd()!=null && appIndvCargo.getMrtl_stat_cd().equalsIgnoreCase(AppConstants.NO)&&(childrenAtHome==null ||childrenAtHome.trim().equals("")||(peopleAlongWithSpouse!=null &&!peopleAlongWithSpouse.trim().equals("")&& peopleAlongWithSpouse.trim().length()>0 && childrenAtHome!=null && !childrenAtHome.trim().equals("") && childrenAtHome.trim().length()>0))){
				this.addMessageCode("90467");
			}
			if(appIndvCargo.getMrtl_stat_cd()!=null && appIndvCargo.getMrtl_stat_cd().equalsIgnoreCase(AppConstants.YES)&&peopleAlongWithSpouse!=null && !peopleAlongWithSpouse.trim().equals("")){
				peopleCount=Integer.parseInt(peopleAlongWithSpouse)+1;
			}else if(appIndvCargo.getMrtl_stat_cd()!=null && appIndvCargo.getMrtl_stat_cd().equalsIgnoreCase(AppConstants.NO)&&childrenAtHome!=null && !childrenAtHome.trim().equals("")){
				peopleCount=Integer.parseInt(childrenAtHome)+1;
			}
			if(peopleCount > 18){
				Object error[] = new Object[] { new FwMessageTextLabel("30555")};
				this.addMessageWithFieldValues("20029", error);
			}
			}
			//Changes Made by Varshi Kasarla for ILIES-282111. Added below condition to not validate personal Info on ABHMD page.
			if(indvSeqNum!= null && !(AppConstants.ONE).equals(indvSeqNum) ){
				
				//for the first name 
				if(appMgr.isFieldEmpty(appIndvCargo.getFst_nam())){
					Object error[] = new Object[] { new FwMessageTextLabel("30021")};
					//PCR 30814 - Changed the error message when First Name is not entered.
					this.addMessageWithFieldValues("95137", error);
				}
				else if(!appMgr.isInvalidFirstChar(appIndvCargo.getFst_nam())){
					Object error[] = new Object[] { new FwMessageTextLabel("30021")};
					this.addMessageWithFieldValues("20000", error);
				}
				else if(!appMgr.isSpecialAlphaNumeric(appIndvCargo.getFst_nam(),specialChars)){
					Object error[] = new Object[] { new FwMessageTextLabel("30021")};
					this.addMessageWithFieldValues("20061", error);
				}
				//for the middle initial
				if(!appMgr.isFieldEmpty(appIndvCargo.getMid_init()) && !appMgr.isAlpha(appIndvCargo.getMid_init())){
					Object error[] = new Object[] { new FwMessageTextLabel("30087")};
					this.addMessageWithFieldValues("20064", error);
				}
				//for the last name 
				if(appMgr.isFieldEmpty(appIndvCargo.getLast_nam())){
					Object error[] = new Object[] { new FwMessageTextLabel("30022")};
					//PCR 30814 - Changed the error message when Last Name is not entered.
					this.addMessageWithFieldValues("95137", error);
				}
				else if(!appMgr.isInvalidFirstChar(appIndvCargo.getLast_nam())){
					Object error[] = new Object[] { new FwMessageTextLabel("30022")};
					this.addMessageWithFieldValues("20000", error);
				}
				else if(!appMgr.isSpecialAlphaNumeric(appIndvCargo.getLast_nam(),specialChars)){
					Object error[] = new Object[] { new FwMessageTextLabel("30022")};
					this.addMessageWithFieldValues("20061", error);
				}
				//for gender field
				if(appMgr.isFieldEmpty(appIndvCargo.getSex_ind())){
					Object error[] = new Object[] { new FwMessageTextLabel("30019")};
					this.addMessageWithFieldValues("20006", error);
				}
				
				//for date of birth
				if(appMgr.isFieldEmpty(appIndvCargo.getBrth_dt())){
					Object error[] = new Object[] { new FwMessageTextLabel("30020")};
					this.addMessageWithFieldValues("20006", error);
				}
				else if (!appMgr.validateDate(appIndvCargo.getBrth_dt())){
					Object error[] = new Object[] { new FwMessageTextLabel("30020")};
					this.addMessageWithFieldValues("95138", error);
				}
				else if(!appMgr.futureDate(appIndvCargo.getBrth_dt())){
					Object error[] = new Object[] { new FwMessageTextLabel("30020")};
					this.addMessageWithFieldValues("20010", error);
				}
				else if (appMgr.isDateBeforeDate(appIndvCargo.getBrth_dt(),Date.valueOf("1900-01-01"))){
					Object error[] = new Object[] { new FwMessageTextLabel("30020")};
					this.addMessageWithFieldValues("20011", error);
				}else if(childOutRes)//Check for the birthdate of outside home child .Child should be <18 
				{
					IndividualAge age=dateRoutine.getAge(dateRoutine.getDateFromTimeStamp(appIndvCargo.getBrth_dt()),fwDate.getDate());
					if(age.getYears() >= 18 )
					{
						this.addMessageCode("40100");
					}
				}
				
				//EBD-29768 new change request:::: make Marital Status Required field -- starts
				//Changed by Uma for Nursing Facility issues BRGUS00287916
				if(!nursingFlag || (nursingFlag && indvSeqNum!=null && indvSeqNum.equalsIgnoreCase(AppConstants.ONE))){
					if(appIndvCargo.getMrtl_stat_cd()==null || appIndvCargo.getMrtl_stat_cd().equalsIgnoreCase("SEL")){
						if(null== isHpe || !isHpe.equals(FwConstants.YES)){
							Object error[] = new Object[] { new FwMessageTextLabel("30663")};
							this.addMessageWithFieldValues("95137", error);
						}
					}
				}
				
				//EBD-29768 new change request:::: make Marital Status Required field -- ends
				
			}
			
			//START: ILIES-126655 - Added by Sudha Srinivasan to validate when Tax Information is not chosen while Medical Assistance is selected.
			//ILIES-311729: Removing the tax information completeness check in people information screen
			//ILIES-315885 added provider check for displaying tax validation for provider portal 
			if (docMhProvider){
			strFMA_Ind 		= appInPrflCargo.getIndv_fma_rqst_ind();
			strFile_Tax_Sw 	= appIndvCargo.getFile_taxes_sw();			
			if(null != strFMA_Ind && !"".equals(strFMA_Ind) && "1".equals(strFMA_Ind)){
				if(null == strFile_Tax_Sw || "".equals(strFile_Tax_Sw) ){
					//	ILIES-149455: Removed HPE check 
			//		if(null== isHpe || !isHpe.equals(FwConstants.YES)){
						Object error[] = new Object[] { new FwMessageTextLabel("41017")};
						this.addMessageWithFieldValues("92031", error);
			//		}
				}
			}
			}
			//END: ILIES-126655 - Added by Sudha Srinivasan to validate when Tax Information is not chosen while Medical Assistance is selected.
			
			//for ssn
			if(!appMgr.isFieldEmpty(appIndvCargo.getSsn_num())){
				String ssnNumber = appIndvCargo.getSsn_num();
				ssnNumber = ssnNumber.trim();
				//ILIES-197788
				String ssnNoSpaces = ssnNumber.replaceAll(" ", ""); 
				if(!appMgr.isInteger(ssnNoSpaces)){
					Object error[] = new Object[] { new FwMessageTextLabel("30023")};
					this.addMessageWithFieldValues("10010", error);
				}
				else if(!appMgr.validateSSN(ssnNoSpaces) && !("0").equals(ssnNoSpaces)){
					Object error[] = new Object[] { new FwMessageTextLabel("30023")};
					this.addMessageWithFieldValues("20005", error);
				}
				else if( ssnNoSpaces.startsWith("9")){
					Object error[] = new Object[] { new FwMessageTextLabel("30023")};
					this.addMessageWithFieldValues("11811", error);
				}	
				String confirmSsn=appIndvCargo.getConfm_ssn_num();
				if(confirmSsn==null || confirmSsn.trim().length()<=0){
					this.addMessageCode("90404");
				}else if(!confirmSsn.trim().equals(ssnNumber)){
					this.addMessageCode("90403");
				}
			}
			if(appIndvCargo.getConfm_ssn_num()!=null && appIndvCargo.getConfm_ssn_num().trim().length()>0 
					&& appMgr.isFieldEmpty(appIndvCargo.getSsn_num())){
				Object error[] = new Object[] { new FwMessageTextLabel("30023")};
				this.addMessageWithFieldValues("30112", error);			
				
			}
			else if(appIndvCargo.getConfm_ssn_num().startsWith("9")){
				Object error[] = new Object[] { new FwMessageTextLabel("30023")};
				this.addMessageWithFieldValues("11811", error);
			}	
			
			
			//for ssn previous -- smulpuru
			if(!appMgr.isFieldEmpty(appIndvCargo.getSsn_num_prev())){
				String ssnNumberPrev = appIndvCargo.getSsn_num_prev();
				ssnNumberPrev = ssnNumberPrev.trim();
				if(!appMgr.isInteger(ssnNumberPrev)){
					Object error[] = new Object[] { new FwMessageTextLabel("42017")};
					this.addMessageWithFieldValues("10010", error);
				}
				else if(!appMgr.validateSSN(ssnNumberPrev) && !("0").equals(ssnNumberPrev)){
					Object error[] = new Object[] { new FwMessageTextLabel("42017")};
					this.addMessageWithFieldValues("20005", error);
				}
			}
			//for ssn date of birth
			if(!appMgr.isFieldEmpty(appIndvCargo.getSs_num_app_dt())){
				 if (!appMgr.validateDate(appIndvCargo.getSs_num_app_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getSs_num_app_dt()))){
					Object error[] = new Object[] { new FwMessageTextLabel("30581")};
					this.addMessageWithFieldValues("20033", error);
				}
				else if(!appMgr.futureDate(appIndvCargo.getSs_num_app_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getSs_num_app_dt()))){
					Object error[] = new Object[] { new FwMessageTextLabel("30564")};
					this.addMessageWithFieldValues("20034", error);
				}
				else if (appMgr.isDateBeforeDate(appIndvCargo.getSs_num_app_dt(),Date.valueOf("1900-01-01"))){
					Object error[] = new Object[] { new FwMessageTextLabel("30581")};
					this.addMessageWithFieldValues("20011", error);
				}
			}
			  
			//Changes Made by Varshi Kasarla for ILIES-282111. Removed Below code since no need to validate address on ABHMD page.
			if(appIndvCargo.getRes_wi_sw() != null && appIndvCargo.getIntn_res_resp() != null){
				if(appIndvCargo.getRes_wi_sw().equals("N") && appIndvCargo.getIntn_res_resp().equals("Y")){
					this.addMessageCode("20007");
				}
			}
			//validation for HPE app
			if(null!=isHpe && isHpe.equals(FwConstants.YES)){
				if(null == appIndvCargo.getLang_cd() || appIndvCargo.getLang_cd().equalsIgnoreCase("SEL")){
					Object error[] = new Object[] { new FwMessageTextLabel("30033")};
					this.addMessageWithFieldValues("30112", error);
				}
				if ((appInPrflCargo.getIndv_fs_rqst_ind()!=null&&appInPrflCargo.getIndv_fs_rqst_ind().trim().equals("1"))
						|| (appInPrflCargo.getIndv_hc_rqst_ind()!=null&&appInPrflCargo.getIndv_hc_rqst_ind().trim().equals("1"))
						|| (appInPrflCargo.getIndv_fma_rqst_ind()!=null&&appInPrflCargo.getIndv_fma_rqst_ind().trim().equals("1"))
						|| (appInPrflCargo.getIndv_msp_rqst_ind()!=null&&appInPrflCargo.getIndv_msp_rqst_ind().trim().equals("1"))
						|| (appInPrflCargo.getIndv_hpe_rqst_ind()!=null&&appInPrflCargo.getIndv_hpe_rqst_ind().trim().equals("1")) ){
				
					if(null == appIndvCargo.getUs_ctzn_sw()){
						Object error[] = new Object[] { new FwMessageTextLabel("30032")};
						this.addMessageWithFieldValues("30112", error);
					}
					if(null == appIndvCargo.getRes_wi_sw() ){
						Object error[] = new Object[] { new FwMessageTextLabel("90455")};
						this.addMessageWithFieldValues("30112", error);
					}
				}
			}
			
			//ILIES-273207 - validations for benefits which are mandatory
			if(appInPrflCargo!=null) {
				validateProgramSelection(appInPrflCargo, session);
				// hard validation when selecting health care and doesn't select backdate question
				// or hard validation when selecting back date question and not selecting backdated months
				if((appInPrflCargo.getIndv_fma_rqst_ind()!=null && appInPrflCargo.getBackdt_med_app()!=null && appInPrflCargo.getIndv_fma_rqst_ind().equals("1") && appInPrflCargo.getBackdt_med_app().equals("3"))
						|| ("1".equals(appInPrflCargo.getBackdt_med_app())&& ("3".equals(appInPrflCargo.getMa_backdt_mo_1()) || "3".equals(appInPrflCargo.getMa_backdt_mo_2()) || "3".equals(appInPrflCargo.getMa_backdt_mo_3())) ) ) {
					if(this.getMessageList()!=null) {
						if(!this.getMessageList().containsMessage("95500")) {
							this.addMessageCode("95500");
						}
					}
					else {
						this.addMessageCode("95500");
					}
				}
				
				
				//FPP validation 
				if((appInPrflCargo.getIndv_fpp_pgm()!=null && appInPrflCargo.getBackdt_fpp_app()!=null && appInPrflCargo.getIndv_fpp_pgm().equals("1") 
						&& appInPrflCargo.getBackdt_fpp_app().equals("3"))
						|| ("1".equals(appInPrflCargo.getBackdt_fpp_app())&& ("3".equals(appInPrflCargo.getMa_backdt_mo_1()) 
								|| "3".equals(appInPrflCargo.getMa_backdt_mo_2()) || "3".equals(appInPrflCargo.getMa_backdt_mo_3())))) {
					if(this.getMessageList()!=null) {
						if(!this.getMessageList().containsMessage("95500")) {
							this.addMessageCode("95500");
						}
					}
					else {
						this.addMessageCode("95500");
					}
				}
				
				//DOC MH
				getDOCValidforSnapCash(appInPrflCargo, dateFormat, docValid, projValidDate, projectedDisDate);
				
			}
			
			//ILIES-273207 - Hard validation for backdate months
			if((appInPrflCargo.getBackdt_med_app()!=null && appInPrflCargo.getBackdt_med_app().trim().equals("1")) 
					|| (appInPrflCargo.getBackdt_fpp_app()!=null && appInPrflCargo.getBackdt_fpp_app().trim().equals("1"))) {
				if((appInPrflCargo.getMa_backdt_mo_1() == null || appInPrflCargo.getMa_backdt_mo_1().trim().length()<=0 
						|| appInPrflCargo.getMa_backdt_mo_1().trim().equals("3") || appInPrflCargo.getMa_backdt_mo_1().trim().equals("0"))
						&& (appInPrflCargo.getMa_backdt_mo_2() == null || appInPrflCargo.getMa_backdt_mo_2().trim().length()<=0
							|| appInPrflCargo.getMa_backdt_mo_2().trim().equals("3") || appInPrflCargo.getMa_backdt_mo_2().trim().equals("0"))
						&& (appInPrflCargo.getMa_backdt_mo_3() == null || appInPrflCargo.getMa_backdt_mo_3().trim().length()<=0 
								|| appInPrflCargo.getMa_backdt_mo_3().trim().equals("3") || appInPrflCargo.getMa_backdt_mo_3().trim().equals("0")))
				{
					
					if(appInPrflCargo.getBackdt_med_app()!=null && appInPrflCargo.getBackdt_med_app().trim().equals("1")) 
					     this.addMessageCode("99213");
					else if(appInPrflCargo.getBackdt_fpp_app()!=null && appInPrflCargo.getBackdt_fpp_app().trim().equals("1")){
						  this.addMessageCode("99220");
					}
				}
			}
			
			Map httpSessionMap = (Map) session.get(FwConstants.HTTP_SESSION);
			String language = (String) httpSessionMap.get(AppConstants.LANGUAGE);
			ABProgramInformationBO abProgramInformationBo = new ABProgramInformationBO();
			//ILIES-273207 - vaidation for backdated months
			if((appInPrflCargo.getBackdt_med_app()!=null && appInPrflCargo.getBackdt_med_app().trim().equals("1")) 
					   || "1".equalsIgnoreCase(appInPrflCargo.getBackdt_fpp_app())) {
				String[] filterOneVal = dateRoutine.getBackDatedMonths(fwDate.getDate());
	            String[] filterVal = new String[1];
	            filterVal[0] = filterOneVal[0];
	            String month1 = abProgramInformationBo.getMonthName(language, filterVal);

	            filterVal[0] = filterOneVal[1];
	            String month2 = abProgramInformationBo.getMonthName(language, filterVal);

	            filterVal[0] = filterOneVal[2];
	            String month3 = abProgramInformationBo.getMonthName(language, filterVal);
	            String and = FwConstants.SPACE + (String) FwMessageFormatter.getCachedText(10065, language) + FwConstants.SPACE;
	            
	            String month_1 = (appInPrflCargo.getMa_backdt_mo_1() == null || "0".equalsIgnoreCase(appInPrflCargo.getMa_backdt_mo_1())) ? null : "1";
	            String month_2 = (appInPrflCargo.getMa_backdt_mo_2() == null || "0".equalsIgnoreCase(appInPrflCargo.getMa_backdt_mo_2())) ? null : "1";
	            String month_3 = (appInPrflCargo.getMa_backdt_mo_3() == null || "0".equalsIgnoreCase(appInPrflCargo.getMa_backdt_mo_3())) ? null : "1";
	            if (month_2 != null && null != month_3 && null == month_1)
	            {
	                 Object[] messageFieldValue = new Object[2];
	                 messageFieldValue[0] = month2 + and + month3;
	                 messageFieldValue[1] = month1;
	                 if("1".equalsIgnoreCase(appInPrflCargo.getBackdt_fpp_app()) &&  !"1".equalsIgnoreCase(appInPrflCargo.getBackdt_med_app()))
	                         this.addMessageWithFieldValues("99218", messageFieldValue);
	                 else{
	                	 this.addMessageWithFieldValues("71045", messageFieldValue);
	                 }
	            }
	            else if (null != month_3 && null == month_2 && null == month_1)
	            {
	                 Object[] messageFieldValue = new Object[2];
	                 messageFieldValue[0] = month3;
	                 messageFieldValue[1] = month2 + and + month1;
	                 if("1".equalsIgnoreCase(appInPrflCargo.getBackdt_fpp_app()) &&  !"1".equalsIgnoreCase(appInPrflCargo.getBackdt_med_app()))
                         this.addMessageWithFieldValues("99218", messageFieldValue);
                     else{
                	     this.addMessageWithFieldValues("71045", messageFieldValue);
                     }
	            }
	            else if (null != month_3 && null != month_1 && null == month_2)
	            {
	                 Object[] messageFieldValue = new Object[2];
	                 messageFieldValue[0] = month3 + and + month1;
	                 messageFieldValue[1] = month2;
	                 if("1".equalsIgnoreCase(appInPrflCargo.getBackdt_fpp_app()) &&  !"1".equalsIgnoreCase(appInPrflCargo.getBackdt_med_app()))
                         this.addMessageWithFieldValues("99218", messageFieldValue);
                     else{
                	    this.addMessageWithFieldValues("71045", messageFieldValue);
                      }
	            }
	            else if (null != month_2 && null == month_1)
	            {
	                 Object[] messageFieldValue = new Object[2];
	                 messageFieldValue[0] = month2;
	                 messageFieldValue[1] = month1;
	                 if("1".equalsIgnoreCase(appInPrflCargo.getBackdt_fpp_app()) &&  !"1".equalsIgnoreCase(appInPrflCargo.getBackdt_med_app()))
                         this.addMessageWithFieldValues("99218", messageFieldValue);
                     else{
                	     this.addMessageWithFieldValues("71045", messageFieldValue);
                     }
	            }
			}
				
				
              // Validation for Date of Leaving facility
			//Changes Made by Varshi Kasarla for ILIES-282111. 
			if(!appMgr.isFieldEmpty(appIndvCargo.getDt_leave_facty())){
				 if (!appMgr.validateDate(appIndvCargo.getDt_leave_facty()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getDt_leave_facty()))){
					Object error[] = new Object[] { new FwMessageTextLabel("36029")};
					this.addMessageWithFieldValues("36030", error);
				}
				else if(!appMgr.futureDate(appIndvCargo.getDt_leave_facty()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getDt_leave_facty()))){
					Object error[] = new Object[] { new FwMessageTextLabel("36029")};
					this.addMessageWithFieldValues("20034", error);
				}
				else if (appMgr.isDateBeforeDate(appIndvCargo.getDt_leave_facty(),Date.valueOf("1900-01-01"))){
					Object error[] = new Object[] { new FwMessageTextLabel("36029")};
					this.addMessageWithFieldValues("20011", error);
				}
			}
			//Indrani - AFB self service expansion
			//Changes Made by Varshi Kasarla for ILIES-282111.
			if(!appMgr.isFieldEmpty(appIndvCargo.getAlien_entry_dt())){
				 if (!appMgr.validateDate(appIndvCargo.getAlien_entry_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getAlien_entry_dt()))){
					Object error[] = new Object[] { new FwMessageTextLabel("81303")};
					this.addMessageWithFieldValues("81300", error);
				}
				else if(!appMgr.futureDate(appIndvCargo.getAlien_entry_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getAlien_entry_dt()))){
					Object error[] = new Object[] { new FwMessageTextLabel("81303")};
					this.addMessageWithFieldValues("20034", error);
				}
				else if (appMgr.isDateBeforeDate(appIndvCargo.getAlien_entry_dt(),Date.valueOf("1900-01-01"))){
					Object error[] = new Object[] { new FwMessageTextLabel("81303")};
					this.addMessageWithFieldValues("20011", error);
				}
			}
			//Validations for Alien_status_begin_dt
			if(StringUtils.isNotEmpty(appIndvCargo.getAlien_status_begin_dt())){
				boolean alien = false;						
				 if(!appMgr.isFieldEmpty(appIndvCargo.getDocumented_alien_sw()) && appIndvCargo.getDocumented_alien_sw().equals("Y") && appIndvCargo.getUs_ctzn_sw().equals(AppConstants.NO)){
					 if(appMgr.isFieldEmpty(appIndvCargo.getAlien_status_begin_dt()) ){				 
						 this.addMessageCode("72029");	
						 alien =true;
				    }
					if(!appMgr.futureDate(appIndvCargo.getAlien_status_begin_dt()) && alien !=true && appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt())){
						this.addMessageCode("82029");
						alien =true;
					}
					 if (!appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt()) && alien !=true){
						this.addMessageCode("82021");
						alien =true;
					}
					
					 //ILIES-299721 CSCD cannot be prior to Individual DOB -START
					 java.sql.Date dateValueOfDOB = getDOB(indvSeqNum,appIndvCargo_indv1,appIndvCargo);
					 if (dateValueOfDOB != null
							 && appMgr.isDateBeforeDate(appIndvCargo.getAlien_status_begin_dt(), dateValueOfDOB) 
							 && !dateValueOfDOB.toString().equals(AppConstants.HIGH_DATE) && alien!=true){
						 this.addMessageCode("99325");
						 alien=true;
					 }
					 //ILIES-299721 CSCD cannot be prior to Individual DOB -END
				}
			   //Validations for Alien_status_begin_dt 
				 boolean alienNo = false;
				 if(!appMgr.isFieldEmpty(appIndvCargo.getDocumented_alien_sw()) && appIndvCargo.getDocumented_alien_sw().equals("N") && !appMgr.isFieldEmpty(appIndvCargo.getUndoc_noncitizen_asylum_sw()) && appIndvCargo.getUndoc_noncitizen_asylum_sw().equals("Y")){
					 if(appMgr.isFieldEmpty(appIndvCargo.getAlien_status_begin_dt()) ){				 
						 this.addMessageCode("72029");	
						 alienNo =true;
				    }
					if(!appMgr.futureDate(appIndvCargo.getAlien_status_begin_dt()) && alienNo !=true && appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt())){
						this.addMessageCode("82029");
						alienNo =true;
					}
					 if (!appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt()) && alienNo !=true){
						this.addMessageCode("82021");
						alienNo =true;
					}
				}
				 if(!appMgr.isFieldEmpty(appIndvCargo.getDocumented_alien_sw()) && appIndvCargo.getDocumented_alien_sw().equals("N") && !appMgr.isFieldEmpty(appIndvCargo.getUndoc_noncitizen_t_visa_sw()) && appIndvCargo.getUndoc_noncitizen_t_visa_sw().equals("Y")){
					 if(appMgr.isFieldEmpty(appIndvCargo.getAlien_status_begin_dt()) ){				 
						 this.addMessageCode("72029");	
						 alienNo =true;
				    }
					if(!appMgr.futureDate(appIndvCargo.getAlien_status_begin_dt()) && alienNo !=true && appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt())){
						this.addMessageCode("82029");
						alienNo =true;
					}
					 if (!appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt()) && alienNo !=true){
						this.addMessageCode("82021");
						alienNo =true;
					}
				}
				 if(!appMgr.isFieldEmpty(appIndvCargo.getDocumented_alien_sw()) && appIndvCargo.getDocumented_alien_sw().equals("N") && !appMgr.isFieldEmpty(appIndvCargo.getUndoc_noncitizen_u_visa_sw()) && appIndvCargo.getUndoc_noncitizen_u_visa_sw().equals("Y")){
					 if(appMgr.isFieldEmpty(appIndvCargo.getAlien_status_begin_dt()) ){				 
						 this.addMessageCode("72029");	
						 alienNo =true;
				    }
					if(!appMgr.futureDate(appIndvCargo.getAlien_status_begin_dt()) && alienNo !=true && appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt())){
						this.addMessageCode("82029");
						alienNo =true;
					}
					 if (!appMgr.validateDate(appIndvCargo.getAlien_status_begin_dt()) && alienNo !=true){
						this.addMessageCode("82021");
						alienNo =true;
					}
				}
			 }
			
			if(!appMgr.isFieldEmpty(appIndvCargo.getTribe_name())){				
				if(!appMgr.isInvalidFirstChar(appIndvCargo.getTribe_name())){
				Object error[] = new Object[] { new FwMessageTextLabel("80078")};
				this.addMessageWithFieldValues("20000", error);
			}
			else if(!appMgr.isSpecialAlphaNumeric(appIndvCargo.getTribe_name(),specialChars)){
				Object error[] = new Object[] { new FwMessageTextLabel("80078")};
				this.addMessageWithFieldValues("20061", error);
			} }
				
			
			  
			// Validation for prior benefits section by sanjeeva nemani
			
			//validating other state response
			if(appIndvCargo.getAssistance_other_state_sw()==null || appIndvCargo.getAssistance_other_state_sw().equals("N")){
				if(appIndvCargo.getOther_state_cd()!=null && !appIndvCargo.getOther_state_cd().equals("AA")|| (appIndvCargo.getOther_county()!=null && !appIndvCargo.getOther_county().trim().equals(""))
						||(appIndvCargo.getCase_worker_name()!=null && !appIndvCargo.getCase_worker_name().trim().equals("")) || (appIndvCargo.getCase_worker_phone_num()!=null && !appIndvCargo.getCase_worker_phone_num().trim().equals(""))
						||(appIndvCargo.getMoved_to_mi_dt()!=null && !appIndvCargo.getMoved_to_mi_dt().trim().equals(""))){
					this.addMessageCode("90483");
				}
			}
			
			
			//for phone number
			if (appIndvCargo.getCase_worker_phone_num()!=null && !appMgr.isFieldEmpty(appIndvCargo.getCase_worker_phone_num())) {
				if (!appMgr.isInteger(appIndvCargo.getCase_worker_phone_num())) {
					Object error[] = new Object[] { new FwMessageTextLabel(
							"91817") };
					this.addMessageWithFieldValues("90402", error);
				} else if (!appMgr.validatePhone(appIndvCargo
						.getCase_worker_phone_num())) {
					Object error[] = new Object[] { new FwMessageTextLabel(
							"91817") };
					this.addMessageWithFieldValues("20048", error);
				}
			}
			
			
			// for the city
			 if (appIndvCargo.getOther_county()!=null && !appMgr.isAlphaWithSpace(appIndvCargo.getOther_county())) {
				Object error[] = new Object[] { new FwMessageTextLabel("91819") };
				this.addMessageWithFieldValues("20064", error);
			}
			
			 //for moved to michigan date
			//Changes Made by Varshi Kasarla for ILIES-282111.
			 if(appIndvCargo.getMoved_to_mi_dt()!=null && !appMgr.isFieldEmpty(appIndvCargo.getMoved_to_mi_dt())){
				 if (!appMgr.validateDate(appIndvCargo.getMoved_to_mi_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getMoved_to_mi_dt()))){
							Object error[] = new Object[] { new FwMessageTextLabel("91825")};
							this.addMessageWithFieldValues("90482", error);
				 }
				 else if(!appMgr.futureDate((appIndvCargo.getMoved_to_mi_dt())) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getMoved_to_mi_dt()))){
					  Object error[] = new Object[] { new FwMessageTextLabel("91825")};
					  this.addMessageWithFieldValues("20034", error);
				}
			 }
			 //for assistance from other state date--------------smulpuru--ILIES121325
			//Changes Made by Varshi Kasarla for ILIES-282111.
			 if(appIndvCargo.getOther_state_dt()!=null && !appMgr.isFieldEmpty(appIndvCargo.getOther_state_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getOther_state_dt()))){
				 if (!appMgr.validateDate(appIndvCargo.getOther_state_dt())){
							Object error[] = new Object[] { new FwMessageTextLabel("42018")};
							this.addMessageWithFieldValues("90482", error);
				 }
				 else if(!appMgr.futureDate((appIndvCargo.getOther_state_dt())) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getOther_state_dt()))){
					  Object error[] = new Object[] { new FwMessageTextLabel("42018")};
					  this.addMessageWithFieldValues("20034", error);
				}
			 }
			
			 //for caseworker name 
			 if(appIndvCargo.getCase_worker_name()!=null && !appIndvCargo.getCase_worker_name().trim().equals("") && !appMgr.isInvalidFirstChar(appIndvCargo.getCase_worker_name())){
					Object error[] = new Object[] { new FwMessageTextLabel("91826")};
					this.addMessageWithFieldValues("20000", error);
			 }
			 else if(appIndvCargo.getCase_worker_name()!=null && !appIndvCargo.getCase_worker_name().trim().equals("") && !appMgr.isSpecialAlphaNumeric(appIndvCargo.getCase_worker_name(),specialChars)){
					Object error[] = new Object[] { new FwMessageTextLabel("91826")};
					this.addMessageWithFieldValues("20061", error);
			 }
			 //michigan assistance
			 if(appIndvCargo.getMi_assistance_sw()==null || appIndvCargo.getMi_assistance_sw().equals("N")){
				 if(appIndvCargo.getMi_assistance_name()!=null && !appIndvCargo.getMi_assistance_name().trim().equals("")) {
					 this.addMessageCode("90484");
				 }
				 
			 }
			 
			 //for Mi assistance name 
			 if(appIndvCargo.getMi_assistance_name()!=null && !appIndvCargo.getMi_assistance_name().trim().equals("") && !appMgr.isInvalidFirstChar(appIndvCargo.getMi_assistance_name())){
					Object error[] = new Object[] { new FwMessageTextLabel("91827")};
					this.addMessageWithFieldValues("20000", error);
			 }
			 else if(appIndvCargo.getMi_assistance_name()!=null && !appIndvCargo.getMi_assistance_name().trim().equals("") && !appMgr.isSpecialAlphaNumeric(appIndvCargo.getMi_assistance_name(),specialChars)){
					Object error[] = new Object[] { new FwMessageTextLabel("91827")};
					this.addMessageWithFieldValues("20061", error);
			 }
			 
			//The new validation will be triggered if the total length is less than 7 characters including the ‘A’, and the maximum length of the text box will be set to 9.
			 boolean flag =false;
			 if(appIndvCargo.getAlien_reg_num()!=null && !appIndvCargo.getAlien_reg_num().isEmpty()){
			 if( appIndvCargo.getAlien_reg_num().matches("([aA]{1}[0-9]{7})" )||appIndvCargo.getAlien_reg_num().matches("([aA]{1}[0-9]{8})" ) || appIndvCargo.getAlien_reg_num().matches("([aA]{1}[0-9]{9})" )){
				 flag = false;
			 }else{
				 flag =true;
			 }
			 }
			//Changes Made by Varshi Kasarla for ILIES-282111.
				if(!appMgr.isFieldEmpty(appIndvCargo.getAlien_reg_num()) && !("0").equals(appIndvCargo.getAlien_reg_num())){
					String alienRegNumber = appIndvCargo.getAlien_reg_num();
					alienRegNumber = alienRegNumber.trim();
					if(flag==true ){
						 this.addMessageCode("99029");	
					}

				}
				
				
				if(!appMgr.isFieldEmpty(appIndvCargo.getFclty_nm())){
					if(!appMgr.isInvalidFirstChar(appIndvCargo.getFclty_nm())){
					Object error[] = new Object[] { new FwMessageTextLabel("39403")};
					this.addMessageWithFieldValues("20000", error);
					}
					else if(!appMgr.isSpecialAlphaNumeric(appIndvCargo.getFclty_nm(),specialChars)){
					Object error[] = new Object[] { new FwMessageTextLabel("39403")};
					this.addMessageWithFieldValues("20061", error);
					}
				}
				//Changes Made by Varshi Kasarla for ILIES-282111.
				if(!appMgr.isFieldEmpty(appIndvCargo.getFclty_strt_dt())){
					 if (!appMgr.validateDate(appIndvCargo.getFclty_strt_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getFclty_strt_dt()))){
						Object error[] = new Object[] { new FwMessageTextLabel("39402")};
						this.addMessageWithFieldValues("36030", error);
					}
					else if(!appMgr.futureDate(appIndvCargo.getFclty_strt_dt()) && !((AppConstants.HIGH_TIMESTAMP).equals(appIndvCargo.getFclty_strt_dt()))){
						Object error[] = new Object[] { new FwMessageTextLabel("39402")};
						this.addMessageWithFieldValues("20034", error);
					}
					else if (appMgr.isDateBeforeDate(appIndvCargo.getFclty_strt_dt(),Date.valueOf("1900-01-01"))){
						Object error[] = new Object[] { new FwMessageTextLabel("39402")};
						this.addMessageWithFieldValues("20011", error);
					}
				}
				
				//ILIES-311729: Removing the tax information completeness check in people information screen
				//ILIES-315885 added provider check for displaying tax validation for provider portal 
				if(docMhProvider && programKey[0]==1){ //tax is mandatory if medical assistance is choosen.
					//Added validation for Tax Information  as per ILIES-126057
					if(appMgr.isFieldEmpty(appIndvCargo.getFile_taxes_sw())){
					//	ILIES-149455: Removed HPE check 
			//			if(null== isHpe || !isHpe.equals(FwConstants.YES)){
							Object error[] = new Object[] { new FwMessageTextLabel("41029")};
							this.addMessageWithFieldValues("30112", error);
				//		}
					}	
				}
				//ILIES-164141: Added by: Arpanday- make  Where does this person live? Required field -- starts  
				
					if((appIndvCargo.getLive_arng_typ()==null || appIndvCargo.getLive_arng_typ().equalsIgnoreCase("SEL"))){
						Object error[];
						if(appMgr.isFieldEmpty(appIndvCargo.getFst_nam())){
							error = new Object[] { new FwMessageTextLabel("131739" +
									"")};							
						}
						else{
							error = new Object[] {appIndvCargo.getFst_nam()};							
						}							
						this.addMessageWithFieldValues("95103", error);
					}
							
				//ILIES-164141 make  Where does this person live? Required field -- ends
				
				if(isHpe == null || isHpe.equals(FwConstants.NO)){
				// Added validation for ILIES-126722
				 if(!appMgr.isFieldEmpty(appIndvCargo.getDocumented_alien_sw()) && appIndvCargo.getDocumented_alien_sw().equals("Y")){
					 if(!appMgr.isFieldEmpty(appIndvCargo.getDocument_type()) && "SEL".equals(appIndvCargo.getDocument_type())) {
						 this.addMessageCode("90512");  
					 }
				}
			 
				 if(appMgr.isFieldEmpty(appIndvCargo.getDocument_number())&&appMgr.isFieldEmpty(appIndvCargo.getAlien_entry_dt())&&"PR".equals(appIndvCargo.getDocument_type())) {
					 this.addMessageCode("97014"); 
				 }
				 
				if (!appMgr.isFieldEmpty(appIndvCargo.getDocument_type())) {
					String warning = "";
					if (request.get(FwConstants.WARNING_MSG_DETAILS) != null) {
						warning = (String) request.get(FwConstants.WARNING_MSG_DETAILS);
					}

					// PR I-551 (Permanent Resident Card)
					// Card Number - 131870
					if ("PR".equals(appIndvCargo.getDocument_type())) {
						if (!warning.contains("97116") && appMgr.isFieldEmpty(appIndvCargo.getDocument_number())) {
							this.addMessageCode("97116");
							session.put("SKIP_VALIDATE", "skipvalidate");
						}
						if (!warning.contains("97117") && !appMgr.isFieldEmpty(appIndvCargo.getDocument_number()) && !appIndvCargo.getDocument_number().matches("([a-zA-Z]{3}[0-9]{10})")) {
							this.addMessageCode("97117");
							session.put("SKIP_VALIDATE", "skipvalidate");
						}
					}

					// EA I-766 (Employment Authorization Card)
					// Document Number - 99802
					if ("EA".equals(appIndvCargo.getDocument_type())) {
						if (!warning.contains("97118") && appMgr.isFieldEmpty(appIndvCargo.getDocument_number())) {
							this.addMessageCode("97118");
							session.put("SKIP_VALIDATE", "skipvalidate");
						}
						if (!warning.contains("97119") && !appMgr.isFieldEmpty(appIndvCargo.getDocument_number()) && !appIndvCargo.getDocument_number().matches("([a-zA-Z]{3}[0-9]{10})")) {
							this.addMessageCode("97119");
							session.put("SKIP_VALIDATE", "skipvalidate");
						}
					}

					// AD I-94 (Arrival/Departure Record)
					// FP I-94 (Arrival/Departure Record) in Unexpired Foreign Passport
					// I-94 Number - 131871
					if ("AD".equals(appIndvCargo.getDocument_type()) ) {
						if (!warning.contains("97120") && appMgr.isFieldEmpty(appIndvCargo.getDocument_number())) {
							this.addMessageCode("97120");
							session.put("SKIP_VALIDATE", "skipvalidate");
						}
						if (!warning.contains("97121") && !appMgr.isFieldEmpty(appIndvCargo.getDocument_number()) && !appIndvCargo.getDocument_number().matches("([0-9]{11})")
								&& !appIndvCargo.getDocument_number().matches("([0-9]{9}[a-zA-Z0-9]{1}[0-9]{1})")) {
							this.addMessageCode("97121");
							session.put("SKIP_VALIDATE", "skipvalidate");
						}
					}
				}
			 }
			//Changes Made by Varshi Kasarla for ILIES-282111. Removed unused declaration. Sonar Issue.
				
				//ERJA validations
				 Map<String, String> validationsMap = new HashMap<String, String>();
				 if(appIndvCargo.getSex_at_birth_details() != null && !"".equalsIgnoreCase(appIndvCargo.getSex_at_birth_details())){
					 validationsMap.put("sexAssignedAtBirthText", appIndvCargo.getSex_at_birth_details());
				 }
				 if(appIndvCargo.getGender_identity_details() != null && !"".equalsIgnoreCase(appIndvCargo.getGender_identity_details())){
					 validationsMap.put("genderIdentityText", appIndvCargo.getGender_identity_details());
				 }
				 if(appIndvCargo.getSexual_orientation_details() != null && !"".equalsIgnoreCase(appIndvCargo.getSexual_orientation_details())){
					 validationsMap.put("sexualOrientationText", appIndvCargo.getSexual_orientation_details());
				 }
				 
				 if(!validationsMap.isEmpty()){
					validateTextFields(validationsMap);
				 }
				
			return this.getMessageList();
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "validateHouseholdMemberDetail", e);
			throw fe;
		}
	}
	//ILIES-308303 CSCD cannot be prior to Individual DOB -START
	private Date getDOB(String indvSeqNum, APP_INDV_Cargo appIndvCargo_indv1, APP_INDV_Cargo appIndvCargo) {
		SimpleDateFormat sdf = null;
		java.util.Date date = null;
		
		java.sql.Date dateValueOfDOB =null;
		try {
			if (indvSeqNum != null && indvSeqNum.equals("1")) {
				sdf = new SimpleDateFormat("yyyy-MM-dd");
				if (appIndvCargo_indv1 != null && !(appMgr.isFieldEmpty (appIndvCargo_indv1.getBrth_dt()) ) && appMgr.validateDate(appIndvCargo_indv1.getBrth_dt())) {
					date = sdf.parse(appIndvCargo_indv1.getBrth_dt());
				}
			} else {
				sdf = new SimpleDateFormat("MM/dd/yyyy");
				if (appIndvCargo != null && !(appMgr.isFieldEmpty (appIndvCargo.getBrth_dt()) ) && appMgr.validateDate(appIndvCargo.getBrth_dt())) {
					date = sdf.parse(appIndvCargo.getBrth_dt());
				}
			}
			
			if (date != null) {
				dateValueOfDOB = new java.sql.Date(date.getTime());
			}
		} catch (ParseException e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		}
		return dateValueOfDOB;
	}
	//ILIES-308303 CSCD cannot be prior to Individual DOB -END
	
	private void getDOCValidforSnapCash(APP_IN_PRFL_Cargo appInPrflCargo, SimpleDateFormat dateFormat, boolean docValid,
			boolean projValidDate, String projectedDisDate){
	 try{
			if(projValidDate && docValid && appInPrflCargo.getIndv_fs_rqst_ind()!=null && appInPrflCargo.getIndv_fs_rqst_ind().trim().equals("1")){
					java.util.Date today = dateFormat.parse(dateFormat.format(new java.util.Date()));
					java.util.Date checkProjDate = (java.util.Date) dateFormat.parse(projectedDisDate);
					log(ILog.DEBUG, "validateHouseholdMemberDetail::checkProjDate::"+checkProjDate+"::today::"+today);
					Calendar cal = Calendar.getInstance();
					cal.setTime(today);
					cal.add(Calendar.DAY_OF_YEAR, 10);
					java.util.Date systemDatePlus10 = cal.getTime();
					if(checkProjDate.after(systemDatePlus10)){
						this.addMessageCode("99301");
					}
			}
			if(docValid && appInPrflCargo.getIndv_hc_rqst_ind()!=null && appInPrflCargo.getIndv_hc_rqst_ind().trim().equals("1"))
			{
				this.addMessageCode("99300");
			}
	   } catch(Exception e) {
		   log(ILog.ERROR, "getDOCValidforSnapCash::appNumber"+appInPrflCargo.getApp_num()+"::exception message::"+e.getMessage()
			+"::cause::"+e.getCause()+"::stackTrace::"+e.getStackTrace());
			FwException fe = createFwException(this.getClass().getName(), "getDOCValidforSnapCash", e);
			throw fe;
		}
	}

	private boolean getProjValidateDate(SimpleDateFormat dateFormat, boolean docValid, boolean projValidDate,
			String projectedDisDate){
	 try{
		   if(docValid){
				if(!appMgr.validateDate(projectedDisDate)){
					projValidDate = false;
					this.addMessageCode("99296");
				}
				if(projValidDate){
					java.util.Date today = dateFormat.parse(dateFormat.format(new java.util.Date()));
					java.util.Date checkProjDate = (java.util.Date) dateFormat.parse(projectedDisDate);
					if(today == null || checkProjDate == null ){
						log(ILog.DEBUG,"returning due to null in the above dates");
						return false;
					}
					log(ILog.DEBUG, "validateHouseholdMemberDetail::checkProjDate::"+checkProjDate+"::today::"+today);
					if(checkProjDate.before(today)){
						this.addMessageCode("99297"); //past date
					}
				}
			} 
	  }catch(Exception e) {
		  log(ILog.ERROR, "getProjValidateDate::exception message::"+e.getMessage()+"::cause::"+e.getCause()+"::stackTrace::"+e.getStackTrace());
		  FwException fe = createFwException(this.getClass().getName(), "getProjValidateDate", e);
		  throw fe;
	  }
	 	return projValidDate;
	}

	private boolean addDocValidationForInmateFacility(APP_INDV_Cargo appIndvCargo, String peopleInHome, Map session,
			boolean providerFlow, boolean docValid) {
		String providerId = null;
		String childrenApplication = null; 
		String docMhProvider = null;
		try{
			if(null != session && null!= session.get(AppConstants.APP_PRVD_ID)){
				 providerId = (String) session.get(AppConstants.APP_PRVD_ID);
				 childrenApplication = (String) session.get("CHILDREN_APPLICATION");
				 docMhProvider = (String) session.get(AppConstants.DOC_MH_PROVIDER);
				  if(StringUtils.isNotEmpty(providerId)){
					  providerFlow = true;
				  }
			}
			if(appIndvCargo.getLive_arng_typ() != null){
				if(("JL".equalsIgnoreCase(appIndvCargo.getLive_arng_typ())  || "SM".equalsIgnoreCase(appIndvCargo.getLive_arng_typ()) || "PS".equalsIgnoreCase(appIndvCargo.getLive_arng_typ())) 
						&& (AppConstants.YES.equalsIgnoreCase(docMhProvider) || !AppConstants.YES.equalsIgnoreCase(childrenApplication))){
					docValid = true;
					  if(!providerFlow){
						  if(StringUtils.isEmpty(appIndvCargo.getFacility_cd())){
							  this.addMessageCode("99303");	
						  }
						  if(StringUtils.isNotEmpty(peopleInHome) && appMgr.isInteger(peopleInHome) && Integer.parseInt(peopleInHome) > 1){
							if ("JL".equalsIgnoreCase(appIndvCargo.getLive_arng_typ())) {
								this.addMessageCode("99294");
							}else if ("SM".equalsIgnoreCase(appIndvCargo.getLive_arng_typ())) {
								this.addMessageCode("99304");
							}else if ("PS".equalsIgnoreCase(appIndvCargo.getLive_arng_typ())) {
								this.addMessageCode("99305");
							}
						  }
					 }
					  
					  if("JL".equalsIgnoreCase(appIndvCargo.getLive_arng_typ())  || "PS".equalsIgnoreCase(appIndvCargo.getLive_arng_typ())){
							if(StringUtils.isEmpty(appIndvCargo.getInmate_num()) || !appMgr.isAlphaNumeric(appIndvCargo.getInmate_num())){
								this.addMessageCode("99302");
						}
					}
			    }
			}
		}catch(Exception e) {
			  log(ILog.ERROR, "addDocValidationForInmateFacility::appNumber::"+appIndvCargo.getApp_num()+"::exception message::"+e.getMessage()+"::cause::"+e.getCause()+"::stackTrace::"+e.getStackTrace());
			  FwException fe = createFwException(this.getClass().getName(), "addDocValidationForInmateFacility", e);
			  throw fe;
		  }
		return docValid;
	}
	
	 private void validateTextFields(Map<String,String> validationMap) {
		  for(Map.Entry<String,String> entry : validationMap.entrySet()){
				String fieldType = entry.getKey();
				String validationString = entry.getValue();
				for(int i = 0; i < validationString.length(); i++){
					char ch = validationString.charAt(i);
					 if(!(Character.isLetter(ch) || Character.isSpaceChar(ch) || ch == ',' || ch == '\'')){
						if("sexAssignedAtBirthText".equalsIgnoreCase(fieldType)){
							if(this.getMessageList()==null){
								this.addMessageCode("99268");
							}else if(!this.getMessageList().containsMessage("99268")){
								this.addMessageCode("99268");
							}
						}else if("genderIdentityText".equalsIgnoreCase(fieldType)){
							if(this.getMessageList()==null){
								this.addMessageCode("99269");
							}else if(!this.getMessageList().containsMessage("99269")){
								this.addMessageCode("99269");
							}
						}else if("sexualOrientationText".equalsIgnoreCase(fieldType)){
							if(this.getMessageList()==null){
								this.addMessageCode("99270");
							}else if(!this.getMessageList().containsMessage("99270")){
								this.addMessageCode("99270");
							}
						}
					}
				}
		  }
	}
	
	//ILIES-197788
	/*private String removeSpaces(String ssnNumber) {
		// remove spaces
		if (ssnNumber == null || ssnNumber.length() == 0) {
			return ssnNumber; 
		}
		char[] array = ssnNumber.toCharArray();  
		int end = 0;
		for (int i = 0; i < array.length; i++) {
			if (array[i] == ' ') {
				continue; 
			}
			else {
				array[end++] = array[i]; 
			}
		}
		ssnNumber = new String(array, 0, end);
		return ssnNumber;
	}*/
		/**
	* Method description here
	*/
	public int loadHouseholdCount(String appNumber) {
		FwDataCriteria[] criteria = null;
		int peopleCount = 0;
		try {
			//then we are loading people from the prg rqst 
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1002");
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List res = executeSQL(sqlMap);
			if (res.size() > 0) {
				Map temp = (Map) res.get(0);
				peopleCount =Integer.parseInt((String) temp.get("HSHL_INDV_CT"));
			}
			return peopleCount;	
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdCount", e);
			throw fe;
		}
	}
	
	
	public int loadHouseholdInCount(String appNumber) {
		FwDataCriteria[] criteria = null;
		int peopleCount = 0;
		try {
			//then we are loading people from the prg rqst 
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1156");
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List res = executeSQL(sqlMap);
			if (res.size() > 0) {
				Map temp = (Map) res.get(0);
				peopleCount =Integer.parseInt((String) temp.get("HSHL_INDV_IN_CNT"));
			}
			return peopleCount;	
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdInCount", e);
			throw fe;
		}
	}
	
	
	public int loadHouseholdOutCount(String appNumber) {
		FwDataCriteria[] criteria = null;
		int peopleCount = 0;
		try {
			//then we are loading people from the prg rqst 
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1157");
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List res = executeSQL(sqlMap);
			if (res.size() > 0) {
				Map temp = (Map) res.get(0);
				peopleCount =Integer.parseInt((String) temp.get("HSHL_INDV_OUT_CNT"));
			}
			return peopleCount;	
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdOutCount", e);
			throw fe;
		}
	}
	
	
	/**
	 * This method is used ot load the children out of home count
	 * @param appNumber
	 * @return
	 */
	public int loadChildOutOfHomeCount(String appNumber) {
		FwDataCriteria[] criteria = null;
		int childCount = 0;
		try {
			//then we are loading people from the prg rqst 
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1068");
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List res = executeSQL(sqlMap);
			if (res.size() > 0) {
				Map temp = (Map) res.get(0);
				childCount =Integer.parseInt((String) temp.get("CHLD_OUT_HOME_CT"));
			}
			return childCount;	
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadChildOutOfHomeCount", e);
			throw fe;
		}
	}

	/**
	 * This method is used ot load the household member details
	 * @param appNumber
	 * @param indvSeqNumber
	 * @return
	 */
	public APP_INDV_Collection loadHouseholdMemberDetail(String appNumber,int indvSeqNumber) {
		APP_INDV_Collection appIndvColl = null;
		Map criteriaMap = null;
		FwDataCriteria[] criteria = null;
		try {
			//here i am getting the individual information
			appIndvColl = new APP_INDV_Collection();
			criteriaMap = new HashMap();
			criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(String.valueOf(indvSeqNumber));
			
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			APP_INDV_Cargo[] appIndvCargoArray =	(APP_INDV_Cargo[]) appIndvColl.select(FwConstants.DAO, criteriaMap);
			if(appIndvCargoArray.length > 0){
				appIndvColl.setResults(appIndvCargoArray);
				//now we need to padding the number 
				APP_INDV_Cargo appIndvCargo = appIndvColl.getCargo(0);
				if(!appIndvCargo.getSsn_num().equals("0")){
					appIndvCargo.setSsn_num(paddingNumbers(appIndvCargo.getSsn_num(),9));
				}
				// Added as per ILIES-154219
				if(!appIndvCargo.getConfm_ssn_num().equals("0")){
					appIndvCargo.setConfm_ssn_num(paddingNumbers(appIndvCargo.getConfm_ssn_num(),9));
				}
				return appIndvColl;
			}
			return null;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdMemberDetail", e);
			throw fe;
		}
	}
	/**
	 * @param appNumber
	 * @return
	 */
	public int loadMaxSeqNum(String appNumber) {
		FwDataCriteria[] criteria = null;
		int maxSeqNum = 0;
		try {
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1003");
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List res = executeSQL(sqlMap);
			if (res.size() > 0) {
				Map temp = (Map) res.get(0);
				maxSeqNum = temp.get("INDV_SEQ_NUM") != null ? Integer.parseInt((String) temp.get("INDV_SEQ_NUM")) : 1;
			}
			return maxSeqNum;	
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadMaxSeqNum", e);
			throw fe;
		}
	}
	/**
	 * @param number
	 * @param length
	 * @return
	 */
	private String paddingNumbers(String number,int length){
		int caseLength = number.length();
		StringBuffer paddedCase = null;
		//Zero pading(Leading) 
		if(caseLength < length) 
		{
			paddedCase = new StringBuffer();
			for (int m = 0; m < (length - caseLength); m++) 
			{
				paddedCase.append("0");
			}
			number=paddedCase.append(number).toString();
		}
	return number;
	}

	
	
	
	//deleting the relations from HSHL_RLT
	/**
	 * This method is used to delete the house hold relationships
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public void deleteHouseholdRelations(String indvSeqNumber, String appNumber){
		try{		
			FwDataCriteria[] criteria = new FwDataCriteria[3];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("REF_INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			criteria[2] = new FwDataCriteria();
			criteria[2].setColumn_name("SRC_INDV_SEQ_NUM");
			criteria[2].setColumn_value(indvSeqNumber);
			criteria[2].setData_type(FwConstants.SHORT);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1016");
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteHouseholdRelations", e);
			throw fe;
		}
	}

	//APP_IN_ABSNP
	/**
	 * This method is used to delete the absent parent
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public boolean deleteAbsentParent(String indvSeqNumber, String appNumber){
		try{		
			boolean noAbsentParent = false;
			Map sqlMap = new HashMap();
			String appSeqNumber = null;
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1017c");
			List res = executeSQL(sqlMap);
			if (res != null && !res.isEmpty()){
				Map temp = (Map) res.get(0);
				appSeqNumber = temp.get("AP_SEQ_NUM") != null ? (String) temp.get("AP_SEQ_NUM") : null;
			}
			criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
		    sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1017");
			executeSQL(sqlMap);
			
			if(appSeqNumber != null){
				sqlMap = new HashMap();
				int rem_App_Number;
				criteria = new FwDataCriteria[2];
				criteria[0] = new FwDataCriteria();
				criteria[0].setColumn_name("APP_NUM");
				criteria[0].setColumn_value(appNumber);
				criteria[0].setData_type(FwConstants.LONG);
				criteria[1] = new FwDataCriteria();
				criteria[1].setColumn_name("AP_SEQ_NUM");
				criteria[1].setColumn_value(appSeqNumber);
				criteria[1].setData_type(FwConstants.SHORT);
				sqlMap.put(FwConstants.CRITERIA, criteria);
				sqlMap.put(FwConstants.SQL_IND, "sql-1017d");
				List res1 = executeSQL(sqlMap);
				if (res1 != null && res1.size() == 0) {
					
					
					criteria = new FwDataCriteria[2];
					criteria[0] = new FwDataCriteria();
					criteria[0].setColumn_name("APP_NUM");
					criteria[0].setColumn_value(appNumber);
					criteria[0].setData_type(FwConstants.LONG);
					criteria[1] = new FwDataCriteria();
					criteria[1].setColumn_name("AP_SEQ_NUM");
					criteria[1].setColumn_value(appSeqNumber);
					criteria[1].setData_type(FwConstants.SHORT);
				    sqlMap = new HashMap();
					sqlMap.put(FwConstants.CRITERIA, criteria);
					sqlMap.put(FwConstants.SQL_IND, "sql-1017a");
					executeSQL(sqlMap);
					noAbsentParent = true;
					
				}
			}
			
			
			criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1017b");
			executeSQL(sqlMap);
			
			return noAbsentParent;		
			
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteAbsentParent", e);
			throw fe;
		}
	}


	//APP_IN_ABSNP
	/**
	 * This method is used to delete the absent parent for unborn child
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public void deleteAbsentParentUnBornChild(String indvSeqNumber, String appNumber){
		try{		
			FwDataCriteria[] criteria = new FwDataCriteria[3];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			criteria[2] = new FwDataCriteria();
			criteria[2].setColumn_name("PATER_ESTB_SW");
			criteria[2].setColumn_value("M");
			criteria[2].setData_type(FwConstants.CHAR);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1024");
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteAbsentParentUnBornChild", e);
			throw fe;
		}
	}


	//APP_IN_NEWB
	/**
	 * This method is used ot delete the new born
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public void deleteNewBorn(String indvSeqNumber, String appNumber){
		try{
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1022");
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteNewBorn", e);
			throw fe;
		}
	}