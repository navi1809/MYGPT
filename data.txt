package IVA_Batch;

import CommonMigratedParts.*;

//*** PROGRAM=ARX03A ****
// COMPONENT NAME: ARX03A - Daily Pending Cases Screen Reports
// ===============
// 
// DESCRIPTION:
// ============
// This module creates the report tables for Daily Pending
// Cases Screen Reports - PEN1,PENC,CPEN.
// The Statistics will be accumulated at the 'Worker' level,
// the lowest level at which the report can be viewed.
// 
// The Daily Program Case History extract file (PCD-FILE)
// will be input to this program. The file will be sorted on
// Office
// Code, Caseload and Case Id.
// 
// MODIFY 3-7-2002:
// MODIFY A PROCESS ARX03P9-BUILD-PEN1 OF A FLAG FOR AFDC 46-90
// WHICH CHANGE TO 46=> DAYS.
// FIELD NO_OF_AFDC_46_90 NAME IN CABLE TWNPNDNG_CSE_STRPT
// IS MEANING LESS BECAUSE MODIFICATION TO THE FLAG.
// 
// MODIFY 3-7-2002:
// MODIFY A PROCESS ARX03P9-BUILD-PENC OF A FLAG FOR AFDC 46-90
// WHICH CHANGE TO 46=> DAYS.
// FIELD NUM_OF_AFDC_46_90 NAME IN CABLE TWNPNDNG_CSE_RPT
// IS MEANING LESS BECAUSE MODIFICATION TO THE FLAG.
// ***********************
Program ARX03A type basicProgram //VAGen Info - main batch program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  inputRecord = VWORKSTOR
  }

  // Data Declarations
  ARX03W ARX03W; // record
  CEP01W CEP01W; // record
  GDW GDW; // record
  GNOMADS GNOMADS; // record
  H-TPCRD1 H-TPCRD1; // record
  H-TPCRI1 H-TPCRI1; // record
  H-TPCSD1 H-TPCSD1; // record
  H-TPCSI1 H-TPCSI1; // record
  H-TPNCD1 H-TPNCD1; // record
  H-TPNCI1 H-TPNCI1; // record
  P-DATE-REC3 P-DATE-REC3; // record
  SR-ARX03W1 SR-ARX03W1; // record
  VDBCOMMON VDBCOMMON; // record
  VDBCONTROL VDBCONTROL; // record
  VMESSAGE VMESSAGE; // record
  VWORKSTOR VWORKSTOR ; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    ARX03P9-MAIN: ARX03P9-MAIN();
  end // end main
end // end ARX03A


// BUILD RECORD FOR CPEN SCREEN
Function ARX03P9-BUILD-CPEN()
  /* Build data needed to add TWNPNDGCSE_CSLDPRT table rows.*/
  /*  */
  H-TPNCI1.APLCT-NM = SR-ARX03W1.PCD-APLCT-NM;
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-STS == "P")
    P-DATE-REC3.C-INPUT-DATE = SR-ARX03W1.PCD-PROCESS-DT;
    P-DATE-REC3.C-OUTPUT-DATE = SR-ARX03W1.PCD-APPL-DT;
  /*  */
  /* Pending Days = Days (Current Date - Application Date)*/
  /*  */
    call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
    ARX03W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  else
    ARX03W.WS-PENDING-DAYS = 00;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "AF")
    H-TPNCI1.FM-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.FM-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "FS")
    H-TPNCI1.FS-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.FS-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "MA")
    H-TPNCI1.MA-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.MA-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "SG")
    H-TPNCI1.SG-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.SG-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TC")
    H-TPNCI1.TC-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.TC-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TL")
    H-TPNCI1.TL-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.TL-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TN")
    H-TPNCI1.TN-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.TN-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TP")
    H-TPNCI1.TP-STS = SR-ARX03W1.PCD-PRGM-CASE-STS;
    H-TPNCI1.TP-PNDNG-DAYS = ARX03W.WS-PENDING-DAYS;
  end
end // end ARX03P9-BUILD-CPEN


// BUILD RECORD FOR PEN1 SCREEN
Function ARX03P9-BUILD-PEN1()
  /* Build data needed to add TWNPNDNG_CSE_STRPT table rows.*/
  /*  */
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX03W1.PCD-APPL-DT;
  P-DATE-REC3.C-INPUT-DATE = SR-ARX03W1.PCD-PROCESS-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  /*  */
  ARX03W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "SG" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TC" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TL" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TN" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TP")
    if (ARX03W.WS-PENDING-DAYS < 46)
      H-TPCSI1.NO-OF-CASH-LTEQ-45 = H-TPCSI1.NO-OF-CASH-LTEQ-45 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 45)
        H-TPCSI1.NO-OF-CASH-GT-45 = H-TPCSI1.NO-OF-CASH-GT-45 + 1;
      end
    end
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "FS")
    if (ARX03W.WS-PENDING-DAYS < 8)
      H-TPCSI1.NO-OF-FS-LTEQ-7 = H-TPCSI1.NO-OF-FS-LTEQ-7 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 7 && 
      ARX03W.WS-PENDING-DAYS < 31)
        H-TPCSI1.NO-OF-FS-8-30 = H-TPCSI1.NO-OF-FS-8-30 + 1;
      else
        if (ARX03W.WS-PENDING-DAYS > 30)
          H-TPCSI1.NO-OF-FS-GT-30 = H-TPCSI1.NO-OF-FS-GT-30 + 1;
        end
      end
    end
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "MA")
    if (ARX03W.WS-PENDING-DAYS < 46)
      H-TPCSI1.NO-OF-MA-LTEQ-45 = H-TPCSI1.NO-OF-MA-LTEQ-45 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 45 && 
      ARX03W.WS-PENDING-DAYS < 91)
        H-TPCSI1.NO-OF-MA-46-90 = H-TPCSI1.NO-OF-MA-46-90 + 1;
      else
        if (ARX03W.WS-PENDING-DAYS > 90)
          H-TPCSI1.NO-OF-MA-GT-90 = H-TPCSI1.NO-OF-MA-GT-90 + 1;
        end
      end
    end
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "AF")
    if (ARX03W.WS-PENDING-DAYS < 46)
      H-TPCSI1.NO-OF-FM-LTEQ-45 = H-TPCSI1.NO-OF-FM-LTEQ-45 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 45)
        H-TPCSI1.NO-OF-FM-GT-45 = H-TPCSI1.NO-OF-FM-GT-45 + 1;
      end
    end
  end
end // end ARX03P9-BUILD-PEN1


// BUILD RECORD FOR PENC SCREEN
Function ARX03P9-BUILD-PENC()
  /* Build data needed to add TWNPNDNG_CSE_RPT table rows.*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = SR-ARX03W1.PCD-PROCESS-DT;
  /*  */
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX03W1.PCD-APPL-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX03W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "SG" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TC" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TL" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TN" || 
  SR-ARX03W1.PCD-PRGM-CASE-TYPE == "TP")
    if (ARX03W.WS-PENDING-DAYS < 46)
      H-TPCRI1.NO-OF-CASH-LTEQ-45 = H-TPCRI1.NO-OF-CASH-LTEQ-45 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 45)
        H-TPCRI1.NUM-OF-CASH-GT-45 = H-TPCRI1.NUM-OF-CASH-GT-45 + 1;
      end
    end
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "FS")
    if (ARX03W.WS-PENDING-DAYS < 8)
      H-TPCRI1.NUM-OF-FS-LTEQ-7 = H-TPCRI1.NUM-OF-FS-LTEQ-7 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 7 && 
      ARX03W.WS-PENDING-DAYS < 31)
        H-TPCRI1.NUM-OF-FS-8-30 = H-TPCRI1.NUM-OF-FS-8-30 + 1;
      else
        if (ARX03W.WS-PENDING-DAYS > 30)
          H-TPCRI1.NUM-OF-FS-GT-30 = H-TPCRI1.NUM-OF-FS-GT-30 + 1;
        end
      end
    end
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "MA")
    if (ARX03W.WS-PENDING-DAYS < 46)
      H-TPCRI1.NO-OF-MA-LTEQ-45 = H-TPCRI1.NO-OF-MA-LTEQ-45 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 45 && 
      ARX03W.WS-PENDING-DAYS < 91)
        H-TPCRI1.NUM-OF-MA-46-90 = H-TPCRI1.NUM-OF-MA-46-90 + 1;
      else
        if (ARX03W.WS-PENDING-DAYS > 90)
          H-TPCRI1.NUM-OF-MA-GT-90 = H-TPCRI1.NUM-OF-MA-GT-90 + 1;
        end
      end
    end
  end
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-TYPE == "AF")
    if (ARX03W.WS-PENDING-DAYS < 46)
      H-TPCRI1.NUM-OF-FM-LTEQ-45 = H-TPCRI1.NUM-OF-FM-LTEQ-45 + 1;
    else
      if (ARX03W.WS-PENDING-DAYS > 45)
        H-TPCRI1.NUM-OF-FM-GT-45 = H-TPCRI1.NUM-OF-FM-GT-45 + 1;
      end
    end
  end
end // end ARX03P9-BUILD-PENC


Function ARX03P9-CLOSE()
  try
    close SR-ARX03W1 ;
  end
  /* CBSI START*/
  /*  */
  if (SR-ARX03W1 is ioError)
    VDBCONTROL.UPROC-NM = "ARX03P9-CLOSE";
    VDBCONTROL.UPROC-OBJ = "SR-ARX03W1";
    VDBCONTROL.UPROC-OPT = "CLOSE";
  /* ** Changes due to PTR # 12537- start ****/
    VDBCONTROL.UMSQLCODE = 0;
    VMESSAGE.UMSGINS[2] = "ARX03A";
  /* **  MOVE EZERT8 TO VMESSAGE.UMSGCODE;*/
    ARX03W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = ARX03W.WS-ERR-LAST-FOUR;
    VDBCONTROL.UEZESQRRM = "QPCDFILE FILE - I/O ERROR";
  /* ** Changes due to PTR # 12537- end   ****/
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* CBSI END*/
end // end ARX03P9-CLOSE


// CREATE RECORD FOR CPEN
Function ARX03P9-CREATCPEN()
  /* Call DB application TPNCI1A to add data to report table.*/
  /*  */
  if (H-TPNCI1.FM-STS != "P" && 
  H-TPNCI1.FS-STS != "P" && 
  H-TPNCI1.MA-STS != "P" && 
  H-TPNCI1.SG-STS != "P" && 
  H-TPNCI1.TC-STS != "P" && 
  H-TPNCI1.TL-STS != "P" && 
  H-TPNCI1.TN-STS != "P" && 
  H-TPNCI1.TP-STS != "P")
    set H-TPNCI1 empty;
    return;
  end
  /*  */
  H-TPNCI1.RPT-DT = SR-ARX03W1.PCD-PROCESS-DT;
  /*  */
  H-TPNCI1.OFC-CD = ARX03W.WS-PREV-OFC-CD;
  H-TPNCI1.SPRVS-UNIT = ARX03W.WS-PREV-SPRVS-UNIT;
  H-TPNCI1.FNL-AREA-CD = ARX03W.WS-PREV-FUNC-AREA-CD;
  H-TPNCI1.WRKR-TYP = ARX03W.WS-PREV-WRKR-TYPE;
  H-TPNCI1.PSN-NMB = ARX03W.WS-PREV-PSN-NMB;
  H-TPNCI1.CASE-ID = ARX03W.WS-PREV-CASE-ID;
  /*  */
  H-TPNCI1.WRKR-ID = ARX03W.WS-WRKR-ID;
  H-TPNCI1.WRKR-NM = ARX03W.WS-WRKR-NM;
  /*  */
  call "TPNCI1A" (VDBCONTROL, VMESSAGE, H-TPNCI1) {isNoRefresh = yes};
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  set H-TPNCI1 empty;
  ARX03W.WS-REC-PROCESSED = "Y";
end // end ARX03P9-CREATCPEN


// CREATE RECORD FOR PEN1
Function ARX03P9-CREATPEN1()
  /* -------------------------------------------------------------**/
  /* **/
  /* Call DB application TPCSI1A to add data to report table.    **/
  /* **/
  /* -------------------------------------------------------------**/
  /*  */
  /* -----------------------PTR#3109 CHANGE BEGIN----------------*/
  /*  */
  H-TPCSI1.RPT-DT = SR-ARX03W1.PCD-PROCESS-DT;
  /*  */
  /* -----------------------PTR#3109 CHANGE END------------------*/
  /*  */
  H-TPCSI1.OFC-CD = ARX03W.WS-PREV-OFC-CD;
  /*  */
  call "TPCSI1A" (VDBCONTROL, VMESSAGE, H-TPCSI1) {isNoRefresh = yes};
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  set H-TPCSI1 empty;
end // end ARX03P9-CREATPEN1


// CREATE RECORD FOR PENC
Function ARX03P9-CREATPENC()
  /* -------------------------------------------------------------**/
  /* **/
  /* Call DB application TPCRI1A to add data to report table.    **/
  /* **/
  /* -------------------------------------------------------------**/
  /*  */
  /*  */
  /* -----------------------PTR#3109 CHANGE BEGIN----------------*/
  /*  */
  H-TPCRI1.RPT-DT = SR-ARX03W1.PCD-PROCESS-DT;
  /*  */
  /* -----------------------PTR#3109 CHANGE END------------------*/
  /*  */
  H-TPCRI1.OFC-CD = ARX03W.WS-PREV-OFC-CD;
  H-TPCRI1.SPRVS-UNIT = ARX03W.WS-PREV-SPRVS-UNIT;
  H-TPCRI1.FNL-AREA-CD = ARX03W.WS-PREV-FUNC-AREA-CD;
  H-TPCRI1.WRKR-TYP = ARX03W.WS-PREV-WRKR-TYPE;
  H-TPCRI1.PSN-NMB = ARX03W.WS-PREV-PSN-NMB;
  H-TPCRI1.WRKR-ID = ARX03W.WS-WRKR-ID;
  H-TPCRI1.WRKR-NM = ARX03W.WS-WRKR-NM;
  /*  */
  call "TPCRI1A" (VDBCONTROL, VMESSAGE, H-TPCRI1) {isNoRefresh = yes};
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  set H-TPCRI1 empty;
end // end ARX03P9-CREATPENC


// INITIALIZATION PROCESS
Function ARX03P9-INITIALISE()
  /* -------------------------------------------------------------**/
  /* This process :                                             **/
  /* **/
  /* 1    Deletes all the records from Daily Pending Cases      **/
  /* Report tables.                                        **/
  /* 2    Initializes the application related variables.        **/
  /* 3    Scans the input file and performs processes necessary **/
  /* to build the report tables.                           **/
  /* **/
  /* -------------------------------------------------------------**/
  /*  */
  /* ** Changes due to PTR # 12537- start ****/
  VGVar.handleHardIOErrors = 1;
  /* ** Changes due to PTR # 12537- end   ****/

  call "TPNCD1A" (VDBCONTROL, VMESSAGE, H-TPNCD1) {isNoRefresh = yes};
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  call "TPCRD1A" (VDBCONTROL, VMESSAGE, H-TPCRD1) {isNoRefresh = yes};
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  call "TPCSD1A" (VDBCONTROL, VMESSAGE, H-TPCSD1) {isNoRefresh = yes};
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  set H-TPNCI1 empty;
  set ARX03W empty;
  set H-TPCRI1 empty;
  set H-TPCSI1 empty;
  set P-DATE-REC3 empty;
  ARX03P9-SCAN-PROC();

  /* ** Changes due to PTR # 11846 - start ****/

  if (SR-ARX03W1 is endOfFile)
    VDBCONTROL.UPROC-NM = "ARX03P9-INITIALISE";
    VDBCONTROL.UPROC-OBJ = "SR-ARX03W1";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VMESSAGE.UMSGCODE = "ARX0102E";
    VDBCONTROL.UMSQLCODE = 0;
    ARX03W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = ARX03W.WS-ERR-LAST-FOUR;
    VMESSAGE.UMSGINS[2] = "ARX03A";
  /* **  MOVE 'PCDFILE HAS NO RECORDS' TO VDBCONTROL.UEZESQRRM;*/
    VMESSAGE.UMSGCODE-JCL-ERR = 8;
    WCM00P2-TO-CEP01A();
    exit program;
  end

  /* ** Changes due to PTR # 11846 - end   ****/

  ARX03W.WS-PREV-OFC-CD = SR-ARX03W1.PCD-OFC-CD;
  ARX03W.WS-PREV-SPRVS-UNIT = SR-ARX03W1.PCD-SPRVS-UNIT;
  ARX03W.WS-PREV-FUNC-AREA-CD = SR-ARX03W1.PCD-FUNC-AREA-CD;
  ARX03W.WS-PREV-WRKR-TYPE = SR-ARX03W1.PCD-WRKR-TYPE;
  ARX03W.WS-PREV-PSN-NMB = SR-ARX03W1.PCD-PSN-NMB;
  ARX03W.WS-PREV-CASE-ID = SR-ARX03W1.PCD-CASE-ID;
  ARX03W.WS-WRKR-ID = SR-ARX03W1.PCD-WRKR-ID;
  ARX03W.WS-WRKR-NM = SR-ARX03W1.PCD-WRKR-NM;
  /*  */
  while (sysVar.errorCode == "00000000")
    ARX03P9-PROCESSING();
    ARX03P9-SCAN-PROC();
  end
  /*  */
end // end ARX03P9-INITIALISE


// MAIN PROCESS
Function ARX03P9-MAIN()
  /* -------------------------------------------------------------**/
  /* **/
  /* **/
  /* -------------------------------------------------------------**/
  /*  */
  ARX03P9-INITIALISE();
  ARX03P9-WIND-UP();
  ARX03P9-CLOSE();
  /*  */
  /* ** Changes due to PTR # 11846 - start ****/

  if (ARX03W.WS-REC-PROCESSED != "Y")
    VDBCONTROL.UPROC-NM = "ARX03P9-MAIN";
    VDBCONTROL.UPROC-OBJ = "SR-ARX03W1";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VDBCONTROL.UMSQLCODE = 0;
    VMESSAGE.UMSGINS[1] = " ";
    VMESSAGE.UMSGCODE = "ARX0103E";
    VMESSAGE.UMSGINS[2] = "ARX03A";
  /* **  MOVE 'NO RECORDS PROCESSED' TO VDBCONTROL.UEZESQRRM;*/
    VMESSAGE.UMSGCODE-JCL-ERR = 8;
    WCM00P2-TO-CEP01A();
    exit program;
  end

  /* ** Changes due to PTR # 11846 - end   ****/
  /* CBSI END*/
end // end ARX03P9-MAIN


// PROCESS PCD RECORD
Function ARX03P9-PROCESSING()
  /* -------------------------------------------------------------**/
  /* **/
  /* This process reads the input file and builds the report     **/
  /* table records as follows:                                   **/
  /* **/
  /* 1   If Case ID changes a record is created in TWNPNDGCSE    **/
  /* _CSLDRPT table                                          **/
  /* 2   If Case Load changes a record is created in TWNPNDNG    **/
  /* _CSE_RPT table                                          **/
  /* 3   If Office Code changes a record is created in TWNPNDNG  **/
  /* _CSE_STRPT table                                        **/
  /* **/
  /* -------------------------------------------------------------**/
  /*  */
  if (SR-ARX03W1.PCD-OFC-CD == ARX03W.WS-PREV-OFC-CD && 
  SR-ARX03W1.PCD-SPRVS-UNIT == ARX03W.WS-PREV-SPRVS-UNIT && 
  SR-ARX03W1.PCD-FUNC-AREA-CD == ARX03W.WS-PREV-FUNC-AREA-CD && 
  SR-ARX03W1.PCD-WRKR-TYPE == ARX03W.WS-PREV-WRKR-TYPE && 
  SR-ARX03W1.PCD-PSN-NMB == ARX03W.WS-PREV-PSN-NMB && 
  SR-ARX03W1.PCD-CASE-ID == ARX03W.WS-PREV-CASE-ID)
    /* Caseload ID and Case ID is not changed*/
  else
    if (SR-ARX03W1.PCD-CASE-ID == ARX03W.WS-PREV-CASE-ID)
    /* Case ID is not changed*/
    else
    /* Create TWNPNDGCSE_CSLDRPT table record*/
      ARX03P9-CREATCPEN();
    end
    if (SR-ARX03W1.PCD-OFC-CD == ARX03W.WS-PREV-OFC-CD && 
    SR-ARX03W1.PCD-SPRVS-UNIT == ARX03W.WS-PREV-SPRVS-UNIT && 
    SR-ARX03W1.PCD-FUNC-AREA-CD == ARX03W.WS-PREV-FUNC-AREA-CD && 
    SR-ARX03W1.PCD-WRKR-TYPE == ARX03W.WS-PREV-WRKR-TYPE && 
    SR-ARX03W1.PCD-PSN-NMB == ARX03W.WS-PREV-PSN-NMB)
      /* Case Load is not changed*/
    else
      /* Create TWNPNDNG_CSE_RPT table record*/
      ARX03P9-CREATPENC();
    end
    if (SR-ARX03W1.PCD-OFC-CD == ARX03W.WS-PREV-OFC-CD)
      /* Office Code is not changed*/
    else
      /* Create TWNPNDNG_CSE_STRPT table record*/
      ARX03P9-CREATPEN1();
    end
    /*  */
    ARX03W.WS-PREV-OFC-CD = SR-ARX03W1.PCD-OFC-CD;
    ARX03W.WS-PREV-SPRVS-UNIT = SR-ARX03W1.PCD-SPRVS-UNIT;
    ARX03W.WS-PREV-FUNC-AREA-CD = SR-ARX03W1.PCD-FUNC-AREA-CD;
    ARX03W.WS-PREV-WRKR-TYPE = SR-ARX03W1.PCD-WRKR-TYPE;
    ARX03W.WS-PREV-PSN-NMB = SR-ARX03W1.PCD-PSN-NMB;
    ARX03W.WS-PREV-CASE-ID = SR-ARX03W1.PCD-CASE-ID;
    ARX03W.WS-WRKR-ID = SR-ARX03W1.PCD-WRKR-ID;
    ARX03W.WS-WRKR-NM = SR-ARX03W1.PCD-WRKR-NM;
  end
  ARX03P9-BUILD-CPEN();
  /*  */
  if (SR-ARX03W1.PCD-PRGM-CASE-STS == "P")
    ARX03P9-BUILD-PENC();
    ARX03P9-BUILD-PEN1();
  end
  /*  */
end // end ARX03P9-PROCESSING


// SCAN PCD FILE
Function ARX03P9-SCAN-PROC()
  /* CBSI START*/
  /*  */
  try
    get next SR-ARX03W1 ;
  end
  if (SR-ARX03W1 is ioError && SR-ARX03W1 not endOfFile)
    VDBCONTROL.UPROC-NM = "ARX03P9-SCAN-PROC";
    VDBCONTROL.UPROC-OBJ = "SR-ARX03W1";
    VDBCONTROL.UPROC-OPT = "SCAN";
  /* ** Changes due to PTR # 12537- start ****/
    VDBCONTROL.UMSQLCODE = 0;
    VMESSAGE.UMSGINS[2] = "ARX03A";
  /* **  MOVE EZERT8 TO VMESSAGE.UMSGCODE;*/
  /* ** Changes due to PTR # 12537- end   ****/
    ARX03W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = ARX03W.WS-ERR-LAST-FOUR;
    VDBCONTROL.UEZESQRRM = "QPCDFILE FILE - I/O ERROR";
    WCM00P2-TO-CEP01A();
  end
  /* CBSI END*/
end // end ARX03P9-SCAN-PROC


// TERMINATE ARX03A
Function ARX03P9-WIND-UP()
  /* CBSI START*/
  /*  */
  ARX03P9-CREATCPEN();
  ARX03P9-CREATPENC();
  ARX03P9-CREATPEN1();
  /*  */
  /* CBSI END*/
end // end ARX03P9-WIND-UP


Record ARX03W type basicRecord
  10 WS-PREV-OFC-CD char(2) ; 
  10 WS-PREV-SPRVS-UNIT char(1) ; 
  10 WS-PREV-FUNC-AREA-CD char(1) ; 
  10 WS-PREV-WRKR-TYPE char(1) ; 
  10 WS-PREV-PSN-NMB smallint ; 
  10 WS-PREV-CASE-ID char(9) ; 
    15 WS-PREV-ID-1 num(9) ; 
  10 WS-WRKR-ID char(8) ; 
  10 WS-WRKR-NM char(30) ; 
  10 WS-PENDING-DAYS num(3) ; 
  10 WS-ERR-CD char(8) ; 
    15 WS-ERR-FIRST-FOUR char(4) ; 
    15 WS-ERR-LAST-FOUR char(4) ; 
  10 WS-REC-PROCESSED char(1) ; 
end // end ARX03W


