package IVA_Batch;
import egl.core.*;
import CommonMigratedParts.*;
import DataTables.*;
//*** PROGRAM=ARX07A ****
// COMPONENT NAME: ARX07A
// ===============
// 
// DESCRIPTION:
// ============
// This Module creates the report table TWNNMDS_PEND_STATS for
// PEND(Statistics For Pending Cases report) screen report. The
// Statistics will be accumulated at the 'Worker' level, as
// that is the lowest level at which the report can be viewed.
// 
// The monthly program case History extract file(PCE-FILE) will
// be input to this program.  The file wil be sorted on Office
// code and Caseload
// 
// 
// ***********************
Program ARX07A type basicProgram //VAGen Info - main batch program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  inputRecord = VWORKSTOR
  }

  // Data Declarations
  ARX07W ARX07W; // record
  ARX07W1 ARX07W1; // record
  ARX07W10 ARX07W10; // record
  ARX07W11 ARX07W11; // record
  ARX07W3 ARX07W3; // record
  ARX07W4 ARX07W4; // record
  ARX07W5 ARX07W5; // record
  ARX07W6 ARX07W6; // record
  ARX07W7 ARX07W7; // record
  ARX07W8 ARX07W8; // record
  ARX07W9 ARX07W9; // record
  CEP01W CEP01W; // record
  GNOMADS GNOMADS; // record
  H2-NMDS-PEND-STATS H2-NMDS-PEND-STATS; // record
  P-DATE-REC3 P-DATE-REC3; // record
  SR-ARX07W2 SR-ARX07W2; // record
  SR-ARX07W9 SR-ARX07W9; // record
  VCOMMON VCOMMON; // record
  VCONTROL VCONTROL; // record
  VDBCOMMON VDBCOMMON; // record
  VDBCONTROL VDBCONTROL; // record
  VDTSREC VDTSREC; // record
  VMESSAGE VMESSAGE; // record
  VWORKSTOR VWORKSTOR ; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use VDB00T1 {deleteAfterUse = yes}; // table

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    ARX07P9-MAIN-PROC: ARX07P9-MAIN-PROC();
  end // end main
end // end ARX07A


Function ARX07P9-AFDC-BSC()
  /* Accumulate Statistics in SG Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W3.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W3.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W3.PNDNG-CASES-CT = ARX07W3.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W3.NUM-OF-APLCS-RCVD = ARX07W3.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W3.PNDNG-LTEQ-5-DAYS = ARX07W3.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W3.PNDNG-LTEQ-16-30-DAYS = ARX07W3.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W3.PNDNG-LTEQ-31-45-DAYS = ARX07W3.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W3.PNDNG-LTEQ-46-90-DAYS = ARX07W3.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W3.PNDNG-GT-90-DAYS = ARX07W3.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-AFDC-BSC


Function ARX07P9-AFDC-UP()
  /* Accumulate Statistics for TC Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W4.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W4.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W4.PNDNG-CASES-CT = ARX07W4.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W4.NUM-OF-APLCS-RCVD = ARX07W4.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W4.PNDNG-LTEQ-5-DAYS = ARX07W4.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W4.PNDNG-LTEQ-16-30-DAYS = ARX07W4.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W4.PNDNG-LTEQ-31-45-DAYS = ARX07W4.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W4.PNDNG-LTEQ-46-90-DAYS = ARX07W4.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W4.PNDNG-GT-90-DAYS = ARX07W4.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-AFDC-UP


// Close pce-file process
Function ARX07P9-CLS-PCE()
  /*  */
  try
    close SR-ARX07W2 ;
  end
  if (SR-ARX07W2 is ioError)
    VDBCONTROL.UPROC-NM = "ARX07P9-CLS-PCE";
    VDBCONTROL.UPROC-OBJ = "SR-ARX07W2";
    VDBCONTROL.UPROC-OPT = "CLOSE";
  /* ** Changes due to PTR # 12537 - start ****/
    VDBCONTROL.UMSQLCODE = 0;
    VMESSAGE.UMSGINS[2] = "ARX07A";
  /* **  MOVE EZERT8 TO VMESSAGE.UMSGCODE;*/
    ARX07W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = ARX07W.WS-ERR-LAST-FOUR;
    VDBCONTROL.UEZESQRRM = "PCEFILE FILE - I/O ERROR";
  /* ** Changes due to PTR # 12537 - end   ****/
    WCM00P2-TO-CEP01A();
  end

  /*  */
end // end ARX07P9-CLS-PCE


// To process data
Function ARX07P9-DATA-PROC()
  /* This process does the following*/
  /* 1. Create records for all 8 program types in TWNNMDS_PEND_STATS*/
  /* if worker changes.*/
  /* 2. Perform the process to accumulate the statistics depends on*/
  /* the PCE_PRGM_CASE_TYPE.*/
  /*  */
  ARX07W.WS-FLAG1 = "Y";
  if (SR-ARX07W2.PCE-OFC-CD == ARX07W.WS-PREV-OFC-CD && 
  SR-ARX07W2.PCE-SPRVS-UNIT == ARX07W.WS-PREV-SPRVS-UNIT && 
  SR-ARX07W2.PCE-FUNC-AREA-CD == ARX07W.WS-PREV-FUNC-AREA-CD && 
  SR-ARX07W2.PCE-WRKR-TYPE == ARX07W.WS-PREV-WRKR-TYPE && 
  SR-ARX07W2.PCE-PSN-NMB == ARX07W.WS-PREV-PSN-NMB)
  else
    ARX07P9-DB-CRT();
  /* Save present values.*/
    ARX07W.WS-PREV-OFC-CD = SR-ARX07W2.PCE-OFC-CD;
    ARX07W.WS-PREV-SPRVS-UNIT = SR-ARX07W2.PCE-SPRVS-UNIT;
    ARX07W.WS-PREV-FUNC-AREA-CD = SR-ARX07W2.PCE-FUNC-AREA-CD;
    ARX07W.WS-PREV-WRKR-TYPE = SR-ARX07W2.PCE-WRKR-TYPE;
    ARX07W.WS-PREV-PSN-NMB = SR-ARX07W2.PCE-PSN-NMB;
    ARX07W.WS-WRKR-ID = SR-ARX07W2.PCE-WRKR-ID;
    ARX07W.WS-WRKR-NM = SR-ARX07W2.PCE-WRKR-NM;
  end
  /*  */
  ARX07W.WS-FLAG = "N";
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "SG")
    ARX07P9-AFDC-BSC();
  end
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "TC")
    ARX07P9-AFDC-UP();
  end
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "AF")
    ARX07P9-MED-EL();
  end
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "MA")
    ARX07P9-MA-DATA();
  end
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "FS")
    ARX07P9-FS-DATA();
  end
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "TL")
    ARX07P9-TL-DATA();
  end
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "TN")
    ARX07P9-TN-DATA();
  end
  /*  */
  if (SR-ARX07W2.PCE-PRGM-CASE-TYPE == "TP")
    ARX07P9-TP-DATA();
  end
end // end ARX07P9-DATA-PROC


// Create DB records
Function ARX07P9-DB-CRT()
  /* Header information.*/
  /*  */
  H2-NMDS-PEND-STATS.RPT-PRD-YR = ARX07W1.PI1-LAST-YY;
  H2-NMDS-PEND-STATS.RPT-PRD-MTH = ARX07W1.PI1-LAST-MM;
  H2-NMDS-PEND-STATS.RPT-RUN-DT = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  H2-NMDS-PEND-STATS.OFC-CD = ARX07W.WS-PREV-OFC-CD;
  H2-NMDS-PEND-STATS.SPRVS-UNIT = ARX07W.WS-PREV-SPRVS-UNIT;
  H2-NMDS-PEND-STATS.FNL-AREA-CD = ARX07W.WS-PREV-FUNC-AREA-CD;
  H2-NMDS-PEND-STATS.WRKR-TYP = ARX07W.WS-PREV-WRKR-TYPE;
  H2-NMDS-PEND-STATS.PSN-NMB = ARX07W.WS-PREV-PSN-NMB;
  H2-NMDS-PEND-STATS.WRKR-ID = ARX07W.WS-WRKR-ID;
  H2-NMDS-PEND-STATS.WRKR-NM = ARX07W.WS-WRKR-NM;
  /* For all the 8 program type records, move the following fields from*/
  /* SG, TC, FM, MA, FS, TL, TN, and TP records to create*/
  /* records in TWNNMDS_PEND_STATS*/
  /*  */
  /* SG-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "SG";
  if (ARX07W3.PNDNG-CASES-CT > 0)
    ARX07W3.AVG-DAYS-PNDNG = (ARX07W3.WS-TOTAL-PNDNG-DAYS /     ARX07W3.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W3.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W3.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W3.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W3.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W3.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W3.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W3.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W3.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* TC-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "TC";
  /*  */
  if (ARX07W4.PNDNG-CASES-CT > 0)
    ARX07W4.AVG-DAYS-PNDNG = (ARX07W4.WS-TOTAL-PNDNG-DAYS /     ARX07W4.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W4.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W4.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W4.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W4.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W4.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W4.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W4.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W4.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* FM-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "FM";
  if (ARX07W5.PNDNG-CASES-CT > 0)
    ARX07W5.AVG-DAYS-PNDNG = (ARX07W5.WS-TOTAL-PNDNG-DAYS /     ARX07W5.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W5.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W5.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W5.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W5.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W5.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W5.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W5.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W5.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* MA-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "MA";
  if (ARX07W6.PNDNG-CASES-CT > 0)
    ARX07W6.AVG-DAYS-PNDNG = (ARX07W6.WS-TOTAL-PNDNG-DAYS /     ARX07W6.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W6.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W6.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W6.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W6.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W6.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W6.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W6.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W6.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* FS-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "FS";
  if (ARX07W7.PNDNG-CASES-CT > 0)
    ARX07W7.AVG-DAYS-PNDNG = (ARX07W7.WS-TOTAL-PNDNG-DAYS /     ARX07W7.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W7.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W7.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W7.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W7.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W7.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W7.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W7.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W7.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* TL-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "TL";
  if (ARX07W9.PNDNG-CASES-CT > 0)
    ARX07W9.AVG-DAYS-PNDNG = (ARX07W9.WS-TOTAL-PNDNG-DAYS /     ARX07W9.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W9.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W9.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W9.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W9.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W9.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W9.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W9.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W9.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* TN-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "TN";
  if (ARX07W10.PNDNG-CASES-CT > 0)
    ARX07W10.AVG-DAYS-PNDNG = (ARX07W10.WS-TOTAL-PNDNG-DAYS /     ARX07W10.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W10.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W10.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W10.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W10.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W10.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W10.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W10.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W10.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* TP-Record.*/
  /*  */
  H2-NMDS-PEND-STATS.PRGM-TYP = "TP";
  if (ARX07W11.PNDNG-CASES-CT > 0)
    ARX07W11.AVG-DAYS-PNDNG = (ARX07W11.WS-TOTAL-PNDNG-DAYS /     ARX07W11.PNDNG-CASES-CT);
  end
  H2-NMDS-PEND-STATS.NUM-OF-APLCS-RCVD = ARX07W11.NUM-OF-APLCS-RCVD;
  H2-NMDS-PEND-STATS.PNDNG-CASES-CT = ARX07W11.PNDNG-CASES-CT;
  H2-NMDS-PEND-STATS.AVG-DAYS-PNDNG = ARX07W11.AVG-DAYS-PNDNG;
  H2-NMDS-PEND-STATS.PNDNG-LTEQ-6-DAYS = ARX07W11.PNDNG-LTEQ-5-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-16-30-DAYS = ARX07W11.PNDNG-LTEQ-16-30-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-31-45-DAYS = ARX07W11.PNDNG-LTEQ-31-45-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-46-90-DAYS = ARX07W11.PNDNG-LTEQ-46-90-DAYS;
  H2-NMDS-PEND-STATS.PNDNG-GT-90-DAYS = ARX07W11.PNDNG-GT-90-DAYS;
  /*  */
  ARX07P9-NPS-ADD();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  set ARX07W3 empty;
  set ARX07W4 empty;
  set ARX07W5 empty;
  set ARX07W6 empty;
  set ARX07W7 empty;
  set ARX07W9 empty;
  set ARX07W10 empty;
  set ARX07W11 empty;
  ARX07W.WS-TOTAL-PNDNG-DAYS = 0;
end // end ARX07P9-DB-CRT


Function ARX07P9-FS-DATA()
  /* Accumulate Statistics for FS Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W7.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W7.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W7.PNDNG-CASES-CT = ARX07W7.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W7.NUM-OF-APLCS-RCVD = ARX07W7.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W7.PNDNG-LTEQ-5-DAYS = ARX07W7.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W7.PNDNG-LTEQ-16-30-DAYS = ARX07W7.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W7.PNDNG-LTEQ-31-45-DAYS = ARX07W7.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W7.PNDNG-LTEQ-46-90-DAYS = ARX07W7.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W7.PNDNG-GT-90-DAYS = ARX07W7.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-FS-DATA


Function ARX07P9-MA-DATA()
  /* Accumulate Statistics for MA Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W6.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W6.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W6.PNDNG-CASES-CT = ARX07W6.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W6.NUM-OF-APLCS-RCVD = ARX07W6.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W6.PNDNG-LTEQ-5-DAYS = ARX07W6.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W6.PNDNG-LTEQ-16-30-DAYS = ARX07W6.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W6.PNDNG-LTEQ-31-45-DAYS = ARX07W6.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W6.PNDNG-LTEQ-46-90-DAYS = ARX07W6.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W6.PNDNG-GT-90-DAYS = ARX07W6.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-MA-DATA


// Main process
Function ARX07P9-MAIN-PROC()
  /* This process does the following*/
  /* 1. Initialize the all application specific records*/
  /* 2. Read the Input Record*/
  /* 3. Validate the Input date and finds the first day of the month*/
  /* and last day of the month*/
  /* 4. Read the PCE-FILE*/
  /* 5. Delete all records from the screen report table*/
  /* TWNNMDS_PEND_STATS*/
  /* 6. Process the data.*/
  /*  */
  set ARX07W empty;
  set ARX07W1 empty;
  set SR-ARX07W2 empty;
  set ARX07W3 empty;
  set ARX07W4 empty;
  set ARX07W5 empty;
  set ARX07W6 empty;
  set ARX07W7 empty;
  set ARX07W8 empty;
  set SR-ARX07W9 empty;
  set ARX07W9 empty;
  set ARX07W10 empty;
  set ARX07W11 empty;
  VGVar.handleHardIOErrors = 1;
  VDBCONTROL.UPROC-NM = "ARX07P9-MAIN-PROC";
  VDBCONTROL.UPROC-OBJ = "SR-ARX07W9";
  VDBCOMMON.UAPPLNAM = "ARX07A";
  /*  */
  try
    get next SR-ARX07W9 ;
  end
  /*  */
  if (SR-ARX07W9 is ioError)
    VDBCONTROL.UPROC-NM = "ARX07P9-MAIN-PROC";
    VDBCONTROL.UPROC-OBJ = "SR-ARX07W9";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VMESSAGE.UMSGINS[2] = "ARX07A";
    VDBCONTROL.UMSQLCODE = 0;
    ARX07W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = ARX07W.WS-ERR-LAST-FOUR;
    VDBCONTROL.UEZESQRRM = "INPUT PARAMETER FILE - I/O ERROR";
    WCM00P2-TO-CEP01A();
    exit program;
  end
  /*  */
  VDBCONTROL.UPROC-NM = "ARX07P9-MAIN-PROC";
  VDBCONTROL.UPROC-OBJ = "SR-ARX07W9";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VMESSAGE.UMSGINS[2] = "ARX07A";
  /*  */
  ARX07W8.PI1-LAST-DAY-OF-MNTH = SR-ARX07W9.IN-DATE;
  ARX07W1.PI1-LAST-MM = ARX07W8.PI1-LAST-MM;
  ARX07W1.PI1-LAST-DD = ARX07W8.PI1-LAST-DD;
  ARX07W1.PI1-LAST-YY = ARX07W8.PI1-LAST-YY;
  ARX07W1.FIL1 = "-";
  ARX07W1.FIL2 = "-";
  /* Vaidate date*/
  VDTSREC.UDATMM = ARX07W1.PI1-LAST-MM;
  VDTSREC.UDATDD = ARX07W1.PI1-LAST-DD;
  VDTSREC.UDATYY = ARX07W1.PI1-LAST-YY;
  /*  */
  call "WDT10A" (VCONTROL, VDTSREC) {isNoRefresh = yes};
  /*  */
  if (VCONTROL.URC != 0)
    VMESSAGE.UMSGCODE = "ARX0402E";
    WCM00P2-TO-CEP01A();
    exit program;
  end
  if ((ARX07W1.PI1-LAST-MM == 1 || 
  ARX07W1.PI1-LAST-MM == 3 || 
  ARX07W1.PI1-LAST-MM == 5 || 
  ARX07W1.PI1-LAST-MM == 7 || 
  ARX07W1.PI1-LAST-MM == 8 || 
  ARX07W1.PI1-LAST-MM == 10 || 
  ARX07W1.PI1-LAST-MM == 12) && 
  ARX07W1.PI1-LAST-DD != 31)
    VDBCONTROL.UPROC-NM = "ARX07P9-MAIN-PROC";
    VDBCONTROL.UPROC-OBJ = "SR-ARX07W9";
    VDBCOMMON.UAPPLNAM = "ARX07A";
    VMESSAGE.UMSGCODE = "ARX0403E";
    WCM00P2-TO-CEP01A();
    exit program;
  else
    if ((ARX07W1.PI1-LAST-MM == 4 || 
    ARX07W1.PI1-LAST-MM == 6 || 
    ARX07W1.PI1-LAST-MM == 9 || 
    ARX07W1.PI1-LAST-MM == 11) && 
    ARX07W1.PI1-LAST-DD != 30)
      VMESSAGE.UMSGCODE = "ARX0403E";
      WCM00P2-TO-CEP01A();
      exit program;
    end
  end
  if (ARX07W1.PI1-LAST-MM == 2)
    ARX07W.WS-LEAP-FLAG = "N";
    ARX07W.WS-TEMP = ARX07W1.PI1-LAST-YY % 4;
    if (ARX07W.WS-TEMP == 0)
      ARX07W.WS-TEMP = ARX07W1.PI1-LAST-YY % 100;
      if (ARX07W.WS-TEMP != 0)
        ARX07W.WS-LEAP-FLAG = "Y";
      else
        ARX07W.WS-TEMP = ARX07W1.PI1-LAST-YY % 400;
        if (ARX07W.WS-TEMP == 0)
          ARX07W.WS-LEAP-FLAG = "Y";
        end
      end
    end
  end
  if ((ARX07W.WS-LEAP-FLAG == "Y" && 
  ARX07W1.PI1-LAST-DD != 29) || 
  (ARX07W.WS-LEAP-FLAG == "N" && 
  ARX07W1.PI1-LAST-DD != 28))
    VMESSAGE.UMSGCODE = "ARX0403E";
    WCM00P2-TO-CEP01A();
    exit program;
  end
  /* Perform initialize process.*/
  set ARX07W3 empty;
  set ARX07W4 empty;
  set ARX07W5 empty;
  set ARX07W6 empty;
  set ARX07W7 empty;
  set ARX07W9 empty;
  set ARX07W10 empty;
  set ARX07W11 empty;
  ARX07W.WS-FLAG1 = "N";
  /*  */
  ARX07W.WS-FRST-DAY-OF-MNTH = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  ARX07W.WS-FRST-DD = "01";
  /*  */
  /* Delete all records from screen rpt tble(twnnmds_pend_stats).*/
  ARX07P9-NPS-DEL();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
  /* Read PCE-FILE.*/
  ARX07P9-SCAN-PCE();
  /*  */
  if (SR-ARX07W2 is endOfFile)
    VDBCONTROL.UPROC-NM = "ARX07P9-MAIN-PROC";
    VDBCONTROL.UPROC-OBJ = "SR-ARX07W2";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VMESSAGE.UMSGCODE = "ARX0404E";
    VDBCONTROL.UMSQLCODE = 0;
    ARX07W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = ARX07W.WS-ERR-LAST-FOUR;
    VMESSAGE.UMSGINS[2] = "ARX07A";
    VMESSAGE.UMSGCODE-JCL-ERR = 8;
    WCM00P2-TO-CEP01A();
    exit program;
  end
  /*  */
  ARX07W.WS-PREV-OFC-CD = SR-ARX07W2.PCE-OFC-CD;
  ARX07W.WS-PREV-SPRVS-UNIT = SR-ARX07W2.PCE-SPRVS-UNIT;
  ARX07W.WS-PREV-FUNC-AREA-CD = SR-ARX07W2.PCE-FUNC-AREA-CD;
  ARX07W.WS-PREV-WRKR-TYPE = SR-ARX07W2.PCE-WRKR-TYPE;
  ARX07W.WS-PREV-PSN-NMB = SR-ARX07W2.PCE-PSN-NMB;
  ARX07W.WS-WRKR-ID = SR-ARX07W2.PCE-WRKR-ID;
  ARX07W.WS-WRKR-NM = SR-ARX07W2.PCE-WRKR-NM;
  /*  */
  while (sysVar.errorCode == "00000000")
    if (SR-ARX07W2.PCE-PRGM-CASE-STS != "P" || 
    SR-ARX07W2.PCE-LAST-REC-FOR-MNTH != "Y")
  /*  */
  /* Skip processing current record.*/
      ARX07P9-SCAN-PCE();
    else
      ARX07P9-DATA-PROC();
  /*  */
      ARX07P9-SCAN-PCE();
    end
  end
  /*  */
  if (ARX07W.WS-FLAG1 == "Y")
    ARX07P9-DB-CRT();
  end
  ARX07P9-CLS-PCE();
  /*  */
  if (ARX07W.WS-FLAG1 != "Y")
    VDBCONTROL.UPROC-NM = "ARX07P9-MAIN-PROC";
    VDBCONTROL.UPROC-OBJ = "SR-ARX07W2";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VMESSAGE.UMSGCODE = "ARX0405E";
    VMESSAGE.UMSGINS[1] = " ";
    VDBCONTROL.UMSQLCODE = 0;
    VMESSAGE.UMSGINS[2] = "ARX07A";
    VMESSAGE.UMSGCODE-JCL-ERR = 8;
    WCM00P2-TO-CEP01A();
    exit program;
  end
end // end ARX07P9-MAIN-PROC


Function ARX07P9-MED-EL()
  /* Accumulate Statistics for FM Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W5.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W5.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W5.PNDNG-CASES-CT = ARX07W5.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W5.NUM-OF-APLCS-RCVD = ARX07W5.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W5.PNDNG-LTEQ-5-DAYS = ARX07W5.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W5.PNDNG-LTEQ-16-30-DAYS = ARX07W5.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W5.PNDNG-LTEQ-31-45-DAYS = ARX07W5.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W5.PNDNG-LTEQ-46-90-DAYS = ARX07W5.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W5.PNDNG-GT-90-DAYS = ARX07W5.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-MED-EL


// Add data into the db table
Function ARX07P9-NPS-ADD()
  /* ---------------------------------------------------------------------**/
  /* This process performs an ADD on the table TWNNMDS_PEND_STATS         **/
  /* table to insert a row                                                **/
  /* ---------------------------------------------------------------------**/
  /*  */
  /* Perform standard database application initialization*/
  WDB00PI();
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "ARX07A";
  /*  */
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-NMDS-PEND-STATS";
  VDBCONTROL.UPROC-OBJ = "H2-NMDS-PEND-STATS";
  VDBCONTROL.UPROC-NM = "ARX07P9-NPS-ADD";
  VDBCONTROL.UPROC-OPT = "ADD";
  /*  */
  try
    add H2-NMDS-PEND-STATS ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
end // end ARX07P9-NPS-ADD


// Delete Data
Function ARX07P9-NPS-DEL()
  /* ---------------------------------------------------------------------**/
  /* This process Deletes all records from the screen report table        **/
  /* TWNNMDS_PEND_STATS                                                   **/
  /* ----------------------------------------------------------------------**/
  /*  */
  /* Perform standard database application initialization*/
  WDB00PI();
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "ARX07A";
  /*  */
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-NMDS-PEND-STATS";
  VDBCONTROL.UPROC-OBJ = "H2-NMDS-PEND-STATS";
  VDBCONTROL.UPROC-NM = "ARX07P9-NPS-DEL";
  VDBCONTROL.UPROC-OPT = "SQLEXEC";
  /*  */
  try
    execute delete 
      #sql{
        DELETE FROM
          TWNNMDS_PEND_STATS T1
      }
      for H2-NMDS-PEND-STATS ; // model = delete
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";
  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  /*  */
end // end ARX07P9-NPS-DEL


// To read PCE-FILE
Function ARX07P9-SCAN-PCE()
  /* ---------------------------------------------------------------------**/
  /* Reading the input file Logical name PCE-FILE                        **/
  /* ---------------------------------------------------------------------**/
  try
    get next SR-ARX07W2 ;
  end
  if (SR-ARX07W2 is ioError && SR-ARX07W2 not endOfFile)
    VDBCONTROL.UPROC-NM = "ARX07P9-SCAN-PCE";
    VDBCONTROL.UPROC-OBJ = "SR-ARX07W2";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VDBCONTROL.UMSQLCODE = 0;
    VMESSAGE.UMSGINS[2] = "ARX07A";
  /* **  MOVE EZERT8 TO VMESSAGE.UMSGCODE;*/
    ARX07W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = ARX07W.WS-ERR-LAST-FOUR;
    VDBCONTROL.UEZESQRRM = "PCEFILE FILE - I/O ERROR";
    WCM00P2-TO-CEP01A();
  end
end // end ARX07P9-SCAN-PCE


Function ARX07P9-TL-DATA()
  /* Accumulate Statistics for TL Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W9.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W9.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W9.PNDNG-CASES-CT = ARX07W9.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W9.NUM-OF-APLCS-RCVD = ARX07W9.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W9.PNDNG-LTEQ-5-DAYS = ARX07W9.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W9.PNDNG-LTEQ-16-30-DAYS = ARX07W9.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W9.PNDNG-LTEQ-31-45-DAYS = ARX07W9.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W9.PNDNG-LTEQ-46-90-DAYS = ARX07W9.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W9.PNDNG-GT-90-DAYS = ARX07W9.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-TL-DATA


Function ARX07P9-TN-DATA()
  /* Accumulate Statistics for TN Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W10.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W10.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W10.PNDNG-CASES-CT = ARX07W10.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W10.NUM-OF-APLCS-RCVD = ARX07W10.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W10.PNDNG-LTEQ-5-DAYS = ARX07W10.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W10.PNDNG-LTEQ-16-30-DAYS = ARX07W10.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W10.PNDNG-LTEQ-31-45-DAYS = ARX07W10.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W10.PNDNG-LTEQ-46-90-DAYS = ARX07W10.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W10.PNDNG-GT-90-DAYS = ARX07W10.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-TN-DATA


Function ARX07P9-TP-DATA()
  /* Accumulate Statistics for TP Record.*/
  /*  */
  /* Calculate difference in date*/
  /*  */
  P-DATE-REC3.C-INPUT-DATE = ARX07W1.PI1-LAST-DAY-OF-MNTH;
  P-DATE-REC3.C-OUTPUT-DATE = SR-ARX07W2.PCE-PRGM-STS-EFF-DT;
  /*  */
  call "DATED1A" (VDBCONTROL, VMESSAGE, P-DATE-REC3) {isNoRefresh = yes};
  ARX07W.WS-PENDING-DAYS = 0;
  ARX07W.WS-PENDING-DAYS = P-DATE-REC3.N-DIFF-DAYS;
  /*  */
  ARX07W11.WS-TOTAL-PNDNG-DAYS = ARX07W.WS-PENDING-DAYS +   ARX07W11.WS-TOTAL-PNDNG-DAYS;
  /*  */
  ARX07W11.PNDNG-CASES-CT = ARX07W11.PNDNG-CASES-CT + 1;
  /*  */
  if (SR-ARX07W2.PCE-APPL-DT >= ARX07W.WS-FRST-DAY-OF-MNTH && 
  SR-ARX07W2.PCE-APPL-DT <= ARX07W1.PI1-LAST-DAY-OF-MNTH)
    ARX07W11.NUM-OF-APLCS-RCVD = ARX07W11.NUM-OF-APLCS-RCVD + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS < 6)
    ARX07W11.PNDNG-LTEQ-5-DAYS = ARX07W11.PNDNG-LTEQ-5-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 15 && ARX07W.WS-PENDING-DAYS < 31)
    ARX07W11.PNDNG-LTEQ-16-30-DAYS = ARX07W11.PNDNG-LTEQ-16-30-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 30 && ARX07W.WS-PENDING-DAYS < 46)
    ARX07W11.PNDNG-LTEQ-31-45-DAYS = ARX07W11.PNDNG-LTEQ-31-45-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 45 && ARX07W.WS-PENDING-DAYS < 91)
    ARX07W11.PNDNG-LTEQ-46-90-DAYS = ARX07W11.PNDNG-LTEQ-46-90-DAYS + 1;
  end
  /*  */
  if (ARX07W.WS-PENDING-DAYS > 90)
    ARX07W11.PNDNG-GT-90-DAYS = ARX07W11.PNDNG-GT-90-DAYS + 1;
  end
end // end ARX07P9-TP-DATA


Record ARX07W type basicRecord
  10 WS-FRST-DAY-OF-MNTH char(10) ; 
    15 * char(8) ; 
    15 WS-FRST-DD char(2) ; 
  10 WS-PENDING-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
  10 WS-PREV-OFC-CD char(2) ; 
  10 WS-PREV-SPRVS-UNIT char(1) ; 
  10 WS-PREV-FUNC-AREA-CD char(1) ; 
  10 WS-PREV-WRKR-TYPE char(1) ; 
  10 WS-PREV-PSN-NMB smallint ; 
  10 WS-WRKR-ID char(8) ; 
  10 WS-WRKR-NM char(30) ; 
  10 WS-FLAG char(1) ; 
  10 WS-FLAG1 char(1) ; 
  10 WS-TEMP num(4) ; 
  10 WS-LEAP-FLAG char(1) ; 
  10 WS-ERR-CD char(8) ; 
    15 WS-ERR-FIRST-FOUR char(4) ; 
    15 WS-ERR-LAST-FOUR char(4) ; 
end // end ARX07W


Record ARX07W1 type basicRecord
  10 PI1-REC char(10) ; 
    15 PI1-LAST-DAY-OF-MNTH char(10) ; 
      20 PI1-LAST-YY num(4) ; 
      20 FIL1 char(1) ; 
      20 PI1-LAST-MM num(2) ; 
      20 FIL2 char(1) ; 
      20 PI1-LAST-DD num(2) ; 
end // end ARX07W1


Record ARX07W10 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W10


Record ARX07W11 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W11


Record ARX07W3 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W3


Record ARX07W4 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W4


Record ARX07W5 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W5


Record ARX07W6 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W6


Record ARX07W7 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W7


Record ARX07W8 type basicRecord
  10 PI1-REC char(8) ; 
    15 PI1-LAST-DAY-OF-MNTH char(8) ; 
      20 PI1-LAST-YY num(4) ; 
      20 PI1-LAST-MM num(2) ; 
      20 PI1-LAST-DD num(2) ; 
end // end ARX07W8


Record ARX07W9 type basicRecord
  10 NUM-OF-APLCS-RCVD num(6) ; 
  10 PNDNG-CASES-CT num(6) ; 
  10 AVG-DAYS-PNDNG num(6) ; 
  10 PNDNG-LTEQ-5-DAYS num(6) ; 
  10 PNDNG-LTEQ-16-30-DAYS num(6) ; 
  10 PNDNG-LTEQ-31-45-DAYS num(6) ; 
  10 PNDNG-LTEQ-46-90-DAYS num(6) ; 
  10 PNDNG-GT-90-DAYS num(6) ; 
  10 WS-TOTAL-PNDNG-DAYS num(6) ; 
end // end ARX07W9


