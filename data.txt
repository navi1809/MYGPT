private static Integer toInt(Object o) {
    if (o == null) return null;
    if (o instanceof Number) return ((Number) o).intValue();
    String s = o.toString().trim();
    if (s.isEmpty()) return null;
    try { return Integer.parseInt(s); } catch (NumberFormatException e) { return null; }
}




java.time.LocalDate asOf = java.time.LocalDate.parse(SystemInfoParam.getAsOfDate());
final int lstYY = asOf.getYear();
final int lstMM = asOf.getMonthValue();

List<ReportMonthlyCaseHistorySorRecord> pceForMonth = pceRecords.stream()
        .filter(r -> {
            Integer by = toInt(r.getBenefitYear());
            Integer bm = toInt(r.getBenefitMonth());
            return by != null && bm != null && by == lstYY && bm == lstMM;
        })
        .collect(java.util.stream.Collectors.toList());

if (pceForMonth.isEmpty()) {
    LOG.warn("PCE month filter produced 0 rows for {}/{}; 
    pceForMonth = pceRecords; 
}

List<String> listMonth = getStrings(pceForMonth);
fileWriter(listMonth);

pceRecords = pceForMonth;
