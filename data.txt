function CIN05P9-WAD-I01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-WAGE-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-WAGE-DTLS";

    VDBCONTROL.UPROC-OPT = "ADD";

    VDBCONTROL.UPROC-NM = "CIN05P9-WAD-I01";

    /*  */

    try

        add H2-WAGE-DTLS;

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();

end // end CIN05P9-WAD-I01



// INQUIRY WAGE DTLS



function CIN05P9-WAD-S01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H3-WAGE-DTLS";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-WAD-S01";

    VDBCOMMON.USQLREC = "H3-WAGE-DTLS";

    /*  */

    try

        get H3-WAGE-DTLS

                with #sql{

        select WGE_AMT

        from TWNWAGE_DTLS T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI = :UPI

        AND   EMPLR_ID = :EMPLR-ID

        AND   LCTE_SRC = :LCTE-SRC

         --AND   CRTN_DT = :CRTN-DT

        AND   QRTR = :QRTR

        AND   WGE_YR = :WGE-YR

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into WGE-AMT;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-WAD-S01



// UPDATE TWNWAGE_DTLS



function CIN05P9-WAD-U01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H2-WAGE-DTLS";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-WAD-U01";

    VDBCOMMON.USQLREC = "H2-WAGE-DTLS";

    /*  */

    try

        execute update 

                #sql{

        UPDATE

          TWNWAGE_DTLS

        SET

          WGE_AMT = :WGE-AMT

        WHERE UPI        = :UPI

        AND   EMPLR_ID   = :EMPLR-ID

        AND   CRTN_DT    = :CRTN-DT

        AND   LCTE_SRC   = :LCTE-SRC

        AND   QRTR       = :QRTR

        AND   WGE_YR     = :WGE-YR

        AND   INTRFC_SSN = :INTRFC-SSN

      }

                for H2-WAGE-DTLS; // model = update

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-WAD-U01



// end CIN05P9-WAGE



function CIN05P9-WAGE-JHINS()

    H2-JOB-HISTORY.UPI = CIN05W.WS-UPI;

    H2-JOB-HISTORY.EMPLR-ID = CIN05W.WS-EMPLR-ID;

    H2-JOB-HISTORY.CRTN-DT = CIN05W1.WS-PROCESS-DT;

    H2-JOB-HISTORY.JOB-BEG-DT = "0001-01-01";

    H2-JOB-HISTORY.JOB-END-DT = "9999-12-31";

    H2-JOB-HISTORY.EMPLT-STS-EFF-DT = CIN05W1.WS-PROCESS-DT;

    H2-JOB-HISTORY.EMPLT-STS = "FT";

    H2-JOB-HISTORY.VRFD-DT = CIN05W1.WS-PROCESS-DT;

    H2-JOB-HISTORY.EMPLT-INFO-SRC = "ESD";

    /* wi 29485; if WS-PRIM-OR-ALT not P, don't make another bad record.*/

    /* since one already exists (V/C with end date or B status record exists)*/

    /* IF CIN05W.WS-PRIM-OR-ALT = 'P';*/

    H2-JOB-HISTORY.VRFN-STS = "C";

    /* ELSE;*/

    /* MOVE 'B' TO H2-JOB-HISTORY.VRFN-STS;*/

    /* END;*/

    H2-JOB-HISTORY.NCP-WWH-EFF-DT = "0001-01-01";

    H2-JOB-HISTORY.INTRFC-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    CIN05P9-JHS-I01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

end // end CIN05P9-WAGE-JHINS



function CIN05P9-WAGE-JHNRF()

    H2-JOB-HISTORY.UPI = CIN05W.WS-UPI;

    H2-JOB-HISTORY.EMPLR-ID = CIN05W.WS-EMPLR-ID;

    H2-JOB-HISTORY.CRTN-DT = CIN05W1.WS-PROCESS-DT;

    H2-JOB-HISTORY.JOB-BEG-DT = "0001-01-01";

    H2-JOB-HISTORY.JOB-END-DT = "9999-12-31";

    H2-JOB-HISTORY.EMPLT-STS-EFF-DT = CIN05W1.WS-PROCESS-DT;

    H2-JOB-HISTORY.EMPLT-STS = "FT";

    H2-JOB-HISTORY.VRFD-DT = CIN05W1.WS-PROCESS-DT;

    H2-JOB-HISTORY.EMPLT-INFO-SRC = "ESD";

    if(CIN05W.WS-PRIM-OR-ALT == "P")

        H2-JOB-HISTORY.VRFN-STS = "C";

    else

        H2-JOB-HISTORY.VRFN-STS = "B";

    end

    H2-JOB-HISTORY.NCP-WWH-EFF-DT = "0001-01-01";

    H2-JOB-HISTORY.INTRFC-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    CIN05P9-JHS-I01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    /* insert wage details*/

    CIN05P9-WAD-I01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    /* generate alert - new employer*/

    set PCALINP empty;

    if(CIN05W.WS-PRIM-OR-ALT == "P")

        PCALINP.PAL-ALERT-CD = 320007;

    else

        PCALINP.PAL-ALERT-CD = 320113;

    end

    PCALINP.PAL-UPI = CIN05W.WS-UPI;

    PCALINP.PAL-SUFFIX = "A";

    PCALINP.PAL-ALERT-ACTION = "C";

    PCALINP.PAL-PROCESS-DT = CIN05W1.WS-PROCESS-DT;

    /*  */

    if(CIN05W3.PI1-ALERT == "NOALERT" && CIN05W3.PI1-ALERT-FLAG == "N")

        /*  */

        call "CAL11A"(VDBCONTROL, VMESSAGE, PCALINP){isNoRefresh = yes};

    /*  */

    end

    /*  */

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    /* if primary ssn, process caseload assignment, forms NV0014, GN0092,*/

    /* generate gn0077 absent parent medical packet*/

    if(CIN05W.WS-PRIM-OR-ALT == "P")

        set H2-IVD-CASE empty;

        H2-IVD-CASE.NCP-UPI = CIN05W.WS-UPI;

        CIN05P9-IDC-S01();

        if(sysVar.sqlData.sqlcode == 0)

            CIN05P9-IDC-SCAN();

            while(sysVar.sqlData.sqlcode == 0)

                /*  */

                set PDCP27-PARM empty;

                PDCP27-PARM.P04-NCP-UPI = CIN05W.WS-UPI;

                PDCP27-PARM.P04-CASE-SUFX = H2-IVD-CASE.CASE-SUFX;

                PDCP27-PARM.P04-PDCM-MANUAL-IND = "N";

                PDCP27-PARM.P04-PROC-DATE = GDW.DTCD;

                call "DCP27A"(VDBCONTROL, VMESSAGE, PDCP27-PARM, GNOMADS,

                        G-IV-D){isNoRefresh = yes};

                if(VDBCONTROL.URC > 104)

                    WCM00P2-TO-CEP01A();

                end

                /*  */

                if((H2-IVD-CASE.CASE-TYPE == "A" || H2-IVD-CASE.CASE-TYPE ==

                                "E" || H2-IVD-CASE.CASE-TYPE == "C" ||

                        H2-IVD-CASE.CASE-TYPE == "M") ||((

                        H2-IVD-CASE.SRVC-LVL == "F" || H2-IVD-CASE.SRVC-LVL ==

                                        "M") &&

                                H2-IVD-CASE.CST-NED-MEDINS-IND == "Y"))

                    /* Print the medical questionnaire to be sent with the packet.*/

                    DFMBTCH-XFER.PIO-FORM-ID = "GN0077";

                    DFMBTCH-XFER.PIO-UPI = CIN05W.WS-UPI;

                    DFMBTCH-XFER.PIO-CASE-SUFX = H2-IVD-CASE.CASE-SUFX;

                    DFMBTCH-XFER.PIO-MODE-IND = "D";

                    DFMBTCH-XFER.PIO-NMB-OF-COPIES = 1;



                    call "DFM08A"(VDBCONTROL, VMESSAGE,

                            DFMBTCH-XFER){isNoRefresh = yes};

                    if(VDBCONTROL.URC > 104)

                        WCM00P2-TO-CEP01A();

                    end

                end

                CIN05P9-IDC-SCAN();

            end

        end

        /* Generate forms and alert for every active order*/

        /* with Income Withholding, against the NCP*/

        set H2-2-COR-DOC empty;

        H2-2-COR-DOC.UPI = CIN05W.WS-UPI;

        CIN05P9-CORDOC-S01();

        if(sysVar.sqlData.sqlcode == 0)

          CIN05P9-CORDOC-SC();

        end



        CIN05W.WS-NV0014-IND = "N";



        while(sysVar.sqlData.sqlcode == 0)

// Do not process closed or non-IV-D case

            set H2-IVD-CASE empty;

            H2-IVD-CASE.NCP-UPI = H2-2-COR-DOC.UPI;

            H2-IVD-CASE.CASE-SUFX = H2-2-COR-DOC.CASE-SUFX;

            CIN05P9-IDC-S02();

            if(sysVar.sqlData.sqlcode != 0)

                if(((H2-2-COR-DOC.INTID-INCWH-EST-DT != "0001-01-01") &&(

                        H2-2-COR-DOC.INTID-INCWH-EST-DT != "9999-12-31")) ||((

                        H2-2-COR-DOC.IMD-IW-EST-DT != "0001-01-01") &&(

                                H2-2-COR-DOC.IMD-IW-EST-DT != "9999-12-31")))

                    CIN05P9-FORMS();

                end

            end

            CIN05P9-CORDOC-SC();

        end

        /*  */

        if(CIN05W.WS-NV0014-IND == "N")

        	set H2-IVD-CASE empty; 

        	H2-IVD-CASE.NCP-UPI = CIN05W.WS-UPI;

        	CIN05P9-IDC-S01();

        	if (sysVar.sqlData.sqlcode == 0)

        	  CIN05P9-IDC-SCAN();

        	  if (sysVar.sqlData.sqlcode == 0)

        	    H2-2-COR-DOC.CASE-SUFX = H2-IVD-CASE.CASE-SUFX;

                CIN05P9-GN0092();

              end

            end

        end

    end

end // end CIN05P9-WAGE-JHNRF





function CIN05P9-WAGE-JHRF()

/* WI 29485;Cheryl T;09/2007*/

/* CIN05W1.WS-EMPLT-STS-EFF-CCYY ==> from existing record*/

/* CIN05W.WS-WAGE-CCYY ==> new record from ESD*/

    CIN05W1.WS-VRFD-DT = H2-JOB-HISTORY.VRFD-DT;

    CIN05P9-DRV-MNTH();

    if(H2-JOB-HISTORY.VRFN-STS == "B" && CIN05W.WS-PRIM-OR-ALT == "P")

        if(H2-JOB-HISTORY.JOB-END-DT == "9999-12-31")

            if(CIN05W.WS-WAGE-CCYY > CIN05W1.WS-VRFD-DT-CCYY ||(

                    CIN05W.WS-WAGE-CCYY == CIN05W1.WS-VRFD-DT-CCYY &&

                            CIN05W.WS-WAGE-MM > CIN05W1.WS-VRFD-DT-MM))

                CIN05P9-WAGE-JHINS();

            end

        else /* if job end date has real value*/

            CIN05W1.WS-JOB-END-DT = H2-JOB-HISTORY.JOB-END-DT;

            if(CIN05W.WS-WAGE-CCYY > CIN05W1.WS-JOB-END-DT-CCYY ||(

                    CIN05W.WS-WAGE-CCYY == CIN05W1.WS-JOB-END-DT-CCYY &&

                            CIN05W.WS-WAGE-MM > CIN05W1.WS-JOB-END-DT-MM))

                CIN05P9-WAGE-JHINS();

            end

        end

    else /* if vrfn_sts not B*/

        if((H2-JOB-HISTORY.VRFN-STS == "C" || H2-JOB-HISTORY.VRFN-STS ==

                        "V") && CIN05W.WS-PRIM-OR-ALT == "P")

            CIN05W1.WS-JOB-END-DT = H2-JOB-HISTORY.JOB-END-DT;

            if(CIN05W.WS-WAGE-CCYY > CIN05W1.WS-JOB-END-DT-CCYY ||(

                    CIN05W.WS-WAGE-CCYY == CIN05W1.WS-JOB-END-DT-CCYY &&

                            CIN05W.WS-WAGE-MM > CIN05W1.WS-JOB-END-DT-MM))

                CIN05P9-WAGE-JHINS();

            end

        end

    end



    /* insert/update TWNWAGE_DTLS*/

    H3-WAGE-DTLS.UPI = H2-WAGE-DTLS.UPI;

    H3-WAGE-DTLS.EMPLR-ID = H2-WAGE-DTLS.EMPLR-ID;

    H3-WAGE-DTLS.CRTN-DT = H2-JOB-HISTORY.CRTN-DT;

    H3-WAGE-DTLS.LCTE-SRC = "ESD";

    H3-WAGE-DTLS.QRTR = H2-WAGE-DTLS.QRTR;

    H3-WAGE-DTLS.WGE-YR = H2-WAGE-DTLS.WGE-YR;

    /* select (oldest) by upi, emplr-id, lcte-src, yr, qrtr, intrfc-ssn*/

    CIN05P9-WAD-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(sysVar.sqlData.sqlcode == 0)

        /* wi 29485;Cheryl T;09/2007 if same record exists with same amount*/

        /* do not insert, if same record exists with different amount, update*/

        /* else insert new record.*/

        if(H3-WAGE-DTLS.WGE-AMT != H2-WAGE-DTLS.WGE-AMT)

            H2-WAGE-DTLS.CRTN-DT = H2-JOB-HISTORY.CRTN-DT;

            CIN05P9-WAD-U01();

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

        end

    else

        H2-WAGE-DTLS.CRTN-DT = H2-JOB-HISTORY.CRTN-DT;

        CIN05P9-WAD-I01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    end

end // end CIN05P9-WAGE-JHRF



function CIN05P9-WAGE-SWICA()

/* insert/update TWNSWICA-EMPLR-DTL*/

    set H2-SWICA-EMPLR-DTL empty;

    H2-SWICA-EMPLR-DTL.UPI = CIN05W.WS-UPI;

    H2-SWICA-EMPLR-DTL.EMPLR-ID = CIN05W.WS-EMPLR-ID;

    H2-SWICA-EMPLR-DTL.EMPLR-NM = CIN05W.WS-WAGE-EMPLR-NM;

    H2-SWICA-EMPLR-DTL.EMPLR-ADLN1 = CIN05W.WS-WAGE-EMPLR-ADLN;

    H2-SWICA-EMPLR-DTL.CTY = CIN05W.WS-WAGE-EMPLR-CITY;

    H2-SWICA-EMPLR-DTL.ST-CD = CIN05W.WS-WAGE-EMPLR-ST;

    H2-SWICA-EMPLR-DTL.ZIP-CD = CIN05W.WS-WAGE-EMPLR-ZIP-CD;

    /* select by upi, emplr-id*/

    H3-SWICA-EMPLR-DTL.UPI = H2-SWICA-EMPLR-DTL.UPI;

    H3-SWICA-EMPLR-DTL.EMPLR-ID = H2-SWICA-EMPLR-DTL.EMPLR-ID;

    CIN05P9-SWE-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(sysVar.sqlData.sqlcode == 0)

        CIN05P9-SWE-U01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    else

        CIN05P9-SWE-I01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    end

    /* insert/update TWNSWICA-WAGE-DTL*/

    set H2-SWICA-WAGE-DTL empty;

    H2-SWICA-WAGE-DTL.UPI = CIN05W.WS-UPI;

    H2-SWICA-WAGE-DTL.EMPLR-ID = CIN05W.WS-EMPLR-ID;

    CIN05W.WS-NUM-1-2 = CIN05W.WS-WAGE-YY;

    CIN05W.WS-NUM-3 = CIN05W.WS-WAGE-QTR;

    H2-SWICA-WAGE-DTL.WGE-QRTR = CIN05W.WS-NUM;

    H2-SWICA-WAGE-DTL.PROCESS-DT = CIN05W1.WS-PROCESS-DT;

    H2-SWICA-WAGE-DTL.QRTR-ERNGS = CIN05W.WS-WAGE-QTR-ERNGS;

    CIN05W.WS-FRST-INIT = CIN05W.WS-WAGE-EMPL-FRST-INIT;

    CIN05W.WS-MID-INIT = CIN05W.WS-WAGE-EMPL-MID-INIT;

    CIN05W.WS-LST-NM = CIN05W.WS-WAGE-EMPL-LST-NM;

    H2-SWICA-WAGE-DTL.EMPL-NM-IN-ESD-REC = CIN05W.WS-PACKED-NM;

    /* select by upi, emplr-id, wge-qrtr, process-dt*/

    H3-SWICA-WAGE-DTL.UPI = H2-SWICA-WAGE-DTL.UPI;

    H3-SWICA-WAGE-DTL.EMPLR-ID = H2-SWICA-WAGE-DTL.EMPLR-ID;

    H3-SWICA-WAGE-DTL.WGE-QRTR = H2-SWICA-WAGE-DTL.WGE-QRTR;

    H3-SWICA-WAGE-DTL.PROCESS-DT = H2-SWICA-WAGE-DTL.PROCESS-DT;

    CIN05P9-SWW-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(sysVar.sqlData.sqlcode == 0)

        /* WI 29485;Cheryl T;09/30/2007; only update if earnings is different*/

        if(H3-SWICA-WAGE-DTL.QRTR-ERNGS != H2-SWICA-WAGE-DTL.QRTR-ERNGS)

            CIN05P9-SWW-U01();

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

        end

    else

        CIN05P9-SWW-I01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    end

end // end CIN05P9-WAGE-SWICA



record CIN05W type basicRecord

    10 WS-INPUT-DATA char(350);

        15 WS-REC-TYPE char(1);

        15 * char(9);

        15 WS-TYPE-SPECIFIC-DATA char(340);

    /* WI 4063 - start */

    10 WS-INPUT-REC-CNT num(6); 

    /* WI 4063 - end */

    10 WS-FIRST char(1);

    10 WS-FIRST-IND char(1);

    10 WS-UPI-ID char(15);

        15 WS-NCP-UPI char(9);

        15 WS-CASE-SUFX char(1);

        15 * char(5);

    10 WS-SSN-ID char(15);

        15 WS-SSN char(9);

        15 WS-SSN-SUFX char(1);

        15 * char(5);

    10 WS-NOMADS-NAME char(56);

        15 WS-NOM-FRST-NM char(16);

        15 WS-NOM-MID-NM char(16);

        15 WS-NOM-LST-NM char(21);

        15 WS-NOM-MODFR char(3);

    10 WS-ERROR char(5);

        15 WS-ERROR-1-2 char(2);

        15 WS-ERROR-3-5 char(3);

    10 WS-DATE char(8);

        15 WS-CCYY char(4);

        15 WS-MM char(2);

        15 WS-DD char(2);

    10 WS-SQL-DATE char(10);

        15 WS-SQL-MM char(2);

        15 WS-SQL-FILL1 char(1);

        15 WS-SQL-DD char(2);

        15 WS-SQL-FILL2 char(1);

        15 WS-SQL-CCYY char(4);

    10 WS-DB-DATE char(10);

        15 WS-DB-CCYY char(4);

        15 WS-DB-FILL1 char(1);

        15 WS-DB-MM char(2);

        15 WS-DB-FILL2 char(1);

        15 WS-DB-DD char(2);

    10 WS-EMPLR-ID char(10);

        15 WS-EMPLR-1-7 char(7);

        15 WS-EMPLR-HYPH char(1);

        15 WS-EMPLR-8-9 char(2);

    10 WS-FEIN char(10);

        15 WS-FEIN-1-2 char(2);

        15 WS-FEIN-HYPH char(1);

        15 WS-FEIN-3-9 char(7);

    10 WS-PACKED-NM char(20);

        15 WS-FRST-INIT char(1);

        15 WS-MID-INIT char(1);

        15 WS-LST-NM char(18);

    10 WS-NUM num(3);

        15 WS-NUM-1-2 num(2);

        15 WS-NUM-3 num(1);

    10 WS-WK-NUM num(4);

        15 WS-WK-YY num(2);

        15 WS-WK-NBR num(2);

    10 WS-ELIG-AMT numc(5, 2);

        15 WS-ELIG-AMT-1-3 num(3);

        15 WS-ELIG-AMT-4 num(1);

        15 WS-ELIG-AMT-5 num(1);

    10 WS-PRIM-OR-ALT char(1);

    10 WS-PER-CLM-DATA char(340); /* 1 record */

        15 WS-PERCLM-LST-NM char(20);

        15 WS-PERCLM-FRST-NM char(14);

            20 WS-PERCLM-FRST-INIT char(1);

            20 * char(13);

        15 WS-PERCLM-MID-INIT char(1);

        15 WS-PERCLM-AKA-LST-NM char(20);

        15 WS-PERCLM-AKA-FRST-NM char(14);

        15 WS-PERCLM-AKA-MID-INIT char(1);

        15 WS-PERCLM-AGNT-ST char(2);

        15 WS-PERCLM-MA-LN1 char(35);

        15 WS-PERCLM-MA-LN2 char(35);

        15 WS-PERCLM-MA-CITY char(24);

        15 WS-PERCLM-MA-ST char(2);

        15 WS-PERCLM-MA-ZIP-CD char(9);

        15 WS-PERCLM-RA-LN1 char(35);

        15 WS-PERCLM-RA-LN2 char(35);

        15 WS-PERCLM-RA-CITY char(24);

        15 WS-PERCLM-RA-ST char(2);

        15 WS-PERCLM-RA-ZIP-CD char(9);

        15 WS-PERCLM-DOB char(8);

            20 WS-PERCLM-DOB-CCYY char(4);

            20 WS-PERCLM-DOB-MM char(2);

            20 WS-PERCLM-DOB-DD char(2);

        15 WS-PERCLM-UI-BYE-DT char(8);

            20 WS-PERCLM-BYE-CCYY char(4);

            20 WS-PERCLM-BYE-MM char(2);

            20 WS-PERCLM-BYE-DD char(2);

        15 WS-PERCLM-LIBL-ST char(2);

        15 * char(2);

        15 WS-PERCLM-CLM-BEG-DT char(8);

            20 WS-PERCLM-CBD-CCYY char(4);

            20 WS-PERCLM-CBD-MM char(2);

            20 WS-PERCLM-CBD-DD char(2);

        15 WS-PERCLM-UI-APPL-DT char(8);

            20 WS-PERCLM-UIA-CCYY char(4);

            20 WS-PERCLM-UIA-MM char(2);

            20 WS-PERCLM-UIA-DD char(2);

        15 WS-PERCLM-UI-CLM-STS char(2);

        /* WI 4063 - start */

        15 WS-PERCLM-CLM-ID char(10);

        15 * char(10);

        /* WI 4063 - end */

    10 WS-WAGE-DATA char(340); /* 2 record */

        15 WS-WAGE-EMPLR-ID char(9);

            20 WS-WAGE-EMPLR-1-7 char(7);

            20 WS-WAGE-EMPLR-8-9 char(2);

        15 WS-WAGE-FEIN char(9);

            20 WS-WAGE-FEIN-1-2 char(2);

            20 WS-WAGE-FEIN-3-9 char(7);

        15 WS-WAGE-DBA-NM char(29);

        15 WS-WAGE-EMPLR-NM char(29);

        15 WS-WAGE-EMPLR-ADLN char(25);

        15 WS-WAGE-EMPLR-CITY char(14);

        15 WS-WAGE-EMPLR-ST char(2);

        15 WS-WAGE-EMPLR-ZIP-CD char(10);

        15 WS-WAGE-CCYY num(4);

            20 WS-WAGE-CC num(2);

            20 WS-WAGE-YY num(2);

        15 WS-WAGE-QTR num(1);

        15 WS-WAGE-QTR-ERNGS numc(11, 2);

        15 WS-WAGE-EMPL-LST-NM char(20);

        15 WS-WAGE-EMPL-FRST-NM char(12);

            20 WS-WAGE-EMPL-FRST-INIT char(1);

            20 * char(11);

        15 WS-WAGE-EMPL-MID-INIT char(1);

        15 * char(164);

    10 WS-ISSUE-DATA char(340); /* 4 record */

        15 WS-ISS-BYE-DT char(8);

            20 WS-ISS-BYE-CCYY char(4);

            20 WS-ISS-BYE-MM char(2);

            20 WS-ISS-BYE-DD char(2);

        15 WS-ISS-SQ-NMB num(3);

        15 WS-ISS-DISQ-BEG-DT char(8);

            20 WS-ISS-DBD-CCYY char(4);

            20 WS-ISS-DBD-MM char(2);

            20 WS-ISS-DBD-DD char(2);

        15 WS-ISS-DISQ-END-DT char(8);

            20 WS-ISS-DED-CCYY char(4);

            20 WS-ISS-DED-MM char(2);

            20 WS-ISS-DED-DD char(2);

        15 WS-ISS-ISSUE-DETERM char(2);

        /* WI 4063 - start */

        15 WS-ISS-CLM-ID char(10);

        15 * char(301);

        /* WI 4063 - end */

    10 WS-CHECK-DATA char(340); /* 5 record */

        15 WS-CHK-UI-BYE-DT char(8);

            20 WS-CHK-BYE-CCYY char(4);

            20 WS-CHK-BYE-MM char(2);

            20 WS-CHK-BYE-DD char(2);

        15 WS-CHK-WBA num(3);

        15 WS-CHK-MBA num(5);

        15 WS-CHK-UI-CLM-STS char(2);

            20 WS-CHK-UI-STS-PRE char(1);

            20 WS-CHK-UI-STS-SFX char(1);

        15 WS-CHK-CHK-DT char(8);

            20 WS-CHK-CHK-CCYY char(4);

                25 WS-CHK-CHK-CC char(2);

                25 WS-CHK-CHK-YY char(2);

            20 WS-CHK-CHK-MM char(2);

            20 WS-CHK-CHK-DD char(2);

        15 WS-CHK-PD-AMT numc(5, 2);

        15 WS-CHK-ERN-AMT numc(7, 2);

        15 WS-CHK-CS-AMT numc(5, 2);

        /* WI 2632 - start - DETR expanded the next 2 fields by 2 each and removed from trailing filler */

        15 WS-CHK-NON-FRD-AMT numc(7, 2);

        15 WS-CHK-FRD-AMT numc(7, 2);

        /* WI 2632 - end */

        15 WS-CHK-CHK-STS char(2);

            20 WS-CHK-STS char(1);

            20 WS-CHK-STSX char(1);

        15 WS-CHK-BASE-PRD-ERN-AMT numc(9, 2);

        15 WS-CHK-MBA-BAL numc(7, 2);

        15 WS-CHK-BNFT-WK-END-DT char(8);

            20 WS-CHK-BWE-CCYY char(4);

            20 WS-CHK-BWE-MM char(2);

            20 WS-CHK-BWE-DD char(2);

        15 WS-CHECK-NMB char(7);

        15 WS-ACH-TRACE-NMB char(15);

        /* WI2632 - 5/2015 - add clm-beg-dt */

        15 WS-CHK-CLM-BEG-DT char(8);

            20 WS-CHK-CLM-BEG-CCYY char(4);

            20 WS-CHK-CLM-BEG-MM char(2);

            20 WS-CHK-CLM-BEG-DD char(2);

        /* WI 4063 - start */

        15 WS-CHK-CLM-ID char(10);

        15 WS-CHK-INCM-WITHLD-AMT num(7,2);

        15 WS-CHK-FED-PYMT-TYPE char(4);

        15 * char(206);

        /* WI 4063 - end */

        /* WI2632 - end */

    10 WS-NOMADS-CASE char(1);

    10 WS-PRINT-IND char(1);

    10 WS-UPI-NUM num(9);

    10 WS-UPI int;

    10 WS-MATCHED-FIPS-CODE char(5);

        15 WS-MATCHED-STATE-CODE char(2);

        15 WS-MATCHED-CNTY-CODE char(3);

    10 WS-CRE-ALERT-FG char(1);

    10 WS-PRTCP char(3);

    10 WS-ERR-INDEX smallInt;

    10 WS-USER-ERR-EXISTS char(1);

    10 WS-ERR-SSN char(11);

    10 WS-PRIM-SSN char(9);

        15 WS-SSN1 char(3);

        15 WS-SSN2 char(2);

        15 WS-SSN3 char(4);

    10 WS-FORMATTED-SSN char(11);

        15 WS-FORMATTED-SSN1 char(3);

        15 WS-FORMATTED-SSN-FILL1 char(1);

        15 WS-FORMATTED-SSN2 char(2);

        15 WS-FORMATTED-SSN-FILL2 char(1);

        15 WS-FORMATTED-SSN3 char(4);

    10 TCON-CNTCT-TXT char(235);

        15 TCON-LITERAL1 char(40);

        15 TCON-LITERAL2 char(21);

        15 TCON-N-FRST-NM char(17);

        15 TCON-N-MID-NM char(17);

        15 TCON-N-LST-NM char(21);

        15 TCON-NNAME-COMMA char(2);

        15 TCON-LITERAL3 char(18);

        15 TCON-E-WHOLE-NM char(22);

            20 TCON-E-FRST-INIT char(2);

            20 TCON-E-MID-INIT char(2);

            20 TCON-E-LST-NM char(18);

        15 TCON-ENAME-COMMA char(2);

        15 TCON-LITERAL4 char(20);

        15 TCON-N-SSN char(9);

        15 TCON-NSSN-COMMA char(2);

        15 TCON-LITERAL5 char(35);

        15 TCON-E-SSN char(9);

    10 TCON-CNTCT-TXT2 char(235);

    10 WS-NV0014-IND char(1);

    10 WS-GOOD-REC char(1);

    10 WS-INDEX smallInt;

    10 WS-MAX-SEQ-NMB smallInt;

    10 WS-WKLY-FCTR num(6, 2);

    10 WS-BIWKLY-FCTR num(6, 2);

    10 WS-PERCENT-FCTR num(6, 3);

    10 WS-FREQ char(1);

    10 WS-FLAG char(1);

    10 WS-FACTOR num(7, 4);

    10 WS-CHECK-CNT num(2);

    10 WS-PAY-REC-CNT num(2);

    10 WS-UNIN-REC-CNT num(2);

    10 WS-UNIN-REC-CNT-F num(2);

    10 WS-PRD-BEG-DT char(10);

        15 WS-PRD-BEG-CCYY num(4);

        15 * char(1);

        15 WS-PRD-BEG-MM num(2);

        15 * char(1);

        15 WS-PRD-BEG-DD num(2);

    10 WS-PRD-BEG-DT-F char(10);

    10 WS-PRD-END-DT char(10);

        15 WS-PRD-END-CCYY num(4);

        15 * char(1);

        15 WS-PRD-END-MM num(2);

        15 * char(1);

        15 WS-PRD-END-DD num(2);

    10 WS-PRD-END-DT2 char(10);

    10 WS-UPD-JINC char(1);

    10 WS-JINC-AMT num(7, 2);

    10 WS-JINC-TOLERANCE-AMT num(7, 2);

    10 WS-UNIN-AMT num(7, 2);

    10 WS-UNIN-AMT-F num(7, 2);

    10 WS-UNIN-TOLERANCE-AMT num(7, 2);

    10 WS-AMT1 num(7, 2);

    10 WS-AMT2 num(7, 2);

    10 WS-DSGNT-IND char(1);

    10 WS-ALERT-FG char(1);

    10 WS-TEMP-ICI1 char(9);

        15 WS-TEMP-ICI num(9);

    10 WS-FRST-TIME-FLG char(1);

    10 WS-HRS-WRKD num(6, 2);

    10 WS-TOT-HRS-WRKD num(6, 2);

    10 WS-AVG-HOURS-WRKD num(6, 2);

    10 WS-WGS-AMT num(7, 2);

    10 WS-GRS-WGS-AMT num(7, 2);

    10 WS-AVG-GRS-WGS-AMT num(7, 2);

    10 WS-TIPS-COMSN-AMT num(7, 2);

    10 WS-AVG-TIPS-COMSN-AMT num(6, 2);

    10 WS-AVG-TIPS-AMT num(6, 2);

    10 WS-INT-AMT num(7, 2);

    10 WS-INTERFACE-AMT num(7, 2);

    10 WS-WGS-FACTOR num(7, 4);

    10 WS-TIPS-FACTOR num(6, 2);

    10 WS-WAGE-MM num(2);

    10 WS-OLD-CHECK-STATUS char(2);

        15 WS-OLD-CHECK-STS char(1);

        15 WS-OLD-CHECK-STSX char(1);

    10 WS-PREV-BENE-WK-END-DT char(8);

    10 WS-CLAIM-STATUS char(2);

    10 WS-OLD-SSN char(9);

    10 WS-CURRENT-SSN char(9);

    10 WS-CLM-END-DT char(10);

    /* WI 2632 - 5/2015 - add clm-beg-dt */

    10 WS-CLM-BEG-DT char(10);

    /* WI 2632 - end */

end // end CIN05W



record CIN05W1 type basicRecord

    10 WS-CRTD-TS char(26);

        15 WS-CRTD-DT char(10);

            20 WS-CRTD-DT-CCYY char(4);

                25 WS-CRTD-DT-CC char(2);

                25 WS-CRTD-DT-YY char(2);

            20 WS-CRTD-DT-SEP-1 char(1);

            20 WS-CRTD-DT-MM char(2);

            20 WS-CRTD-DT-SEP-2 char(1);

            20 WS-CRTD-DT-DD char(2);

        15 WS-TIME-STAMP char(16);

    10 WS-PROCESS-DT char(10);

        15 WS-PROC-DT-CCYY char(4);

            20 WS-PROC-DT-CC char(2);

            20 WS-PROC-DT-YY char(2);

        15 WS-PROC-DT-SEP-1 char(1);

        15 WS-PROC-DT-MM char(2);

        15 WS-PROC-DT-SEP-2 char(1);

        15 WS-PROC-DT-DD char(2);

    10 WS-ERR-CD char(8);

        15 WS-ERR-FIRST-FOUR char(4);

        15 WS-ERR-LAST-FOUR char(4);

    10 WS-VRFD-DT char(10);

        15 WS-VRFD-DT-CCYY char(4);

        15 WS-VRFD-DT-SEP-1 char(1);

        15 WS-VRFD-DT-MM char(2);

        15 WS-VRFD-DT-SEP-2 char(1);

        15 WS-VRFD-DT-DD char(2);

    10 WS-JOB-END-DT char(10);

        15 WS-JOB-END-DT-CCYY char(4);

        15 WS-JOB-END-DT-SEP-1 char(1);

        15 WS-JOB-END-DT-MM char(2);

        15 WS-JOB-END-DT-SEP-2 char(1);

        15 WS-JOB-END-DT-DD char(2);

end // end CIN05W1



record CIN05W2 type basicRecord

    10 PDLI-ID-INFO char(30);

        15 PO3-OLD-ID char(10);

        15 PO3-NEW-ID char(10);

        15 PO3-CURRENT-DT char(10);

end // end CIN05W2



record CIN05W3 type basicRecord

    10 PCIN05-PGM-PARMS char(80);

        15 PI1-ALERT char(7);

        15 PI1-ALERT-FLAG char(1);

        15 PI1-FILLER char(72);

end



/* WI 4063 - start */

Record CIN05W4 type basicRecord // used to format display of current record

  5 WS-TRAC-REC char(132) ;

    10 WS-TR-REC-NMB num(6);

    10 * char(1);

    10 WS-TR-REC-TY char(1) ;

    10 * char(1) ;

    10 WS-TR-SSN char(9) ;

    10 * char(114) ;

end // end CIN05W4

/* WI 4063 - end */



function CIN05P9-CHECK()

    set H2-UIB-DTLS empty;

    H2-UIB-DTLS.UPI = CIN05W.WS-UPI;

    H2-UIB-DTLS.PROCESS-DT = CIN05W1.WS-PROCESS-DT;

    if(CIN05W.WS-CHK-UI-BYE-DT == "99999999")

        H2-UIB-DTLS.CLM-END-DT = "9999-12-31";

        CIN05W.WS-CLM-END-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-BYE-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-CHK-BYE-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-CHK-BYE-DD;

        H2-UIB-DTLS.CLM-END-DT = CIN05W.WS-DB-DATE;

        CIN05W.WS-CLM-END-DT = CIN05W.WS-DB-DATE;

    end

    H2-UIB-DTLS.INTRFC-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    CIN05W.WS-OLD-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    CIN05W.WS-ELIG-AMT-1-3 = CIN05W.WS-CHK-WBA;

    WS-ELIG-AMT-4 = 0;

    WS-ELIG-AMT-5 = 0;

    H2-UIB-DTLS.WK-BNFT-AMT = CIN05W.WS-ELIG-AMT;

    H2-UIB-DTLS.MAX-BNFT-AMT = CIN05W.WS-CHK-MBA;

    H2-UIB-DTLS.UIB-APPL-STS = CIN05W.WS-CHK-UI-CLM-STS;

    if(CIN05W.WS-CHK-CHK-DT == "99999999")

        H2-UIB-DTLS.CHK-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-CHK-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-CHK-CHK-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-CHK-CHK-DD;

        H2-UIB-DTLS.CHK-DT = CIN05W.WS-DB-DATE;

    end

    H2-UIB-DTLS.CSI-AMT = CIN05W.WS-CHK-CS-AMT;

    H2-UIB-DTLS.BASE-PRD-ERN-AMT = CIN05W.WS-CHK-BASE-PRD-ERN-AMT;

    H2-UIB-DTLS.UIB-BAL-AMT = CIN05W.WS-CHK-MBA-BAL;

    /* WI 4063 - start */

    H2-UIB-DTLS.UIB-CLM-NMB = CIN05W.WS-CHK-CLM-ID;

    /* WI 4063 - end */

    /* Check for partial record created by P9-PER-CLM earlier in this batch*/

    set H3-UIB-DTLS empty;

    H3-UIB-DTLS.UPI = CIN05W.WS-UPI;

    H3-UIB-DTLS.PROCESS-DT = CIN05W1.WS-PROCESS-DT;

    H3-UIB-DTLS.CLM-END-DT = H2-UIB-DTLS.CLM-END-DT;

    H3-UIB-DTLS.UIB-APPL-STS = H2-UIB-DTLS.UIB-APPL-STS;

    H3-UIB-DTLS.INTRFC-SSN = H2-UIB-DTLS.INTRFC-SSN;

    /* WI 4063 - start */

    H3-UIB-DTLS.UIB-CLM-NMB = CIN05W.WS-CHK-CLM-ID;

    /* WI 4063 - end */



    /*  */

    /* WI2632 - 5/2015 - add clm-beg-dt */

    if(CIN05W.WS-CHK-CLM-BEG-DT == "00000000" ||

            CIN05W.WS-CHK-CLM-BEG-DT == "99999999")

        H3-UIB-DTLS.CLM-BEG-DT = "0001-01-01";

        CIN05W.WS-CLM-BEG-DT = "0001-01-01";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-CLM-BEG-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-CHK-CLM-BEG-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-CHK-CLM-BEG-DD;

        H3-UIB-DTLS.CLM-BEG-DT = CIN05W.WS-DB-DATE;

        CIN05W.WS-CLM-BEG-DT = CIN05W.WS-DB-DATE;

    end

    /* WI2632 - end */

    CIN05P9-UIB-S02();

    /*  */

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(sysVar.sqlData.sqlcode == 0)

        H2-UIB-DTLS.CLM-BEG-DT = H3-UIB-DTLS.CLM-BEG-DT;

        CIN05P9-UIB-U02();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    /* Proj 21 - Bug Fix - Start */    

    else

//    	/* WI 2632 - 5/2015 - we now have a valid clm-beg-dt, so use it */

////        H2-UIB-DTLS.CLM-BEG-DT = "0001-01-01";

//        H2-UIB-DTLS.CLM-BEG-DT = H3-UIB-DTLS.CLM-BEG-DT;

//        /* WI2632 - end */

//        H2-UIB-DTLS.CLNTS-DOB = "0001-01-01";

//        H2-UIB-DTLS.DISQL-BEG-DT = "0001-01-01";

//        H2-UIB-DTLS.DISQL-END-DT = "9999-12-31";

//        H2-UIB-DTLS.CLM-EFF-DT = "0001-01-01";

//        H2-UIB-DTLS.CLM-CMPTD-DT = "0001-01-01";

//        H2-UIB-DTLS.UI-APPL-DT = "0001-01-01";

//

//        CIN05P9-UIB-I01();

//        if(VDBCONTROL.URC > 104)

//            WCM00P2-TO-CEP01A();

//        end

    /* Proj 21 Bug Fix - end */

    end

    /* WI #58*/

    /* LOOK FOR DUPLICATE TWNUIB_BNFT_DTLS RECORD BEFORE INSERT.*/

    /*  */

    set H2-UIB-BNFT-DTLS empty;

    H2-UIB-BNFT-DTLS.UPI = CIN05W.WS-UPI;

    if(CIN05W.WS-CHK-BNFT-WK-END-DT == "99999999")

        H2-UIB-BNFT-DTLS.BNFT-WK-END-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-BWE-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-CHK-BWE-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-CHK-BWE-DD;

        H2-UIB-BNFT-DTLS.BNFT-WK-END-DT = CIN05W.WS-DB-DATE;

    end

    CIN05W.WS-PREV-BENE-WK-END-DT = H2-UIB-BNFT-DTLS.BNFT-WK-END-DT;

    H2-UIB-BNFT-DTLS.ACH-TRACE-NMB = CIN05W.WS-ACH-TRACE-NMB;

    H2-UIB-BNFT-DTLS.CHECK-NMB = CIN05W.WS-CHECK-NMB;

    /*  */

    CIN05P9-UBD-S01();

    /*  */

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    /*  */

    /* WI 4063 - start */

//    if(VDBCONTROL.URC == 0)

//        CIN05W.WS-OLD-CHECK-STATUS = H2-UIB-BNFT-DTLS.CHECK-STS;

//        if(CIN05W.WS-OLD-CHECK-STS == "1" || CIN05W.WS-OLD-CHECK-STS == "3")

//        /* SKIP THESE RECORDS, DO NOT UPDATE*/

//        else

//            if(CIN05W.WS-OLD-CHECK-STS == "0" || CIN05W.WS-OLD-CHECK-STS ==

//                            "2")

//               if(CIN05W.WS-CHK-CS-AMT != H2-UIB-BNFT-DTLS.CSI-AMT ||

//                       (CIN05W.WS-CHK-PD-AMT != H2-UIB-BNFT-DTLS.ISSUD-BNFT-AMT &&

//                        CIN05W.WS-CHK-UI-CLM-STS != 

//                                H2-UIB-BNFT-DTLS.UIB-APPL-STS ||

//                        CIN05W.WS-CHK-ERN-AMT != H2-UIB-BNFT-DTLS.ERN-AMT ||

//                        CIN05W.WS-CHK-NON-FRD-AMT !=

//                                H2-UIB-BNFT-DTLS.NON-FRD-OFST-AMT ||

//                        CIN05W.WS-CHK-FRD-AMT !=

//                                H2-UIB-BNFT-DTLS.FRD-OFST-AMT ||

//                        CIN05W.WS-CHK-CHK-STS != H2-UIB-BNFT-DTLS.CHECK-STS

//                        /* WI 2632 - start */

//                        || CIN05W.WS-CHK-CLM-BEG-DT != H2-UIB-BNFT-DTLS.CLM-BEG-DT)

//                        /* WI 2632 - end */

//                    H2-UIB-BNFT-DTLS.CSI-AMT = CIN05W.WS-CHK-CS-AMT;

//                    H2-UIB-BNFT-DTLS.ISSUD-BNFT-AMT = CIN05W.WS-CHK-PD-AMT;

//                    H2-UIB-BNFT-DTLS.UIB-APPL-STS = CIN05W.WS-CHK-UI-CLM-STS;

//                    H2-UIB-BNFT-DTLS.ERN-AMT = CIN05W.WS-CHK-ERN-AMT;

//                    H2-UIB-BNFT-DTLS.NON-FRD-OFST-AMT = CIN05W.WS-CHK-NON-FRD-AMT;

//                    H2-UIB-BNFT-DTLS.FRD-OFST-AMT = CIN05W.WS-CHK-FRD-AMT;

//                    H2-UIB-BNFT-DTLS.CHECK-STS = CIN05W.WS-CHK-CHK-STS;

//                    H2-UIB-BNFT-DTLS.CHECK-NMB = CIN05W.WS-CHECK-NMB;

//                    H2-UIB-BNFT-DTLS.ACH-TRACE-NMB = CIN05W.WS-ACH-TRACE-NMB;

//                    /* WI 2632 - start */

//                    CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-CLM-BEG-CCYY;

//                    CIN05W.WS-DB-FILL1 = "-";

//                    CIN05W.WS-DB-MM = CIN05W.WS-CHK-CLM-BEG-MM;

//                    CIN05W.WS-DB-FILL2 = "-";

//                    CIN05W.WS-DB-DD = CIN05W.WS-CHK-CLM-BEG-DD;

//                    H2-UIB-BNFT-DTLS.CLM-BEG-DT = CIN05W.WS-DB-DATE;

//                    /* WI 2632 - end */

//                    /*  */

//                    CIN05P9-UBD-U01();

//                    /*  */

//                    if(VDBCONTROL.URC > 104)

//                        WCM00P2-TO-CEP01A();

//                    end

//                end

//            end

//        end

//    else

    	/* WI 4063 - start */

//        if(VDBCONTROL.URC == 100 ||

//           (VDBCONTROL.URC == 0 &&

//          if (VDBCONTROL.URC == 100)

//          	  CIN05W.WS-FPUC-IND = CIN05W.WS-CHK-FED-PYMT-TYPED;

//          end

//          if (CIN05W.WS-FPUC-IND != " " &&

//            CIN05W.WS-CHK-FED-PYMT-TYPE != " ")

        /* WI 4063 - end */    		

//            set H3-UIB-BNFT-DTLS empty;

//            H3-UIB-BNFT-DTLS.RCPT-SSN = SR-CIN05-RECIN.INTRFC-SSN;

//            H3-UIB-BNFT-DTLS.APPL-BNFT-RECD-DT = H2-UIB-DTLS.CHK-DT;

//            H3-UIB-BNFT-DTLS.CSI-AMT = CIN05W.WS-CHK-CS-AMT;

//            H3-UIB-BNFT-DTLS.ISSUD-BNFT-AMT = CIN05W.WS-CHK-PD-AMT;

//            H3-UIB-BNFT-DTLS.UIB-APPL-STS = CIN05W.WS-CHK-UI-CLM-STS;

//            H3-UIB-BNFT-DTLS.ERN-AMT = CIN05W.WS-CHK-ERN-AMT;

//            H3-UIB-BNFT-DTLS.NON-FRD-OFST-AMT = CIN05W.WS-CHK-NON-FRD-AMT;

//            H3-UIB-BNFT-DTLS.FRD-OFST-AMT = CIN05W.WS-CHK-FRD-AMT;

//            H3-UIB-BNFT-DTLS.CHECK-STS = CIN05W.WS-CHK-CHK-STS;

//            /*  */

//            call "DATEAPP"(GDW, VDBCONTROL, VMESSAGE){isNoRefresh = yes};

//            /*  */

//            CIN05W1.WS-CRTD-TS = GDW.TS;

//            CIN05W1.WS-CRTD-DT = CIN05W1.WS-PROCESS-DT;

//            H3-UIB-BNFT-DTLS.CRN-TS = CIN05W1.WS-CRTD-TS;

//            /*  */

//            H3-UIB-BNFT-DTLS.UPI = CIN05W.WS-UPI;

//            if(CIN05W.WS-CHK-BNFT-WK-END-DT == "99999999")

//                H3-UIB-BNFT-DTLS.BNFT-WK-END-DT = "9999-12-31";

//            else

//                CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-BWE-CCYY;

//                CIN05W.WS-DB-FILL1 = "-";

//                CIN05W.WS-DB-MM = CIN05W.WS-CHK-BWE-MM;

//                CIN05W.WS-DB-FILL2 = "-";

//                CIN05W.WS-DB-DD = CIN05W.WS-CHK-BWE-DD;

//                H3-UIB-BNFT-DTLS.BNFT-WK-END-DT = CIN05W.WS-DB-DATE;

//            end

//            H3-UIB-BNFT-DTLS.ACH-TRACE-NMB = CIN05W.WS-ACH-TRACE-NMB;

//            H3-UIB-BNFT-DTLS.CHECK-NMB = CIN05W.WS-CHECK-NMB;

//            /* WI 2632 - start */

//            if(CIN05W.WS-CHK-CLM-BEG-DT == "99999999")

//                H3-UIB-BNFT-DTLS.CLM-BEG-DT = "9999-12-31";

//            else

//                CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-CLM-BEG-CCYY;

//                CIN05W.WS-DB-FILL1 = "-";

//                CIN05W.WS-DB-MM = CIN05W.WS-CHK-CLM-BEG-MM;

//                CIN05W.WS-DB-FILL2 = "-";

//                CIN05W.WS-DB-DD = CIN05W.WS-CHK-CLM-BEG-DD;

//                H3-UIB-BNFT-DTLS.CLM-BEG-DT = CIN05W.WS-DB-DATE;

//            end

//            /* WI 2632 - end */

//            /* WI 4063 - start */

//            H3-UIB-BNFT-DTLS.UIB-CLM-NMB = CIN05W.WS-CHK-CLM-ID;

//            if (CIN05W.WS-CHK-UI-BYE-DT == "00000000" ||

//                CIN05W.WS-CHK-UI-BYE-DT == "99999999")

//                H3-UIB-BNFT-DTLS.CLM-END-DT = "0001-01-01";

//                CIN05W.WS-CLM-END-DT = "0001-01-01";

//            else

//                CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-BYE-CCYY;

//                CIN05W.WS-DB-FILL1 = "-";

//                CIN05W.WS-DB-MM = CIN05W.WS-CHK-BYE-MM;

//                CIN05W.WS-DB-FILL2 = "-";

//                CIN05W.WS-DB-DD = CIN05W.WS-CHK-BYE-DD;

//                H3-UIB-BNFT-DTLS.CLM-END-DT = CIN05W.WS-DB-DATE;

//                CIN05W.WS-CLM-END-DT = CIN05W.WS-DB-DATE;

//            end

//            /* WI 4063 - end */

//            /*  */

//            CIN05P9-UBD-I01();

//            /*  */

//            if(VDBCONTROL.URC > 104)

//                WCM00P2-TO-CEP01A();

//            end

// //       end

//        if(VDBCONTROL.URC == 0)

//            CIN05W.WS-OLD-CHECK-STATUS = H3-UIB-BNFT-DTLS.CHECK-STS;

//            if(CIN05W.WS-OLD-CHECK-STS == "1" || CIN05W.WS-OLD-CHECK-STS ==

//                            "3")

//            /* SKIP THESE RECORDS, DO NOT UPDATE*/

//            else

//                if(CIN05W.WS-OLD-CHECK-STS == "0" || CIN05W.WS-OLD-CHECK-STS ==

//                                "2")

//                    if(CIN05W.WS-OLD-CHECK-STS != CIN05W.WS-CHK-STS)

//                        if(CIN05W.WS-CHK-CS-AMT != H3-UIB-BNFT-DTLS.CSI-AMT ||

//                                CIN05W.WS-CHK-PD-AMT !=

//                                        H3-UIB-BNFT-DTLS.ISSUD-BNFT-AMT ||

//                                CIN05W.WS-CHK-UI-CLM-STS !=

//                                        H3-UIB-BNFT-DTLS.UIB-APPL-STS ||

//                                CIN05W.WS-CHK-ERN-AMT !=

//                                        H3-UIB-BNFT-DTLS.ERN-AMT ||

//                                CIN05W.WS-CHK-NON-FRD-AMT !=

//                                        H3-UIB-BNFT-DTLS.NON-FRD-OFST-AMT ||

//                                CIN05W.WS-CHK-FRD-AMT !=

//                                        H3-UIB-BNFT-DTLS.FRD-OFST-AMT ||

//                                CIN05W.WS-CHK-CHK-STS !=

//                                        H3-UIB-BNFT-DTLS.CHECK-STS

//                                /* WI 2632 - start */

//                                || CIN05W.WS-CHK-CLM-BEG-DT != H3-UIB-BNFT-DTLS.CLM-BEG-DT)

//                                /* WI 2632 - end */

//                            H3-UIB-BNFT-DTLS.CSI-AMT = CIN05W.WS-CHK-CS-AMT;

//                            H3-UIB-BNFT-DTLS.ISSUD-BNFT-AMT = CIN05W.WS-CHK-PD-AMT;

//                            H3-UIB-BNFT-DTLS.UIB-APPL-STS = CIN05W.WS-CHK-UI-CLM-STS;

//                            H3-UIB-BNFT-DTLS.ERN-AMT = CIN05W.WS-CHK-ERN-AMT;

//                            H3-UIB-BNFT-DTLS.NON-FRD-OFST-AMT = CIN05W.WS-CHK-NON-FRD-AMT;

//                            H3-UIB-BNFT-DTLS.FRD-OFST-AMT = CIN05W.WS-CHK-FRD-AMT;

//                            H3-UIB-BNFT-DTLS.CHECK-STS = CIN05W.WS-CHK-CHK-STS;

//                            H3-UIB-BNFT-DTLS.CHECK-NMB = CIN05W.WS-CHECK-NMB;

//                            H3-UIB-BNFT-DTLS.ACH-TRACE-NMB = CIN05W.WS-ACH-TRACE-NMB;

//                            /* WI 2632 - start */

//                            if (CIN05W.WS-CHK-CLM-BEG-DT == "99999999")

//                            	H3-UIB-BNFT-DTLS.CLM-BEG-DT = "9999-12-31";

//                            else

//                            	if (CIN05W.WS-CHK-CLM-BEG-DT == "00000000" ||

//                            	    CIN05W.WS-CHK-CLM-BEG-DT == "00010101")

//                            	    H3-UIB-BNFT-DTLS.CLM-BEG-DT = "0001-01-01";

//                            	else

//                            		CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-CLM-BEG-CCYY;

//                            		CIN05W.WS-DB-FILL1 = "-";

//                            		CIN05W.WS-DB-MM = CIN05W.WS-CHK-CLM-BEG-MM;

//                            		CIN05W.WS-DB-FILL2 = "-";

//                            		CIN05W.WS-DB-DD = CIN05W.WS-CHK-CLM-BEG-DD;

//                            		H3-UIB-BNFT-DTLS.CLM-BEG-DT = CIN05W.WS-DB-DATE;

//                            	end

//                            end

//                            /* WI 2632 - end */    

//                            /*  */

//                            CIN05P9-UBD-U02();

//                            /*  */

//                            if(VDBCONTROL.URC > 104)

//                                WCM00P2-TO-CEP01A();

//                            end

//                        end

//                    end

//                end

//            end

//        end

////    end



    if (VDBCONTROL.URC == 0)

    	CIN05P9-UPDATE-BENEFIT();

    else

    	if (VDBCONTROL.URC == 100)

    		CIN05P9-INSERT-BENEFIT();

    	end

    end

    /* WI 4063 - end */

    

    if(CIN05W.WS-CURRENT-SSN == CIN05W.WS-OLD-SSN)

        if(H2-UIB-BNFT-DTLS.BNFT-WK-END-DT > CIN05W.WS-PREV-BENE-WK-END-DT)

            CIN05W.WS-PREV-BENE-WK-END-DT = H2-UIB-BNFT-DTLS.BNFT-WK-END-DT;

        end

    end

    if(CIN05W.WS-CURRENT-SSN != CIN05W.WS-OLD-SSN)

        H2-UIB-BNFT-DTLS.UIB-APPL-STS = CIN05W.WS-CHK-UI-CLM-STS;

        H2-UIB-DTLS.UPI = CIN05W.WS-UPI;

        H2-UIB-DTLS.CLM-END-DT = CIN05W.WS-CLM-END-DT;

        /* WI 2632 - 05-2015 - add clm-beg-dt */

        H2-UIB-DTLS.CLM-BEG-DT = CIN05W.WS-CLM-BEG-DT;

        /* WI 2632 - end */

        /*  */

        CIN05P9-UIB-U03();

        /*  */

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    end



    if(CIN05W3.PI1-ALERT == "NOALERT" && CIN05W3.PI1-ALERT-FLAG == "N")

        /*  */

        CIN05P9-VR-UNIN-PR();

    end

end // end CIN05P9-CHECK()





/* WI 4063 - Start */

function CIN05P9-UPDATE-BENEFIT()

	if (CIN05W.WS-CHK-PD-AMT != H2-UIB-BNFT-DTLS.ISSUD-BNFT-AMT &&

	     CIN05W.WS-CHK-FED-PYMT-TYPE != H2-UIB-BNFT-DTLS.FED-PYMT-TYPE)

	     CIN05P9-INSERT-BENEFIT();

	else

		 /* Proj 21-BUG FIX - Start */

		 CIN05W.WS-DB-DATE = H2-UIB-BNFT-DTLS.CLM-BEG-DT;

		 CIN05W.WS-CCYY = CIN05W.WS-DB-CCYY;

		 CIN05W.WS-MM = CIN05W.WS-DB-MM;

		 CIN05W.WS-DD = CIN05W.WS-DB-DD;

		 /* Proj 21-BUG FIX - end */	    	

         if(CIN05W.WS-CHK-CS-AMT              != H2-UIB-BNFT-DTLS.CSI-AMT ||

             (CIN05W.WS-CHK-PD-AMT            != H2-UIB-BNFT-DTLS.ISSUD-BNFT-AMT &&

                  CIN05W.WS-CHK-FED-PYMT-TYPE == H2-UIB-BNFT-DTLS.FED-PYMT-TYPE) ||

              CIN05W.WS-CHK-UI-CLM-STS        != H2-UIB-BNFT-DTLS.UIB-APPL-STS ||

              CIN05W.WS-CHK-ERN-AMT           != H2-UIB-BNFT-DTLS.ERN-AMT ||

              CIN05W.WS-CHK-NON-FRD-AMT       != H2-UIB-BNFT-DTLS.NON-FRD-OFST-AMT ||

              CIN05W.WS-CHK-FRD-AMT           != H2-UIB-BNFT-DTLS.FRD-OFST-AMT ||

//              CIN05W.WS-CHK-CLM-BEG-DT != H2-UIB-BNFT-DTLS.CLM-BEG-DT)

              CIN05W.WS-CHK-CLM-BEG-DT        != CIN05W.WS-DATE)

                  H2-UIB-BNFT-DTLS.CSI-AMT = CIN05W.WS-CHK-CS-AMT;

                  H2-UIB-BNFT-DTLS.ISSUD-BNFT-AMT = CIN05W.WS-CHK-PD-AMT;

                  H2-UIB-BNFT-DTLS.UIB-APPL-STS = CIN05W.WS-CHK-UI-CLM-STS;

                  H2-UIB-BNFT-DTLS.ERN-AMT = CIN05W.WS-CHK-ERN-AMT;

                  H2-UIB-BNFT-DTLS.NON-FRD-OFST-AMT = CIN05W.WS-CHK-NON-FRD-AMT;

                  H2-UIB-BNFT-DTLS.FRD-OFST-AMT = CIN05W.WS-CHK-FRD-AMT;

                  H2-UIB-BNFT-DTLS.CHECK-STS = CIN05W.WS-CHK-CHK-STS;

                  H2-UIB-BNFT-DTLS.CHECK-NMB = CIN05W.WS-CHECK-NMB;

                  H2-UIB-BNFT-DTLS.ACH-TRACE-NMB = CIN05W.WS-ACH-TRACE-NMB;

                  CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-CLM-BEG-CCYY;

                  CIN05W.WS-DB-FILL1 = "-";

                  CIN05W.WS-DB-MM = CIN05W.WS-CHK-CLM-BEG-MM;

                  CIN05W.WS-DB-FILL2 = "-";

                  CIN05W.WS-DB-DD = CIN05W.WS-CHK-CLM-BEG-DD;

                  H2-UIB-BNFT-DTLS.CLM-BEG-DT = CIN05W.WS-DB-DATE;

                  CIN05W.WS-ELIG-AMT-1-3 = CIN05W.WS-CHK-WBA;

                  WS-ELIG-AMT-4 = 0;

                  WS-ELIG-AMT-5 = 0;

                  H2-UIB-BNFT-DTLS.WK-BNFT-AMT = CIN05W.WS-ELIG-AMT;

                  H2-UIB-BNFT-DTLS.INCM-WITHLD-AMT = CIN05W.WS-CHK-INCM-WITHLD-AMT;

                  H2-UIB-BNFT-DTLS.UIB-CLM-NMB = CIN05W.WS-CHK-CLM-ID;

                  /*  */

                  CIN05P9-UBD-U01();

                  /*  */

                  if(VDBCONTROL.URC > 104)

                      WCM00P2-TO-CEP01A();

                  end

         end  

     end	

end // end CIN05P9-UPDATE-BENEFIT





function CIN05P9-INSERT-BENEFIT()

//    CIN05W.WS-FPUC-IND = CIN05W.WS-CHK-FED-PYMT-TYPE;

    

    set H3-UIB-BNFT-DTLS empty;

    H3-UIB-BNFT-DTLS.RCPT-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    H3-UIB-BNFT-DTLS.APPL-BNFT-RECD-DT = H2-UIB-DTLS.CHK-DT;

    H3-UIB-BNFT-DTLS.CSI-AMT = CIN05W.WS-CHK-CS-AMT;

    H3-UIB-BNFT-DTLS.ISSUD-BNFT-AMT = CIN05W.WS-CHK-PD-AMT;

    H3-UIB-BNFT-DTLS.UIB-APPL-STS = CIN05W.WS-CHK-UI-CLM-STS;

    H3-UIB-BNFT-DTLS.ERN-AMT = CIN05W.WS-CHK-ERN-AMT;

    H3-UIB-BNFT-DTLS.NON-FRD-OFST-AMT = CIN05W.WS-CHK-NON-FRD-AMT;

    H3-UIB-BNFT-DTLS.FRD-OFST-AMT = CIN05W.WS-CHK-FRD-AMT;

    H3-UIB-BNFT-DTLS.CHECK-STS = CIN05W.WS-CHK-CHK-STS;

    /*  */

    call "DATEAPP"(GDW, VDBCONTROL, VMESSAGE){isNoRefresh = yes};

    /*  */

    CIN05W1.WS-CRTD-TS = GDW.TS;

    CIN05W1.WS-CRTD-DT = CIN05W1.WS-PROCESS-DT;

    H3-UIB-BNFT-DTLS.CRN-TS = CIN05W1.WS-CRTD-TS;

    /*  */

    H3-UIB-BNFT-DTLS.UPI = CIN05W.WS-UPI;

    if(CIN05W.WS-CHK-BNFT-WK-END-DT == "99999999")

        H3-UIB-BNFT-DTLS.BNFT-WK-END-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-BWE-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-CHK-BWE-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-CHK-BWE-DD;

        H3-UIB-BNFT-DTLS.BNFT-WK-END-DT = CIN05W.WS-DB-DATE;

    end

    H3-UIB-BNFT-DTLS.ACH-TRACE-NMB = CIN05W.WS-ACH-TRACE-NMB;

    H3-UIB-BNFT-DTLS.CHECK-NMB = CIN05W.WS-CHECK-NMB;

    /* WI 2632 - start */

    if(CIN05W.WS-CHK-CLM-BEG-DT == "99999999")

        H3-UIB-BNFT-DTLS.CLM-BEG-DT = "9999-12-31";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-CLM-BEG-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-CHK-CLM-BEG-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-CHK-CLM-BEG-DD;

        H3-UIB-BNFT-DTLS.CLM-BEG-DT = CIN05W.WS-DB-DATE;

    end

    /* WI 2632 - end */

    /* WI 4063 - start */

    H3-UIB-BNFT-DTLS.UIB-CLM-NMB = CIN05W.WS-CHK-CLM-ID;

    if (CIN05W.WS-CHK-UI-BYE-DT == "00000000" ||

        CIN05W.WS-CHK-UI-BYE-DT == "99999999")

        H3-UIB-BNFT-DTLS.CLM-END-DT = "0001-01-01";

        CIN05W.WS-CLM-END-DT = "0001-01-01";

    else

        CIN05W.WS-DB-CCYY = CIN05W.WS-CHK-BYE-CCYY;

        CIN05W.WS-DB-FILL1 = "-";

        CIN05W.WS-DB-MM = CIN05W.WS-CHK-BYE-MM;

        CIN05W.WS-DB-FILL2 = "-";

        CIN05W.WS-DB-DD = CIN05W.WS-CHK-BYE-DD;

            H3-UIB-BNFT-DTLS.CLM-END-DT = CIN05W.WS-DB-DATE;

            CIN05W.WS-CLM-END-DT = CIN05W.WS-DB-DATE;

    end

    CIN05W.WS-ELIG-AMT-1-3 = CIN05W.WS-CHK-WBA;

    WS-ELIG-AMT-4 = 0;

    WS-ELIG-AMT-5 = 0;

    H3-UIB-BNFT-DTLS.WK-BNFT-AMT = CIN05W.WS-ELIG-AMT;

    H3-UIB-BNFT-DTLS.INCM-WITHLD-AMT = CIN05W.WS-CHK-INCM-WITHLD-AMT;

    H3-UIB-BNFT-DTLS.FED-PYMT-TYPE = CIN05W.WS-CHK-FED-PYMT-TYPE;

    /* WI 4063 - end */

    /*  */

    CIN05P9-UBD-I01();

    /*  */

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

end // end CIN05P9-INSERT-BENEFIT

/* WI 4063 - end */



function CIN05P9-UIB-D01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H3-UIB-DTLS";

    VDBCONTROL.UPROC-OPT = "DELETE";

    VDBCONTROL.UPROC-NM = "CIN05P9-UIB-D01";

    VDBCOMMON.USQLREC = "H3-UIB-DTLS";

    /* WI 4063 - changes made to query to include claim number

                 and all other columns not coming from 1 rec*/

    /*  */

    try

      execute delete

        #sql{

          delete from TWNUIB_DTLS T1

            --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

            WHERE T1.UPI          = :UPI

            AND  (T1.CLM_BEG_DT   = '0001-01-01' OR

                  T1.CLM_BEG_DT   = :CLM-BEG-DT)

            AND   T1.CLM_END_DT   = :CLM-END-DT

            AND   T1.INTRFC_SSN   = :INTRFC-SSN

            AND  (T1.UIB_CLM_NMB  = '          ' OR

                  T1.UIB_CLM_NMB  = :UIB-CLM-NMB) 

             --** INSERT ORDER BY CLAUSE HERE **

        }

        for H4-UIB-DTLS;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end



// end CIN05P9-UIB-D01



function CIN05P9-UIB-S01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H3-UIB-DTLS";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-UIB-S01";

    VDBCOMMON.USQLREC = "H3-UIB-DTLS";

    /*  */

    try

        get H3-UIB-DTLS singleRow

                with #sql{

        select EMPL_ADLN1,

          EMPL_ADLN2,

          CTY,

          ST_CD,

          ZIP_CD

        from TWNUIB_DTLS T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE T1.UPI          = :UPI

        AND  (T1.CLM_BEG_DT   = '0001-01-01' OR

              T1.CLM_BEG_DT   = :CLM-BEG-DT)

        AND   T1.CLM_END_DT   = :CLM-END-DT

        AND   T1.INTRFC_SSN   = :INTRFC-SSN

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into EMPL-ADLN1, EMPL-ADLN2, CTY, ST-CD, ZIP-CD;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end



// end CIN05P9-UIB-S01



// Get latest UIB addr info



function CIN05P9-UIB-S02()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H3-UIB-DTLS";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-UIB-S02";

    VDBCOMMON.USQLREC = "H3-UIB-DTLS";

    /*  */

    /* WI2632 - 5/2015 - add clm_beg_dt */

    try

        get H3-UIB-DTLS

                with #sql{

        select CLM_BEG_DT

        from TWNUIB_DTLS T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE T1.UPI = :UPI

        AND   T1.CLM_END_DT = :CLM-END-DT

        AND   T1.CLM_BEG_DT = :CLM-BEG-DT

        AND   T1.INTRFC_SSN = :INTRFC-SSN

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into CLM-BEG-DT;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end



// end CIN05P9-UIB-S02



function CIN05P9-WAGE()

/* format EMPLR-ID*/

    CIN05W.WS-EMPLR-1-7 = CIN05W.WS-WAGE-EMPLR-1-7;

    CIN05W.WS-EMPLR-HYPH = "-";

    CIN05W.WS-EMPLR-8-9 = CIN05W.WS-WAGE-EMPLR-8-9;

    /* format FEIN*/

    CIN05W.WS-FEIN-1-2 = CIN05W.WS-WAGE-FEIN-1-2;

    CIN05W.WS-FEIN-HYPH = "-";

    CIN05W.WS-FEIN-3-9 = CIN05W.WS-WAGE-FEIN-3-9;

    /* insert/update TWNEMPLOYER*/

    set H2-EMPLOYER empty;

    H2-EMPLOYER.EMPLR-ID = CIN05W.WS-EMPLR-ID;

    H2-EMPLOYER.LST-CHNGD-DT = CIN05W1.WS-PROCESS-DT;

    H2-EMPLOYER.EMPLR-NM = CIN05W.WS-WAGE-EMPLR-NM;

    H2-EMPLOYER.DOING-BUS-AS-NM = CIN05W.WS-WAGE-DBA-NM;

    H2-EMPLOYER.ADR-LN1 = CIN05W.WS-WAGE-EMPLR-ADLN;

    H2-EMPLOYER.CITY = CIN05W.WS-WAGE-EMPLR-CITY;

    H2-EMPLOYER.ST-CD = CIN05W.WS-WAGE-EMPLR-ST;

    H2-EMPLOYER.ZIP-CD = CIN05W.WS-WAGE-EMPLR-ZIP-CD;

    H2-EMPLOYER.FEIN = CIN05W.WS-FEIN;

    /* select by emplr-id*/

    H3-EMPLOYER.EMPLR-ID = H2-EMPLOYER.EMPLR-ID;

    CIN05P9-EMP-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(sysVar.sqlData.sqlcode == 0)

        CIN05P9-EMP-U01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    else

        /* select by FEIN as emplr-id*/

        H3-EMPLOYER.EMPLR-ID = H2-EMPLOYER.FEIN;

        CIN05P9-EMP-S01();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

        /* call appl to change existing records from FEIN to emplr-id*/

        if(VDBCONTROL.URC == 0)

            CIN05W2.PO3-CURRENT-DT = CIN05W1.WS-PROCESS-DT;

            CIN05W2.PO3-NEW-ID = H2-EMPLOYER.EMPLR-ID;

            CIN05W2.PO3-OLD-ID = H2-EMPLOYER.FEIN;

            /* WI 1198 begin*/

            /* MOVE 'B' TO CIN05W2.PDLI-ID-INFO;*/

            /* WI 1198 end*/

            call "DLI27A"(VDBCONTROL, VMESSAGE, CIN05W2){isNoRefresh = yes};

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

            CIN05P9-EMP-U01();

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

        else

            H2-EMPLOYER.BTCH-ENTRY-DT = CIN05W1.WS-PROCESS-DT;

            CIN05P9-EMP-I01();

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

        end

    end

    /*  */

    set H2-WAGE-DTLS empty;

    H2-WAGE-DTLS.UPI = CIN05W.WS-UPI;

    H2-WAGE-DTLS.EMPLR-ID = CIN05W.WS-EMPLR-ID;

    H2-WAGE-DTLS.CRTN-DT = CIN05W1.WS-PROCESS-DT;

    H2-WAGE-DTLS.LCTE-SRC = "ESD";

    H2-WAGE-DTLS.INTRFC-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    H2-WAGE-DTLS.WGE-YR = CIN05W.WS-WAGE-CCYY;

    H2-WAGE-DTLS.QRTR = CIN05W.WS-WAGE-QTR;

    H2-WAGE-DTLS.WGE-AMT = CIN05W.WS-WAGE-QTR-ERNGS;

    H2-WAGE-DTLS.EMPL-LST-NM = CIN05W.WS-WAGE-EMPL-LST-NM;

    H2-WAGE-DTLS.EMPL-FRST-NM = CIN05W.WS-WAGE-EMPL-FRST-NM;

    H2-WAGE-DTLS.EMPL-MID-INIT = CIN05W.WS-WAGE-EMPL-MID-INIT;

    /* check for existing active JOB-HISTORY for this UPI, EMPLR-ID*/

    set H2-JOB-HISTORY empty;

    H2-JOB-HISTORY.UPI = CIN05W.WS-UPI;

    H2-JOB-HISTORY.EMPLR-ID = CIN05W.WS-EMPLR-ID;



    /* wi 29485;Cheryl T; 09/28/2007; check for max duplicate record.if one*/

    /* exists and qrtr and year of new is older than dup, don't insert new*/

    /* else insert new record*/

    /* MOVE '9999-12-31' TO H2-JOB-HISTORY.JOB-END-DT;*/

    CIN05P9-JHS-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(sysVar.sqlData.sqlcode == 0)

        if(H2-JOB-HISTORY.VRFD-DT != "9999-12-31")

            CIN05P9-WAGE-JHRF();

        end

    else

        /* if no JOB-HISTORY, insert it*/

        if(sysVar.sqlData.sqlcode == 100)

            CIN05P9-WAGE-JHNRF();

        end

    end

    /* CHERYL T;WI    :Remove all activity on SWICA tables*/

    /* insert/update TWNSWICA-EMPLR-DTL*/

    /* PERFORM CIN05P9-WAGE-SWICA;*/



    /* Format Quarter begin and end dates*/

    CIN05W.WS-DB-CCYY = CIN05W.WS-WAGE-CCYY;

    CIN05W.WS-DB-FILL1 = "-";

    CIN05W.WS-DB-FILL2 = "-";

    /* Begin-date*/

    CIN05W.WS-DB-DD = "01";

    if(CIN05W.WS-WAGE-QTR == 1)

        CIN05W.WS-DB-MM = "01";

    else

        if(CIN05W.WS-WAGE-QTR == 2)

            CIN05W.WS-DB-MM = "03";

        else

            if(CIN05W.WS-WAGE-QTR == 3)

                CIN05W.WS-DB-MM = "06";

            else

                CIN05W.WS-DB-MM = "09";

            end

        end

    end

    CIN05W.WS-PRD-BEG-DT = CIN05W.WS-DB-DATE;

    /* End-date*/

    if(CIN05W.WS-WAGE-QTR == 1)

        CIN05W.WS-DB-MM = "03";

        CIN05W.WS-DB-DD = "31";

    else

        if(CIN05W.WS-WAGE-QTR == 2)

            CIN05W.WS-DB-MM = "06";

            CIN05W.WS-DB-DD = "30";

        else

            if(CIN05W.WS-WAGE-QTR == 3)

                CIN05W.WS-DB-MM = "09";

                CIN05W.WS-DB-DD = "30";

            else

                CIN05W.WS-DB-MM = "12";

                CIN05W.WS-DB-DD = "31";

            end

        end

    end

    CIN05W.WS-PRD-END-DT = CIN05W.WS-DB-DATE;



    /* Get factors*/

    CIN05P9-GET-FCTRS();



    CIN05W.WS-UPD-JINC = "T";



    while(CIN05W.WS-PRD-BEG-MM <= CIN05W.WS-PRD-END-MM)

        CIN05P9-GT-JID-DTA();

        CIN05W.WS-PRD-BEG-MM = CIN05W.WS-PRD-BEG-MM + 1;

    end



    if(CIN05W.WS-PAY-REC-CNT == 0)

        CIN05W.WS-ALERT-FG = "T";

    else

        /* if record found in WNJOB_INCM_DTLS and TWNPAY_DTLS, calculate*/

        /* the difference between amount reported by ESD and the amount*/

        /* reported by the client.*/



        CIN05W.WS-JINC-TOLERANCE-AMT = CIN05W.WS-JINC-AMT *(

                CIN05W.WS-PERCENT-FCTR / 100);



        CIN05W.WS-AMT1 =(CIN05W.WS-WAGE-QTR-ERNGS - CIN05W.WS-JINC-AMT);

        CIN05W.WS-AMT2 =(CIN05W.WS-JINC-AMT - CIN05W.WS-WAGE-QTR-ERNGS);



        if(CIN05W.WS-AMT1 > CIN05W.WS-JINC-TOLERANCE-AMT || CIN05W.WS-AMT2 >

                        CIN05W.WS-JINC-TOLERANCE-AMT)

            /* create an alert*/

            CIN05W.WS-ALERT-FG = "T";

        end

    end

end // end CIN05W3