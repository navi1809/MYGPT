 if (AME37W.WS-PAMRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAMRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAMRC = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAMRC = "     0";
  end

  if (AME37W.WS-NAMRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAMRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAMRC = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAMRC = "     0";
  end

  if (AME37W.WS-SUBTOTMRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTMRC;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTMRC = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTMRC = "      0";
  end

  if (AME37W.WS-DMI0 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMI0;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI0 = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMI0 = "     0";
  end

  if (AME37W.WS-DMI1 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMI1;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI1 = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMI1 = "     0";
  end

  if (AME37W.WS-DMI2 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMI2;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI2 = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMI2 = "     0";
  end

  if (AME37W.WS-DMI3 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMI3;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI3 = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMI3 = "     0";
  end

  if (AME37W.WS-DMI4 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMI4;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI4 = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMI4 = "     0";
  end

  if (AME37W.WS-DMI5 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMI5;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI5 = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMI5 = "     0";
  end

  if (AME37W.WS-DMI6 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMI6;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI6 = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMI6 = "     0";
  end

  if (AME37W.WS-DMIEBT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-DMIEBT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMIEBT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-DMIEBT = "     0";
  end

  /* cbsi end*/
end // end AME37P9-POP-OFDET


// POPULATING REPORTS STATE DTLS
Function AME37P9-POP-STDET()
  /* move state-totals to report variables*/

  if (AME37W1.WS-ST-PACASES != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PACASES;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PACASES = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PACASES = "     0";
  end

  if (AME37W1.WS-ST-NACASES != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NACASES;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NACASES = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NACASES = "     0";
  end

  if (AME37W1.WS-ST-GRNDTOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-GRNDTOT;
    FORMATW.LENGTH = 9;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNDTOT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-GRNDTOT = "        0";
  end

  if (AME37W1.WS-ST-PAEXPCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAEXPCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAEXPCASE = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAEXPCASE = "     0";
  end

  if (AME37W1.WS-ST-NAEXPCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAEXPCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAEXPCASE = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAEXPCASE = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTEX != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTEX;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTEX = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTEX = "      0";
  end


  if (AME37W1.WS-ST-PADAMS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PADAMS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PADAMS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PADAMS = "     0";
  end

  if (AME37W1.WS-ST-NADAMS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NADAMS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NADAMS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NADAMS = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTDM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTDM;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTDM = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTDM = "      0";
  end

  if (AME37W1.WS-ST-PASPHNDL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PASPHNDL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PASPHNDL = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PASPHNDL = "     0";
  end

  if (AME37W1.WS-ST-NASPHNDL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NASPHNDL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NASPHNDL = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NASPHNDL = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTSP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTSP;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTSP = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTSP = "      0";
  end

  if (AME37W1.WS-ST-PAEBTCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAEBTCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAEBTCASE = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PASPHNDL = "     0";
  end

  if (AME37W1.WS-ST-NAEBTCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAEBTCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAEBTCASE = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NASPHNDL = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTEBT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTEBT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTEBT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTSP = "      0";
  end

  if (AME37W1.WS-ST-PALMISS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PALMISS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PALMISS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PALMISS = "     0";
  end

  if (AME37W1.WS-ST-NALMISS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NALMISS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NALMISS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NALMISS = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTIS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTIS;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTIS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTIS = "      0";
  end

  if (AME37W1.WS-ST-PAREVISED != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAREVISED;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAREVISED = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAREVISED = "     0";
  end

  if (AME37W1.WS-ST-NAREVISED != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAREVISED;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAREVISED = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAREVISED = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTREV != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTREV;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTREV = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTREV = "      0";
  end

  if (AME37W1.WS-ST-PARETRO != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PARETRO;
    FORMATW.LENGTH = 5;
    FORMATW.DEC-COUNT = 1;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PARETRO = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PARETRO = "  0.0";
  end

  AME37W-DET.C-1 = "%";

  if (AME37W1.WS-ST-NARETRO != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NARETRO;
    FORMATW.LENGTH = 5;
    FORMATW.DEC-COUNT = 1;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NARETRO = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NARETRO = "  0.0";
  end

  AME37W-DET.C-2 = "%";

  if (AME37W1.WS-ST-SUBTOTRET != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTRET;
    FORMATW.LENGTH = 5;
    FORMATW.DEC-COUNT = 1;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTRET = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTRET = "  0.0";
  end

  AME37W-DET.C-3 = "%";

  if (AME37W1.WS-ST-PAEST != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAEST;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAEST = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAEST = "     0";
  end

  if (AME37W1.WS-ST-NAEST != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAEST;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAEST = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAEST = "     0";
  end

  if (AME37W1.WS-ST-GRNDTOTES != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-GRNDTOTES;
    FORMATW.LENGTH = 9;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNDTOTES = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-GRNDTOTES = "        0";
  end

  if (AME37W1.WS-ST-PABNFT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PABNFT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PABNFT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PABNFT = "     0";
  end

  if (AME37W1.WS-ST-NABNFT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NABNFT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NABNFT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NABNFT = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTBN != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTBN;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTBN = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTBN = "      0";
  end

  if (AME37W1.WS-ST-PAPART != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAPART;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAPART = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAPART = "     0";
  end

  if (AME37W1.WS-ST-NAPART != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAPART;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAPART = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAPART = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTPRT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTPRT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTPRT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTPRT = "      0";
  end

  if (AME37W1.WS-ST-PAAPPRV != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAAPPRV;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPRV = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAAPPRV = "     0";
  end

  if (AME37W1.WS-ST-NAAPPRV != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAAPPRV;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPRV = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAAPPRV = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTAP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTAP;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTAP = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTAP = "      0";
  end

  if (AME37W1.WS-ST-PAWTDR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAWTDR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAWTDR = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAWTDR = "     0";
  end

  if (AME37W1.WS-ST-NAWTDR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAWTDR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAWTDR = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAWTDR = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTWD != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTWD;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTWD = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTWD = "      0";
  end

  if (AME37W1.WS-ST-PADENY != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PADENY;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PADENY = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PADENY = "     0";
  end

  if (AME37W1.WS-ST-NADENY != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NADENY;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NADENY = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NADENY = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTDNY != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTDNY;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTDNY = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTDNY = "      0";
  end

  if (AME37W1.WS-ST-PANCOOP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PANCOOP;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PANCOOP = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PANCOOP = "     0";
  end

  if (AME37W1.WS-ST-NANCOOP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NANCOOP;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NANCOOP = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NANCOOP = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTNC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTNC;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTNC = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTNC = "      0";
  end

  if (AME37W1.WS-ST-PAQUIT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAQUIT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAQUIT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAQUIT = "     0";
  end

  if (AME37W1.WS-ST-NAQUIT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAQUIT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAQUIT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAQUIT = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTQT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTQT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTQT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTQT = "      0";
  end

  if (AME37W1.WS-ST-PARSRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PARSRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PARSRC = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PARSRC = "     0";
  end

  if (AME37W1.WS-ST-NARSRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NARSRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NARSRC = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NARSRC = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTRC;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTRC = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTRC = "      0";
  end

  if (AME37W1.WS-ST-PAOTHR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAOTHR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAOTHR = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAOTHR = "     0";
  end

  if (AME37W1.WS-ST-NAOTHR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAOTHR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAOTHR = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAOTHR = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTOTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTOTH;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTOTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTOTH = "      0";
  end

  if (AME37W1.WS-ST-PATOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PATOT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PATOT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PATOT = "     0";
  end

  if (AME37W1.WS-ST-NATOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NATOT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NATOT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NATOT = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTTOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTTOT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTTOT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTTOT = "      0";
  end

  if (AME37W1.WS-ST-PAAPPL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAAPPL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPL = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAAPPL = "     0";
  end

  if (AME37W1.WS-ST-NAAPPL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAAPPL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPL = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAAPPL = "     0";
  end

  /* Changes due to WI 16330 Begin -----------------------*/
  if (AME37W1.WS-ST-GRNTOTAPP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-GRNTOTAPP;
    FORMATW.LENGTH = 9;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNTOTAPP = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-GRNTOTAPP = "        0";
  end

  /* Changes due to WI 16330 End   -----------------------*/

  if (AME37W1.WS-ST-PANEW != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PANEW;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PANEW = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PANEW = "     0";
  end

  if (AME37W1.WS-ST-NANEW != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NANEW;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NANEW = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NANEW = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTNEW != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTNEW;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTNEW = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTNEW = "      0";
  end

  if (AME37W1.WS-ST-PASUBS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PASUBS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PASUBS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PASUBS = "     0";
  end

  if (AME37W1.WS-ST-NASUBS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NASUBS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NASUBS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NASUBS = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTSUBS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTSUBS;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTSUBS = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTSUBS = "      0";
  end

  /* Added for WI 15820*/
  if (AME37W1.WS-ST-PAPNDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAPNDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAPNDMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAPNDMTH = "     0";
  end

  if (AME37W1.WS-ST-NAPNDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAPNDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAPNDMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAPNDMTH = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTPNDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTPNDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTPNDMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTPNDMTH = "     0";
  end

  if (AME37W1.WS-ST-PAAPPRVMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAAPPRVMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPRVMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAAPPRVMTH = "     0";
  end

  if (AME37W1.WS-ST-NAAPPRVMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAAPPRVMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPRVMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAAPPRVMTH = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTAPMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTAPMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTAPMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTAPMTH = "     0";
  end


  if (AME37W1.WS-ST-PADNYWDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PADNYWDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PADNYWDMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PADNYWDMTH = "     0";
  end

  if (AME37W1.WS-ST-NADNYWDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NADNYWDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NADNYWDMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NADNYWDMTH = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTDNYWD != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTDNYWD;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTDNYWD = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTDNYWD = "     0";
  end

  if (AME37W1.WS-ST-PAAPPLMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAAPPLMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPLMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAAPPLMTH = "     0";
  end

  if (AME37W1.WS-ST-NAAPPLMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAAPPLMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPLMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAAPPLMTH = "     0";
  end

  if (AME37W1.WS-ST-GRNTOTAPPMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-GRNTOTAPPMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNTOTAPPMTH = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-GRNTOTAPPMTH = "     0";
  end

  /* End of WI 15820*/


  if (AME37W1.WS-ST-PATERM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PATERM;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PATERM = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PATERM = "     0";
  end

  if (AME37W1.WS-ST-NATERM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NATERM;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NATERM = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NATERM = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTTRM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTTRM;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTTRM = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTTRM = "      0";
  end

  /* IF AME37W1.WS-ST-PAUPD NE 0;*/
  /* SET FORMATW EMPTY;*/
  /* MOVE AME37W1.WS-ST-PAUPD TO FORMATW.INPUT-NUMBER;*/
  /* MOVE 6 TO FORMATW.LENGTH;*/
  /* MOVE 'Y' TO FORMATW.FORMAT-FLAG;*/
  /* MOVE 'N' TO FORMATW.DOLLAR-FLAG;*/
  /* PERFORM REPP9-FORMAT-PROC;*/
  /* MOVE FORMATW.OUTPUT-CHAR TO AME37W-DET.S-PAUPD;*/
  /* ELSE;*/
  /* MOVE '     0' TO AME37W-DET.S-PAUPD;*/
  /* END;*/

  /* IF AME37W1.WS-ST-NAUPD NE 0;*/
  /* SET FORMATW EMPTY;*/
  /* MOVE AME37W1.WS-ST-NAUPD TO FORMATW.INPUT-NUMBER;*/
  /* MOVE 6 TO FORMATW.LENGTH;*/
  /* MOVE 'Y' TO FORMATW.FORMAT-FLAG;*/
  /* MOVE 'N' TO FORMATW.DOLLAR-FLAG;*/
  /* PERFORM REPP9-FORMAT-PROC;*/
  /* MOVE FORMATW.OUTPUT-CHAR TO AME37W-DET.S-NAUPD;*/
  /* ELSE;*/
  /* MOVE '     0' TO AME37W-DET.S-NAUPD;*/
  /* END;*/

  /* AME37W1.WS-ST-SUBTOTUP = AME37W1.WS-ST-PAUPD + AME37W1.WS-ST-NAUPD;*/
  /*  */
  /* IF AME37W1.WS-ST-SUBTOTUP NE 0;*/
  /* SET FORMATW EMPTY;*/
  /* MOVE AME37W1.WS-ST-SUBTOTUP TO FORMATW.INPUT-NUMBER;*/
  /* MOVE 7 TO FORMATW.LENGTH;*/
  /* MOVE 'Y' TO FORMATW.FORMAT-FLAG;*/
  /* MOVE 'N' TO FORMATW.DOLLAR-FLAG;*/
  /* PERFORM REPP9-FORMAT-PROC;*/
  /* MOVE FORMATW.OUTPUT-CHAR TO AME37W-DET.S-SUBTOTUP;*/
  /* ELSE;*/
  /* MOVE '      0' TO AME37W-DET.S-SUBTOTUP;*/
  /* END;*/

  /* AME37W1.WS-ST-PAACTNS = AME37W1.WS-ST-PATERM + AME37W1.WS-ST-PAUPD;*/
  /* AME37W1.WS-ST-NAACTNS = AME37W1.WS-ST-NATERM + AME37W1.WS-ST-NAUPD;*/
  /* AME37W1.WS-ST-GRNDTOT = AME37W1.WS-ST-PAACTNS + AME37W1.WS-ST-NAACTNS;*/

  /* IF AME37W1.WS-ST-PAACTNS NE 0;*/
  /* SET FORMATW EMPTY;*/
  /* MOVE AME37W1.WS-ST-PAACTNS TO FORMATW.INPUT-NUMBER;*/
  /* MOVE 6 TO FORMATW.LENGTH;*/
  /* MOVE 'Y' TO FORMATW.FORMAT-FLAG;*/
  /* MOVE 'N' TO FORMATW.DOLLAR-FLAG;*/
  /* PERFORM REPP9-FORMAT-PROC;*/
  /* MOVE FORMATW.OUTPUT-CHAR TO AME37W-DET.S-PAACTNS;*/
  /* ELSE;*/
  /* MOVE '     0' TO AME37W-DET.S-PAACTNS;*/
  /* END;*/

  /* IF AME37W1.WS-ST-NAACTNS NE 0;*/
  /* SET FORMATW EMPTY;*/
  /* MOVE AME37W1.WS-ST-NAACTNS TO FORMATW.INPUT-NUMBER;*/
  /* MOVE 6 TO FORMATW.LENGTH;*/
  /* MOVE 'Y' TO FORMATW.FORMAT-FLAG;*/
  /* MOVE 'N' TO FORMATW.DOLLAR-FLAG;*/
  /* PERFORM REPP9-FORMAT-PROC;*/
  /* MOVE FORMATW.OUTPUT-CHAR TO AME37W-DET.S-NAACTNS;*/
  /* ELSE;*/
  /* MOVE '     0' TO AME37W-DET.S-NAACTNS;*/
  /* END;*/

  /* IF AME37W1.WS-ST-GRNDTOT NE 0;*/
  /* SET FORMATW EMPTY;*/
  /* MOVE AME37W1.WS-ST-GRNDTOT TO FORMATW.INPUT-NUMBER;*/
  /* MOVE 9 TO FORMATW.LENGTH;*/
  /* MOVE 'Y' TO FORMATW.FORMAT-FLAG;*/
  /* MOVE 'N' TO FORMATW.DOLLAR-FLAG;*/
  /* PERFORM REPP9-FORMAT-PROC;*/
  /* MOVE FORMATW.OUTPUT-CHAR TO AME37W-DET.S-GRNDTOTAC;*/
  /* ELSE;*/
  /* MOVE '        0' TO AME37W-DET.S-GRNDTOTAC;*/
  /* END;*/

  if (AME37W1.WS-ST-PAMRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-PAMRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAMRC = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-PAMRC = "     0";
  end

  if (AME37W1.WS-ST-NAMRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-NAMRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAMRC = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAMRC = "     0";
  end

  if (AME37W1.WS-ST-SUBTOTMRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-SUBTOTMRC;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTMRC = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-SUBTOTMRC = "      0";
  end

  if (AME37W1.WS-ST-DMI0 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMI0;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI0 = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMI0 = "     0";
  end

  if (AME37W1.WS-ST-DMI1 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMI1;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI1 = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMI1 = "     0";
  end

  if (AME37W1.WS-ST-DMI2 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMI2;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI2 = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMI2 = "     0";
  end

  if (AME37W1.WS-ST-DMI3 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMI3;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI3 = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMI3 = "     0";
  end

  if (AME37W1.WS-ST-DMI4 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMI4;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI4 = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMI4 = "     0";
  end

  if (AME37W1.WS-ST-DMI5 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMI5;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI5 = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMI5 = "     0";
  end

  if (AME37W1.WS-ST-DMI6 != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMI6;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMI6 = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMI6 = "     0";
  end

  if (AME37W1.WS-ST-DMIEBT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W1.WS-ST-DMIEBT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-DMIEBT = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-DMIEBT = "     0";
  end
end // end AME37P9-POP-STDET


// PROCESS TO PRINT THE REPORT
Function AME37P9-PRINT-PARA()
  /* GET BEGIN AND END DATE OF THE INPUT MTH AND PREVIOUS MTH*/

  AME37P9-PARA1();

  /* If no ofc cd is entered as input, read all recs from PCE file*/
  /* and print each office as well as statewide details*/

  AME37P9-SET-FLG-1();

  /* WDS(11-17-1999)- JCL HANDLED '**' ON IN-PARM BUT THIS PROGRAM DID NOT*/
  /* IF AME37W.WS-RPT-LEVEL IS BLANKS;*/
  if ((AME37W.WS-RPT-LEVEL == "  " || 
  AME37W.WS-RPT-LEVEL == "**" || 
  AME37W.WS-RPT-LEVEL == "* "))

    AME37W.WS-NRF-FLG = "N";
    AME37P9-SETINQ-S01(); /* GET DISTINCT OFFICE CODES*/

  /* PERFORM AME37P9-READPCE;*/

    if (sysVar.sqlData.sqlcode == 0)
      AME37P9-SCAN-S01(); /* GET DISTINCT OFFICE CODES*/

      while (AME37W.WS-S01-SQLCD == 0)

  /* WHILE SR-ARX04-REC NOT ERR;*/
  /* MOVE SR-ARX04-REC.PCE-OFC-CD TO AME37W.WS-OFC-CD;*/

        AME37W.WS-OFC-CD = H2-CASELD-DEBTLD.OFC-CD;

        H2-OFFICE.OFC-CD = AME37W.WS-OFC-CD;

        AME37Q1-S01();

        AME37W-SUBH.S-LEVEL = H2-OFFICE.OFC-NM;

        AME37P9-APPLSPEC();

        /* PROCESS TO POPULATE DETAILS FOR THE OFC*/

        AME37P9-POP-OFDET();

        /* Compute the statewide totals*/

        AME37P9-ST-TOTS();

       /* Print each office details on new pg*/

        REP-COMMON.WS-NEW-PAGE = "Y";
        if (AME37W.WS-NODATA-FLG == "Y")
          AME37P9-PRN-DETAIL();
        end
        AME37P9-SET-FLG-1();
        AME37P9-SET-ZERO();

        AME37P9-SCAN-S01(); /* GET DISTINCT OFFICE CODES*/
      end
    end

    AME37P9-POP-STDET();
    AME37W-SUBH.S-LEVEL = " ";
    AME37W-SUBH.S-LEVEL = "STATEWIDE";

  /* PRINT STATEWIDE-DETAILS ON NEW PAGE*/


    REP-COMMON.WS-NEW-PAGE = "Y";

    AME37P9-PRN-DETAIL();
    REP132P9-EOR-PROC();

  else

    /* If input given for ofc-cd, print details for that office only*/

    AME37W.WS-OFC-CD = AME37W.WS-RPT-LEVEL;
    H2-OFFICE.OFC-CD = AME37W.WS-RPT-LEVEL;
    AME37Q1-S01();

    if (VDBCONTROL.URC == 100)

      /* Call CEP01A for invalid parameters*/
      /* Input ofc-cd has no entry in twnofc_cd*/

      VMESSAGE.UMSGCODE-JCL-ERR = 0;
      VMESSAGE.UMSGCODE = "GEN0541E";
      VMESSAGE.UMSGINS[2] = "AME37A";
      VDBCONTROL.UPROC-NM = "AME37P9-PRINT-PARA";
      VDBCONTROL.UPROC-OPT = "SCAN";
      VDBCONTROL.UPROC-OBJ = "SR-AME37-RECIN";
      VMESSAGE.UMSGINS[1] = " ";
      VDBCONTROL.UMSQLCODE = 0;
      WCM00P2-TO-CEP01A();
    end

    AME37W-SUBH.S-LEVEL = H2-OFFICE.OFC-NM;
    AME37P9-APPLSPEC();
        /* PROCESS TO POPULATE DETAILS FOR THE OFC*/

    AME37P9-POP-OFDET();

       /* Print each office details on new pg*/

    if (AME37W.WS-NODATA-FLG == "N")
      AME37P9-PRN-HEAD();
      REP132P9-NRF-PROC();
      AME37P9-CLOS-PARA();
    end

    REP-COMMON.WS-NEW-PAGE = "Y";

    AME37P9-PRN-DETAIL();
    AME37P9-SET-FLG-1();
    AME37P9-SET-ZERO();
    REP132P9-EOR-PROC();

  end

  /*  */
end // end AME37P9-PRINT-PARA


// PROCESS TO PRINT DETAIL
Function AME37P9-PRN-DETAIL()
  /* cbsi start*/

  /* print header & subheader if new page*/

  if (REP-COMMON.WS-NEW-PAGE == "Y")
    AME37P9-PRN-HEAD();
    AME37P9-PRN-SUBH();
  end

  /* print all detail lines*/

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE1;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE2;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE3;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE4;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE4E;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE5;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE6;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE7;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE8;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE9;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE10;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE11;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE12;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE13;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE14;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE15;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE16;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE17;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE18;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE19;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE20;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE21;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE22;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE23;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE24;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE25;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE26;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  /* Added for WI 15820*/

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE27;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE28;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE29;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE30;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE31;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";
  /* End of WI 15820*/

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE32;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE33;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  /* MOVE AME37W-DET.LINE35 TO SR-132REP-RECOUT.UFIELD;*/
  /* PERFORM WR-132REP-OUT-FILE;*/
  /* MOVE '0' TO SR-132REP-RECOUT.PRNT-CC;*/

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE36;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = "0";

  /* give a blank line before printing the current line*/

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE37;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-DET.LINE38;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";

  /* cbsi end*/
end // end AME37P9-PRN-DETAIL


// PROCESS TO PRINT HEADER
Function AME37P9-PRN-HEAD()
  /* cbsi start*/
  AME37W-HEAD.UPAGE = REP-COMMON.WS-PAGE-NO;

  if (REP-COMMON.WS-PAGE-NO > 1)
    SR-132REP-RECOUT.PRNT-CC = "1";
  else
    SR-132REP-RECOUT.PRNT-CC = " ";
  end

  /* move each line of header to map and print*/
  SR-132REP-RECOUT.UFIELD = AME37W-HEAD.LINE1;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AME37W-HEAD.LINE2;
  WR-132REP-OUT-FILE();

  /* increment the page no for the for the next office*/

  REP-COMMON.WS-PAGE-NO = REP-COMMON.WS-PAGE-NO + 1;

  /* cbsi end*/
end // end AME37P9-PRN-HEAD


// PRINTING THE REPORT'S SUB-HEAD
Function AME37P9-PRN-SUBH()
  /* cbsi start*/
  /* MOVE EACH LINE OF SUBHEADER TO MAP*/

  /* SET CONTROL CHARACTER TO MOVE ONE LINE BEFORE PRINTING CURR LINE*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AME37W-SUBH.LINE1;
  WR-132REP-OUT-FILE();

  /* SET CONTROL CHARACTER TO MOVE ONE LINE BEFORE PRINTING CURR LINE*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AME37W-SUBH.LINE2;
  WR-132REP-OUT-FILE();

  SR-132REP-RECOUT.PRNT-CC = " ";
  SR-132REP-RECOUT.UFIELD = AME37W-SUBH.LINE3;
  WR-132REP-OUT-FILE();

  /* SET CONTROL CHARACTER TO MOVE ONE LINE AFTER PRINTING CURR LINE*/
  SR-132REP-RECOUT.PRNT-CC = " ";
  /* cbsi end*/
end // end AME37P9-PRN-SUBH


Function AME37P9-READ-S02()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-2-FAA-FCH";
  VDBCONTROL.UPROC-NM = "AME37P9-READ-S02";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCONTROL.UPROC-OBJ = "H2-2-FAA-FCH";

  VDBCONTROL.UACCTYP = "R";
  try
    get H2-2-FAA-FCH
      with #sql{
        select T1.ICI, T1.PRGM_TYP, T1.ACTN_TS, T1.ACTN_TYP,
          T1.ACTN_RSN_CD, T1.ACTN_EFF_DT, T1.VER_NMB,
          T1.BNFT_MTH, T1.BNFT_YR, T1.ELIG_CD, T1.AID_CD,
          T1.MULT_CLSRE_RSN_IND, T1.INIT_APRVL_DT,
          T1.EXPD_FS_RSN_CD, T1.APPL_DT,
          T1.FAM_APPL_TYPE, T2.ICI, T2.PRD_BEG_DT,
          T2.CASE_STS, T2.MTHLY_RPTR_IND,
          T2.AUTO_POST_IND, T2.RESET_VRFN_IND,
          T2.PRD_END_DT, T2.NMB_OF_DPNDS, T2.HOH_UPI,
          T2.APPL_UPI, T2.PREV_HOH_UPI,
          T2.HOH_UPI_CHNG_DT, T2.AUTO_CLSRE_IND,
          T2.VERF_DUE_DT,
          T2.SBSDZ_IND, T2.HSG_TYP_CD,
          T2.NMB_OF_PA_PRSNS, T2.FS_SUFX,
          T2.VRFN_EXTN_IND, T2.HMLS_IND, T2.SPLZD_CD,
          T2.OLD_MTHLY_RPTR_IND
        from TWNFAM_ACTNS T1,
             TWNFAM_CASE_HSTRY T2
        WHERE T1.ICI = :ICI AND
        T1.PRGM_TYP = 'FS' AND
        T1.ACTN_TS < :ACTN-TS AND
        T1.ICI = T2.ICI AND
        T2.PRD_BEG_DT <= :AME37W.WS-RPT-END-DT AND
        T2.PRD_END_DT >= :AME37W.WS-RPT-END-DT
         --** INSERT ORDER BY CLAUSE HERE **
        ORDER BY T1.ACTN_TS DESC
      }
      into ICI, PRGM-TYP, ACTN-TS, ACTN-TYP, ACTN-RSN-CD,
           ACTN-EFF-DT, VER-NMB, BNFT-MTH, BNFT-YR,
           ELIG-CD, AID-CD, MULT-CLSRE-RSN-IND,
           INIT-APRVL-DT, EXPD-FS-RSN-CD, APPL-DT,
           FAM-APPL-TYPE, T2-ICI, PRD-BEG-DT, CASE-STS,
           MTHLY-RPTR-IND, AUTO-POST-IND, RESET-VRFN-IND,
           PRD-END-DT, NMB-OF-DPNDS, HOH-UPI, APPL-UPI,
           PREV-HOH-UPI, HOH-UPI-CHNG-DT, AUTO-CLSRE-IND,
           VERF-DUE-DT,   SBSDZ-IND,
           HSG-TYP-CD, NMB-OF-PA-PRSNS, FS-SUFX,
           VRFN-EXTN-IND, HMLS-IND, SPLZD-CD,
           OLD-MTHLY-RPTR-IND ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-READ-S02


Function AME37P9-READ-S03()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-PRGM-CASE-HSTRY";
  VDBCONTROL.UPROC-NM = "AME37P9-READ-S03";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCONTROL.UPROC-OBJ = "H2-PRGM-CASE-HSTRY";

  VDBCONTROL.UACCTYP = "R";
  try
    get H2-PRGM-CASE-HSTRY singleRow
      with #sql{
        select ICI, PRGM_CASE_TYPE, PRD_BEG_DT, STS_EFF_DT,
          PRGM_CASE_STS, INIT_APPRVD_BY, EXPD_FS_RSN_CD,
          INIT_APRVL_TM, INIT_APRVL_DT, APPL_DT,
          REDET_FRQ, PRGM_EFF_DT, PRD_END_DT,
          ADVR_ACTN_WVD_IND, DUPL_ASST_IND,
          ADVR_ACTN_WVD_DT, CLSRE_RSN_CD, RFRD_BY,
          EXFS_DSCVR_DT, TR_STRT_DT, TR_ADD_COVER_IND,
          TR_EXPRN_DT, AID_CD, PRIR_MDCAL_IND,
          ACTUL_APLD_DT, ELIG_CD, MULT_CLSRE_RSN_IND,
          FRST_TM_APRVL_IND, SYS_CLSRE_DNL_RSN,
          RCRT_APL_DT, AID_CD_CHNG_DT, PREV_AID_CD,
          MA_CLOSE_STS_IND, OLD_APPL_DT,
          REAP_HIGH_AID_FG, ACTUL_STS_EFF_DT, HRDSHP_CD,
          HRDSHP_DNL_CD, HRDSHP_24_60_CNT,
          TR_LOSS_INC_EARN, TR_LOSS_DISREG, CATGL_ELIG
        from TWNPRGM_CASE_HSTRY T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE ICI = :ICI
        AND PRGM_CASE_TYPE = 'FS'
        AND PRD_BEG_DT <= :AME37W.WS-RPT-END-DT
        AND PRD_END_DT >= :AME37W.WS-RPT-END-DT
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into ICI, PRGM-CASE-TYPE, PRD-BEG-DT, STS-EFF-DT,
           PRGM-CASE-STS, INIT-APPRVD-BY, EXPD-FS-RSN-CD,
           INIT-APRVL-TM, INIT-APRVL-DT, APPL-DT,
           REDET-FRQ, PRGM-EFF-DT, PRD-END-DT,
           ADVR-ACTN-WVD-IND, DUPL-ASST-IND,
           ADVR-ACTN-WVD-DT, CLSRE-RSN-CD, RFRD-BY,
           EXFS-DSCVR-DT, TR-STRT-DT, TR-ADD-COVER-IND,
           TR-EXPRN-DT, AID-CD, PRIR-MDCAL-IND,
           ACTUL-APLD-DT, ELIG-CD, MULT-CLSRE-RSN-IND,
           FRST-TM-APRVL-IND, SYS-CLSRE-DNL-RSN,
           RCRT-APL-DT, AID-CD-CHNG-DT, PREV-AID-CD,
           MA-CLOSE-STS-IND, OLD-APPL-DT,
           REAP-HIGH-AID-FG, ACTUL-STS-EFF-DT, HRDSHP-CD,
           HRDSHP-DNL-CD, HRDSHP-24-60-CNT,
           TR-LOSS-INC-EARN, TR-LOSS-DISREG, CATGL-ELIG ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-READ-S03


// PROCESS TO READ INPUT FILE
Function AME37P9-READIP()
  /* cbsi start*/
  VGVar.handleHardIOErrors = 1;
  VDBCONTROL.UPROC-NM = "AME37P9-READIP";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "SR-AME37-RECIN";
  VMESSAGE.UMSGINS[2] = "AME37A";
  try
    get next SR-AME37-RECIN ;
  end
  /* check if any i/o error has occured*/
  if (SR-AME37-RECIN is ioError && SR-AME37-RECIN not endOfFile)
  /* ************* PTR 11842 STARTS HERE ***********************/
    VMESSAGE.UMSGCODE-JCL-ERR = 0;
    AME37W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AME37W.WS-ERR-LAST-FOUR;
  /* MOVE 'WR-132-REP-OUT-FILE' TO VDBCONTROL.UPROC-NM;*/
  /* MOVE 'ADD' TO VDBCONTROL.UPROC-OPT;*/
  /* MOVE 'SR-132REP-RECOUT' TO VDBCONTROL.UPROC-OBJ;*/
    /* return error code to indicate abnormal ending*/
  /* MOVE 8 TO EZERCODE;*/
    WCM00P2-TO-CEP01A();
  /* ************* PTR 11842 ENDS HERE *************************/
  end

  /* ************* PTR 11842 STARTS HERE ***********************/
  if (SR-AME37-RECIN is endOfFile)
    VMESSAGE.UMSGCODE-JCL-ERR = 0;
    AME37W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AME37W.WS-ERR-LAST-FOUR;
    WCM00P2-TO-CEP01A();
  end
  /* ************* PTR 11842 ENDS HERE *************************/
  /* cbsi end*/
end // end AME37P9-READIP


Function AME37P9-SCAN-S01()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-CASELD-DEBTLD";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S01";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-CASELD-DEBTLD";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-CASELD-DEBTLD ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S01-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S01


Function AME37P9-SCAN-S02()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-FSI";
  VDBCONTROL.UPROC-NM = "AME37P9-SCAN-S02";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-FSI";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-3-FAC-FCH-FSI ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S02-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S02


Function AME37P9-SCAN-S03()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-FSI";
  VDBCONTROL.UPROC-NM = "AME37P9-SCAN-S03";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-FSI";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-3-FAC-FCH-FSI ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S03-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S03


Function AME37P9-SCAN-S04()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-2-FAA-FAC";
  VDBCONTROL.UPROC-NM = "AME37P9-SCAN-S04";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-2-FAA-FAC";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-2-FAA-FAC ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S04-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S04


Function AME37P9-SCAN-S05()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SCAN-S05";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S05-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S05


Function AME37P9-SCAN-S06()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SCAN-S06";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S06-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S06


Function AME37P9-SCAN-S07()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SCAN-S07";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S07-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S07


Function AME37P9-SCAN-S08()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SCAN-S08";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    get next H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  AME37W.WS-S08-SQLCD = sysVar.sqlData.sqlcode;
  /*  */
end // end AME37P9-SCAN-S08


// INITIALIZE ALL RECORDS
Function AME37P9-SET-EMPTY()
  /* cbsi start*/
  set REP-COMMON empty;
  set AME37W-DET empty;
  set AME37W-HEAD empty;
  set AME37W-SUBH empty;
  set VMESSAGE empty;
  set CEP01W empty;
  set VDBCONTROL empty;
  set VDBCOMMON empty;
  set FORMATW empty;
  set AME37W empty;
  set AME37W1 empty;

  /* set all h2 records empty*/
  set H2-OFFICE empty;
  set H2-3-FAC-FCH-FSI empty;
  set H2-3-FAC-FCH-PSY empty;
  set H2-CASELD-DEBTLD empty;
  set H2-2-FAA-FAC empty;
  set H2-PRGM-CASE-HSTRY empty;
  /* SET H2-FS-ISNCE-SMRY EMPTY;*/
  /* SET H2-FS-ISNCE EMPTY;*/
  /* set all serial records empty*/

  set SR-AME37-RECIN empty;
  set SR-132REP-RECOUT empty;
  /* SET SR-ARX04-REC EMPTY;*/
  /* cbsi end*/
end // end AME37P9-SET-EMPTY


// INITIALIZE FLAGS - 1
Function AME37P9-SET-FLG-1()
  /* cbsi start*/

  /* Initialize flags other than the flags*/
  /* used for DSC03 & DSC04.*/

  AME37W.WS-PACASES-FLG = "N";
  AME37W.WS-NACASES-FLG = "N";
  AME37W.WS-PAEXPCASE-FLG = "N";
  AME37W.WS-NAEXPCASE-FLG = "N";
  AME37W.WS-PAMRC-FLG = "N";
  AME37W.WS-NAMRC-FLG = "N";
  AME37W.WS-PANEW-FLG = "N";
  AME37W.WS-NANEW-FLG = "N";
  AME37W.WS-PATERM-FLG = "N";
  AME37W.WS-NATERM-FLG = "N";
  AME37W.WS-PAWTDR-FLG = "N";
  AME37W.WS-NAWTDR-FLG = "N";
  AME37W.WS-PADENY-FLG = "N";
  AME37W.WS-NADENY-FLG = "N";
  AME37W.WS-PANCOOP-FLG = "N";
  AME37W.WS-NANCOOP-FLG = "N";
  AME37W.WS-PAQUIT-FLG = "N";
  AME37W.WS-NAQUIT-FLG = "N";
  AME37W.WS-PARSRC-FLG = "N";
  AME37W.WS-NARSRC-FLG = "N";
  AME37W.WS-PAOTHR-FLG = "N";
  AME37W.WS-NAOTHR-FLG = "N";
  /* ** Changes due to WI 16330 Begin ----------------*/
  AME37W.WS-FSISNCE-FLG = "N";
  AME37W.WS-PAAPPRVMTH-FLG = "N";
  AME37W.WS-PADNYWDMTH-FLG = "N";
  AME37W.WS-PAPNDMTH-FLG = "N";
  AME37W.WS-NADNYWDMTH-FLG = "N";
  AME37W.WS-NAAPPRVMTH-FLG = "N";
  AME37W.WS-NAPNDMTH-FLG = "N";
  /* ** Changes due to WI 16330 End   ----------------*/
  /* cbsi end*/
end // end AME37P9-SET-FLG-1


// INITIALIZE VARIABLES TO ZERO
Function AME37P9-SET-ZERO()
  AME37W.WS-PACASES = 0;
  AME37W.WS-NACASES = 0;
  AME37W.WS-PAEXPCASE = 0;
  AME37W.WS-NAEXPCASE = 0;
  AME37W.WS-PADAMS = 0;
  AME37W.WS-NADAMS = 0;
  AME37W.WS-PASPHNDL = 0;
  AME37W.WS-NASPHNDL = 0;
  AME37W.WS-PAEBTCASE = 0;
  AME37W.WS-NAEBTCASE = 0;
  AME37W.WS-PALMISS = 0;
  AME37W.WS-NALMISS = 0;
  AME37W.WS-PAREVISED = 0;
  AME37W.WS-NAREVISED = 0;
  AME37W.WS-PARETRO = 0;
  AME37W.WS-NARETRO = 0;
  AME37W.WS-PAEST = 0;
  AME37W.WS-NAEST = 0;
  AME37W.WS-PABNFT = 0;
  AME37W.WS-NABNFT = 0;
  AME37W.WS-PAPART = 0;
  AME37W.WS-NAPART = 0;
  AME37W.WS-PAWTDR = 0;
  AME37W.WS-NAWTDR = 0;
  AME37W.WS-PADENY = 0;
  AME37W.WS-NADENY = 0;
  AME37W.WS-PANCOOP = 0;
  AME37W.WS-NANCOOP = 0;
  AME37W.WS-PAQUIT = 0;
  AME37W.WS-NAQUIT = 0;
  AME37W.WS-PARSRC = 0;
  AME37W.WS-NARSRC = 0;
  AME37W.WS-PAOTHR = 0;
  AME37W.WS-NAOTHR = 0;
  AME37W.WS-PATOT = 0;
  AME37W.WS-NATOT = 0;

  AME37W.WS-PANEW = 0;
  AME37W.WS-NANEW = 0;
  AME37W.WS-PASUBS = 0;
  AME37W.WS-NASUBS = 0;
  AME37W.WS-PAPNDMTH = 0;
  AME37W.WS-NAPNDMTH = 0;
  AME37W.WS-PAAPPRVMTH = 0;
  AME37W.WS-NAAPPRVMTH = 0;
  AME37W.WS-PADNYWDMTH = 0;
  AME37W.WS-NADNYWDMTH = 0;
  AME37W.WS-PAAPPLMTH = 0;
  AME37W.WS-NAAPPLMTH = 0;

  AME37W.WS-PATERM = 0;
  AME37W.WS-NATERM = 0;
  AME37W.WS-PAMRC = 0;
  AME37W.WS-NAMRC = 0;
  AME37W.WS-DMI0 = 0;
  AME37W.WS-DMI1 = 0;
  AME37W.WS-DMI2 = 0;
  AME37W.WS-DMI3 = 0;
  AME37W.WS-DMI4 = 0;
  AME37W.WS-DMI5 = 0;
  AME37W.WS-DMI6 = 0;
  AME37W.WS-DMIEBT = 0;
  AME37W.WS-F1 = "-";
  AME37W.WS-F2 = "-";
  AME37W.WS-F3 = "-";
  AME37W.WS-F4 = "-";
  /* Changes due to WI 16330 End ------*/
end // end AME37P9-SET-ZERO


Function AME37P9-SETINQ-S01()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-CASELD-DEBTLD";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S01";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-CASELD-DEBTLD";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S01_RSI01
      with #sql{
        select DISTINCT(OFC_CD)
        from TWNCASELD_DEBTLD T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE PRGM_OFC_TYPE = 'A'
        AND OFC_CD NOT IN ('DC','DH','DL','DR')
         --** INSERT ORDER BY CLAUSE HERE **
        ORDER BY OFC_CD
      }      
      into OFC-CD
      for H2-CASELD-DEBTLD ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S01


Function AME37P9-SETINQ-S02()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-FSI";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S02";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-FSI";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S02_RSI01
      with #sql{
        select T1.OFC_CD, T1.PRGM_OFC_TYPE, T1.SPRVS_UNIT,
          T1.PSN_NMB, T1.FUNC_AREA_CD, T1.WRKR_TYPE,
          T1.CASLD_EFF_DT, T1.ICI, T1.CASLD_ID, T2.ICI,
          T2.PRD_BEG_DT, T2.CASE_STS, T2.MTHLY_RPTR_IND,
          T2.AUTO_POST_IND, T2.RESET_VRFN_IND,
          T2.PRD_END_DT, T2.NMB_OF_DPNDS, T2.HOH_UPI,
          T2.APPL_UPI, T2.PREV_HOH_UPI,
          T2.HOH_UPI_CHNG_DT, T2.AUTO_CLSRE_IND,
          T2.VERF_DUE_DT,
          T2.SBSDZ_IND, T2.HSG_TYP_CD,
          T2.NMB_OF_PA_PRSNS, T2.FS_SUFX,
          T2.VRFN_EXTN_IND, T2.HMLS_IND, T2.SPLZD_CD,
          T2.OLD_MTHLY_RPTR_IND, T3.ISNCE_NMB,
          T3.CYCLE_PRD_DT, T3.REISU_RSN_CD,
          T3.PYEE_ADLN1, T3.PYEE_NM, T3.FS_ISNCE_STS,
          T3.BNFT_TYPE, T3.BNFT_AMT, T3.ISNCE_DT,
          T3.EXPD_SRVC_IND, T3.ISNCE_EXPRN_DT,
          T3.MAILD_DT, T3.COUPN_BKS_DOLR_120,
          T3.COUPN_BKS_DOLR_65, T3.COUPN_BKS_DOLR_50,
          T3.COUPN_BKS_DOLR_40, T3.COUPN_BKS_DOLR_10,
          T3.COUPN_BKS_DOLR_7, T3.COUPN_BKS_DOLR_2,
          T3.MTHD_OF_ISNCE, T3.PYEE_ADLN2, T3.SER_NMB,
          T3.JULIAN_DAY, T3.STORE_ID, T3.ZIP_CD,
          T3.ST_CD, T3.CTY, T3.REISU_NMB,
          T3.ISNCE_STS_EFF_DT, T3.BNFT_CD,
          T3.ORGNL_ISNCE_DT, T3.RNSTM_IND, T3.BNFT_YR,
          T3.BNFT_MTH, T3.ICI, T3.PRGM_CASE_TYPE,
          T3.VER_NMB, T3.RSDN_CNTY_CD, T3.ISNCE_MTHD
        from TWNFAM_CASELD_CASE T1,
             TWNFAM_CASE_HSTRY T2,
             TWNFS_ISNCE T3
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.OFC_CD = :AME37W.WS-OFC-CD
        AND T1.ICI = T2.ICI
        AND T2.PRD_BEG_DT <= :AME37W.WS-RPT-END-DT
        AND T2.PRD_END_DT >= :AME37W.WS-RPT-END-DT
        AND T2.ICI = T3.ICI
         -- wi 25480 AND T3.ISNCE_DT >= :AME37W.WS-RPT-BEG-DT
        AND T3.ISNCE_DT <= :AME37W.WS-RPT-END-DT
        AND T3.BNFT_MTH = :AME37W.WS-RPT-MONTH-BIN
        AND T3.BNFT_YR = :AME37W.WS-RPT-YEAR-BIN
        AND T3.BNFT_TYPE = 'RG'
        AND T3.FS_ISNCE_STS IN ('IS', 'RD')
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into OFC-CD, PRGM-OFC-TYPE, SPRVS-UNIT, PSN-NMB,
           FUNC-AREA-CD, WRKR-TYPE, CASLD-EFF-DT, ICI,
           CASLD-ID, T2-ICI, PRD-BEG-DT, CASE-STS,
           MTHLY-RPTR-IND, AUTO-POST-IND, RESET-VRFN-IND,
           PRD-END-DT, NMB-OF-DPNDS, HOH-UPI, APPL-UPI,
           PREV-HOH-UPI, HOH-UPI-CHNG-DT, AUTO-CLSRE-IND,
           VERF-DUE-DT,  SBSDZ-IND,
           HSG-TYP-CD, NMB-OF-PA-PRSNS, FS-SUFX,
           VRFN-EXTN-IND, HMLS-IND, SPLZD-CD,
           OLD-MTHLY-RPTR-IND, ISNCE-NMB, CYCLE-PRD-DT,
           REISU-RSN-CD, PYEE-ADLN1, PYEE-NM,
           FS-ISNCE-STS, BNFT-TYPE, BNFT-AMT, ISNCE-DT,
           EXPD-SRVC-IND, ISNCE-EXPRN-DT, MAILD-DT,
           COUPN-BKS-DOLR-120, COUPN-BKS-DOLR-65,
           COUPN-BKS-DOLR-50, COUPN-BKS-DOLR-40,
           COUPN-BKS-DOLR-10, COUPN-BKS-DOLR-7,
           COUPN-BKS-DOLR-2, MTHD-OF-ISNCE, PYEE-ADLN2,
           SER-NMB, JULIAN-DAY, STORE-ID, ZIP-CD, ST-CD,
           CTY, REISU-NMB, ISNCE-STS-EFF-DT, BNFT-CD,
           ORGNL-ISNCE-DT, RNSTM-IND, BNFT-YR, BNFT-MTH,
           T3-ICI, PRGM-CASE-TYPE, VER-NMB,
           T3-RSDN-CNTY-CD, ISNCE-MTHD
      for H2-3-FAC-FCH-FSI ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S02


Function AME37P9-SETINQ-S03()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-FSI";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S02";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-FSI";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S03_RSI01
      with #sql{
        select T1.OFC_CD, T1.PRGM_OFC_TYPE, T1.SPRVS_UNIT,
          T1.PSN_NMB, T1.FUNC_AREA_CD, T1.WRKR_TYPE,
          T1.CASLD_EFF_DT, T1.ICI, T1.CASLD_ID, T2.ICI,
          T2.PRD_BEG_DT, T2.CASE_STS, T2.MTHLY_RPTR_IND,
          T2.AUTO_POST_IND, T2.RESET_VRFN_IND,
          T2.PRD_END_DT, T2.NMB_OF_DPNDS, T2.HOH_UPI,
          T2.APPL_UPI, T2.PREV_HOH_UPI,
          T2.HOH_UPI_CHNG_DT, T2.AUTO_CLSRE_IND,
          T2.VERF_DUE_DT,
          T2.SBSDZ_IND, T2.HSG_TYP_CD,
          T2.NMB_OF_PA_PRSNS, T2.FS_SUFX,
          T2.VRFN_EXTN_IND, T2.HMLS_IND, T2.SPLZD_CD,
          T2.OLD_MTHLY_RPTR_IND, T3.ISNCE_NMB,
          T3.CYCLE_PRD_DT, T3.REISU_RSN_CD,
          T3.PYEE_ADLN1, T3.PYEE_NM, T3.FS_ISNCE_STS,
          T3.BNFT_TYPE, T3.BNFT_AMT, T3.ISNCE_DT,
          T3.EXPD_SRVC_IND, T3.ISNCE_EXPRN_DT,
          T3.MAILD_DT, T3.COUPN_BKS_DOLR_120,
          T3.COUPN_BKS_DOLR_65, T3.COUPN_BKS_DOLR_50,
          T3.COUPN_BKS_DOLR_40, T3.COUPN_BKS_DOLR_10,
          T3.COUPN_BKS_DOLR_7, T3.COUPN_BKS_DOLR_2,
          T3.MTHD_OF_ISNCE, T3.PYEE_ADLN2, T3.SER_NMB,
          T3.JULIAN_DAY, T3.STORE_ID, T3.ZIP_CD,
          T3.ST_CD, T3.CTY, T3.REISU_NMB,
          T3.ISNCE_STS_EFF_DT, T3.BNFT_CD,
          T3.ORGNL_ISNCE_DT, T3.RNSTM_IND, T3.BNFT_YR,
          T3.BNFT_MTH, T3.ICI, T3.PRGM_CASE_TYPE,
          T3.VER_NMB, T3.RSDN_CNTY_CD
        from TWNFAM_CASELD_CASE T1,
             TWNFAM_CASE_HSTRY T2,
             TWNFS_ISNCE T3
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.OFC_CD = :AME37W.WS-OFC-CD
        AND T1.ICI = T2.ICI
        AND T2.PRD_BEG_DT <= :AME37W.WS-RPT-END-DT
        AND T2.PRD_END_DT >= :AME37W.WS-RPT-END-DT
        AND T2.ICI = T3.ICI
        AND T3.BNFT_MTH = :AME37W.WS-PREV-RPT-MTH
        AND T3.BNFT_YR = :AME37W.WS-PREV-RPT-YR
        AND T3.BNFT_TYPE = 'RG'
        AND T3.FS_ISNCE_STS IN ('IS', 'RD')
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into OFC-CD, PRGM-OFC-TYPE, SPRVS-UNIT, PSN-NMB,
           FUNC-AREA-CD, WRKR-TYPE, CASLD-EFF-DT, ICI,
           CASLD-ID, T2-ICI, PRD-BEG-DT, CASE-STS,
           MTHLY-RPTR-IND, AUTO-POST-IND, RESET-VRFN-IND,
           PRD-END-DT, NMB-OF-DPNDS, HOH-UPI, APPL-UPI,
           PREV-HOH-UPI, HOH-UPI-CHNG-DT, AUTO-CLSRE-IND,
           VERF-DUE-DT,  SBSDZ-IND,
           HSG-TYP-CD, NMB-OF-PA-PRSNS, FS-SUFX,
           VRFN-EXTN-IND, HMLS-IND, SPLZD-CD,
           OLD-MTHLY-RPTR-IND, ISNCE-NMB, CYCLE-PRD-DT,
           REISU-RSN-CD, PYEE-ADLN1, PYEE-NM,
           FS-ISNCE-STS, BNFT-TYPE, BNFT-AMT, ISNCE-DT,
           EXPD-SRVC-IND, ISNCE-EXPRN-DT, MAILD-DT,
           COUPN-BKS-DOLR-120, COUPN-BKS-DOLR-65,
           COUPN-BKS-DOLR-50, COUPN-BKS-DOLR-40,
           COUPN-BKS-DOLR-10, COUPN-BKS-DOLR-7,
           COUPN-BKS-DOLR-2, MTHD-OF-ISNCE, PYEE-ADLN2,
           SER-NMB, JULIAN-DAY, STORE-ID, ZIP-CD, ST-CD,
           CTY, REISU-NMB, ISNCE-STS-EFF-DT, BNFT-CD,
           ORGNL-ISNCE-DT, RNSTM-IND, BNFT-YR, BNFT-MTH,
           T3-ICI, PRGM-CASE-TYPE, VER-NMB,
           T3-RSDN-CNTY-CD
      for H2-3-FAC-FCH-FSI ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S03


Function AME37P9-SETINQ-S04()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-2-FAA-FAC";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S04";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-2-FAA-FAC";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S04_RSI01
      with #sql{
        select T1.ICI, MIN(T1.ACTN_TS)
        from TWNFAM_ACTNS T1,
             TWNFAM_CASELD_CASE T2
        WHERE T2.OFC_CD = :AME37W.WS-OFC-CD AND
          T2.PRGM_OFC_TYPE = 'A' AND
          T1.ACTN_TS >=  :AME37W.WS-REP-BEG-TS AND
          T1.ACTN_TS <=  :AME37W.WS-REP-END-TS AND
          T1.ICI = T2.ICI  AND
          T1.ACTN_TYP = 'AP' AND
          T1.PRGM_TYP = 'FS'
          GROUP BY T1.ICI
          FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into ICI, ACTN-TS
      for H2-2-FAA-FAC ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S04


Function AME37P9-SETINQ-S05()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S05";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S05_RSI01
      with #sql{
        select T1.OFC_CD, T1.PRGM_OFC_TYPE, T1.SPRVS_UNIT,
          T1.PSN_NMB, T1.FUNC_AREA_CD, T1.WRKR_TYPE,
          T1.CASLD_EFF_DT, T1.ICI, T1.CASLD_ID, T2.ICI,
          T2.PRD_BEG_DT, T2.CASE_STS, T2.MTHLY_RPTR_IND,
          T2.AUTO_POST_IND, T2.RESET_VRFN_IND,
          T2.PRD_END_DT, T2.NMB_OF_DPNDS, T2.HOH_UPI,
          T2.APPL_UPI, T2.PREV_HOH_UPI,
          T2.HOH_UPI_CHNG_DT, T2.AUTO_CLSRE_IND,
          T2.VERF_DUE_DT,
          T2.SBSDZ_IND, T2.HSG_TYP_CD,
          T2.NMB_OF_PA_PRSNS, T2.FS_SUFX,
          T2.VRFN_EXTN_IND, T2.HMLS_IND, T2.SPLZD_CD,
          T3.ICI, T3.PRGM_CASE_TYPE, T3.PRD_BEG_DT,
          T3.STS_EFF_DT, T3.PRGM_CASE_STS,
          T3.INIT_APPRVD_BY, T3.EXPD_FS_RSN_CD,
          T3.INIT_APRVL_TM, T3.INIT_APRVL_DT, T3.APPL_DT,
          T3.REDET_FRQ, T3.PRGM_EFF_DT, T3.PRD_END_DT,
          T3.ADVR_ACTN_WVD_IND, T3.DUPL_ASST_IND,
          T3.ADVR_ACTN_WVD_DT, T3.CLSRE_RSN_CD,
          T3.RFRD_BY, T3.EXFS_DSCVR_DT, T3.TR_STRT_DT,
          T3.TR_ADD_COVER_IND, T3.TR_EXPRN_DT, T3.AID_CD,
          T3.PRIR_MDCAL_IND, T3.ACTUL_APLD_DT,
          T3.ELIG_CD, T3.MULT_CLSRE_RSN_IND,
          T3.FRST_TM_APRVL_IND, T3.SYS_CLSRE_DNL_RSN,
          T3.RCRT_APL_DT, T2.OLD_MTHLY_RPTR_IND,
          T3.AID_CD_CHNG_DT, T3.PREV_AID_CD
        from TWNFAM_CASELD_CASE T1,
             TWNFAM_CASE_HSTRY T2,
             TWNPRGM_CASE_HSTRY T3
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.OFC_CD = :AME37W.WS-OFC-CD AND
        T1.PRGM_OFC_TYPE = 'A' AND
        T1.ICI = T2.ICI AND
        T2.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
        T2.PRD_END_DT >=  :AME37W.WS-RPT-END-DT AND
        T1.ICI = T3.ICI  AND
        T3.PRGM_CASE_TYPE = 'FS' AND
        T3.STS_EFF_DT >= :AME37W.WS-RPT-BEG-DT AND
        T3.STS_EFF_DT <= :AME37W.WS-RPT-END-DT AND
         --T3.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
         --T3.PRD_END_DT >=  :AME37W.WS-RPT-END-DT AND
        T3.CLSRE_RSN_CD = 'W'
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into OFC-CD, PRGM-OFC-TYPE, SPRVS-UNIT, PSN-NMB,
           FUNC-AREA-CD, WRKR-TYPE, CASLD-EFF-DT, ICI,
           CASLD-ID, T2-ICI, T2-PRD-BEG-DT, CASE-STS,
           MTHLY-RPTR-IND, AUTO-POST-IND, RESET-VRFN-IND,
           T2-PRD-END-DT, NMB-OF-DPNDS, HOH-UPI, APPL-UPI,
           PREV-HOH-UPI, HOH-UPI-CHNG-DT, AUTO-CLSRE-IND,
           VERF-DUE-DT, SBSDZ-IND,
           HSG-TYP-CD, NMB-OF-PA-PRSNS, FS-SUFX,
           VRFN-EXTN-IND, HMLS-IND, SPLZD-CD, T3-ICI,
           PRGM-CASE-TYPE, T3-PRD-BEG-DT, STS-EFF-DT,
           PRGM-CASE-STS, INIT-APPRVD-BY, EXPD-FS-RSN-CD,
           INIT-APRVL-TM, INIT-APRVL-DT, APPL-DT,
           REDET-FRQ, PRGM-EFF-DT, T3-PRD-END-DT,
           ADVR-ACTN-WVD-IND, DUPL-ASST-IND,
           ADVR-ACTN-WVD-DT, CLSRE-RSN-CD, RFRD-BY,
           EXFS-DSCVR-DT, TR-STRT-DT, TR-ADD-COVER-IND,
           TR-EXPRN-DT, AID-CD, PRIR-MDCAL-IND,
           ACTUL-APLD-DT, ELIG-CD, MULT-CLSRE-RSN-IND,
           FRST-TM-APRVL-IND, SYS-CLSRE-DNL-RSN,
           RCRT-APL-DT, OLD-MTHLY-RPTR-IND,
           AID-CD-CHNG-DT, PREV-AID-CD
      for H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S05


Function AME37P9-SETINQ-S06()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S06";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S06_RSI01
      with #sql{
        select T1.OFC_CD, T1.PRGM_OFC_TYPE, T1.SPRVS_UNIT,
          T1.PSN_NMB, T1.FUNC_AREA_CD, T1.WRKR_TYPE,
          T1.CASLD_EFF_DT, T1.ICI, T1.CASLD_ID, T2.ICI,
          T2.PRD_BEG_DT, T2.CASE_STS, T2.MTHLY_RPTR_IND,
          T2.AUTO_POST_IND, T2.RESET_VRFN_IND,
          T2.PRD_END_DT, T2.NMB_OF_DPNDS, T2.HOH_UPI,
          T2.APPL_UPI, T2.PREV_HOH_UPI,
          T2.HOH_UPI_CHNG_DT, T2.AUTO_CLSRE_IND,
          T2.VERF_DUE_DT,
          T2.SBSDZ_IND, T2.HSG_TYP_CD,
          T2.NMB_OF_PA_PRSNS, T2.FS_SUFX,
          T2.VRFN_EXTN_IND, T2.HMLS_IND, T2.SPLZD_CD,
          T3.ICI, T3.PRGM_CASE_TYPE, T3.PRD_BEG_DT,
          T3.STS_EFF_DT, T3.PRGM_CASE_STS,
          T3.INIT_APPRVD_BY, T3.EXPD_FS_RSN_CD,
          T3.INIT_APRVL_TM, T3.INIT_APRVL_DT, T3.APPL_DT,
          T3.REDET_FRQ, T3.PRGM_EFF_DT, T3.PRD_END_DT,
          T3.ADVR_ACTN_WVD_IND, T3.DUPL_ASST_IND,
          T3.ADVR_ACTN_WVD_DT, T3.CLSRE_RSN_CD,
          T3.RFRD_BY, T3.EXFS_DSCVR_DT, T3.TR_STRT_DT,
          T3.TR_ADD_COVER_IND, T3.TR_EXPRN_DT, T3.AID_CD,
          T3.PRIR_MDCAL_IND, T3.ACTUL_APLD_DT,
          T3.ELIG_CD, T3.MULT_CLSRE_RSN_IND,
          T3.FRST_TM_APRVL_IND, T3.SYS_CLSRE_DNL_RSN,
          T3.RCRT_APL_DT, T2.OLD_MTHLY_RPTR_IND,
          T3.AID_CD_CHNG_DT, T3.PREV_AID_CD
        from TWNFAM_CASELD_CASE T1,
             TWNFAM_CASE_HSTRY T2,
             TWNPRGM_CASE_HSTRY T3
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.OFC_CD = :AME37W.WS-OFC-CD AND
        T1.PRGM_OFC_TYPE = 'A' AND
        T1.ICI = T2.ICI AND
        T2.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
        T2.PRD_END_DT >=  :AME37W.WS-RPT-END-DT AND
        T1.ICI = T3.ICI  AND
        T3.PRGM_CASE_TYPE = 'FS' AND
        T3.STS_EFF_DT >= :AME37W.WS-RPT-BEG-DT AND
        T3.STS_EFF_DT <= :AME37W.WS-RPT-END-DT AND
         --T3.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
         --T3.PRD_END_DT >=  :AME37W.WS-RPT-END-DT AND
        T3.PRGM_CASE_STS = 'D' AND
        T3.CLSRE_RSN_CD <> 'W'
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into OFC-CD, PRGM-OFC-TYPE, SPRVS-UNIT, PSN-NMB,
           FUNC-AREA-CD, WRKR-TYPE, CASLD-EFF-DT, ICI,
           CASLD-ID, T2-ICI, T2-PRD-BEG-DT, CASE-STS,
           MTHLY-RPTR-IND, AUTO-POST-IND, RESET-VRFN-IND,
           T2-PRD-END-DT, NMB-OF-DPNDS, HOH-UPI, APPL-UPI,
           PREV-HOH-UPI, HOH-UPI-CHNG-DT, AUTO-CLSRE-IND,
           VERF-DUE-DT, SBSDZ-IND,
           HSG-TYP-CD, NMB-OF-PA-PRSNS, FS-SUFX,
           VRFN-EXTN-IND, HMLS-IND, SPLZD-CD, T3-ICI,
           PRGM-CASE-TYPE, T3-PRD-BEG-DT, STS-EFF-DT,
           PRGM-CASE-STS, INIT-APPRVD-BY, EXPD-FS-RSN-CD,
           INIT-APRVL-TM, INIT-APRVL-DT, APPL-DT,
           REDET-FRQ, PRGM-EFF-DT, T3-PRD-END-DT,
           ADVR-ACTN-WVD-IND, DUPL-ASST-IND,
           ADVR-ACTN-WVD-DT, CLSRE-RSN-CD, RFRD-BY,
           EXFS-DSCVR-DT, TR-STRT-DT, TR-ADD-COVER-IND,
           TR-EXPRN-DT, AID-CD, PRIR-MDCAL-IND,
           ACTUL-APLD-DT, ELIG-CD, MULT-CLSRE-RSN-IND,
           FRST-TM-APRVL-IND, SYS-CLSRE-DNL-RSN,
           RCRT-APL-DT, OLD-MTHLY-RPTR-IND,
           AID-CD-CHNG-DT, PREV-AID-CD
      for H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S06


Function AME37P9-SETINQ-S07()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S07";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S07_RSI01
      with #sql{
        select T1.OFC_CD, T1.PRGM_OFC_TYPE, T1.SPRVS_UNIT,
          T1.PSN_NMB, T1.FUNC_AREA_CD, T1.WRKR_TYPE,
          T1.CASLD_EFF_DT, T1.ICI, T1.CASLD_ID, T2.ICI,
          T2.PRD_BEG_DT, T2.CASE_STS, T2.MTHLY_RPTR_IND,
          T2.AUTO_POST_IND, T2.RESET_VRFN_IND,
          T2.PRD_END_DT, T2.NMB_OF_DPNDS, T2.HOH_UPI,
          T2.APPL_UPI, T2.PREV_HOH_UPI,
          T2.HOH_UPI_CHNG_DT, T2.AUTO_CLSRE_IND,
          T2.VERF_DUE_DT,
          T2.SBSDZ_IND, T2.HSG_TYP_CD,
          T2.NMB_OF_PA_PRSNS, T2.FS_SUFX,
          T2.VRFN_EXTN_IND, T2.HMLS_IND, T2.SPLZD_CD,
          T3.ICI, T3.PRGM_CASE_TYPE, T3.PRD_BEG_DT,
          T3.STS_EFF_DT, T3.PRGM_CASE_STS,
          T3.INIT_APPRVD_BY, T3.EXPD_FS_RSN_CD,
          T3.INIT_APRVL_TM, T3.INIT_APRVL_DT, T3.APPL_DT,
          T3.REDET_FRQ, T3.PRGM_EFF_DT, T3.PRD_END_DT,
          T3.ADVR_ACTN_WVD_IND, T3.DUPL_ASST_IND,
          T3.ADVR_ACTN_WVD_DT, T3.CLSRE_RSN_CD,
          T3.RFRD_BY, T3.EXFS_DSCVR_DT, T3.TR_STRT_DT,
          T3.TR_ADD_COVER_IND, T3.TR_EXPRN_DT, T3.AID_CD,
          T3.PRIR_MDCAL_IND, T3.ACTUL_APLD_DT,
          T3.ELIG_CD, T3.MULT_CLSRE_RSN_IND,
          T3.FRST_TM_APRVL_IND, T3.SYS_CLSRE_DNL_RSN,
          T3.RCRT_APL_DT, T2.OLD_MTHLY_RPTR_IND,
          T3.AID_CD_CHNG_DT, T3.PREV_AID_CD
        from TWNFAM_CASELD_CASE T1,
             TWNFAM_CASE_HSTRY T2,
             TWNPRGM_CASE_HSTRY T3
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.OFC_CD = :AME37W.WS-OFC-CD AND
        T1.PRGM_OFC_TYPE = 'A' AND
        T1.ICI = T2.ICI AND
        T2.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
        T2.PRD_END_DT >=  :AME37W.WS-RPT-END-DT AND
        T1.ICI = T3.ICI  AND
        T3.PRGM_CASE_TYPE = 'FS' AND
        T3.RCRT_APL_DT >= :AME37W.WS-RPT-BEG-DT AND
        T3.RCRT_APL_DT <= :AME37W.WS-RPT-END-DT AND
        T3.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
        T3.PRD_END_DT >=  :AME37W.WS-RPT-END-DT
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into OFC-CD, PRGM-OFC-TYPE, SPRVS-UNIT, PSN-NMB,
           FUNC-AREA-CD, WRKR-TYPE, CASLD-EFF-DT, ICI,
           CASLD-ID, T2-ICI, T2-PRD-BEG-DT, CASE-STS,
           MTHLY-RPTR-IND, AUTO-POST-IND, RESET-VRFN-IND,
           T2-PRD-END-DT, NMB-OF-DPNDS, HOH-UPI, APPL-UPI,
           PREV-HOH-UPI, HOH-UPI-CHNG-DT, AUTO-CLSRE-IND,
           VERF-DUE-DT, SBSDZ-IND,
           HSG-TYP-CD, NMB-OF-PA-PRSNS, FS-SUFX,
           VRFN-EXTN-IND, HMLS-IND, SPLZD-CD, T3-ICI,
           PRGM-CASE-TYPE, T3-PRD-BEG-DT, STS-EFF-DT,
           PRGM-CASE-STS, INIT-APPRVD-BY, EXPD-FS-RSN-CD,
           INIT-APRVL-TM, INIT-APRVL-DT, APPL-DT,
           REDET-FRQ, PRGM-EFF-DT, T3-PRD-END-DT,
           ADVR-ACTN-WVD-IND, DUPL-ASST-IND,
           ADVR-ACTN-WVD-DT, CLSRE-RSN-CD, RFRD-BY,
           EXFS-DSCVR-DT, TR-STRT-DT, TR-ADD-COVER-IND,
           TR-EXPRN-DT, AID-CD, PRIR-MDCAL-IND,
           ACTUL-APLD-DT, ELIG-CD, MULT-CLSRE-RSN-IND,
           FRST-TM-APRVL-IND, SYS-CLSRE-DNL-RSN,
           RCRT-APL-DT, OLD-MTHLY-RPTR-IND,
           AID-CD-CHNG-DT, PREV-AID-CD
      for H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S07


Function AME37P9-SETINQ-S08()
  VGVar.handleHardIOErrors = 1;
  VDBCOMMON.USQLREC = "H2-3-FAC-FCH-PSY";
  VDBCONTROL.UPROC-NM = "AME37P9-SETINQ-S08";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCONTROL.UPROC-OBJ = "H2-3-FAC-FCH-PSY";

  VDBCONTROL.UACCTYP = "R";
  try
    open AME37P9-SETINQ-S08_RSI01
      with #sql{
        select T1.OFC_CD, T1.PRGM_OFC_TYPE, T1.SPRVS_UNIT,
          T1.PSN_NMB, T1.FUNC_AREA_CD, T1.WRKR_TYPE,
          T1.CASLD_EFF_DT, T1.ICI, T1.CASLD_ID, T2.ICI,
          T2.PRD_BEG_DT, T2.CASE_STS, T2.MTHLY_RPTR_IND,
          T2.AUTO_POST_IND, T2.RESET_VRFN_IND,
          T2.PRD_END_DT, T2.NMB_OF_DPNDS, T2.HOH_UPI,
          T2.APPL_UPI, T2.PREV_HOH_UPI,
          T2.HOH_UPI_CHNG_DT, T2.AUTO_CLSRE_IND,
          T2.VERF_DUE_DT,
          T2.SBSDZ_IND, T2.HSG_TYP_CD,
          T2.NMB_OF_PA_PRSNS, T2.FS_SUFX,
          T2.VRFN_EXTN_IND, T2.HMLS_IND, T2.SPLZD_CD,
          T3.ICI, T3.PRGM_CASE_TYPE, T3.PRD_BEG_DT,
          T3.STS_EFF_DT, T3.PRGM_CASE_STS,
          T3.INIT_APPRVD_BY, T3.EXPD_FS_RSN_CD,
          T3.INIT_APRVL_TM, T3.INIT_APRVL_DT, T3.APPL_DT,
          T3.REDET_FRQ, T3.PRGM_EFF_DT, T3.PRD_END_DT,
          T3.ADVR_ACTN_WVD_IND, T3.DUPL_ASST_IND,
          T3.ADVR_ACTN_WVD_DT, T3.CLSRE_RSN_CD,
          T3.RFRD_BY, T3.EXFS_DSCVR_DT, T3.TR_STRT_DT,
          T3.TR_ADD_COVER_IND, T3.TR_EXPRN_DT, T3.AID_CD,
          T3.PRIR_MDCAL_IND, T3.ACTUL_APLD_DT,
          T3.ELIG_CD, T3.MULT_CLSRE_RSN_IND,
          T3.FRST_TM_APRVL_IND, T3.SYS_CLSRE_DNL_RSN,
          T3.RCRT_APL_DT, T2.OLD_MTHLY_RPTR_IND,
          T3.AID_CD_CHNG_DT, T3.PREV_AID_CD
        from TWNFAM_CASELD_CASE T1,
             TWNFAM_CASE_HSTRY T2,
             TWNPRGM_CASE_HSTRY T3
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE T1.OFC_CD = :AME37W.WS-OFC-CD AND
        T1.PRGM_OFC_TYPE = 'A' AND
        T1.ICI = T2.ICI AND
        T2.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
        T2.PRD_END_DT >=  :AME37W.WS-RPT-END-DT AND
        T1.ICI = T3.ICI  AND
        T3.PRGM_CASE_TYPE = 'FS' AND
        T3.PRD_BEG_DT <=  :AME37W.WS-RPT-END-DT AND
        T3.PRD_END_DT >=  :AME37W.WS-RPT-END-DT and
        T3.STS_EFF_DT >= :AME37W.WS-RPT-BEG-DT AND
        T3.STS_EFF_DT <= :AME37W.WS-RPT-END-DT AND
        T3.PRGM_CASE_STS = 'T'
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into OFC-CD, PRGM-OFC-TYPE, SPRVS-UNIT, PSN-NMB,
           FUNC-AREA-CD, WRKR-TYPE, CASLD-EFF-DT, ICI,
           CASLD-ID, T2-ICI, T2-PRD-BEG-DT, CASE-STS,
           MTHLY-RPTR-IND, AUTO-POST-IND, RESET-VRFN-IND,
           T2-PRD-END-DT, NMB-OF-DPNDS, HOH-UPI, APPL-UPI,
           PREV-HOH-UPI, HOH-UPI-CHNG-DT, AUTO-CLSRE-IND,
           VERF-DUE-DT, SBSDZ-IND,
           HSG-TYP-CD, NMB-OF-PA-PRSNS, FS-SUFX,
           VRFN-EXTN-IND, HMLS-IND, SPLZD-CD, T3-ICI,
           PRGM-CASE-TYPE, T3-PRD-BEG-DT, STS-EFF-DT,
           PRGM-CASE-STS, INIT-APPRVD-BY, EXPD-FS-RSN-CD,
           INIT-APRVL-TM, INIT-APRVL-DT, APPL-DT,
           REDET-FRQ, PRGM-EFF-DT, T3-PRD-END-DT,
           ADVR-ACTN-WVD-IND, DUPL-ASST-IND,
           ADVR-ACTN-WVD-DT, CLSRE-RSN-CD, RFRD-BY,
           EXFS-DSCVR-DT, TR-STRT-DT, TR-ADD-COVER-IND,
           TR-EXPRN-DT, AID-CD, PRIR-MDCAL-IND,
           ACTUL-APLD-DT, ELIG-CD, MULT-CLSRE-RSN-IND,
           FRST-TM-APRVL-IND, SYS-CLSRE-DNL-RSN,
           RCRT-APL-DT, OLD-MTHLY-RPTR-IND,
           AID-CD-CHNG-DT, PREV-AID-CD
      for H2-3-FAC-FCH-PSY ;
  end
  VDBCONTROL.URC = 0;
  if (sysVar.sqlData.sqlcode != 0)
    REPP9-SQL-CHKERR();
  end
  /*  */
end // end AME37P9-SETINQ-S08


// POPULATING REPT STATE TOTALS
Function AME37P9-ST-TOTS()
  /* cbsi start*/

  /* get totals of all offices in the state*/

  AME37W1.WS-ST-PACASES = AME37W1.WS-ST-PACASES + AME37W.WS-PACASES;
  AME37W1.WS-ST-NACASES = AME37W1.WS-ST-NACASES + AME37W.WS-NACASES;
  AME37W1.WS-ST-GRNDTOT = AME37W1.WS-ST-PACASES + AME37W1.WS-ST-NACASES;

  AME37W1.WS-ST-PAEXPCASE = AME37W1.WS-ST-PAEXPCASE + AME37W.WS-PAEXPCASE;
  AME37W1.WS-ST-NAEXPCASE = AME37W1.WS-ST-NAEXPCASE + AME37W.WS-NAEXPCASE;
  AME37W1.WS-ST-SUBTOTEX = AME37W1.WS-ST-PAEXPCASE   + AME37W1.WS-ST-NAEXPCASE;

  AME37W1.WS-ST-PADAMS = AME37W1.WS-ST-PADAMS + AME37W.WS-PADAMS;
  AME37W1.WS-ST-NADAMS = AME37W1.WS-ST-NADAMS + AME37W.WS-NADAMS;
  AME37W1.WS-ST-SUBTOTDM = AME37W1.WS-ST-PADAMS + AME37W1.WS-ST-NADAMS;

  AME37W1.WS-ST-PASPHNDL = AME37W1.WS-ST-PASPHNDL + AME37W.WS-PASPHNDL;
  AME37W1.WS-ST-NASPHNDL = AME37W1.WS-ST-NASPHNDL + AME37W.WS-NASPHNDL;
  AME37W1.WS-ST-SUBTOTSP = AME37W1.WS-ST-PASPHNDL + AME37W1.WS-ST-NASPHNDL;

  AME37W1.WS-ST-PAEBTCASE = AME37W1.WS-ST-PAEBTCASE + AME37W.WS-PAEBTCASE;
  AME37W1.WS-ST-NAEBTCASE = AME37W1.WS-ST-NAEBTCASE + AME37W.WS-NAEBTCASE;
  AME37W1.WS-ST-SUBTOTEBT = AME37W1.WS-ST-PAEBTCASE +   AME37W1.WS-ST-NAEBTCASE;

  AME37W1.WS-ST-PALMISS = AME37W1.WS-ST-PALMISS + AME37W.WS-PALMISS;
  AME37W1.WS-ST-NALMISS = AME37W1.WS-ST-NALMISS + AME37W.WS-NALMISS;
  AME37W1.WS-ST-SUBTOTIS = AME37W1.WS-ST-PALMISS + AME37W1.WS-ST-NALMISS;

  AME37W1.WS-ST-PAREVISED = AME37W1.WS-ST-PAREVISED + AME37W.WS-PAREVISED;
  AME37W1.WS-ST-NAREVISED = AME37W1.WS-ST-NAREVISED + AME37W.WS-NAREVISED;
  AME37W1.WS-ST-SUBTOTREV = AME37W1.WS-ST-PAREVISED   + AME37W1.WS-ST-NAREVISED;

  if (AME37W1.WS-ST-PACASES != 0)
    AME37W1.WS-ST-PARETRO = mathLib.round((AME37W1.WS-ST-PALMISS * 100)     / AME37W1.WS-ST-PACASES, -mathLib.decimals(AME37W1.WS-ST-PARETRO));
  else
    AME37W1.WS-ST-PARETRO = 0;
  end

  if (AME37W1.WS-ST-NACASES != 0)
    AME37W1.WS-ST-NARETRO = mathLib.round((AME37W1.WS-ST-NALMISS * 100)     / AME37W1.WS-ST-NACASES, -mathLib.decimals(AME37W1.WS-ST-NARETRO));
  else
    AME37W1.WS-ST-NARETRO = 0;
  end

  if (AME37W1.WS-ST-GRNDTOT != 0)
    AME37W1.WS-ST-SUBTOTRET = mathLib.round((AME37W1.WS-ST-SUBTOTIS * 100) /     AME37W1.WS-ST-GRNDTOT, -mathLib.decimals(AME37W1.WS-ST-SUBTOTRET));
  else
    AME37W1.WS-ST-SUBTOTRET = 0;
  end

  AME37W1.WS-ST-PAEST = mathLib.round(AME37W1.WS-ST-PACASES +   (AME37W1.WS-ST-PARETRO * AME37W1.WS-ST-PACASES) / 100, -mathLib.decimals(AME37W1.WS-ST-PAEST));
  AME37W1.WS-ST-NAEST = mathLib.round(AME37W1.WS-ST-NACASES +   (AME37W1.WS-ST-NARETRO * AME37W1.WS-ST-NACASES) / 100, -mathLib.decimals(AME37W1.WS-ST-NAEST));
  AME37W1.WS-ST-GRNDTOTES = AME37W1.WS-ST-PAEST + AME37W1.WS-ST-NAEST;

  AME37W1.WS-ST-PABNFT = AME37W1.WS-ST-PABNFT + AME37W.WS-PABNFT;
  AME37W1.WS-ST-NABNFT = AME37W1.WS-ST-NABNFT + AME37W.WS-NABNFT;
  AME37W1.WS-ST-SUBTOTBN = AME37W1.WS-ST-PABNFT + AME37W1.WS-ST-NABNFT;

  AME37W1.WS-ST-PAPART = AME37W1.WS-ST-PAPART + AME37W.WS-PAPART;
  AME37W1.WS-ST-NAPART = AME37W1.WS-ST-NAPART + AME37W.WS-NAPART;
  AME37W1.WS-ST-SUBTOTPRT = AME37W1.WS-ST-PAPART + AME37W1.WS-ST-NAPART;

  AME37W1.WS-ST-PAAPPRV = AME37W1.WS-ST-PAAPPRV + AME37W.WS-PAAPPRV;
  AME37W1.WS-ST-NAAPPRV = AME37W1.WS-ST-NAAPPRV + AME37W.WS-NAAPPRV;
  AME37W1.WS-ST-SUBTOTAP = AME37W1.WS-ST-PAAPPRV + AME37W1.WS-ST-NAAPPRV;

  AME37W1.WS-ST-PAWTDR = AME37W1.WS-ST-PAWTDR + AME37W.WS-PAWTDR;
  AME37W1.WS-ST-NAWTDR = AME37W1.WS-ST-NAWTDR + AME37W.WS-NAWTDR;
  AME37W1.WS-ST-SUBTOTWD = AME37W1.WS-ST-PAWTDR + AME37W1.WS-ST-NAWTDR;

  AME37W1.WS-ST-PADENY = AME37W1.WS-ST-PADENY + AME37W.WS-PADENY;
  AME37W1.WS-ST-NADENY = AME37W1.WS-ST-NADENY + AME37W.WS-NADENY;
  AME37W1.WS-ST-SUBTOTDNY = AME37W1.WS-ST-PADENY + AME37W1.WS-ST-NADENY;

  AME37W1.WS-ST-PANCOOP = AME37W1.WS-ST-PANCOOP + AME37W.WS-PANCOOP;
  AME37W1.WS-ST-NANCOOP = AME37W1.WS-ST-NANCOOP + AME37W.WS-NANCOOP;
  AME37W1.WS-ST-SUBTOTNC = AME37W1.WS-ST-PANCOOP + AME37W1.WS-ST-NANCOOP;

  AME37W1.WS-ST-PAQUIT = AME37W1.WS-ST-PAQUIT + AME37W.WS-PAQUIT;
  AME37W1.WS-ST-NAQUIT = AME37W1.WS-ST-NAQUIT + AME37W.WS-NAQUIT;
  AME37W1.WS-ST-SUBTOTQT = AME37W1.WS-ST-PAQUIT + AME37W1.WS-ST-NAQUIT;

  AME37W1.WS-ST-PARSRC = AME37W1.WS-ST-PARSRC + AME37W.WS-PARSRC;
  AME37W1.WS-ST-NARSRC = AME37W1.WS-ST-NARSRC + AME37W.WS-NARSRC;
  AME37W1.WS-ST-SUBTOTRC = AME37W1.WS-ST-PARSRC + AME37W1.WS-ST-NARSRC;

  AME37W1.WS-ST-PAOTHR = AME37W1.WS-ST-PAOTHR + AME37W.WS-PAOTHR;
  AME37W1.WS-ST-NAOTHR = AME37W1.WS-ST-NAOTHR + AME37W.WS-NAOTHR;
  AME37W1.WS-ST-SUBTOTOTH = AME37W1.WS-ST-PAOTHR + AME37W1.WS-ST-NAOTHR;

  AME37W1.WS-ST-PATOT = AME37W1.WS-ST-PATOT + AME37W.WS-PATOT;
  AME37W1.WS-ST-NATOT = AME37W1.WS-ST-NATOT + AME37W.WS-NATOT;
  AME37W1.WS-ST-SUBTOTTOT = AME37W1.WS-ST-PATOT + AME37W1.WS-ST-NATOT;

  AME37W1.WS-ST-PAAPPL = AME37W1.WS-ST-PAAPPL + AME37W.WS-PAAPPL;
  AME37W1.WS-ST-NAAPPL = AME37W1.WS-ST-NAAPPL + AME37W.WS-NAAPPL;
  AME37W1.WS-ST-GRNTOTAPP = AME37W1.WS-ST-PAAPPL + AME37W1.WS-ST-NAAPPL;

  AME37W1.WS-ST-PANEW = AME37W1.WS-ST-PANEW + AME37W.WS-PANEW;
  AME37W1.WS-ST-NANEW = AME37W1.WS-ST-NANEW + AME37W.WS-NANEW;
  AME37W1.WS-ST-SUBTOTNEW = AME37W1.WS-ST-PANEW + AME37W1.WS-ST-NANEW;

  AME37W1.WS-ST-PASUBS = AME37W1.WS-ST-PASUBS + AME37W.WS-PASUBS;
  AME37W1.WS-ST-NASUBS = AME37W1.WS-ST-NASUBS + AME37W.WS-NASUBS;
  AME37W1.WS-ST-SUBTOTSUBS = AME37W1.WS-ST-PASUBS + AME37W1.WS-ST-NASUBS;

  AME37W1.WS-ST-PAPNDMTH = AME37W1.WS-ST-PAPNDMTH + AME37W.WS-PAPNDMTH;
  AME37W1.WS-ST-NAPNDMTH = AME37W1.WS-ST-NAPNDMTH + AME37W.WS-NAPNDMTH;
  AME37W1.WS-ST-SUBTOTPNDMTH = AME37W1.WS-ST-PAPNDMTH +   AME37W1.WS-ST-NAPNDMTH;

  AME37W1.WS-ST-PAAPPRVMTH = AME37W1.WS-ST-PAAPPRVMTH   + AME37W.WS-PAAPPRVMTH;
  AME37W1.WS-ST-NAAPPRVMTH = AME37W1.WS-ST-NAAPPRVMTH   + AME37W.WS-NAAPPRVMTH;
  AME37W1.WS-ST-SUBTOTAPMTH = AME37W1.WS-ST-PAAPPRVMTH +   AME37W1.WS-ST-NAAPPRVMTH;

  AME37W1.WS-ST-PADNYWDMTH = AME37W1.WS-ST-PADNYWDMTH   + AME37W.WS-PADNYWDMTH;
  AME37W1.WS-ST-NADNYWDMTH = AME37W1.WS-ST-NADNYWDMTH   + AME37W.WS-NADNYWDMTH;
  AME37W1.WS-ST-SUBTOTDNYWD = AME37W1.WS-ST-PADNYWDMTH +   AME37W1.WS-ST-NADNYWDMTH;

  AME37W1.WS-ST-PAAPPLMTH = AME37W1.WS-ST-PAAPPLMTH   + AME37W.WS-PAAPPLMTH;
  AME37W1.WS-ST-NAAPPLMTH = AME37W1.WS-ST-NAAPPLMTH   + AME37W.WS-NAAPPLMTH;
  AME37W1.WS-ST-GRNTOTAPPMTH = AME37W1.WS-ST-PAAPPLMTH   + AME37W1.WS-ST-NAAPPLMTH;


  AME37W1.WS-ST-PATERM = AME37W1.WS-ST-PATERM + AME37W.WS-PATERM;
  AME37W1.WS-ST-NATERM = AME37W1.WS-ST-NATERM + AME37W.WS-NATERM;
  AME37W1.WS-ST-SUBTOTTRM = AME37W1.WS-ST-PATERM + AME37W1.WS-ST-NATERM;

  AME37W1.WS-ST-PAMRC = AME37W1.WS-ST-PAMRC + AME37W.WS-PAMRC;
  AME37W1.WS-ST-NAMRC = AME37W1.WS-ST-NAMRC + AME37W.WS-NAMRC;
  AME37W1.WS-ST-SUBTOTMRC = AME37W1.WS-ST-PAMRC + AME37W1.WS-ST-NAMRC;

  AME37W1.WS-ST-DMI0 = AME37W1.WS-ST-DMI0 + AME37W.WS-DMI0;
  AME37W1.WS-ST-DMI1 = AME37W1.WS-ST-DMI1 + AME37W.WS-DMI1;
  AME37W1.WS-ST-DMI2 = AME37W1.WS-ST-DMI2 + AME37W.WS-DMI2;
  AME37W1.WS-ST-DMI3 = AME37W1.WS-ST-DMI3 + AME37W.WS-DMI3;
  AME37W1.WS-ST-DMI4 = AME37W1.WS-ST-DMI4 + AME37W.WS-DMI4;
  AME37W1.WS-ST-DMI5 = AME37W1.WS-ST-DMI5 + AME37W.WS-DMI5;
  AME37W1.WS-ST-DMI6 = AME37W1.WS-ST-DMI6 + AME37W.WS-DMI6;
  AME37W1.WS-ST-DMIEBT = AME37W1.WS-ST-DMIEBT + AME37W.WS-DMIEBT;

  /* cbsi end*/
end // end AME37P9-ST-TOTS