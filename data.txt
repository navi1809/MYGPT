private void populateQ43AndQ45(SnapCharacteristicRecord record, List<BenefitsCaseProgramHistorySorRecord> programHistory, List<CaseActionSorRecord> dnActions) {
    for (CaseActionSorRecord ca : dnActions) {
        programHistory.stream()
            .filter(h -> h.getIci() == ca.getIci())
            .filter(h -> !h.getProgramEffectiveDate().after(ca.getActionTimeStamp())
                      && !h.getEffectiveEndDate().before(ca.getActionTimeStamp()))
            .findFirst()
            .ifPresent(h -> {
                Date appl = h.getApplicationReceivedDate();
                if (appl != null) {
                    LocalDate actionDate = ca.getActionTimeStamp().toLocalDateTime().toLocalDate();
                    LocalDate applDate = convertUtilDateToLocalDate(appl);
                    int dateDiff = dateDiff(actionDate, applDate);
                    dateDiff = actionDate.isBefore(applDate) ? 1 : dateDiff + 1;
                    record.setDiffDDays(record.getDiffDDays() + dateDiff);
                    record.setDiffDays(record.getDiffDays() + dateDiff);
                    record.setIciDCount(record.getIciDCount() + 1);
                    record.setIciADCount(record.getIciADCount() + 1);
                }
            });
    }
}
