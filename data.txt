// Keep only CURRENT rows from ARX04A run; historic/initial rows don’t block an insert in AMA46A
List<ReportMonthlyCaseHistorySorRecord> pceCurrent = pceRecords.stream()
    .filter(r -> {
        String ici = (r.getIci() == null ? "" : r.getIci().trim().toUpperCase());
        return "C".equals(ici);   // <-- adjust if your “current” code differs
    })
    .collect(java.util.stream.Collectors.toList());

pceRecords = pceCurrent; // use this list for building pceDistinct
