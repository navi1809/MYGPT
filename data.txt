import pyautogui
import time
import subprocess
import platform

def keep_system_active():
    """Simulate periodic mouse movement to keep the system active."""
    while True:
        # Simulate small mouse movement
        pyautogui.move(10, 0, duration=0.2)
        pyautogui.move(-10, 0, duration=0.2)
        time.sleep(300)  # Wait 5 minutes before moving again

def open_and_focus_app(app_name):
    """Ensure the specified application is running and brought to focus."""
    os_type = platform.system()
    if os_type == "Windows":
        subprocess.run(f'start {app_name}', shell=True)
    elif os_type == "Darwin":  # macOS
        subprocess.run(["open", "-a", app_name])
    elif os_type == "Linux":
        subprocess.run(["xdg-open", app_name])

def keep_teams_zoom_active():
    """Simulate activity in Teams and Zoom."""
    apps = ["Teams", "Zoom"]
    for app in apps:
        open_and_focus_app(app)
        time.sleep(5)  # Wait for app to open
        pyautogui.typewrite(" ")
        time.sleep(5)

if __name__ == "__main__":
    try:
        keep_system_active()
        keep_teams_zoom_active()
    except KeyboardInterrupt:
        print("Program terminated by user.")
