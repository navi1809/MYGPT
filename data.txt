// *******************************************************************************
// Scriptable Batch Config
// Customer: DWSS Nevada

// Load Business Object - Business Object to use
var BOresourceId = xpath.numberValueOf("/DocumentRequest/JOB_DETAILS/BUSINESSOBJECT_ID");
var OPConfigID = 206800145;

var bo = xpath.loadBO("/DocumentRequest", BOresourceId, 1, "DocumentRequestType");

var DOCTYPE = "PRIMARY"; // Set default recipient to primary
var channelCount = 0; // Used for setting thunderhead channel job properties

// Set language, this section sets the language for the primary recipient. 
//var primaryLanguage = bo.JOB_DETAILS.PRIMARY_LANG_CD;
//Additional Code for NOD
var primaryLanguage = bo.JOB_DETAILS.PRIMARY_LANG_CD;

var language = 5; // 5 is for English (United States)
// Setting Language  "02" indicates Spanish
if (primaryLanguage == "02"){
  language = 6; // 6 is for Spanish
}
if (primaryLanguage == "03"){
  language = 157600097; // 157600097 is for Arabic
}

// Reset Job Setup to clear it before adding anything to the job
job.reset();
setPrint();
setArgs();
job.submit();

function setPrint()
{
  job.addChannel(2, -5);
  job.setChannelProperty(channelCount, "print.jobsetup", "Print");
  job.setChannelProperty(channelCount, "Feed1", "false");
  job.setChannelProperty(channelCount, "Feed2", "false");
  job.setChannelProperty(channelCount, "Feed3", "false");
  job.setChannelProperty(channelCount, "language", language);
  channelCount+=1;
}


function setArgs()
{
 if (bo.JOB_DETAILS.TEMPLATE_ID == "983003172"){ 
  job.setTemplate(bo.JOB_DETAILS.TEMPLATE_ID);
 } else {
  job.setTemplate(bo.JOB_DETAILS.TEMPLATE_ID); 	
 } 
  job.setArg("DocumentRequest", bo);
  job.setLanguage(language);
}