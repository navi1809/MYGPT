package gov.illinois.ies.business.rules.al;

import java.sql.Connection;
import java.sql.Timestamp;
import java.util.HashMap;
import java.util.Map;
import gov.illinois.fw.business.exceptions.TIERSRunTimeException;
import gov.illinois.ies.business.rules.mu.IMassUpdate;
import gov.illinois.ies.business.rules.mu.MUFactory;

/**
*This class is used by alert batch programs to insert Mass Update Triggers.
* @author	Deloitte
* @version	%Revision%
*/
public class AlMassUpdateManager {
	/**
	 * Field conn.
	 */
	private Connection conn;

    /**
     * Default Constructor 
     */
	public AlMassUpdateManager() {
		super();
	}

	/**
	*Constructor
	* @param aConn Connection*/
	public AlMassUpdateManager(Connection aConn) {
		this.conn = aConn;
	}

	/**
	*This method inserts a mass update trigger.
	* @param triggerCd String
	* @param caseNum long
	* @param runDt Timestamp
	* @param reqUserId String
	* @throws TIERSRunTimeException 
	**/
	public void insertMassUpdateTrigger(
		String triggerCd,
		long caseNum,
		Timestamp runDt,
		String reqUserId)
		throws TIERSRunTimeException {
		try {
			IMassUpdate imu = MUFactory.getinstance();
			Map muTriggerData = new HashMap();
			muTriggerData.put("TRIGGER_CD", triggerCd);
			muTriggerData.put("SCHD_RUN_DT", runDt);
			muTriggerData.put("REQUEST_USER_ID", reqUserId);
			muTriggerData.put("CASE_NUM", new Long(caseNum));
			muTriggerData.put("CONNECTION", conn);
			imu.addTrigger(muTriggerData);
		} catch (Exception e) {
			throw new TIERSRunTimeException(
				"insertMassUpdateTrigger failed in AlMassUpdateManager ", e);
		}
	}
	/**
	 * This method inserts the mass update trigger with all type of exceptions thrown to caller method
	 * @param triggerCd
	 * @param caseNum
	 * @param runDt
	 * @param reqUserId
	 * @throws Exception
	 */
	public void insertAgeRelatedMassUpdateTrigger(
			String triggerCd,
			long caseNum,
			Timestamp runDt,
			String reqUserId)
			throws Exception {
			try {
				IMassUpdate imu = MUFactory.getinstance();
				Map muTriggerData = new HashMap();
				muTriggerData.put("TRIGGER_CD", triggerCd);
				muTriggerData.put("SCHD_RUN_DT", runDt);
				muTriggerData.put("REQUEST_USER_ID", reqUserId);
				muTriggerData.put("CASE_NUM", new Long(caseNum));
				muTriggerData.put("CONNECTION", conn);
				imu.addTrigger(muTriggerData);
			} catch (Exception e) {
				throw e;
			}
		}
}
