package gov.illinois.access.business.rules;

import gov.illinois.access.business.customEntities.APP_ABS_PRNT_Cust_Cargo;
import gov.illinois.access.business.customEntities.APP_ABS_PRNT_Cust_Collection;
import gov.illinois.access.business.customEntities.INDIVIDUAL_Custom_Cargo;
import gov.illinois.access.business.customEntities.INDIVIDUAL_Custom_Collection;
import gov.illinois.access.business.entities.APP_HSHL_RLT_Cargo;
import gov.illinois.access.business.entities.APP_HSHL_RLT_Collection;
import gov.illinois.access.business.entities.APP_INDV_Cargo;
import gov.illinois.access.business.entities.APP_INDV_Collection;
import gov.illinois.access.business.entities.APP_IN_DABL_Cargo;
import gov.illinois.access.business.entities.APP_IN_DABL_Collection;
import gov.illinois.access.business.entities.APP_IN_INST_Cargo;
import gov.illinois.access.business.entities.APP_IN_INST_Collection;
import gov.illinois.access.business.entities.APP_IN_PREG_Cargo;
import gov.illinois.access.business.entities.APP_IN_PREG_Collection;
import gov.illinois.access.business.entities.APP_IN_PRFL_Cargo;
import gov.illinois.access.business.entities.APP_IN_PRFL_Collection;
import gov.illinois.access.business.entities.APP_PGM_RQST_Cargo;
import gov.illinois.access.business.entities.APP_PGM_RQST_Collection;
import gov.illinois.access.business.entities.APP_RQST_Cargo;
import gov.illinois.access.business.entities.APP_RQST_Collection;
import gov.illinois.access.business.entities.NO_ONE_Cargo;
import gov.illinois.access.business.entities.NO_ONE_Collection;
import gov.illinois.access.business.entities.SS_RIDP_DET_Cargo;
import gov.illinois.access.business.entities.SS_RIDP_DET_Collection;
import gov.illinois.access.management.constants.AppConstants;
import gov.illinois.access.management.individuals.PeopleHandler;
import gov.illinois.access.management.programs.FwProgramManager;
import gov.illinois.access.management.programs.IProgramManager;
import gov.illinois.access.management.rules.RulesBO;
import gov.illinois.framework.driver.FwPageManager;
import gov.illinois.framework.driver.IPage;
import gov.illinois.framework.exceptions.FwException;
import gov.illinois.framework.management.constants.FwConstants;
import gov.illinois.framework.management.logging.ILog;
import gov.illinois.framework.management.messages.FwMessageList;
import gov.illinois.framework.management.messages.FwMessageTextLabel;
import gov.illinois.framework.management.util.FwDataCriteria;
import gov.illinois.framework.management.util.FwMessageFormatter;
import gov.illinois.ies.business.services.clearances.ClearanceInformationResponseVO;
import gov.illinois.ies.business.services.clearances.IndvClearanceInformationVO;

import java.text.DateFormat;
import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.List;
import java.util.Map;

import javax.xml.datatype.XMLGregorianCalendar;

/**
* ABHouseholdMembersSummaryBO - Business Object
* skeleton auto generated - Architecture Team
* @Creation Date :Tue Dec 27 11:22:35 CST 2005
* Modified By:
* Modified on:
*/
public class ABHouseholdMembersSummaryBO extends AFBBO  {

	/**
	* Constructor
	*/
	 public ABHouseholdMembersSummaryBO() {}

	/**
	* Method description here
	*/
	public void storeHouseholdMemberSummary() {

		try {
			
			// SEC-1343: Below piece of code is added to satisfy Fortify tool complaining empty try-catch block.
			// Please remove this code when you have something to write here.
			int a = 0, b = 0, c = a + b;
			log(ILog.INFO, "Unused variable value: " + c);

		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "storeHouseholdMemberSummary", e);
			throw fe;
		}
	}
	/**
	* This method loads the household individual information from database
	* @param appNumber java.lang.String
	* @return appIndvCollection gov.wisconsin.access.business.entities.APP_INDV_Collection
	* @author govinpr
	*/
	public APP_INDV_Collection loadHouseholdMembers(String appNumber) {

		try {
			APP_INDV_Collection appIndvCollection = new APP_INDV_Collection();
			Map criteriaMap = new HashMap();
			FwDataCriteria[] criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			APP_INDV_Cargo[] cargoArray = (APP_INDV_Cargo[])appIndvCollection.select(FwConstants.DAO, criteriaMap);
			appIndvCollection.setResults(cargoArray);
			return appIndvCollection;

		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdMembers", e);
			throw fe;
		}
	}
	
	/**
	* Validates Household members summary page questions page on submit
	* @param pageAppInPrflCollection gov.wisconsin.access.business.entities.APP_IN_PRFL_Collection
	* @param sessionAppInPrflCollection gov.wisconsin.access.business.entities.APP_IN_PRFL_Collection
	* @param noOneCollection gov.wisconsin.access.business.entities.NO_ONE_Collection
	* @author govinpr
	*/
	public void validateQuestions(APP_IN_PRFL_Collection pageAppInPrflCollection, NO_ONE_Collection noOneCollection, Map noOneCheckedMap) {
		try{
			int noOneCollectionSize = 0;
			int pageAppInPrflCollectionSize = 0;

			if(noOneCollection != null){
				noOneCollectionSize = noOneCollection.size();
			}
			if(pageAppInPrflCollection != null){
				pageAppInPrflCollectionSize = pageAppInPrflCollection.size();
			}

			//checking for noOne clicked validation
			boolean disabilityFlag = false;
			boolean drugFelonFlag = false;
    		// Added for ILIES-129516
			boolean drugTrtPrgFlag = false;
			boolean parPrbViolFlag = false;
			boolean fsBenefitsFlag = false;
			//Added by Uma for SS Expansion
			boolean ssiBenefitFlag = false;
			boolean cashBenefitFlag = false;
			
			for(int i = 0; i < pageAppInPrflCollectionSize; i++) {
				APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) pageAppInPrflCollection.get(i);				
					for(int j = 0; j < noOneCollectionSize; j++) {
					NO_ONE_Cargo noOneCargo = (NO_ONE_Cargo) noOneCollection.getResult(j);
					if ( noOneCargo.getNo_one_name().equals("Disablity") && appInCargo.getDabl_resp() != null && !disabilityFlag) {
						noOneCheckedMap.put("NO_ONE_CHECKED_56", FwConstants.YES);
						disabilityFlag = true;
					}
					if (noOneCargo.getNo_one_name().equals("DrugFelon") && appInCargo.getDrug_feln_resp() != null && !drugFelonFlag) {
						noOneCheckedMap.put("NO_ONE_CHECKED_58", FwConstants.YES);
						drugFelonFlag = true;
					}
	        		// Added for ILIES-129516 - Starts
					if (noOneCargo.getNo_one_name().equals("DrugTrtPrg") && appInCargo.getDrug_trtmnt_prg_resp() != null && !drugTrtPrgFlag) {
						noOneCheckedMap.put("NO_ONE_CHECKED_5218", FwConstants.YES);
						drugTrtPrgFlag = true;
					}
					if (noOneCargo.getNo_one_name().equals("ParPrbViol") && appInCargo.getParole_prob_viol_resp() != null && !parPrbViolFlag) {
						noOneCheckedMap.put("NO_ONE_CHECKED_5219", FwConstants.YES);
						parPrbViolFlag = true;
					}
	        		// Added for ILIES-129516 - Ends
					if (noOneCargo.getNo_one_name().equals("FoodStampBenefits") && appInCargo.getRcv_fs_oth_st_resp() != null && !fsBenefitsFlag) {
						noOneCheckedMap.put("NO_ONE_CHECKED_41", FwConstants.YES);
						fsBenefitsFlag = true;
					}	
					//Added by Uma for AFB Expansion for SSI and cash Gatepost Questions
					if (noOneCargo.getNo_one_name().equals("SSIB") && appInCargo.getSsi_benefit_resp() != null && !ssiBenefitFlag) {
						noOneCheckedMap.put("NO_ONE_CHECKED_418", FwConstants.YES);
						ssiBenefitFlag = true;
					}
					if (noOneCargo.getNo_one_name().equals("CASHB") && appInCargo.getCash_benefit_resp() != null && !cashBenefitFlag) {
						noOneCheckedMap.put("NO_ONE_CHECKED_419", FwConstants.YES);
						cashBenefitFlag = true;
					}
				}
			}
			if(disabilityFlag){
				Object[] msgs = {new FwMessageTextLabel("32156"), new FwMessageTextLabel("10041"), new FwMessageTextLabel("10041")};
				this.addMessageWithFieldValues("20019", msgs);
			}
			if(drugFelonFlag){
				Object[] msgs = {new FwMessageTextLabel("32157"), new FwMessageTextLabel("10041"), new FwMessageTextLabel("10041")};
				this.addMessageWithFieldValues("20019", msgs);
			}
    		// Added for ILIES-129516 - Starts
			if(drugTrtPrgFlag){
				Object[] msgs = {new FwMessageTextLabel("32157"), new FwMessageTextLabel("10041"), new FwMessageTextLabel("10041")};
				this.addMessageWithFieldValues("20019", msgs);
			}
			if(parPrbViolFlag){
				Object[] msgs = {new FwMessageTextLabel("32157"), new FwMessageTextLabel("10041"), new FwMessageTextLabel("10041")};
				this.addMessageWithFieldValues("20019", msgs);
			}
    		// Added for ILIES-129516 - Ends
			if(fsBenefitsFlag){
				Object[] msgs = {new FwMessageTextLabel("32191"), new FwMessageTextLabel("10041"), new FwMessageTextLabel("10041")};
				this.addMessageWithFieldValues("20019", msgs);
			}
			if(ssiBenefitFlag){
				Object[] msgs = {new FwMessageTextLabel("81100"), new FwMessageTextLabel("10041"), new FwMessageTextLabel("10041")};
				this.addMessageWithFieldValues("20019", msgs);
			}
			if(cashBenefitFlag){
				Object[] msgs = {new FwMessageTextLabel("81101"), new FwMessageTextLabel("10041"), new FwMessageTextLabel("10041")};
				this.addMessageWithFieldValues("20019", msgs);
			}
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "validateQuestions", e);
			throw fe;
		}
	}
	
	//ILIES-273207 - Compare selection of programs on summary screen to apply for benefit screen(first screen).
	public void validateIndividualProgramSelection(String appNum, APP_IN_PRFL_Collection appInPrflCol, String language) {

		APP_PGM_RQST_Collection appPgmColl = new APP_PGM_RQST_Collection();
		Map criteriaMap = new HashMap();
		FwDataCriteria[] criteria = new FwDataCriteria[1];
		criteria[0] = new FwDataCriteria();
		criteria[0].setColumn_name("APP_NUM");
		criteria[0].setColumn_value(appNum);
		criteriaMap.put(FwConstants.CRITERIA, criteria);
		APP_PGM_RQST_Cargo[] cargoArray = (APP_PGM_RQST_Cargo[])appPgmColl.select(FwConstants.DAO, criteriaMap);
		APP_PGM_RQST_Cargo appPgmRqst = new APP_PGM_RQST_Cargo();
		if(cargoArray!=null && cargoArray.length>0) {
			appPgmRqst = cargoArray[0];
		}
		
		boolean fsSelected = false, hcSelected = false, CashSelected = false, medicareSelected = false, familyPlanningSelected = false;
		ArrayList<String> missedProgram = new ArrayList<String>();
		if(appPgmRqst.getFs_rqst_ind()!=null && appPgmRqst.getFs_rqst_ind().trim().equalsIgnoreCase("1")) {
			APP_IN_PRFL_Cargo tempappInPrfl = new APP_IN_PRFL_Cargo();
			for(int i=0;i<appInPrflCol.size();i++) {
				tempappInPrfl = appInPrflCol.getCargo(i);
				if(null!=tempappInPrfl.getIndv_fs_rqst_ind() && tempappInPrfl.getIndv_fs_rqst_ind().trim().equalsIgnoreCase("1")) {
					fsSelected = true;
					missedProgram.remove("30377");
					break;
				}
				else {
					if(!missedProgram.contains("30377")) {
						missedProgram.add("30377");
					}
					
				}
			}
		}
		if (appPgmRqst.getFma_rqst_ind()!=null && appPgmRqst.getFma_rqst_ind().trim().equalsIgnoreCase("1")) {
			APP_IN_PRFL_Cargo tempappInPrfl = new APP_IN_PRFL_Cargo();
			for(int i=0;i<appInPrflCol.size();i++) {
				tempappInPrfl = appInPrflCol.getCargo(i);
				if(null!=tempappInPrfl.getIndv_fma_rqst_ind() && tempappInPrfl.getIndv_fma_rqst_ind().trim().equalsIgnoreCase("1")) {
					CashSelected = true;
					missedProgram.remove("13219");
					break;
				}
				else {
					if(!missedProgram.contains("13219")) {
						missedProgram.add("13219");
					}
				}
			}
		}
		if (appPgmRqst.getHc_rqst_ind()!=null && appPgmRqst.getHc_rqst_ind().trim().equalsIgnoreCase("1")) {
			APP_IN_PRFL_Cargo tempappInPrfl = new APP_IN_PRFL_Cargo();
			for(int i=0;i<appInPrflCol.size();i++) {
				tempappInPrfl = appInPrflCol.getCargo(i);
				if(null!=tempappInPrfl.getIndv_hc_rqst_ind() && tempappInPrfl.getIndv_hc_rqst_ind().trim().equalsIgnoreCase("1")) {
					hcSelected = true;
					missedProgram.remove("32372");
					break;
				}
				else {
					if(!missedProgram.contains("32372")) {
						missedProgram.add("32372");
					}
				}
			}
		}
		if (appPgmRqst.getMedicare_rqst_ind()!=null && appPgmRqst.getMedicare_rqst_ind().trim().equalsIgnoreCase("1")) {
			APP_IN_PRFL_Cargo tempappInPrfl = new APP_IN_PRFL_Cargo();
			for(int i=0;i<appInPrflCol.size();i++) {
				tempappInPrfl = appInPrflCol.getCargo(i);
				if(null!=tempappInPrfl.getIndv_msp_rqst_ind() && tempappInPrfl.getIndv_msp_rqst_ind().trim().equalsIgnoreCase("1")) {
					medicareSelected = true;
					//missedProgram ="";
					missedProgram.remove("98710");
					break;
				}
				else {
					if(!missedProgram.contains("98710")) { 
						missedProgram.add("98710");
					}
				}
			}
		}
		if (appPgmRqst.getFpp_rqst_ind()!=null && appPgmRqst.getFpp_rqst_ind().trim().equalsIgnoreCase("1")) {
			APP_IN_PRFL_Cargo tempappInPrfl = new APP_IN_PRFL_Cargo();
			for(int i=0;i<appInPrflCol.size();i++) {
				tempappInPrfl = appInPrflCol.getCargo(i);
				if(null!=tempappInPrfl.getIndv_fpp_pgm() && tempappInPrfl.getIndv_fpp_pgm().trim().equalsIgnoreCase("1")) {
					familyPlanningSelected = true;
					//todo : update the testid for program
					missedProgram.remove("1800087");
					break;
				}
				else {
					if(!missedProgram.contains("1800087")) { 
						missedProgram.add("1800087");
					}
				}
			}
		}	

		
		String programsMissed = "";
		for(String s:missedProgram) {
			programsMissed += (String) FwMessageFormatter.getCachedText(Integer.parseInt(s), language) +",";
		} 
		if(missedProgram!=null && missedProgram.size()>0) {
			programsMissed = programsMissed.substring(0, programsMissed.lastIndexOf(","));
			Object[] messageFieldValue = new Object[2];
			messageFieldValue[0] = programsMissed;
			messageFieldValue[1] = programsMissed;
			this.addMessageWithFieldValues("99215", messageFieldValue);
		}
			
	}
	public  void validatePregnancyAdd() {
		try{
			Object[] msgs = {new FwMessageTextLabel("32735")};
			this.addMessageWithFieldValues("20022", msgs);
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "validatePregnancyAdd", e);
			throw fe;
		}
	}
	/**
	* This method loads the household relationships information from database
	* @param appNumber java.lang.String
	* @param indvSeq java.lang.String[]
	* @return appHshlRltCollection gov.wisconsin.access.business.entities.APP_HSHL_RLT_Collection
	* @author govinpr
	*/
	public APP_HSHL_RLT_Collection loadHouseholdRelationshipsSummary(String appNumber, String[] indvSeq) {

		try {
			APP_HSHL_RLT_Collection appHshlRltCollection = new APP_HSHL_RLT_Collection();
			APP_HSHL_RLT_Cargo appHshlRltCargo = null;
			// Forming individual sequence string
			//String indvSeqStr = this.formIndvSeqString(indvSeq);	
			
			// Calling DataCriteria to fetch data from database
			Map dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, "sql-1009");
			FwDataCriteria[] criteria = new FwDataCriteria[37];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			int k =1;
			int indvSize = 0;
			
			if(indvSeq != null)
				indvSize = indvSeq.length;
					
			for(int i =0; i < 18; i++){
				criteria[k] = new FwDataCriteria();
				criteria[k].setColumn_name("SRC_INDV_SEQ_NUM");
				if(i < indvSize)
					criteria[k].setColumn_value(indvSeq[i]);
				else	
					criteria[k].setColumn_value("0");
				criteria[k].setData_type(FwConstants.SHORT);
				k++;
			}
			for(int i =0; i < 18; i++){
				criteria[k] = new FwDataCriteria();
				criteria[k].setColumn_name("REF_INDV_SEQ_NUM");
				if(i < indvSize)
					criteria[k].setColumn_value(indvSeq[i]);
				else	
					criteria[k].setColumn_value("0");
				criteria[k].setData_type(FwConstants.SHORT);
				k++;
			}

			dataCriteria.put(FwConstants.CRITERIA, criteria);
			List results = this.executeSQL(dataCriteria);
			int resultSize = results.size();
			// Assigning the Access data to the collection
			for (int i = 0; i < resultSize; i++)	{
				Map resMap = (Map) results.get(i);
				appHshlRltCargo = new APP_HSHL_RLT_Cargo();
				appHshlRltCargo.setRef_indv_seq_num((String)resMap.get("REF_INDV_SEQ_NUM").toString().trim());
				appHshlRltCargo.setRlt_cd((String)resMap.get("RLT_CD").toString().trim());
				appHshlRltCargo.setSrc_indv_seq_num((String)resMap.get("SRC_INDV_SEQ_NUM").toString().trim());
				appHshlRltCargo.setRec_cplt_ind((String)resMap.get("REC_CPLT_IND").toString().trim());
				appHshlRltCargo.setTax_dependent_sw((String)resMap.get("TAX_DEPENDENT_SW").toString().trim());
				appHshlRltCargo.setTax_jointly_filed_sw((String)resMap.get("TAX_JOINTLY_FILED_SW").toString().trim());
				appHshlRltCollection.addCargo(appHshlRltCargo);
			} 	
			return appHshlRltCollection;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdRelationshipsSummary", e);
			throw fe;
		}
	}	
	
	/**
	* This method loads the household pregnancy information from database
	* @param appNumber java.lang.String
	* @param indvSeq java.lang.String[]
	* @return appInPregCollection gov.wisconsin.access.business.entities.APP_IN_PREG_Collection
	* @author govinpr
	*/
	public APP_IN_PREG_Collection  loadHouseholdPregnancySummary(String appNumber, String[] indvSeq) {

		try {
			APP_IN_PREG_Collection appInPregCollection = new APP_IN_PREG_Collection();
			APP_IN_PREG_Cargo appInPregCargo = null;
			
			// Forming individual sequence string
			//String indvSeqStr = this.formIndvSeqString(indvSeq);	
			// Calling DataCriteria to fetch data from database
			Map dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, "sql-1011");
			FwDataCriteria[] criteria = new FwDataCriteria[19];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			
			int indvSize = 0;
			if(indvSeq != null)
				indvSize = indvSeq.length;
			int k = 1;
			for(int i =0; i < 18; i++){
				criteria[k] = new FwDataCriteria();
				criteria[k].setColumn_name("INDV_SEQ_NUM");
				if(i < indvSize)
					criteria[k].setColumn_value(indvSeq[i]);
				else	
					criteria[k].setColumn_value("0");
				criteria[k].setData_type(FwConstants.SHORT);
				k++;
			}

			dataCriteria.put(FwConstants.CRITERIA, criteria);
			
			List results = this.executeSQL(dataCriteria);
			// Assigning the Access data to the collection
			int resultSize = results.size();
			for (int i = 0; i < resultSize; i++)	{
				Map resMap = (Map) results.get(i);
				appInPregCargo = new APP_IN_PREG_Cargo();
				appInPregCargo.setIndv_seq_num((String)resMap.get("INDV_SEQ_NUM").toString().trim());
				appInPregCargo.setFetus_ct((String)resMap.get("FETUS_CT").toString().trim());
				appInPregCargo.setPreg_due_dt((String)resMap.get("PREG_DUE_DT").toString().trim());
				appInPregCargo.setApp_num((String)resMap.get("APP_NUM").toString().trim());
				appInPregCargo.setRec_cplt_ind((String)resMap.get("REC_CPLT_IND").toString().trim());
				appInPregCollection.addCargo(appInPregCargo);
			} 	
			return appInPregCollection;

		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdPregnancySummary", e);
			throw fe;
		}
	}	
	
	/**
	* This method loads the other parents information from database
	* @param appNumber java.lang.String 
	* @param indvSeq java.lang.String[]
	* @return appAbsPrntCollection gov.wisconsin.access.business.entities.APP_ABS_PRNT_Collection
	* @author govinpr
	*/
	public APP_ABS_PRNT_Cust_Collection  loadOtherParentSummary(String appNumber, String[] indvSeq) {

		try {
			APP_ABS_PRNT_Cust_Collection appAbsPrntCustCollection1 = new APP_ABS_PRNT_Cust_Collection();
			APP_ABS_PRNT_Cust_Collection appAbsPrntCustCollection2 = new APP_ABS_PRNT_Cust_Collection();
			APP_ABS_PRNT_Cust_Cargo appAbsPrntCustCargo1 = null;
			APP_ABS_PRNT_Cust_Cargo appAbsPrntCustCargo2 = null;
			//Forming individual sequence string
			//String indvSeqStr = this.formIndvSeqString(indvSeq);	
			//Calling DataCriteria to fetch data from database
			Map dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, "sql-1012");
			FwDataCriteria[] criteria = new FwDataCriteria[19];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			int indvSize = 0;
			if(indvSeq != null)
				indvSize = indvSeq.length;
			int k = 1;
			for(int i =0; i < 18; i++){
				criteria[k] = new FwDataCriteria();
				criteria[k].setColumn_name("INDV_SEQ_NUM");
				if(i < indvSize)
					criteria[k].setColumn_value(indvSeq[i]);
				else	
					criteria[k].setColumn_value("0");
				criteria[k].setData_type(FwConstants.SHORT);
				k++;
			}
			dataCriteria.put(FwConstants.CRITERIA, criteria);
			List results = this.executeSQL(dataCriteria);
			// Assigning the Access data to the collection
			int resultSize = results.size();
			for (int i = 0; i < resultSize; i++)	{
				Map resMap = (Map) results.get(i);
				appAbsPrntCustCargo1 = new APP_ABS_PRNT_Cust_Cargo();
				appAbsPrntCustCargo1.setAp_seq_num((String)resMap.get("AP_SEQ_NUM").toString().trim());
				appAbsPrntCustCargo1.setIndv_seq_num((String)resMap.get("INDV_SEQ_NUM").toString().trim());
				appAbsPrntCustCargo1.setPater_estb_sw((String)resMap.get("PATER_ESTB_SW").toString().trim());
				appAbsPrntCustCollection1.addCargo(appAbsPrntCustCargo1);
			}
			if(resultSize > 0){
				int appAbsPrntCustCollection1Size	= appAbsPrntCustCollection1.size();
				String[] indvApSeqArray = new String[appAbsPrntCustCollection1Size]; 			
				// Getting all indv seq numbers
				for(int w=0;w<appAbsPrntCustCollection1Size;w++){
					indvApSeqArray[w] = appAbsPrntCustCollection1.getResult(w).getAp_seq_num();
				}
				//String indvApSeqStr = this.formIndvSeqString(indvApSeqArray);
				
				indvSize = 0;
				if(indvSeq != null)
					indvSize = indvApSeqArray.length;

				dataCriteria = new HashMap();
				dataCriteria.put(FwConstants.SQL_IND, "sql-1010");
				criteria = new FwDataCriteria[19];
				criteria[0] = new FwDataCriteria();
				criteria[0].setColumn_name("APP_NUM");
				criteria[0].setColumn_value(appNumber);
				criteria[0].setData_type(FwConstants.STRING);
				k = 1;
				for(int i=0; i < 18 ; i++){
					criteria[k] = new FwDataCriteria();
					criteria[k].setColumn_name("AP_SEQ_NUM");
					if(i < indvSize)
						criteria[k].setColumn_value(indvApSeqArray[i]);
					else	
						criteria[k].setColumn_value("0");
					criteria[k].setData_type(FwConstants.SHORT);
					k++;
				}
				
				dataCriteria.put(FwConstants.CRITERIA, criteria);
				results = this.executeSQL(dataCriteria);
				resultSize = results.size();
				for (int i = 0; i < resultSize; i++)	{
					Map resMap = (Map) results.get(i);
					appAbsPrntCustCargo2 = new APP_ABS_PRNT_Cust_Cargo();
					appAbsPrntCustCargo2.setAp_seq_num((String)resMap.get("AP_SEQ_NUM").toString().trim());
					appAbsPrntCustCargo2.setAp_fst_nam((String)resMap.get("AP_FST_NAM").toString().trim());
					appAbsPrntCustCargo2.setAp_last_nam((String)resMap.get("AP_LAST_NAM").toString().trim());
					appAbsPrntCustCargo2.setAp_mid_init((String)resMap.get("AP_MID_INIT").toString().trim());
					appAbsPrntCustCargo2.setAp_absn_dt((String)resMap.get("AP_ABSN_DT").toString().trim());
					appAbsPrntCustCargo2.setAp_sex_ind((String)resMap.get("AP_SEX_IND").toString().trim());
					appAbsPrntCustCargo2.setRec_cplt_ind((String)resMap.get("REC_CPLT_IND").toString().trim());
					appAbsPrntCustCargo2.setAp_absn_rsn_cd((String)resMap.get("AP_ABSN_RSN_CD").toString().trim());
					appAbsPrntCustCargo2.setCase_gdcs_clm_sw((String)resMap.get("CASE_GDCS_CLM_SW").toString().trim());
					appAbsPrntCustCollection2.addCargo(appAbsPrntCustCargo2);
				} 
			}
			
			return this.populateIndvSeqNum(appAbsPrntCustCollection1, appAbsPrntCustCollection2);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadOtherParentSummary", e);
			throw fe;
		}
	}	
	
	/**
	* This method loads the blind and disability information from database
	* @param appNumber java.lang.String
	* @param indvSeq java.lang.String[]
	* @return appBlindDisableCollection gov.wisconsin.access.business.entities.APP_IN_DABL_Collection
	* @author marapsa
	*/
	public APP_IN_DABL_Collection loadHouseholdBlindDisableSummary(String appNumber, String[] indvSeq) {

		try {
			APP_IN_DABL_Collection appBlindDisableCollection = new APP_IN_DABL_Collection();
			APP_IN_DABL_Cargo appBlindDisableCargo = null;
			// Forming individual sequence string
			//String indvSeqStr = this.formIndvSeqString(indvSeq);	
			
			// Calling DataCriteria to fetch data from database
//			 Forming individual sequence string
			//String indvSeqStr = this.formIndvSeqString(indvSeq);	
			// Calling DataCriteria to fetch data from database
			Map dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, "sql-1052");
			FwDataCriteria[] criteria = new FwDataCriteria[19];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			
			int indvSize = 0;
			if(indvSeq != null)
				indvSize = indvSeq.length;
			int k = 1;
			for(int i =0; i < 18; i++){
				criteria[k] = new FwDataCriteria();
				criteria[k].setColumn_name("INDV_SEQ_NUM");
				if(i < indvSize)
					criteria[k].setColumn_value(indvSeq[i]);
				else	
					criteria[k].setColumn_value("0");
				criteria[k].setData_type(FwConstants.SHORT);
				k++;
			}

			dataCriteria.put(FwConstants.CRITERIA, criteria);
			
			List results = this.executeSQL(dataCriteria);
			// Assigning the Access data to the collection
			int resultSize = results.size();
			for (int i = 0; i < resultSize; i++)	{
				Map resMap = (Map) results.get(i);
				appBlindDisableCargo = new APP_IN_DABL_Cargo();
				appBlindDisableCargo.setIndv_seq_num((String)resMap.get("INDV_SEQ_NUM").toString().trim());
				appBlindDisableCargo.setEstb_blnd_resp((String)resMap.get("ESTB_BLND_RESP").toString().trim());
				appBlindDisableCargo.setEstb_dabl_resp((String)resMap.get("ESTB_DABL_RESP").toString().trim());
				appBlindDisableCargo.setUabl_work_sw((String)resMap.get("UABL_WORK_SW").toString().trim());
				appBlindDisableCargo.setApp_num((String)resMap.get("APP_NUM").toString().trim());
				appBlindDisableCargo.setRec_cplt_ind((String)resMap.get("REC_CPLT_IND").toString().trim());
				appBlindDisableCollection.addCargo(appBlindDisableCargo);
			} 	
			return appBlindDisableCollection;

		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdBlindDisableSummary", e);
			throw fe;
		}
	}
	
	/**
	* This method loads the household pregnancy information from database
	* @param appNumber java.lang.String
	* @param indvSeq java.lang.String[]
	* @return appInPregCollection gov.wisconsin.access.business.entities.APP_IN_PREG_Collection
	* @author govinpr
	*/
	public APP_IN_INST_Collection  loadHouseholdInstitutionSummary(String appNumber, String[] indvSeq) {

		try {
			APP_IN_INST_Collection appInstituteColl = new APP_IN_INST_Collection();
			APP_IN_INST_Cargo appInstituteCargo = null;
			
			// Forming individual sequence string
			//String indvSeqStr = this.formIndvSeqString(indvSeq);	
			// Calling DataCriteria to fetch data from database
			Map dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, "sql-1053");
			FwDataCriteria[] criteria = new FwDataCriteria[19];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			
			int indvSize = 0;
			if(indvSeq != null)
				indvSize = indvSeq.length;
			int k = 1;
			for(int i =0; i < 18; i++){
				criteria[k] = new FwDataCriteria();
				criteria[k].setColumn_name("INDV_SEQ_NUM");
				if(i < indvSize)
					criteria[k].setColumn_value(indvSeq[i]);
				else	
					criteria[k].setColumn_value("0");
				criteria[k].setData_type(FwConstants.SHORT);
				k++;
			}

			dataCriteria.put(FwConstants.CRITERIA, criteria);
			
			List results = this.executeSQL(dataCriteria);
			// Assigning the Access data to the collection
			int resultSize = results.size();
			for (int i = 0; i < resultSize; i++)	{
				Map resMap = (Map) results.get(i);
				appInstituteCargo = new APP_IN_INST_Cargo();
				appInstituteCargo.setIndv_seq_num((String)resMap.get("INDV_SEQ_NUM").toString().trim());
				appInstituteCargo.setInst_nam((String)resMap.get("INST_NAM").toString().trim());
				appInstituteCargo.setApp_num((String)resMap.get("APP_NUM").toString().trim());
				appInstituteCargo.setRec_cplt_ind((String)resMap.get("REC_CPLT_IND").toString().trim());
				appInstituteColl.addCargo(appInstituteCargo);
			} 	
			return appInstituteColl;

		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdInstitutionSummary", e);
			throw fe;
		}
	}	
	
	
	/**
	* This method deletes individual information by making the individual not relevant to the household
	* @param appNumber java.lang.String
	* @param indvSeqNumber java.lang.String
	* @return appInAbsnpCollection gov.wisconsin.access.business.entities.APP_IN_ABSNP_Collection
	* @author govinpr
	*/
	public void  deletePregnancyInfo(APP_IN_PREG_Collection appInPregColl) {

		try {
			if(appInPregColl != null){
				appInPregColl.getCargo(0).setRowAction(FwConstants.ROWACTION_DELETE);
				//add "" (space) if the Src_app_ind is null -- it will be "" in EBD and it will be updated in RMC
				if(appInPregColl.getCargo(0).getSrc_app_ind() == null)
					appInPregColl.getCargo(0).setSrc_app_ind("");
				appInPregColl.persist(FwConstants.DAO);
			}
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deletePregnancyInfo", e);
			throw fe;
		}
	}
	
	/**
	* This method deletes individual information by making the individual not relevant to the household
	* @param appNumber java.lang.String
	* @param indvSeqNumber java.lang.String
	* @return appInDisableCollection gov.wisconsin.access.business.entities.APP_IN_DABL_Collection
	* @author marapsa
	*/
	public void  deleteDisabilityInfo(APP_IN_DABL_Collection appInDisableColl) {

		try {
			if(appInDisableColl != null){
				appInDisableColl.getCargo(0).setRowAction(FwConstants.ROWACTION_DELETE);
				appInDisableColl.persist(FwConstants.DAO);
			}
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteDisabilityInfo", e);
			throw fe;
		}
	}
	
	/**
	* This forms an individual seq number string to execute sql
	* @param indvSeqNumber java.lang.String
	* @return indvSeqStr java.lang.String
	* @author govinpr
	*/
//	private String formIndvSeqString(String[] indvSeq){
//		int totalIndv = indvSeq.length;			
//		StringBuffer indvSeqStr = new StringBuffer();
//		for(int i=0;i<totalIndv;i++){
//			indvSeqStr.append(indvSeq[i]);
//			if(i+1 != totalIndv ){
//				indvSeqStr.append(","); 
//			}
//		}
//		return indvSeqStr.toString();
//	}
	
	/**
	* This forms an individual seq number string to execute sql
	* @param indvSeqNumber java.lang.String
	* @return indvSeqStr java.lang.String
	* @author govinpr
	*/
	private APP_ABS_PRNT_Cust_Collection populateIndvSeqNum(APP_ABS_PRNT_Cust_Collection coll1, APP_ABS_PRNT_Cust_Collection coll2){
		try
		{
			int appAbsPrntCustCollection1Size = coll1.size();
			int appAbsPrntCustCollection2Size = coll2.size();
			
			for(int k=0;k<appAbsPrntCustCollection1Size;k++){
				String apSeqNum1 = coll1.getResult(k).getAp_seq_num();;
				for(int l=0;l<appAbsPrntCustCollection2Size;l++){
					String apSeqNum2 = coll2.getResult(l).getAp_seq_num();
					if(apSeqNum1.equals(apSeqNum2)){
						//now we are setting the abs ind.
						
						if(coll1.getResult(k).getPater_estb_sw().trim().length() > 0 && coll1.getResult(k).getPater_estb_sw().charAt(0) == 'M'){
							coll1.getResult(k).setAbs_ind(AppConstants.PREG_MOTHER);
						}
						else{
							if(coll2.getResult(l).getAp_sex_ind().charAt(0) == 'M'){
								coll1.getResult(k).setAbs_ind(AppConstants.ABS_FATHER);
							}
							else{
								coll1.getResult(k).setAbs_ind(AppConstants.ABS_MOTHER);
							}
						}
						coll1.getResult(k).setAp_fst_nam(coll2.getResult(l).getAp_fst_nam());
						coll1.getResult(k).setAp_last_nam(coll2.getResult(l).getAp_last_nam());
						coll1.getResult(k).setAp_mid_init(coll2.getResult(l).getAp_mid_init());
						coll1.getResult(k).setAp_sex_ind(coll2.getResult(l).getAp_sex_ind());
						coll1.getResult(k).setRec_cplt_ind(coll2.getResult(l).getRec_cplt_ind());
						coll1.getResult(k).setAp_absn_dt(coll2.getResult(l).getAp_absn_dt());
						coll1.getResult(k).setAp_absn_rsn_cd(coll2.getResult(l).getAp_absn_rsn_cd());
						coll1.getResult(k).setCase_gdcs_clm_sw(coll2.getResult(l).getCase_gdcs_clm_sw());
					}
				}
			}
			return coll1;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "populateIndvSeqNum", e);
			throw fe;
		}
	}
	
		
	/**
	 * filters the individuals based on one rule out of two rules
	 * rule 1: individual age <= 18  OR  rule 2: individual should be a parant 
	 */	
	public boolean checkOtherExpensesRequired(String appNumber,PeopleHandler peopleHandler,short[] programRequestKey) {

		try{
		
			IProgramManager programManager = FwProgramManager.getInstance();
			if(programManager.isThisProgramRequested(programRequestKey,FwConstants.FS_INDEX)){
				return true;
			}
			APP_HSHL_RLT_Collection appHSHLRltColl = new APP_HSHL_RLT_Collection();
			APP_HSHL_RLT_Cargo appHSHLRltCargo = new APP_HSHL_RLT_Cargo();
			appHSHLRltCargo.setApp_num(appNumber);
			appHSHLRltColl.addCargo(appHSHLRltCargo);
			APP_HSHL_RLT_Cargo[] appHSHLRltCargoArray = (APP_HSHL_RLT_Cargo[])appHSHLRltColl.select(FwConstants.DAO, "findByAppNum");

			INDIVIDUAL_Custom_Collection indvCustomColl = peopleHandler.getRelevantIndividuals();		
			
			int size = indvCustomColl.size();
			if(size == 1){
				if(RulesBO.isValidAge(((INDIVIDUAL_Custom_Cargo)indvCustomColl.get(0)).getIndv_age(), 18, RulesBO.OPERAND_GREATER_THAN_EQUAL)){
						return true;
				}
			}
			else{			
				for(int i=0; i<size; i++){
					if(RulesBO.isValidAge(((INDIVIDUAL_Custom_Cargo)indvCustomColl.get(i)).getIndv_age(), 16, RulesBO.OPERAND_GREATER_THAN_EQUAL) || RulesBO.isParent(indvCustomColl.getResult(i), appHSHLRltCargoArray)){
						return true;
					}
				}
			}
			return false;	
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe =
				createFwException(this.getClass().getName(), "isAgeGreaterThanOrEqualTo16OrParent", e);
			throw fe;
		}	
	}
	/**
	 * filters the individuals based on rule 1 
	 * rule 1: individual age >= 18 
	 */	
	public boolean checkJobIncomeRequired(String appNumber,PeopleHandler peopleHandler) {

		try{
			INDIVIDUAL_Custom_Collection indvCustomColl = peopleHandler.getRelevantIndividuals();		
			
			int size = indvCustomColl.size();
			for(int i=0; i<size; i++){
				if(RulesBO.isValidAge(((INDIVIDUAL_Custom_Cargo)indvCustomColl.get(i)).getIndv_age(), 17, RulesBO.OPERAND_GREATER_THAN)){
					return true;
				}
			}
	
			return false;	
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe =
				createFwException(this.getClass().getName(), "isAgeGreaterThanOrEqualTo16OrParent", e);
			throw fe;
		}	
	}
	
	//here i am delting the dependent care information
	public String deleteDependentCare(String appNumber, String indvSeqNum){
		try{
			String updatedSeqNumber = "0";
			Map dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, "sql-1025");
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("PAID_IN_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNum);
			criteria[1].setData_type(FwConstants.LONG);			
			dataCriteria.put(FwConstants.CRITERIA, criteria);
			List results = this.executeSQL(dataCriteria);
			// Assigning the Access data to the collection
			int resultSize = results.size();
			List indvSeqList = new ArrayList();
			for (int i = 0; i < resultSize; i++){
				Map resMap = (Map) results.get(i);
				if(!indvSeqList.contains(resMap.get("INDV_SEQ_NUM")))
					indvSeqList.add(resMap.get("INDV_SEQ_NUM"));
			}
			if(indvSeqList.size() == 1){
				updatedSeqNumber = (String)indvSeqList.get(0);
			}
			dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, "sql-1031");
			criteria = new FwDataCriteria[3];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("PAID_IN_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNum);
			criteria[1].setData_type(FwConstants.LONG);
			criteria[2] = new FwDataCriteria();
			criteria[2].setColumn_name("INDV_SEQ_NUM");
			criteria[2].setColumn_value(indvSeqNum);
			criteria[2].setData_type(FwConstants.LONG);
			dataCriteria.put(FwConstants.CRITERIA, criteria);
			this.executeSQL(dataCriteria);
			return updatedSeqNumber;
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe =
				createFwException(this.getClass().getName(), "deleteDependentCare", e);
			throw fe;
		}	
		
	}
	//here we are deleting the individual details information
	public void deleteDetailRecords(String appNumber, String indvSeqNum, String pageId){
		try{
			String sqlInd = null;
			if(pageId.equals("ABEDT")){
				sqlInd = "sql-1026";
			}
			else if(pageId.equals("ABSED")){
				sqlInd = "sql-1027";
			}
			else if(pageId.equals("ABUID")){
				sqlInd = "sql-1028";
			}
			else if(pageId.equals("ABSCD")){
				sqlInd = "sql-1029";
			}
			else if(pageId.equals("ABUCD")){
				sqlInd = "sql-1030";
			}
			else if(pageId.equals("ABMED")){
				sqlInd = "sql-1032";
			}
			else if(pageId.equals("ABSEN")){
				sqlInd = "sql-1033";
			}
			else if(pageId.equals("ABVAD")){
				sqlInd = "sql-1057";
			}
			else if(pageId.equals("ABRPD")){
				sqlInd = "sql-1058";
			}
			else if(pageId.equals("ABPPD")){
				sqlInd = "sql-1059";
			}
			else if(pageId.equals("ABBAD")){
				sqlInd = "sql-1060";
			}
			else if(pageId.equals("ABLID")){
				sqlInd = "sql-1061";
			}
			// start of BRGUS00286206 added by rotanak
			else if(pageId.equals("ABCCD")){
				sqlInd = "sql-1099";
			}
			else if(pageId.equals("ABSBD")){
				sqlInd = "sql-1100";
			}
			else if(pageId.equals("ABSDB")){
				sqlInd = "sql-1101";
			}
			else if(pageId.equals("ABMEA")){
				sqlInd = "sql-1110";
			}
			else if(pageId.equals("ABMCD")){
				sqlInd = "sql-1111";
			}
			else if(pageId.equals("ABMDA")){
				sqlInd = "sql-1112";
			}
			else if(pageId.equals("ABSTD")){
				sqlInd = "sql-1113";
			}
			else if(pageId.equals("ABMBD")){
				sqlInd = "sql-1114";
			}
			else if(pageId.equals("ABATS")){
				sqlInd = "sql-1140";
			}
			// end of BRGUS00286206 added by rotanak
			else{
				return;
			}
			Map dataCriteria = new HashMap();
			dataCriteria.put(FwConstants.SQL_IND, sqlInd);
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNum);
			criteria[1].setData_type(FwConstants.LONG);			
			dataCriteria.put(FwConstants.CRITERIA, criteria);
			executeSQL(dataCriteria);
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe =
				createFwException(this.getClass().getName(), "deleteDetailRecords", e);
			throw fe;
		}	

	}
	
	
	
    /**
     * This method is to return all Non Deleted Individuals.
     * @param appNumber
     * @return APP_INDV_Collection collection of All Non Deleted Individuals.
     */

    public APP_INDV_Collection loadAllNonDeletedIndividuals(String appNumber) { //Added for ILIES-131450

	APP_INDV_Collection appIndvCollection = new APP_INDV_Collection();

	APP_INDV_Cargo appIndvCargo = new APP_INDV_Cargo();
	appIndvCargo.setApp_num(appNumber);
	appIndvCollection.addCargo(appIndvCargo);
	APP_INDV_Cargo[] appIndvCargoArray = (APP_INDV_Cargo[]) appIndvCollection.select(FwConstants.DAO, "findAllNonDeletedIndividuals");
	
	APP_INDV_Collection indvCollection = new APP_INDV_Collection();
	if(appIndvCargoArray.length > 0)
	{
	    indvCollection.setResults(appIndvCargoArray);
	    return indvCollection;
	}	
	return indvCollection;	
    }
    
  //added for ILIES - 133592
    /**
     * This method is to return the List of messages.
     * @param primaryPersonFName
     * @param secondaryPersonFNameList
     * @return List of Messages.
     */
    public  FwMessageList validateSecondAdultMessage(String primaryPersonFName,List<String> secondaryPersonFNameList) {
		try{
			String secPerFName = "";
			Object error[] = null;
			for(int i=0;i<secondaryPersonFNameList.size();i++){
				secPerFName = secondaryPersonFNameList.get(i);
				error = new Object[] {secPerFName,primaryPersonFName,secPerFName};
				this.addMessageWithFieldValues("95003", error);
			}
			return getMessageList();
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "validatePregnancyAdd", e);
			throw fe;
		}
	}
    
    
    public  FwMessageList validateHouseHoldCount(int peopleCount) {
  		try{
  			if(peopleCount > 16){
				Object error[] = new Object[] { new FwMessageTextLabel("30555")};
				this.addMessageWithFieldValues("99349", error);
			}
  			return getMessageList();
  		} catch (FwException fe) {
  			throw fe;
  		} catch (Exception e) {
  			FwException fe = createFwException(this.getClass().getName(), "validateHouseHoldCount", e);
  			throw fe;
  		}
  	}
    
   public  void validateWarningMessageForClearance(ClearanceInformationResponseVO clearanceInformationResponseVO, INDIVIDUAL_Custom_Collection householIndvColl, String language){
	   
	   
	   StringBuffer failureList = new StringBuffer();; 
	   IPage iPage = FwPageManager.createInstance();	
	   
	   if(clearanceInformationResponseVO != null){
		   if(clearanceInformationResponseVO.getHouseholdClearanceInformation() != null ){
			   String[] sub = new String[2];
			   for(IndvClearanceInformationVO indvClearanceInformationVO : clearanceInformationResponseVO.getHouseholdClearanceInformation().getIndvClearanceInformationVO()){
				   sub[1]=((INDIVIDUAL_Custom_Cargo)householIndvColl.get((int)indvClearanceInformationVO.getIndvSeqNum()-1)).getFst_nam() +" "+
				   		((INDIVIDUAL_Custom_Cargo)householIndvColl.get((int)indvClearanceInformationVO.getIndvSeqNum()-1)).getLast_nam() ;
				   
				   if(indvClearanceInformationVO.getDrsResponse() != null){
					   if(indvClearanceInformationVO.getDrsResponse().getDrsDqExistInd() != null && indvClearanceInformationVO.getDrsResponse().getDrsDqExistInd().equals("F")){
						   String[] subForDrs = new String[3];
						   subForDrs[0]=((INDIVIDUAL_Custom_Cargo)householIndvColl.get((int)indvClearanceInformationVO.getIndvSeqNum()-1)).getFst_nam() +" "+
					   			((INDIVIDUAL_Custom_Cargo)householIndvColl.get((int)indvClearanceInformationVO.getIndvSeqNum()-1)).getLast_nam();
						   if(null != indvClearanceInformationVO.getDrsResponse().getDrsDqEndDt()){
							   subForDrs[2]=formatGregorianCalendarToStringDate(indvClearanceInformationVO.getDrsResponse().getDrsDqEndDt());
						   }else{
							   subForDrs[2]=FwConstants.EMPTY_STRING;
						   }
						   if(null != indvClearanceInformationVO.getDrsResponse().getDrsDqStarDt()){
							   subForDrs[1]=formatGregorianCalendarToStringDate(indvClearanceInformationVO.getDrsResponse().getDrsDqStarDt());
						   }else{
							   subForDrs[1]=FwConstants.EMPTY_STRING;
						   }
						   this.addMessageWithFieldValues("23237", subForDrs);
					   }
				   }
				   if(indvClearanceInformationVO.getIlsosResponse() != null){
					   if(indvClearanceInformationVO.getIlsosResponse().getIlsosVrfInd() != null && indvClearanceInformationVO.getIlsosResponse().getIlsosVrfInd().equals("F")){
						   sub[0]= iPage.getDisplayText(59679,language);
						   failureList.append(FwMessageFormatter.getFormattedMessage(iPage.getDisplayText(54354,language),sub) + "<br>");
						   
					   }
				   }
				   if(indvClearanceInformationVO.getSsaResponse() != null){
					   if(indvClearanceInformationVO.getSsaResponse().getSsaCitVrfInd() != null && indvClearanceInformationVO.getSsaResponse().getSsaCitVrfInd().equals("F")){
						   sub[0]= iPage.getDisplayText(59680,language);
						   failureList.append(FwMessageFormatter.getFormattedMessage(iPage.getDisplayText(54354,language),sub) + "<br>");
					   }
					   if(indvClearanceInformationVO.getSsaResponse().getSsaSsnVrfInd() != null && indvClearanceInformationVO.getSsaResponse().getSsaSsnVrfInd().equals("F")){
						   sub[0]= iPage.getDisplayText(59681,language);
						   failureList.append(FwMessageFormatter.getFormattedMessage(iPage.getDisplayText(54354,language),sub) + "<br>");
					   }
				   }
				   if(indvClearanceInformationVO.getVlpResponse() != null){
					   if(indvClearanceInformationVO.getVlpResponse().getVlpVrfInd() != null && indvClearanceInformationVO.getVlpResponse().getVlpVrfInd().equals("F")){
						   sub[0]= iPage.getDisplayText(59682,language);
						   failureList.append(FwMessageFormatter.getFormattedMessage(iPage.getDisplayText(54354,language),sub) + "<br>");
					   }
				   }
			   }
		   }
		   if(failureList.length() != 0){
			   Object[] sub= new Object[1];
			   sub[0] = failureList.toString(); 
			   this.addMessageWithFieldValues("23233", sub);
		   }
		   
		   //23233 message code for clearances SSA, VLP, ILSOS
		  //23237 message code for clearances DRS 
		  // 54354 Unable to verify
	   }
    }
   
   public boolean IsApplicantIdProofedByTheIdentityProofingService(String appNum){
	   boolean isIdProofed = false;
	   SS_RIDP_DET_Cargo ssRidpDetCargo = new SS_RIDP_DET_Cargo();
	   ssRidpDetCargo.setApp_num(appNum);
	   SS_RIDP_DET_Collection ssRidpCollection = new SS_RIDP_DET_Collection();
	   ssRidpCollection.add(ssRidpDetCargo);
	   SS_RIDP_DET_Cargo[] ridpCargoArr = (SS_RIDP_DET_Cargo[])ssRidpCollection.select(FwConstants.DAO, "findByAppNum");
	   if(ridpCargoArr != null && ridpCargoArr.length > 0){
		   for(SS_RIDP_DET_Cargo cargo: ridpCargoArr){
			   //TODO ALSO CHECK FOR MOST RECENT LAST_VERIFIED_DT
			   if(cargo.getRidp_status_cd() != null && cargo.getRidp_status_cd().equals("PR")){
				   isIdProofed= true;
				   break;
			   }
		   }
	   }
	   /**ILIES-230510: Stop overriding the actual ID proofing. Below code was causing to loop ABE-VERIFY IDENTITY PAGE POP UP TWICE .
	   As per Design, Clearances will not be invoked unless the applicant has been identity proofed	*/   
	   // Since the ID proofing is not working...using reference table switch to test clearances
	   /*if(!isIdProofed){
		   IReferenceTableManager iref = ReferenceTableManager.getInstance();
			String val = iref.getColumnValue( "TCLE",
						839, "INVSW",
						"EN");
			if(val != null && val.equals("Y")){
				isIdProofed= true;
			}
	   }*/  /**ILIES-230510:END */
	   return isIdProofed;
   }
   
   public boolean checkWhetherClearancesHaveBeenInvokedInThePast7Days(String appNum){
	    boolean hasClearanceBeenInvoked = false;
		Map dataCriteria = new HashMap();
		dataCriteria.put(FwConstants.SQL_IND, "sql-1132");
		FwDataCriteria[] criteria = new FwDataCriteria[1];
		criteria[0] = new FwDataCriteria();
		criteria[0].setColumn_name("APP_NUM");
		criteria[0].setColumn_value(appNum);
		criteria[0].setData_type(FwConstants.STRING);
					
		dataCriteria.put(FwConstants.CRITERIA, criteria);
		List results = this.executeSQL(dataCriteria);
		// Assigning the Access data to the collection
		int resultSize = results.size();
		List indvSeqList = new ArrayList();
		if(resultSize > 0){
			Map resMap = (Map) results.get(0);
			String simp_create_dt = (String)resMap.get("SIMP_CREATE_DT");
			// Since complex is Async rec may not be present
			//String cmpx_create_dt = (String)resMap.get("CMPX_CREATE_DT");
			
			Date day7DayOld =  dateRoutine.subtractDaysFromDate(fwDate.getDate(), 7);
			
			Date simpleDt = new Date(dateRoutine.getDateFromString(simp_create_dt).getTime());
			//Date complexDt = new Date(dateRoutine.getDateFromString(cmpx_create_dt).getTime());
			if(simpleDt.after(day7DayOld) /*|| complexDt.after(day7DayOld)*/){
				hasClearanceBeenInvoked= true;
			}
		}
		
	   return hasClearanceBeenInvoked;
	   
   }
   
   private String formatGregorianCalendarToStringDate(XMLGregorianCalendar xmlGregorianCalendar){
		
		if (xmlGregorianCalendar != null){
			Date date = new Date(xmlGregorianCalendar.toGregorianCalendar().getTimeInMillis());
			return DateFormat.getDateTimeInstance(DateFormat.MEDIUM, DateFormat.SHORT).format(date);
		} else {
			return FwConstants.HIGH_DATE;
		}
	   
   }
   
   private APP_RQST_Collection  loadAppRequest(String appNumber) {
//		Map pageCollection = null;
		try {
			
			APP_RQST_Collection appRqstColl = new APP_RQST_Collection();
			Map criteriaMap = new HashMap();
			FwDataCriteria[] criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			APP_RQST_Cargo[] appRgstCargoArray =	(APP_RQST_Cargo[]) appRqstColl.select(FwConstants.DAO, criteriaMap);
			if(appRgstCargoArray != null && appRgstCargoArray.length > 0){
				appRqstColl.setResults(appRgstCargoArray);
			}
			else{
				return null;
			}


			return appRqstColl;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadAppRequest", e);
			throw fe;
		}
	} 

   
   /**
 * @param appNumber
 * ILIES-311729
 */
public void validateHouseholdComposition(String appNumber) {
		APP_INDV_Collection householdMembers = loadAllNonDeletedIndividuals(appNumber);
		APP_RQST_Collection appRequest = loadAppRequest(appNumber);
		
		int inHomeActual = 0;
		int outHomeActual  = 0;
		
		for(APP_INDV_Cargo indiv : householdMembers.getResults()){
			if(indiv!=null && indiv.getLive_arng_typ()!=null){
				String value = indiv.getLive_arng_typ();
				if("SU".equalsIgnoreCase(value)){	//ILIES-318944 - Removed OH and added SU-Other	
					outHomeActual++; 
				}else{
					inHomeActual++;
				}
			}
		}
		int totalActual = inHomeActual + outHomeActual;
		APP_RQST_Cargo cargo = appRequest.getCargo(0);
		
		int inhomeExpected = Integer.valueOf(cargo.getHshl_indv_in_cnt().trim());
		int outhomeExpected = Integer.valueOf(cargo.getHshl_indv_out_cnt().trim());
		int totalexpected = Integer.valueOf(cargo.getHshl_indv_ct().trim());
		
		boolean mismatch = inHomeActual != inhomeExpected || totalActual != totalexpected || outHomeActual != outhomeExpected;
		if(mismatch){
			try{
				Object[] msgs = new Object[] {totalexpected,inhomeExpected,outhomeExpected};
				this.addMessageWithFieldValues("99348", msgs);
			} catch (FwException fe) {
				throw fe;
			} catch (Exception e) {
				FwException fe = createFwException(this.getClass().getName(), "validateHouseholdComposition", e);
				throw fe;
			}
		}
	}
   
}