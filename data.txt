function CIN05P9-SCAN-INPUT()

    try

        get next SR-CIN05-RECIN;

    end

    if(SR-CIN05-RECIN is ioError && SR-CIN05-RECIN not endOfFile)

        VDBCONTROL.UMSQLCODE = 0;

        VDBCONTROL.UPROC-OBJ = "SR-CIN05-RECIN";

        VDBCONTROL.UPROC-NM = "CIN05P9-SCAN-INPUT";

        VDBCONTROL.UPROC-OPT = "SCAN";

        CIN05W1.WS-ERR-CD = sysVar.errorCode;

        VMESSAGE.UMSGINS[1] = CIN05W1.WS-ERR-LAST-FOUR;

        VMESSAGE.UMSGINS[2] = "CIN05A";

        VDBCONTROL.UEZESQRRM = " ";

        if(SR-CIN05-RECIN is invalidFormat)

            VDBCONTROL.UEZESQRRM = "FILE FORMAT MISMATCH";

        end

        WCM00P2-TO-CEP01A();

    end



    if(SR-CIN05-RECIN is endOfFile && CIN05W.WS-FIRST-IND == "Y")

        VDBCONTROL.UMSQLCODE = 0;

        VDBCONTROL.UPROC-OBJ = "SR-CIN05-RECIN";

        VDBCONTROL.UPROC-NM = "CIN05P9-SCAN-INPUT";

        VDBCONTROL.UPROC-OPT = "SCAN";

        VMESSAGE.UMSGINS[1] = " ";

        VMESSAGE.UMSGINS[2] = "CIN05A";

        VMESSAGE.UMSGCODE = "GEN0274";

        VDBCONTROL.UEZESQRRM = "NO DATA FOUND";

        VMESSAGE.UMSGCODE-JCL-ERR = 8;

        WCM00P2-TO-CEP01A();

    end

    CIN05W.WS-FIRST-IND = "N";

end // end CIN05P9-SCAN-INPUT



// SCAN SR-CIN05-PARMS RECORD



function CIN05P9-SCANPARMS()

    VGVar.handleHardIOErrors = 1;

    /*  */

    try

        get next SR-CIN05-PARMS;

    end

    /*  */

    if(SR-CIN05-PARMS is ioError)

        VDBCONTROL.UPROC-OBJ = "SR-CIN05-PARMS";

        VDBCONTROL.UPROC-NM = "CIN05P9-SCANPARMS";

        VDBCONTROL.UPROC-OPT = "SCAN";

        VMESSAGE.WS-ERR-CD = sysVar.errorCode;

        VMESSAGE.UMSGINS[1] = VMESSAGE.WS-ERR-LAST-FOUR;

        VMESSAGE.UMSGINS[2] = sysVar.transferName;

        /*  */

        WCM00P2-TO-CEP01A();

    end

end // end CIN05P9-SCANPARMS



// ADD Data



function CIN05P9-SWE-I01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-SWICA-EMPLR-DTL";

    VDBCONTROL.UPROC-OBJ = "H2-SWICA-EMPLR-DTL";

    VDBCONTROL.UPROC-OPT = "ADD";

    VDBCONTROL.UPROC-NM = "CIN05P9-SWE-I01";

    /*  */

    try

        add H2-SWICA-EMPLR-DTL;

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();

end // end CIN05P9-SWE-I01



// Check if row exists



function CIN05P9-SWE-S01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H3-SWICA-EMPLR-DTL";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-SWE-S01";

    VDBCOMMON.USQLREC = "H3-SWICA-EMPLR-DTL";

    /*  */

    try

        get H3-SWICA-EMPLR-DTL singleRow

                with #sql{

        select UPI

        from TWNSWICA_EMPLR_DTL T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI      = :UPI

        AND   EMPLR_ID = :EMPLR-ID

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UPI;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-SWE-S01



// UPDATE



function CIN05P9-SWE-U01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H2-SWICA-EMPLR-DTL";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-SWE-U01";

    VDBCOMMON.USQLREC = "H2-SWICA-EMPLR-DTL";

    /*  */

    try

        execute update 

                #sql{

        UPDATE

          TWNSWICA_EMPLR_DTL

        SET

          CTY         = :CTY,

          EMPLR_ADLN1 = :EMPLR-ADLN1,

          ST_CD       = :ST-CD,

          ZIP_CD      = :ZIP-CD,

          EMPLR_NM    = :EMPLR-NM

        WHERE UPI      = :UPI

        AND   EMPLR_ID = :EMPLR-ID

      }

                for H2-SWICA-EMPLR-DTL; // model = update

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-SWE-U01



// ADD Data



function CIN05P9-SWW-I01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-SWICA-WAGE-DTL";

    VDBCONTROL.UPROC-OBJ = "H2-SWICA-WAGE-DTL";

    VDBCONTROL.UPROC-OPT = "ADD";

    VDBCONTROL.UPROC-NM = "CIN05P9-SWW-I01";

    /*  */

    try

        add H2-SWICA-WAGE-DTL;

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();

end // end CIN05P9-SWW-I01



// Check if row exists



function CIN05P9-SWW-S01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H3-SWICA-WAGE-DTL";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-SWW-S01";

    VDBCOMMON.USQLREC = "H3-SWICA-WAGE-DTL";

    /*  */

    try

        get H3-SWICA-WAGE-DTL

                with #sql{

        select qrtr_erngs

        from TWNSWICA_WAGE_DTL T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI        = :UPI

        AND   EMPLR_ID   = :EMPLR-ID

        AND   WGE_QRTR   = :WGE-QRTR

         --AND   PROCESS_DT = :PROCESS-DT

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into QRTR-ERNGS;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-SWW-S01



// UPDATE



function CIN05P9-SWW-U01()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-OBJ = "H2-SWICA-WAGE-DTL";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-SWW-U01";

    VDBCOMMON.USQLREC = "H2-SWICA-WAGE-DTL";

    /*  */

    try

        execute update 

                #sql{

        UPDATE

          TWNSWICA_WAGE_DTL

        SET

          QRTR_ERNGS         = :QRTR-ERNGS,

          EMPL_NM_IN_ESD_REC = :EMPL-NM-IN-ESD-REC

        WHERE UPI      = :UPI

        AND   EMPLR_ID = :EMPLR-ID

        AND   WGE_QRTR = :WGE-QRTR

        AND   PROCESS_DT = :PROCESS-DT

      }

                for H2-SWICA-WAGE-DTL; // model = update

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-SWW-U01





/* WI 4063 - start */

//Display the current record being processed

Function CIN05P9-TRAC-PROC()

  set CIN05W4 empty;

  CIN05W4.WS-TR-REC-NMB = CIN05W.WS-INPUT-REC-CNT;

  CIN05W4.WS-TR-REC-TY = SR-CIN05-RECIN.REC-TYPE;

  CIN05W4.WS-TR-SSN = SR-CIN05-RECIN.INTRFC-SSN;

  

  DDA-TRAC-REC.TRAC-REC = CIN05W4.WS-TRAC-REC;

  

  DDATRAC-PROC();

        

end // end of CIN05P9-TRAC-PROC

/* WI 4063 - end */



// INSERT INTO TWNUIB_BNFT_DTLS



function CIN05P9-UBD-I01()

    WDB00PI();

    /*  */

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OPT = "ADD";

    VDBCONTROL.UPROC-NM = "CIN05P9-UBD-I01";

    /*  */

    try

        add H3-UIB-BNFT-DTLS;

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "Y";

    /*  */

    WDB00PE-SQLERR();

end // end CIN05P9-UBD-I01



// READS TWNUIB_BNFT_DTLS RECORD



function CIN05P9-UBD-S01()

    WDB00PI();

    /*  */

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCOMMON.USQLREC = "H2-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCONTROL.UPROC-NM = "CIN05P9-UBD-S01";

    /*  */

    /* WI 2632 - 5/2015 - Sondra - both ACH and check numbers default to zeros */

    /* add those to query, also, add clm-beg-dt */

    /* WI 4063 - start */

    try

        get H2-UIB-BNFT-DTLS

                with #sql{

        select UPI,

          CSI_AMT,

          ISSUD_BNFT_AMT,

          UIB_APPL_STS,

          ERN_AMT,

          NON_FRD_OFST_AMT,

          FRD_OFST_AMT,

          CHECK_STS,

          BNFT_WK_END_DT,

          ACH_TRACE_NMB,

          CHECK_NMB,

          CLM_BEG_DT,

          FED_PYMT_TYPE

        from TWNUIB_BNFT_DTLS T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE T1.UPI = :UPI

          AND T1.BNFT_WK_END_DT = :BNFT-WK-END-DT

          AND T1.ACH_TRACE_NMB = :ACH-TRACE-NMB

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UPI, CSI-AMT, ISSUD-BNFT-AMT, UIB-APPL-STS, ERN-AMT, NON-FRD-OFST-AMT, 

                     FRD-OFST-AMT, CHECK-STS, BNFT-WK-END-DT, ACH-TRACE-NMB, CHECK-NMB, 

                     CLM-BEG-DT, FED-PYMT-TYPE;

    end

    /* WI 2632 - end */

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UBD-S01



// UPDATES TWNUIB_BNFT_DTLS



function CIN05P9-UBD-U01()

    WDB00PI();

    /*  */

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCOMMON.USQLREC = "H2-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-UBD-U01";

    /*  */

    /* WI 2632 - start */

    try

        execute update 

                #sql{

        UPDATE

          TWNUIB_BNFT_DTLS T1

        SET

          CSI_AMT = :CSI-AMT,

          ISSUD_BNFT_AMT = :ISSUD-BNFT-AMT,

          UIB_APPL_STS = :UIB-APPL-STS,

          ERN_AMT = :ERN-AMT,

          NON_FRD_OFST_AMT = :NON-FRD-OFST-AMT,

          FRD_OFST_AMT = :FRD-OFST-AMT,

          CHECK_STS = :CHECK-STS,

          ACH_TRACE_NMB = :ACH-TRACE-NMB,

          CHECK_NMB = :CHECK-NMB,

          CLM_BEG_DT = :CLM-BEG-DT,

          WK_BNFT_AMT = :WK-BNFT-AMT,

          INCM_WITHLD_AMT = :INCM-WITHLD-AMT,

          UIB_CLM_NMB = :UIB-CLM-NMB

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE T1.UPI = :UPI

          AND T1.BNFT_WK_END_DT = :BNFT-WK-END-DT

          AND T1.ACH_TRACE_NMB = :ACH-TRACE-NMB

          AND T1.CHECK_NMB = :CHECK-NMB

      }

                for H2-UIB-BNFT-DTLS; // model = update

    end

    /* WI 2632 - end */

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UBD-U01



// UPDATES TWNUIB_BNFT_DTLS



function CIN05P9-UBD-U02()

    WDB00PI();

    /*  */

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCOMMON.USQLREC = "H3-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OBJ = "H3-UIB-BNFT-DTLS";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-UBD-U02";

    /*  */

    /* WI 2632 - start */

    try

        execute update 

                #sql{

        UPDATE

          TWNUIB_BNFT_DTLS T1

        SET

          CSI_AMT = :CSI-AMT,

          ISSUD_BNFT_AMT = :ISSUD-BNFT-AMT,

          UIB_APPL_STS = :UIB-APPL-STS,

          ERN_AMT = :ERN-AMT,

          NON_FRD_OFST_AMT = :NON-FRD-OFST-AMT,

          FRD_OFST_AMT = :FRD-OFST-AMT,

          CHECK_STS = :CHECK-STS,

          ACH_TRACE_NMB = :ACH-TRACE-NMB,

          CHECK_NMB = :CHECK-NMB,

          CLM_BEG_DT = :CLM-BEG-DT

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE T1.UPI = :UPI

          AND T1.BNFT_WK_END_DT = :BNFT-WK-END-DT

          AND T1.ACH_TRACE_NMB = :ACH-TRACE-NMB

          AND T1.CHECK_NMB = :CHECK-NMB

      }

                for H3-UIB-BNFT-DTLS; // model = update

    end

    /* WI 2632 - end */

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UBD-U02



// Insert in TWNUIB_DTLS



function CIN05P9-UIB-I01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OPT = "ADD";

    VDBCONTROL.UPROC-NM = "CIN05P9-UIB-I01";

    /*  */

    try

        add H2-UIB-DTLS;

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "Y";

    /*  */

    WDB00PE-SQLERR();

end // end CIN05P9-UIB-I01



// Update TWNUIB_DTLS



function CIN05P9-UIB-U01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-UIB-U01";

    /*  */

    /* WI 2632 - 5/2015 - Sondra B - remove process_dt from query */

    try

        execute update 

                #sql{

        UPDATE

          TWNUIB_DTLS T1

        SET

          EMPL_NM_IN_ESD_REC = :EMPL-NM-IN-ESD-REC,

          EMPL_ADLN1         = :EMPL-ADLN1,

          EMPL_ADLN2         = :EMPL-ADLN2,

          ST_CD              = :ST-CD,

          ZIP_CD             = :ZIP-CD,

          CTY                = :CTY,

          CLNTS_DOB          = :CLNTS-DOB,

          AGNT_ST            = :AGNT-ST,

          LIBL_ST            = :LIBL-ST,

          RES_ADLN1          = :RES-ADLN1,

          RES_ADLN2          = :RES-ADLN2,

          RES_CITY           = :RES-CITY,

          RES_ST             = :RES-ST,

          RES_ZIP_CD         = :RES-ZIP-CD,

          LST_NM             = :LST-NM,

          FRST_NM            = :FRST-NM,

          MID_INIT           = :MID-INIT,

          AKA_LST_NM         = :AKA-LST-NM,

          AKA_FRST_NM        = :AKA-FRST-NM,

          AKA_MID_INIT       = :AKA-MID-INIT,

          UI_APPL_DT         = :UI-APPL-DT

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE      UPI = :UPI

      --AND PROCESS_DT = :PROCESS-DT

        AND CLM_BEG_DT = :CLM-BEG-DT

        AND CLM_END_DT = :CLM-END-DT

      }

                for H2-UIB-DTLS; // model = update

    end

    /* WI 2632 - end */

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    WDB00PE-SQLERR();

end // end CIN05P9-UIB-U01



// Update TWNUIB_DTLS



function CIN05P9-UIB-U02()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-UIB-U02";

    /*  */

    /* WI 2632 - 05/2015 - Sondra B - after the claim info has come in, we */

    /* need to be able to update the TWNUIB_DTLS row with any info from any */

    /* 5 records that come in afterward, so, take process_dt out of this query */

    

    /* WI 4063 - start - add claim # */

    try

        execute update 

                #sql{

        UPDATE

          TWNUIB_DTLS T1

        SET

          UIB_BAL_AMT      = :UIB-BAL-AMT,

          UIB_APPL_STS     = :UIB-APPL-STS,

          CSI_AMT          = :CSI-AMT,

          WK_BNFT_AMT      = :WK-BNFT-AMT,

          MTH_BNFT_AMT     = :MTH-BNFT-AMT,

          MAX_BNFT_AMT     = :MAX-BNFT-AMT,

          CHK_DT           = :CHK-DT,

          BASE_PRD_ERN_AMT = :BASE-PRD-ERN-AMT,

          UIB_CLM_NMB      = :UIB-CLM-NMB

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI = :UPI

--      AND PROCESS_DT = :PROCESS-DT

        AND CLM_BEG_DT = :CLM-BEG-DT

        AND CLM_END_DT = :CLM-END-DT

      }

                for H2-UIB-DTLS; // model = update

    end

    /* WI 2632 - end */

    /* WI 4063 - end */

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    WDB00PE-SQLERR();

end // end CIN05P9-UIB-U02



// Update TWNUIB_DTLS



function CIN05P9-UIB-U03()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OBJ = "H2-UIB-DTLS";

    VDBCONTROL.UPROC-OPT = "SQLEXEC";

    VDBCONTROL.UPROC-NM = "CIN05P9-UIB-U03";

    /*  */

    /* WI 2632 - 05/2015 - add clm_beg_dt */

    try

        execute update 

                #sql{

        UPDATE

          TWNUIB_DTLS T1

        SET

          UIB_APPL_STS     = :UIB-APPL-STS

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI = :UPI

          AND CLM_END_DT = :CLM-END-DT

          AND CLM_BEG_DT = :CLM-BEG-DT

      }

                for H2-UIB-DTLS; // model = update

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    WDB00PE-SQLERR();

end // end CIN05P9-UIB-U03



// PROCESS TO GET THE UNIN DATA



function CIN05P9-UID-CHECK()

/*  */

/* this process is to read the table TWNUERND_INCM_DTL to check if*/

/* a record is found in TWNUERND_INCM_DTL for any months AFTER*/

/* ESD period covered*/

/*  */

/* build a cursor from TWNUERND_INCM_DTL of any future UNIN screens*/

/*  */

    set H3-UERND-INCM-DTL empty;

    H3-UERND-INCM-DTL.UPI = CIN05W.WS-UPI;

    H3-UERND-INCM-DTL.UERND-INC-TYPE-CD = "45";

    /*  */

    CIN05P9-UID-S02();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end



    CIN05W.WS-UNIN-REC-CNT-F = 0;

    while(sysVar.sqlData.sqlcode == 0)



        /* if successful, perform the process to scan the records*/



        CIN05P9-UID-S02-SC();

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

        if(sysVar.sqlData.sqlcode == 0)

            CIN05W.WS-UNIN-REC-CNT-F = CIN05W.WS-UNIN-REC-CNT-F + 1;

            if(CIN05W.WS-UNIN-REC-CNT-F == 1)

                CIN05W.WS-PRD-BEG-DT-F = H3-UERND-INCM-DTL.PRD-BEG-DT;

            end

            if(H3-UERND-INCM-DTL.CHNG-ENTRY-DT != GDW.DTCD)

                CIN05W.WS-FREQ = H3-UERND-INCM-DTL.UERND-INC-FREQ;



                /* perform the process to get the conversion factor*/

                CIN05P9-GET-CNV-FR();



                CIN05W.WS-UNIN-AMT-F = CIN05W.WS-FACTOR *

                        H3-UERND-INCM-DTL.UERND-INC-AMT;

                H3-UERND-INCM-DTL.PREV-AMT = CIN05W.WS-UNIN-AMT-F;

                H3-UERND-INCM-DTL.UERND-INC-AMT = CIN05W.WS-INTERFACE-AMT;

                H3-UERND-INCM-DTL.UERND-INC-FREQ = "M";

                H3-UERND-INCM-DTL.UNE-INC-VERF-CD = "?";

                if(H3-UERND-INCM-DTL.PRD-END-DT == "9999-12-31")

                    H3-UERND-INCM-DTL.RECUR-IND = "Y";

                else

                    H3-UERND-INCM-DTL.RECUR-IND = "N";

                end

                /* if the interface amount is not equal to the UNIN amount*/

                if(CIN05W.WS-UNIN-AMT-F != CIN05W.WS-INTERFACE-AMT)

                    CIN05P9-UID-U01();

                    if(VDBCONTROL.URC > 104)

                        WCM00P2-TO-CEP01A();

                    end

                end

            end

        end /* end check for records found*/

    end /* end while*/

end // end CIN05P9-UID-CHECK



// INSERT INTO TWNUERND_INCM_DTL



function CIN05P9-UID-I01()

    WDB00PI();

    VDBCONTROL.UACCTYP = "W";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /* Move name of SQL row record used to common record*/

    VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";

    VDBCONTROL.UPROC-NM = "CIN05P9-UID-I01";

    VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OBJ = "ADD";

    try

        add H2-UERND-INCM-DTL

                with #sql{

        insert into TWNUERND_INCM_DTL

        (UPI, PRD_BEG_DT, UERND_INC_TYPE_CD, INCM_SQ_NMB,

            SSI_RSDI_RCVD_MTH, UERND_INC_RCVD_DT, UERND_INC_FREQ,

            UERND_INC_AMT, PREV_AMT, SSI_RSDI_RCVD_YR, BNFTS_APLD_IND,

            AFDC_CNTBL_IND, FS_CNTBL_IND, MA_CNTBL_CD, PRD_END_DT,

            CHNG_ENTRY_DT, UNE_INC_VERF_CD, RECUR_IND, UNE_INC_VERF_DT,

            RCVD_DT, RPRTD_DT, RCPT_DT)

        values (:UPI, :PRD-BEG-DT, :UERND-INC-TYPE-CD, :INCM-SQ-NMB,

            :SSI-RSDI-RCVD-MTH, :UERND-INC-RCVD-DT, :UERND-INC-FREQ,

            :UERND-INC-AMT, :PREV-AMT, :SSI-RSDI-RCVD-YR, :BNFTS-APLD-IND,

            :AFDC-CNTBL-IND, :FS-CNTBL-IND, :MA-CNTBL-CD, :PRD-END-DT,

            :CHNG-ENTRY-DT, :UNE-INC-VERF-CD, :RECUR-IND, :UNE-INC-VERF-DT,

            :RCVD-DT, :RPRTD-DT, :RCPT-DT)

      };

    end

    /*  */

    /* Increment count of rows written*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "Y";

    /*  */

    WDB00PE-SQLERR();

end // end CIN05P9-UID-I01



// SETINQ ON TWNUERND_INCM_DTL



function CIN05P9-UID-S01()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-UID-S01";

    VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OPT = "SETINQ";

    VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";

    try

        open CIN05P9-UID-S01_RSI01

                with #sql{

        select UERND_INC_FREQ, UERND_INC_AMT,

            PREV_AMT, prd_beg_dt, prd_end_dt, INCM_SQ_NMB,

            UNE_INC_VERF_CD,

            AFDC_CNTBL_IND,

            FS_CNTBL_IND,

            MA_CNTBL_CD

        from TWNUERND_INCM_DTL T1

        WHERE UPI = :UPI AND

        UERND_INC_TYPE_CD = :UERND-INC-TYPE-CD AND

        (:CIN05W.WS-PRD-BEG-DT BETWEEN PRD_BEG_DT AND PRD_END_DT OR

        :CIN05W.WS-PRD-END-DT BETWEEN PRD_BEG_DT AND PRD_END_DT)

        FOR FETCH ONLY

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into UERND-INC-FREQ, UERND-INC-AMT, PREV-AMT, PRD-BEG-DT, PRD-END-DT, INCM-SQ-NMB, UNE-INC-VERF-CD, AFDC-CNTBL-IND, FS-CNTBL-IND, MA-CNTBL-CD

                for H2-UERND-INCM-DTL;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "1";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UID-S01



// check for more UID in grtr mth



function CIN05P9-UID-S02()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-UID-S02";

    VDBCONTROL.UPROC-OBJ = "H3-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OPT = "SETINQ";

    VDBCOMMON.USQLREC = "H3-UERND-INCM-DTL";

    try

        open CIN05P9-UID-S02_RSI01

                with #sql{

        select UERND_INC_FREQ, UERND_INC_AMT,

            PREV_AMT, prd_beg_dt, prd_end_dt, INCM_SQ_NMB,

            UNE_INC_VERF_CD, CHNG_ENTRY_DT,

            AFDC_CNTBL_IND,

            FS_CNTBL_IND,

            MA_CNTBL_CD

        from TWNUERND_INCM_DTL T1

        WHERE UPI = :UPI AND

        UERND_INC_TYPE_CD = :UERND-INC-TYPE-CD AND

        PRD_BEG_DT > :CIN05W.WS-PRD-BEG-DT

         --** INSERT ORDER BY CLAUSE HERE **

        order by prd_beg_dt asc

        FOR FETCH ONLY

      }

                into UERND-INC-FREQ, UERND-INC-AMT, PREV-AMT, PRD-BEG-DT, PRD-END-DT, INCM-SQ-NMB, UNE-INC-VERF-CD, CHNG-ENTRY-DT, AFDC-CNTBL-IND, FS-CNTBL-IND, MA-CNTBL-CD

                for H3-UERND-INCM-DTL;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "1";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UID-S02



// FETCH FROM TWNUERND_INCM_DTL



function CIN05P9-UID-S02-SC()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-UID-S02-SC";

    VDBCONTROL.UPROC-OBJ = "H3-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OPT = "SCAN";

    VDBCOMMON.USQLREC = "H3-UERND-INCM-DTL";

    try

        get next H3-UERND-INCM-DTL;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UID-S02-SC



// GET MAX SEQUENCE NUMBER



function CIN05P9-UID-S03()

    WDB00PI();

    /* Initialize:*/

    /* UACCTYP - Access type (R=read, W=write)*/

    /* UAPPLNAM - Application name*/

    VDBCONTROL.UACCTYP = "R";

    VDBCOMMON.UAPPLNAM = "CIN05A";

    /*  */

    VDBCONTROL.UPROC-NM = "CIN05P9-UID-S03";

    VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OPT = "INQUIRY";

    VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";

    try

        get H2-UERND-INCM-DTL singleRow

                with #sql{

        select MAX (INCM_SQ_NMB)

        from TWNUERND_INCM_DTL T1

         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **

        WHERE UPI =:UPI

        AND   PRD_BEG_DT = :PRD-BEG-DT

         --** INSERT ORDER BY CLAUSE HERE **

      }

                into CIN05W.WS-MAX-SEQ-NMB;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UID-S03



// FETCH FROM TWNUERND_INCM_DTL



function CIN05P9-UID-SCAN()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-UID-SCAN";

    VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OPT = "SCAN";

    VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";

    try

        get next H2-UERND-INCM-DTL;

    end

    /*  */

    /* Increment count of rows retrieved*/

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;

    end

    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UID-SCAN



// UPDATE TABLE TWNUERND_INCM_DTL



function CIN05P9-UID-U01()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-UID-U01";

    VDBCONTROL.UPROC-OBJ = "H3-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OBJ = "SQLEXEC";

    VDBCOMMON.USQLREC = "H3-UERND-INCM-DTL";

    try

        execute update 

                #sql{

        UPDATE

          TWNUERND_INCM_DTL T1

        SET

          prd_end_dt = :PRD-END-DT,

          UERND_INC_AMT=:UERND-INC-AMT,

          PREV_AMT=:PREV-AMT,

          UERND_INC_FREQ = :UERND-INC-FREQ,

          UNE_INC_VERF_CD = :UNE-INC-VERF-CD,

          RECUR_IND = :RECUR-IND,

          RCVD_DT = :GDW.DTCD,

          RPRTD_DT = :GDW.DTCD,

          RCPT_DT = :GDW.DTCD,

          CHNG_ENTRY_DT = :GDW.DTCD

        WHERE UPI = :UPI AND

        UERND_INC_TYPE_CD = :UERND-INC-TYPE-CD AND

        PRD_BEG_DT = :PRD-BEG-DT and

        INCM_SQ_NMB = :INCM-SQ-NMB

      }

                for H3-UERND-INCM-DTL; // model = update

    end

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end



    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UID-U01



// UPDATE TABLE TWNUERND_INCM_DTL



function CIN05P9-UID-U02()

    WDB00PI();



    VDBCOMMON.UAPPLNAM = "CIN05A";

    VDBCONTROL.UACCTYP = "R";



    VDBCONTROL.UPROC-NM = "CIN05P9-UID-U02";

    VDBCONTROL.UPROC-OBJ = "H2-UERND-INCM-DTL";

    VDBCONTROL.UPROC-OBJ = "SQLEXEC";

    VDBCOMMON.USQLREC = "H2-UERND-INCM-DTL";

    try

        execute update 

                #sql{

        UPDATE

          TWNUERND_INCM_DTL T1

        SET

          prd_end_dt = :PRD-END-DT,

          UERND_INC_AMT=:UERND-INC-AMT,

          PREV_AMT=:PREV-AMT,

          UERND_INC_FREQ = :UERND-INC-FREQ,

          UNE_INC_VERF_CD = :UNE-INC-VERF-CD,

          RECUR_IND = :RECUR-IND,

          RCVD_DT = :GDW.DTCD,

          RPRTD_DT = :GDW.DTCD,

          RCPT_DT = :GDW.DTCD,

          CHNG_ENTRY_DT = :GDW.DTCD

        WHERE UPI = :UPI AND

        UERND_INC_TYPE_CD = :UERND-INC-TYPE-CD AND

        PRD_BEG_DT = :PRD-BEG-DT and

        INCM_SQ_NMB = :INCM-SQ-NMB

      }

                for H2-UERND-INCM-DTL; // model = update

    end

    if(sysVar.sqlData.sqlcode == 0)

        VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;

    end



    /* Set error control flags*/

    /* UNRF - No record found flag (Y,N,1)*/

    /* UDUP - Duplicate key flag (Y,N)*/

    VDBCOMMON.UNRF = "Y";

    VDBCOMMON.UDUP = "N";

    /*  */

    /* Perform DBM error processing*/

    WDB00PE-SQLERR();

end // end CIN05P9-UID-U02



// Update the contact entries



function CIN05P9-UPD-CON()

/* Move name (per NOMADS) to contact fields:*/

    CIN05W.TCON-N-FRST-NM = CIN05W.WS-NOM-FRST-NM;

    CIN05W.TCON-N-MID-NM = CIN05W.WS-NOM-MID-NM;

    CIN05W.TCON-N-LST-NM = CIN05W.WS-NOM-LST-NM;

    /*  */

    /* Move name (per ESD) to contact fields:*/

    CIN05W.TCON-E-WHOLE-NM = "(NOT AVAILABLE)";

    if(CIN05W.WS-REC-TYPE == 1)

        if(CIN05W.WS-PERCLM-LST-NM != " ")

            CIN05W.TCON-E-FRST-INIT = CIN05W.WS-PERCLM-FRST-INIT;

            CIN05W.TCON-E-MID-INIT = CIN05W.WS-PERCLM-MID-INIT;

            CIN05W.TCON-E-LST-NM = CIN05W.WS-PERCLM-LST-NM;

        end

    end

    if(CIN05W.WS-REC-TYPE == 2)

        if(WS-WAGE-EMPL-LST-NM != " ")

            CIN05W.TCON-E-FRST-INIT = CIN05W.WS-WAGE-EMPL-FRST-INIT;

            CIN05W.TCON-E-MID-INIT = CIN05W.WS-WAGE-EMPL-MID-INIT;

            CIN05W.TCON-E-LST-NM = CIN05W.WS-WAGE-EMPL-LST-NM;

        end

    end

    /* Note: Type 4 and 5 records do not have names on them.*/

    /*  */

    CIN05W.TCON-E-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    /*  */

    /* Write an entry in IV-D contacts to notify the worker that ESD*/

    /* has responded.*/

    if(CIN05W.WS-PRIM-OR-ALT == "P")

        CIN05W.TCON-N-SSN = SR-CIN05-RECIN.INTRFC-SSN;

    else

        CIN05W.TCON-N-SSN = CIN05W.WS-PRIM-SSN;

    end

    /*  */

    H2-IVD-CONTACTS.UPI = CIN05W.WS-UPI;

    H2-IVD-CONTACTS.CASE-SUFX = "A";

    /* cntct type is interface*/

    H2-IVD-CONTACTS.CNTCT-TYPE = "I";

    H2-IVD-CONTACTS.CNTCT-SRC = "ESD";

    H2-IVD-CONTACTS.CASE-SPCFC-IND = "N";

    call "DATEAPP"(GDW, VDBCONTROL, VMESSAGE){isNoRefresh = yes};

    CIN05W1.WS-CRTD-TS = GDW.TS;

    CIN05W1.WS-CRTD-DT = CIN05W1.WS-PROCESS-DT;

    H2-IVD-CONTACTS.CRTD-TS = CIN05W1.WS-CRTD-TS;

    /*  */

    H2-2-DCC-SPT.UPI = H2-IVD-CONTACTS.UPI;

    H2-2-DCC-SPT.CASE-SUFX = H2-IVD-CONTACTS.CASE-SUFX;

    CIN05P9-GET-WRKR();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    /*  */

    H2-IVD-CONTACTS.WRKR-ID = H2-2-DCC-SPT.NOMADS-USRID;

    /* Compress contact message:*/

    set VSTRREC7 empty;

    VSTRREC7.UINSTRG = CIN05W.TCON-CNTCT-TXT;

    VSTRREC7.USTRLENGTH = 235;

    call "WST60A"(VSTRREC7);

    H2-IVD-CONTACTS.CNTCT-TXT = VSTRREC7.UOUTSTRG;

    CIN05W.TCON-CNTCT-TXT2 = VSTRREC7.UOUTSTRG;

    /* Check for existing Contact record (minus CRTD_TS), don't add if found*/

    CIN05P9-CON-S01();

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    else

        if(sysVar.sqlData.sqlcode == 100)

            CIN05P9-CON-I01();

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

        end

    end

end // end CIN05P9-UPD-CON



// Update TWNLCTE_ACTVY



function CIN05P9-UPD-LCA()

    H-TLCAS1.UPI = CIN05W.WS-UPI;

    H-TLCAS1.LOC-SRC-CD = "ESD";

    H-TLCAS1.RQST-SENT-DT = "0001-01-01";

    H-TLCAS1.INFO-RCVD-DT = "0001-01-01";

    /* The ESD interface uses the following constant values because*/

    /* this type of interface is person-level.*/

    H-TLCAS1.CASE-SUFX = "A";

    H-TLCAS1.RQST-SQ-NMB = 1;

    call "TLCAS1A"(VDBCONTROL, VMESSAGE, H-TLCAS1){isNoRefresh = yes};

    if(VDBCONTROL.URC > 104)

        WCM00P2-TO-CEP01A();

    end

    if(VDBCONTROL.URC == 0)

        if(H-TLCAS1.NPLS-FG == "Y")

            /* Alert 320093: SEND FORM GNO132: ADD/EMP INFORMATION*/

            /* Received*/

            PCALINP.PAL-ALERT-CD = 320093;

            PCALINP.PAL-UPI = CIN05W.WS-UPI;

            /* ACTION IS CREATE*/

            PCALINP.PAL-ALERT-ACTION = "C";

            PCALINP.PAL-SUFFIX = "A";

            PCALINP.PAL-PROCESS-DT = CIN05W1.WS-PROCESS-DT;

            if(CIN05W3.PI1-ALERT == "NOALERT" && CIN05W3.PI1-ALERT-FLAG == "N")

                /*  */

                call "CAL11A"(VDBCONTROL, VMESSAGE,

                        PCALINP){isNoRefresh = yes};

            /*  */

            end

            /*  */

            if(VDBCONTROL.URC > 104)

                WCM00P2-TO-CEP01A();

            end

        end

        /* Update locate activity to show that the information*/

        /* was received*/

        H-TLCAU1.INFO-RCVD-DT = CIN05W1.WS-PROCESS-DT;

        H-TLCAU1.UPI = CIN05W.WS-UPI;

        H-TLCAU1.LOC-SRC-CD = "ESD";

        H-TLCAU1.RQST-SENT-DT = "0001-01-01";

        H-TLCAU1.CASE-SUFX = "A";

        H-TLCAU1.RQST-SQ-NMB = 1;

        H-TLCAU1.INFO-RQSTD-TS = H-TLCAS1.INFO-RQSTD-TS;



        call "TLCAU1A"(VDBCONTROL, VMESSAGE, H-TLCAU1){isNoRefresh = yes};

        if(VDBCONTROL.URC > 104)

            WCM00P2-TO-CEP01A();

        end

    end

    /*  */

end // end CIN05P9-UPD-LCA



// VERIFY THE UNIN DATA



function CIN05P9-VR-UNIN-PR()

/* the uib details check week number and amount for the person are stored*/

/* in the working storage table ws-check-table. amounts of all the weeks*/

/* which fall in a month are added to give the monthly figure. then unin*/

/* table is searched to verify if any data is available for the given*/

/* period. if data is available for the period then the amounts are added*/

/* to compare against the data given by the esd. if there are no records*/

/* available in the unin table then the system inserts a record into the*/

/* table and generates an alert. if there are more than one record then*/

/* alert is generated.*/

/*  */

    H2-UERND-INCM-DTL.BNFTS-APLD-IND = "N";

    H2-UERND-INCM-DTL.AFDC-CNTBL-IND = "N";

    H2-UERND-INCM-DTL.BNFTS-APLD-IND = "N";

    H2-UERND-INCM-DTL.FS-CNTBL-IND = "N";

    H2-UERND-INCM-DTL.BNFTS-APLD-IND = "N";

    H2-UERND-INCM-DTL.MA-CNTBL-CD = "N";

    /*  */

    CIN05W.WS-PRD-BEG-DT = H2-UIB-DTLS.CHK-DT;

    CIN05W.WS-PRD-BEG-DD = "01";

    /*  */

    CIN05W.WS-PRD-END-DT = CIN05W.WS-PRD-BEG-DT;

    /*  */

    CIN05P9-DET-END-DD();

    /*  */

    /* MULTIPLY BY 4.3 TO GET MONTHLY INCOME AMOUNT*/

    CIN05W.WS-INT-AMT = CIN05W.WS-CHK-PD-AMT * 4.3;



    CIN05W.WS-INTERFACE-AMT = CIN05W.WS-INT-AMT;

    CIN05P9-PRUNIN-DTA();

end // end CIN05P9-VR-UNIN-PR



// ADD Data