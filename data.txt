// --Sai--Convert first characters of first name and last name to
			// uppercase---

			if (appIndvCargo.getFst_nam() != null) {
				appIndvCargo.setFst_nam(appIndvCargo.getFst_nam()
						.substring(0, 1).toUpperCase()
						+ appIndvCargo.getFst_nam().substring(1).toLowerCase());
			}
			// --Sai--edit ended---
			// Sushma added
			session.put("SKIP_VALIDATE", "");
			// Sushma endded
			appIndvCargo = appIndvColl.getCargo(0);
			appIndvCargo.setApp_num(appNumber);
			appRgstCargo = appRgstColl.getCargo(0);
			appRgstCargo.setApp_num(appNumber);
			appRgstCargo.setHshl_indv_ct("0");
			if (appRgstCargo.getHless_sw() == null
					|| appRgstCargo.getHless_sw().length() == 0) {
				appRgstCargo.setHless_sw(FwConstants.SPACE);
			}

			if (appIndvCargo.getMid_init() == null
					|| appIndvCargo.getMid_init().length() == 0) {
				appIndvCargo.setMid_init(FwConstants.SPACE);
			}
			if (appIndvCargo.getSex_ind() == null
					|| appIndvCargo.getSex_ind().length() == 0) {
				appIndvCargo.setSex_ind(FwConstants.SPACE);
			}

			// commented by sushma
			// commented by sushma

			// added by sushma
			// Conversion of date to timestamp for the ILIES project
			if (appIndvCargo.getBrth_dt() == null
					|| appIndvCargo.getBrth_dt().trim().length() == 0) {
				appIndvCargo.setBrth_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo.setBrth_dt(displayFormatter
						.getYYYYMMDDTimestamp(appIndvCargo.getBrth_dt()));
			}
			// added by sushma.

			// added by Sushma june 24
			// Conversion of date to timestamp for the ILIES project
			if (appIndvCargo.getSs_num_app_dt() == null
					|| appIndvCargo.getSs_num_app_dt().trim().length() == 0) {
				appIndvCargo.setSs_num_app_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo.setSs_num_app_dt(displayFormatter
						.getYYYYMMDDTimestamp(appIndvCargo.getSs_num_app_dt()));
			}

			// added by Sushma june 24

			// Modified by Rashmi
			// Conversion of date to timestamp for the ILIES project
			if (appIndvCargo.getDt_leave_facty() == null
					|| appIndvCargo.getDt_leave_facty().trim().length() == 0) {
				appIndvCargo.setDt_leave_facty(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo
						.setDt_leave_facty(displayFormatter
								.getYYYYMMDDTimestamp(appIndvCargo
										.getDt_leave_facty()));
			}

			if (appIndvCargo.getVet_resp() == null
					|| appIndvCargo.getVet_resp().trim().length() == 0) {
				appIndvCargo.setVet_resp(FwConstants.SPACE);
			}

			if (appIndvCargo.getVet_act_duty_resp() == null
					|| appIndvCargo.getVet_act_duty_resp().trim().length() == 0) {
				appIndvCargo.setVet_act_duty_resp(FwConstants.SPACE);
			}

			if (appIndvCargo.getSps_deceased_vet_resp() == null
					|| appIndvCargo.getSps_deceased_vet_resp().trim().length() == 0) {
				appIndvCargo.setSps_deceased_vet_resp(FwConstants.SPACE);
			}

			if (appIndvCargo.getChld_deceased_vet_resp() == null
					|| appIndvCargo.getChld_deceased_vet_resp().trim().length() == 0) {
				appIndvCargo.setChld_deceased_vet_resp(FwConstants.SPACE);
			}

			if (appIndvCargo.getDisable_vet_resp() == null
					|| appIndvCargo.getDisable_vet_resp().trim().length() == 0) {
				appIndvCargo.setDisable_vet_resp(FwConstants.SPACE);
			}
			// Added by Kumar Karuppanan for the Job Commitment
			if (appIndvCargo.getJob_commitment_resp() == null
					|| appIndvCargo.getJob_commitment_resp().trim().length() == 0) {
				appIndvCargo.setJob_commitment_resp(FwConstants.SPACE);
			}

			// Added by Indrani for self service expansion - Aug 5, 2011
			// Conversion of date to timestamp for the ILIES project
			if (appIndvCargo.getAlien_entry_dt() == null
					|| appIndvCargo.getAlien_entry_dt().trim().length() == 0) {
				appIndvCargo.setAlien_entry_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo
						.setAlien_entry_dt(displayFormatter
								.getYYYYMMDDTimestamp(appIndvCargo
										.getAlien_entry_dt()));
			}

			if (appIndvCargo.getTribe_name() == null
					|| appIndvCargo.getTribe_name().trim().length() == 0) {
				appIndvCargo.setTribe_name(FwConstants.SPACE);
			}
			// Added by Uma for Nursing facility
			if (appIndvCargo.getUnpaid_medical_expense_sw() == null
					|| appIndvCargo.getUnpaid_medical_expense_sw().trim()
							.length() == 0) {
				appIndvCargo.setUnpaid_medical_expense_sw(FwConstants.SPACE);
			}
			if (appIndvCargo.getHealth_ins_premium_pay_sw() == null
					|| appIndvCargo.getHealth_ins_premium_pay_sw().trim()
							.length() == 0) {
				appIndvCargo.setHealth_ins_premium_pay_sw(FwConstants.SPACE);
			}
			if (appIndvCargo.getLtc_insurance_coverage_sw() == null
					|| appIndvCargo.getLtc_insurance_coverage_sw().trim()
							.length() == 0) {
				appIndvCargo.setLtc_insurance_coverage_sw(FwConstants.SPACE);
			}
			if (appIndvCargo.getPlan_contract_sw() == null
					|| appIndvCargo.getPlan_contract_sw().trim().length() == 0) {
				appIndvCargo.setPlan_contract_sw(FwConstants.SPACE);
			}
			if (appIndvCargo.getInjury_related_med_cvrg_sw() == null
					|| appIndvCargo.getInjury_related_med_cvrg_sw().trim()
							.length() == 0) {
				appIndvCargo.setInjury_related_med_cvrg_sw(FwConstants.SPACE);
			}
			if (appIndvCargo.getCourt_ordered_med_cvrg_sw() == null
					|| appIndvCargo.getCourt_ordered_med_cvrg_sw().trim()
							.length() == 0) {
				appIndvCargo.setCourt_ordered_med_cvrg_sw(FwConstants.SPACE);
			}
			if (appIndvCargo.getMedicare_coverage_sw() == null
					|| appIndvCargo.getMedicare_coverage_sw().trim().length() == 0) {
				appIndvCargo.setMedicare_coverage_sw(FwConstants.SPACE);
			}

			// Added for the ILIES project
			if (appIndvCargo.getDays_child_sleeps_in_home_num() == null
					|| appIndvCargo.getDays_child_sleeps_in_home_num().trim()
							.length() == 0) {
				appIndvCargo
						.setDays_child_sleeps_in_home_num(AppConstants.ZERO);
			}

			if (appIndvCargo.getAlien_reg_num() == null) {
				appIndvCargo.setAlien_reg_num(AppConstants.ZERO);
			}

			if (appIndvCargo.getFclty_nm() == null) {
				appIndvCargo.setFclty_nm(FwConstants.SPACE);
			}

			if (appIndvCargo.getFclty_strt_dt() == null) {
				appIndvCargo.setFclty_strt_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo.setFclty_strt_dt(displayFormatter
						.getYYYYMMDDTimestamp(appIndvCargo.getFclty_strt_dt()));
			}

			if (appIndvCargo.getTyp_of_assist() == null) {
				appIndvCargo.setTyp_of_assist(FwConstants.SPACE);
			}

			if (appIndvCargo.getMoved_to_mi_dt() == null) {
				appIndvCargo.setMoved_to_mi_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo
						.setMoved_to_mi_dt(displayFormatter
								.getYYYYMMDDTimestamp(appIndvCargo
										.getMoved_to_mi_dt()));
			}

			if (appIndvCargo.getMove_in_dt() == null) {
				appIndvCargo.setMove_in_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo.setMove_in_dt(displayFormatter
						.getYYYYMMDDTimestamp(appIndvCargo.getMove_in_dt()));
			}

			if (appIndvCargo.getConfm_brth_dt() == null) {
				appIndvCargo.setConfm_brth_dt(AppConstants.HIGH_TIMESTAMP);
			}

			if (appIndvCargo.getDisability_claim_sw() == null) {
				appIndvCargo.setDisability_claim_sw(FwConstants.SPACE);
			}

			if (appIndvCargo.getNon_hspc_ind() == null) {
				appIndvCargo.setNon_hspc_ind(FwConstants.SPACE);
			}

			boolean completeFlag = true;
			if (appRgstCargo.getPref_cntc_ind() == null
					|| appRgstCargo.getPref_cntc_ind().equals("SEL")) {
				appRgstCargo.setPref_cntc_ind("0");
			} else {
				String indicator = appRgstCargo.getPref_cntc_ind();
				if (indicator.equals("1")
						&& appRgstCargo.getHshl_home_phn_num().trim().length() == 0) {
					completeFlag = false;
				}
				if (indicator.equals("2")
						&& appRgstCargo.getHshl_work_phn_num().trim().length() == 0) {
					completeFlag = false;
				}
				if (indicator.equals("3")
						&& appRgstCargo.getHshl_cell_phn_num().trim().length() == 0) {
					completeFlag = false;
				}
				if (indicator.equals("4")
						&& appRgstCargo.getMsg_phn_num().trim().length() == 0) {
					completeFlag = false;
				}
			}

			if (appRgstCargo.getAlt_city_adr() == null
					|| appRgstCargo.getAlt_city_adr().length() == 0) {
				appRgstCargo.setAlt_city_adr(FwConstants.SPACE);
			}
			if (appRgstCargo.getAlt_l2_adr() == null
					|| appRgstCargo.getAlt_l2_adr().length() == 0) {
				appRgstCargo.setAlt_l2_adr(FwConstants.SPACE);
			}

			if (appRgstCargo.getAlt_st_adr() == null
					|| appRgstCargo.getAlt_st_adr().length() == 0) {
				appRgstCargo.setAlt_st_adr(FwConstants.SPACE);
			}

			if (appRgstCargo.getAlt_zip_adr() == null
					|| appRgstCargo.getAlt_zip_adr().length() == 0) {
				appRgstCargo.setAlt_zip_adr(FwConstants.SPACE);
			}

			if (appRgstCargo.getHshl_city_adr() == null
					|| appRgstCargo.getHshl_city_adr().length() == 0) {
				appRgstCargo.setHshl_city_adr(FwConstants.SPACE);
			}
			if (appRgstCargo.getHshl_email_adr() == null
					|| appRgstCargo.getHshl_email_adr().length() == 0) {
				appRgstCargo.setHshl_email_adr(FwConstants.SPACE);
			}
			/*Modified by Gauresh for ILIES-282110: Verifying email and confirm email address entered by the user*/
			if (appRgstCargo.gethshlConfirmemailAdr() == null
					|| appRgstCargo.gethshlConfirmemailAdr().length() == 0) {
				appRgstCargo.sethshlConfirmemailAdr(FwConstants.SPACE);
			}
			if (appRgstCargo.getLang_cd() == null
					|| appRgstCargo.getLang_cd().length() == 0) {
				appRgstCargo.setLang_cd(FwConstants.SPACE);
			}
			if (appRgstCargo.getPhn_txt_typ_cd() == null
					|| appRgstCargo.getPhn_txt_typ_cd().equals("SEL")) {
				appRgstCargo.setPhn_txt_typ_cd(FwConstants.SPACE);
			}
			//ILIES-282110: change ends here
			if (appRgstCargo.getPref_cntc_tm_txt() == null
					|| appRgstCargo.getPref_cntc_tm_txt().equals("SEL")) {
				appRgstCargo.setPref_cntc_tm_txt(FwConstants.SPACE);
			}
			if (appRgstCargo.getHshl_zip_adr() == null
					|| appRgstCargo.getHshl_zip_adr().length() == 0) {
				appRgstCargo.setHshl_zip_adr(FwConstants.SPACE);
			}
			if (appRgstCargo.getHshl_l1_adr() == null
					|| appRgstCargo.getHshl_l1_adr().length() == 0) {
				appRgstCargo.setHshl_l1_adr(FwConstants.SPACE);
			}
			if (appRgstCargo.getHshl_l2_adr() == null
					|| appRgstCargo.getHshl_l2_adr().length() == 0) {
				appRgstCargo.setHshl_l2_adr(FwConstants.SPACE);
			}
			if (appRgstCargo.getHshl_sta_adr() == null
					|| appRgstCargo.getHshl_sta_adr().length() == 0) {
				appRgstCargo.setHshl_sta_adr(FwConstants.SPACE);
			}
			if (appRgstCargo.getPhn_num_typ() == null
					|| appRgstCargo.getPhn_num_typ().equals("SEL")) {
				appRgstCargo.setPhn_num_typ(FwConstants.SPACE);
			}
			if (appRgstCargo.getMsg_phn_extn_num() == null
					|| appRgstCargo.getMsg_phn_extn_num().length() == 0) {
				appRgstCargo.setMsg_phn_extn_num(FwConstants.SPACE);
			}

			if (appRgstCargo.getWork_phn_extn_num() == null
					|| appRgstCargo.getWork_phn_extn_num().length() == 0) {
				appRgstCargo.setWork_phn_extn_num(FwConstants.SPACE);
			}
			
			//ILIES Phase-2 changes - ILIES-153070
			//default values for the columns added for RMC/RMB
			appRgstCargo.setAlt_cnty_num("0");
			appRgstCargo.setHouse_util_cst_chg_sw(" ");
			
			

			// added for ssn ILIES-69318
			if (appIndvCargo.getSsn_num() == null
					|| appIndvCargo.getSsn_num().length() == 0) {
				appIndvCargo.setSsn_num("0");
			}
			// commented and code added for ILIES-126625
			/*
			 * if (appIndvCargo.getFile_taxes_sw() == null ||
			 * appIndvCargo.getFile_taxes_sw().equals("")) {
			 * appIndvCargo.setFile_taxes_sw(AppConstants.NO); }
			 */
			if (appIndvCargo.getFile_taxes_sw() == null
					|| appIndvCargo.getFile_taxes_sw().equals("")) {
				appIndvCargo.setFile_taxes_sw(AppConstants.SPACE);
			}
			
			if (appIndvCargo.getVet_ind() == null
					|| appIndvCargo.getVet_ind().equals("")) {
				appIndvCargo.setVet_ind(AppConstants.SPACE);
			}
			
			if (appIndvCargo.getSsn_num_prev() == null
					|| appIndvCargo.getSsn_num_prev().length() == 0) {
				appIndvCargo.setSsn_num_prev("0");
			}

			if (appIndvCargo.getOther_state_dt() == null) {
				appIndvCargo.setOther_state_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appIndvCargo
						.setOther_state_dt(displayFormatter
								.getYYYYMMDDTimestamp(appIndvCargo
										.getOther_state_dt()));
			}

			appRgstCargo.getHless_sw();

			boolean isSectioncomplted = false;
			boolean isNumber = false;
			boolean isEmail = false;

			if (appRgstCargo.getPref_cntc_ind() != null) {

				if (appRgstCargo.getPref_cntc_ind().trim().equals("1")
						&& (!appRgstCargo.getHshl_home_phn_num().trim()
								.equals(""))) {
					isNumber = true;
				}

				else if (appRgstCargo.getPref_cntc_ind().trim().equals("2")
						&& (!appRgstCargo.getHshl_work_phn_num().trim()
								.equals(""))
						|| (!appRgstCargo.getWork_phn_extn_num().trim()
								.equals(""))) {
					isNumber = true;
				} else if (appRgstCargo.getPref_cntc_ind().trim().equals("3")
						&& (!appRgstCargo.getHshl_cell_phn_num().trim()
								.equals(""))) {
					isNumber = true;
				} else if (appRgstCargo.getPref_cntc_ind().trim().equals("4")
						&& (!appRgstCargo.getMsg_phn_num().trim().equals(""))) {
					isNumber = true;
					// Start of WR:BRGUS00232722 - Added by MuthaiahM
				} else if (appRgstCargo.getPref_cntc_ind().trim().equals("5")
						&& (!appRgstCargo.getHshl_email_adr().trim().equals(""))) {
					isEmail = true;
				}
				// End of WR:BRGUS00232722
			} // end of outer if

			// Added for ILIES-126057, commented below code as we are filling
			// all the mandatory fields in Registration screen.
			appRgstCargo.setRec_cplt_ind("1");

			/*
			 * if((isNumber ||
			 * isEmail)&&appRgstCargo.getLang_cd()!=null&&!appRgstCargo
			 * .getLang_cd().trim().equals("")
			 * &&appIndvCargo.getSex_ind()!=null&&
			 * !appIndvCargo.getSex_ind().trim().equals("")
			 * &&appIndvCargo.getBrth_dt
			 * ()!=null&&appIndvCargo.getBrth_dt().trim().length()>0){
			 * isSectioncomplted=true; } if(isSectioncomplted){
			 * appRgstCargo.setRec_cplt_ind("1"); }else{
			 * appRgstCargo.setRec_cplt_ind("0"); }
			 */
			// end

			/*
			 * if(completeFlag){ appRgstCargo.setRec_cplt_ind("1"); } else{
			 */
			// appRgstCargo.setRec_cplt_ind("0");
			/* } */
			if (appRgstCargo.getChg_eff_dt() == null
					|| appRgstCargo.getChg_eff_dt().trim().length() == 0) {
				appRgstCargo.setChg_eff_dt(AppConstants.HIGH_TIMESTAMP);
			} else {
				appRgstCargo.setChg_eff_dt(displayFormatter
						.getYYYYMMDDTimestamp(appRgstCargo.getChg_eff_dt()));
			}
			if (appRgstCargo.getSrc_app_ind() == null) {
				appRgstCargo.setSrc_app_ind(AppConstants.SRC_APP_IND_AFB);
			}
			// now we are comparing the individual informaton with old data
			// comparing the individual information
			//Modified by Gauresh for ILIES-282110: SONAR fixes-replacing size() by isEmpty()
			if (appRgstBeforeColl != null && !appRgstBeforeColl.isEmpty()) {
				// now we are comparing the collections
				appRgstBeforeCargo = appRgstBeforeColl.getCargo(0);
				appRgstCargo.setChg_eff_dt(appRgstBeforeCargo.getChg_eff_dt());
				appRgstCargo
						.setSrc_app_ind(appRgstBeforeCargo.getSrc_app_ind());
				appRgstCargo = (APP_RGST_Cargo) isChanged(appRgstBeforeCargo,
						appRgstCargo);
				if (appRgstCargo.isDirty()) {
					// if the cargo is dirty then we are updating the data base
					appRgstCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
					registrationBo.storeRegistrationInformation(appRgstColl);
				}
			} else {
				// here we are setting the row action to the insert
				appRgstColl.getCargo(0).setRowAction(
						FwConstants.ROWACTION_INSERT);
				registrationBo.storeRegistrationInformation(appRgstColl);
			}
			//Modified by Gauresh for ILIES-282110: SONAR fixes-replacing size() by isEmpty()
			if (appIndvBeforeColl != null && !appIndvBeforeColl.isEmpty()) {
				// here we need to check data hasa been change or not
				// added SSN ILIES-69318
				appIndvBeforeCargo = appIndvBeforeColl.getCargo(0);
				if (!appIndvBeforeCargo.getFst_nam().trim()
						.equals(appIndvCargo.getFst_nam().trim())
						|| !appIndvBeforeCargo.getMid_init().trim()
								.equals(appIndvCargo.getMid_init().trim())
						|| !appIndvBeforeCargo.getLast_nam().trim()
								.equals(appIndvCargo.getLast_nam().trim())
						|| !appIndvBeforeCargo.getSuffix_name().trim()
								.equals(appIndvCargo.getSuffix_name().trim())
						|| !appIndvBeforeCargo.getSex_ind().equals(
								appIndvCargo.getSex_ind())
						|| dateRoutine.getDateFromTimeStamp(appIndvBeforeCargo
								.getBrth_dt()) != dateRoutine
								.getDateFromTimeStamp(appIndvCargo.getBrth_dt())
						|| !appIndvBeforeCargo.getSsn_num().trim()
								.equals(appIndvCargo.getSsn_num().trim())) {
					appIndvBeforeCargo.setBrth_dt(appIndvCargo.getBrth_dt());
					// Added by Rashmi1
					appIndvBeforeCargo.setDt_leave_facty(appIndvCargo
							.getDt_leave_facty());
					appIndvBeforeCargo.setFst_nam(appIndvCargo.getFst_nam());
					appIndvBeforeCargo.setMid_init(appIndvCargo.getMid_init());
					appIndvBeforeCargo.setLast_nam(appIndvCargo.getLast_nam());
					// ILIES-133283: Added Suffix name
					appIndvBeforeCargo.setSuffix_name(appIndvCargo
							.getSuffix_name());
					// rotanak added
					appIndvBeforeCargo.setAlien_entry_dt(appIndvCargo
							.getAlien_entry_dt());

					appIndvBeforeCargo.setSex_ind(appIndvCargo.getSex_ind());
					// added for ILIES-69318
					appIndvBeforeCargo.setSsn_num(appIndvCargo.getSsn_num());
					// added for ILIES-121325
					appIndvBeforeCargo.setFile_taxes_sw(appIndvCargo
							.getFile_taxes_sw());
					appIndvBeforeCargo.setVet_ind(appIndvCargo
							.getVet_ind());
					appIndvBeforeCargo.setSsn_num_prev(appIndvCargo
							.getSsn_num_prev());
					appIndvBeforeCargo.setOther_state_dt(appIndvCargo
							.getOther_state_dt());
					// Added for the ILIES project
					appIndvBeforeCargo.setMi_assistance_name(" ");					
					if(appIndvBeforeCargo.getAptc_eligible() ==  null){
						appIndvBeforeCargo.setAptc_eligible(FwConstants.SPACE);
					}					
					peopleHandler.updateIndividual(appIndvBeforeCargo);
				}
			} else {
				// here we need to insert this information to the data base
				// first we need to create the individual
				peopleHandler = new PeopleHandler();
				APP_INDV_Cargo appIndvNewCargo = peopleHandler
						.createIndividual();
				appIndvNewCargo.setFst_nam(appIndvCargo.getFst_nam());
				appIndvNewCargo.setMid_init(appIndvCargo.getMid_init());
				appIndvNewCargo.setLast_nam(appIndvCargo.getLast_nam());
				// ILIES-133283: Added Suffix name
				appIndvNewCargo.setSuffix_name(appIndvCargo.getSuffix_name());
				appIndvNewCargo.setSex_ind(appIndvCargo.getSex_ind());
				appIndvNewCargo.setBrth_dt(appIndvCargo.getBrth_dt());
				// added for ILIES-69318
				appIndvNewCargo.setSsn_num(appIndvCargo.getSsn_num());
				// Added By KumarK
				appIndvNewCargo.setJob_commitment_resp(appIndvCargo
						.getJob_commitment_resp());
				// Added by Indrani for self service expansion - Aug 5, 2011
				appIndvNewCargo.setAlien_entry_dt(appIndvCargo
						.getAlien_entry_dt());
				appIndvNewCargo.setTribe_name(appIndvCargo.getTribe_name());
				// Added by Rashmi
				appIndvNewCargo.setVet_resp(appIndvCargo.getVet_resp());
				appIndvNewCargo.setVet_act_duty_resp(appIndvCargo
						.getVet_act_duty_resp());
				appIndvNewCargo.setSps_deceased_vet_resp(appIndvCargo
						.getSps_deceased_vet_resp());
				appIndvNewCargo.setChld_deceased_vet_resp(appIndvCargo
						.getChld_deceased_vet_resp());
				appIndvNewCargo.setDisable_vet_resp(appIndvCargo
						.getDisable_vet_resp());
				appIndvNewCargo.setDt_leave_facty(appIndvCargo
						.getDt_leave_facty());
				appIndvNewCargo.setApp_num(appNumber);
				appIndvNewCargo.setIndv_seq_num("1");
				appIndvNewCargo.setPrim_prsn_sw("Y");
				// PCR# 35501 - set Child Out of Home response to "N" when
				// initializing APP_INDV for PP.
				appIndvNewCargo.setChld_out_home_resp(FwConstants.NO);
				appIndvNewCargo.setChld_trb_mbr_resp(" ");
				appIndvNewCargo.setTrb_mbr_resp(" ");
				// Added by Uma for Nursing facility
				appIndvNewCargo.setUnpaid_medical_expense_sw(appIndvCargo
						.getUnpaid_medical_expense_sw());
				appIndvNewCargo.setHealth_ins_premium_pay_sw(appIndvCargo
						.getHealth_ins_premium_pay_sw());
				appIndvNewCargo.setMedicare_coverage_sw(appIndvCargo
						.getMedicare_coverage_sw());
				appIndvNewCargo.setLtc_insurance_coverage_sw(appIndvCargo
						.getLtc_insurance_coverage_sw());
				appIndvNewCargo.setCourt_ordered_med_cvrg_sw(appIndvCargo
						.getCourt_ordered_med_cvrg_sw());
				appIndvNewCargo.setInjury_related_med_cvrg_sw(appIndvCargo
						.getInjury_related_med_cvrg_sw());
				appIndvNewCargo.setPlan_contract_sw(appIndvCargo
						.getPlan_contract_sw());
				// Added for the ILIES project
				appIndvNewCargo.setSs_num_app_dt(appIndvCargo
						.getSs_num_app_dt());
				appIndvNewCargo.setDays_child_sleeps_in_home_num(appIndvCargo
						.getDays_child_sleeps_in_home_num());
				appIndvNewCargo.setAlien_reg_num(appIndvCargo
						.getAlien_reg_num());
				appIndvNewCargo.setFclty_strt_dt(appIndvCargo
						.getFclty_strt_dt());
				appIndvNewCargo.setNon_hspc_ind(appIndvCargo.getNon_hspc_ind());
				appIndvNewCargo.setFile_taxes_sw(appIndvCargo
						.getFile_taxes_sw());
				appIndvNewCargo.setVet_ind(appIndvCargo
						.getVet_ind());
				appIndvNewCargo.setSsn_num_prev(appIndvCargo.getSsn_num_prev());
				appIndvNewCargo.setOther_state_dt(appIndvCargo
						.getOther_state_dt());
				if(appIndvNewCargo.getAptc_eligible() ==  null){
					appIndvNewCargo.setAptc_eligible(FwConstants.SPACE);
				}
				peopleHandler.addNewIndividual(appIndvNewCargo);
			}
			session.put(AppConstants.INDIV_MASTER_HANDLER, peopleHandler);

			if (appRgstCargo.getHless_sw() != null
					&& appRgstCargo.getHless_sw().trim().equals("Y")
					&& (appRgstCargo.getAlt_city_adr() == null || appRgstCargo
							.getAlt_city_adr().trim().length() == 0)
					&& (appRgstCargo.getAlt_l2_adr() == null || appRgstCargo
							.getAlt_l2_adr().trim().length() == 0)
					&& (appRgstCargo.getAlt_st_adr() == null || appRgstCargo
							.getAlt_st_adr().trim().length() == 0)
					&& (appRgstCargo.getAlt_zip_adr() == null || appRgstCargo
							.getAlt_zip_adr().trim().length() == 0)) {

				applicationManager.runDirtyLogicOnDriver(appNumber, 2, "ABMAH",
						driverArray);
				// applicationManager.runDirtyLogicOnDriver(appNumber, 2 ,
			}
			//Modified by Gauresh for ILIES-282110: SONAR fixes- declaring constant
			driverManager.makeComplete(FwConstants.AFB_DRIVER, AppConstants.ABRGI,
					driverArray, appNumber);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID(AppConstants.STORE_REG_INFORMATION);//Modified by Gauresh for ILIES-282110: SONAR fixes- declaring constant
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			throw createFwException(this.getClass().getName(),
					AppConstants.STORE_REG_INFORMATION, e);//Modified by Gauresh for ILIES-282110: SONAR fixes-immediately throwing exception
		}
	}

	// Sushma added
	public boolean checkForSkipValidation(FwMessageList messageList) {
		log(ILog.INFO, "AppSessionBean::checkForSkipValidation::Start");
		try {
			int messageListSize = 0;
			if (messageList != null)
				messageListSize = messageList.getMessageListSize();
			boolean skipvalidation = false;
			for (int i = 0; i < messageListSize; i++) {
				if (messageList.getMessageAtIndex(i).getMessageCode() == "36200"
						|| messageList.getMessageAtIndex(i).getMessageCode() == "36202") {
					// skipvalidation true only if there is only address
					// invalidation only
					skipvalidation = true;
				} else {
					skipvalidation = false;
					break;
				}
			}

			log(ILog.INFO, "AppSessionBean::checkForSkipValidation::End");
			return skipvalidation;
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(),
					"checkForSkipValidation", e);
			throw fe;
		}
	}

	// Sushma ended
	/**
	 * Method to get priorty service questions
	 */
	public void getPriorityServiceQuestions(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {
			Map request = txnBean.getRequest();
			Map session = txnBean.getSession();
			Map pageCollection = txnBean.getPageCollection();
			FwMessageList messageList = null;
			APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = null;
			ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
			aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
			// call validatePSEligibility to show info message if tha APP_NUM is
			// eligible
			String flag = (String) session.get("PSE_FLAG");
			messageList = aBPriorityServiceBO
					.validatePSEligibility(aPP_PRIR_SRV_Collection);
			if (aBPriorityServiceBO.hasMessages() && (flag != null)
					&& (flag != FwConstants.NO)) {
				request.put(FwConstants.MESSAGE_LIST, messageList);
			} else {
				session.put("PSE_FLAG", FwConstants.NO);
			}

			//Arjun: added to hide Income and expense sections when user already given income and expenses.   
			String appNum= (String) session
					.get(AppConstants.APP_NUMBER);
			
			//Changes made by Varshi Kasarla for ILIES-282111. Not to prefill SNAP radio button on ABHMD -- START
			String pageAction = (String) request.get(AppConstants.PAGE_ACTION);
			if(pageAction != null && ("ABSVENext".equals(pageAction) || "ClearSessionAndLoginToAFBWelcomeBack".equals(pageAction))){
				short[] selectedProgram = (short[]) session.get(FwConstants.AFB_PROGRAM_KEY);
				
				APP_IN_PRFL_Collection appInPrflCollection = (APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);

				if(appInPrflCollection == null || appInPrflCollection.isEmpty()){

					APP_IN_PRFL_Cargo appInPrflCargo = new APP_IN_PRFL_Cargo();
					appInPrflCargo.setApp_num(appNum);
					
					appInPrflCargo.setIndv_fma_rqst_ind(String.valueOf(selectedProgram[0])); 
					appInPrflCargo.setIndv_fpw_rqst_ind(String.valueOf(selectedProgram[1])); 
					appInPrflCargo.setIndv_fs_rqst_ind(String.valueOf(selectedProgram[2])); 
					appInPrflCargo.setIndv_hc_rqst_ind(String.valueOf(selectedProgram[3])); 
					appInPrflCargo.setIndv_ebd_rqst_ind(String.valueOf(selectedProgram[4])); 
					appInPrflCargo.setIndv_hpe_rqst_ind("0");
					appInPrflCargo.setIndv_msp_rqst_ind(String.valueOf(selectedProgram[7])); 
					appInPrflCargo.setIndv_fpp_pgm(String.valueOf(selectedProgram[8])); 
					
					appInPrflCargo.setIndv_seq_num("1");
					IApplicationManager applicationManager = ApplicationManager.getInstance();
					applicationManager.createAppIndividualProfile(appInPrflCargo);
					
					APP_IN_PRFL_Collection  appInPrflSessioncoll = applicationManager.loadAppIndividualProfile(appNum);
					//Modified by Varshi for ILIES-282111: SONAR fixes: replacing size() with isEmpty().
					if(appInPrflSessioncoll != null && !appInPrflSessioncoll.isEmpty()){
						session.put(AppConstants.APP_IN_PRFL_MASTER,appInPrflSessioncoll);
					}else{
						appInPrflSessioncoll.addCargo(appInPrflCargo);
					}
				}
			}
			
			//Changes made by Varshi Kasarla for ILIES-282111. Not to prefill SNAP radio button on ABHMD -- END
			
			
			double totalJobIncome=calculateTotalJobIncome(appNum, session);
			double totalOtherIncome=calculateTotalOtherIncome(appNum, session);
			double totalSelEmpIncome=calculatetotalSelfEmploymentIncome(appNum, session);
			double countableIncome = totalJobIncome+ totalSelEmpIncome + totalOtherIncome - calculateChildSupportPayment(appNum, session);
			if(countableIncome<0.0){countableIncome=0.0;}
			
			
			String PREFILLED_INCOME= String.format("%.2f",(totalJobIncome+totalOtherIncome+totalSelEmpIncome));
			String PREFILLED_EXPENSES=String.format("%.2f",(calculateTotalExpenses(appNum, session)));
			String PREFILLED_ASSETS = String.format("%.2f",(calculateTotalAssets(appNum, session)));
			String PREFILLED_CHILD_SUPPORT = String.format("%.2f",(calculateChildSupportPayment(appNum, session)));
			String PREFILLED_HEAT_EXPENSE = getHeatExpense(appNum,session);
			String PREFILLED_NON_HEAT_ELECTRICITY_EXPENSE = getNonHeatElectricityExpense(appNum,session);
			String PREFILLED_COOK_FUEL_EXPENSE = getCookFuelExpense(appNum,session);
			String PREFILLED_GARBAGE_REMOVAL_EXPENSE = getGarbageRemovalExpense(appNum,session);
			String PREFILLED_TELEPHONE_EXPENSE = getTelephoneExpense(appNum,session);
			String PREFILLED_UTILITY_EXPENSE = getUtlilityExpense(appNum,session);
			String PREFILLED_WATER_SEWER_WELL_SEPTIC_EXPENSE = getWaterSewerWellSepticExpense(appNum,session);
			String PREFILLED_SEWER_WATER_EXPENSE = getSewerWaterExpense(appNum,session);
			String PREFILLED_FARMER_STATUS = getFarmerStatus(appNum, session);
			//ILIES-280700
			String LIHEAP_STATUS = "";			
			if(session.get("LIHEAP_STATUS") != null){
				LIHEAP_STATUS = (String)session.get("LIHEAP_STATUS"); 
			}
			
			String PREFILLED_LIHEAP_STATUS = "";
			
			if(!LIHEAP_STATUS.equals("")){
				PREFILLED_LIHEAP_STATUS = LIHEAP_STATUS;
			}else{
				PREFILLED_LIHEAP_STATUS = getLiHeapStatus(appNum, session);
			}
			String PREFILLED_COUNTABLE_INCOME = String.format("%.2f",(countableIncome)); 
			
			pageCollection.put("PREFILLED_INCOME",PREFILLED_INCOME);
			pageCollection.put("PREFILLED_EXPENSES",PREFILLED_EXPENSES);
			pageCollection.put("PREFILLED_ASSETS",PREFILLED_ASSETS);
			pageCollection.put("PREFILLED_CHILD_SUPPORT",PREFILLED_CHILD_SUPPORT);
			pageCollection.put("PREFILLED_HEAT_EXPENSE",PREFILLED_HEAT_EXPENSE);
			pageCollection.put("PREFILLED_COOK_FUEL_EXPENSE",PREFILLED_COOK_FUEL_EXPENSE);
			pageCollection.put("PREFILLED_GARBAGE_REMOVAL_EXPENSE",PREFILLED_GARBAGE_REMOVAL_EXPENSE);
			pageCollection.put("PREFILLED_TELEPHONE_EXPENSE",PREFILLED_TELEPHONE_EXPENSE);
			pageCollection.put("PREFILLED_UTILITY_EXPENSE",PREFILLED_UTILITY_EXPENSE);
			pageCollection.put("PREFILLED_WATER_SEWER_WELL_SEPTIC_EXPENSE",PREFILLED_WATER_SEWER_WELL_SEPTIC_EXPENSE);
			pageCollection.put("PREFILLED_NON_HEAT_ELECTRICITY_EXPENSE",PREFILLED_NON_HEAT_ELECTRICITY_EXPENSE);
			pageCollection.put("PREFILLED_SEWER_WATER_EXPENSE",PREFILLED_SEWER_WATER_EXPENSE);
			pageCollection.put("PREFILLED_FARMER_STATUS",PREFILLED_FARMER_STATUS);
			pageCollection.put("PREFILLED_LIHEAP_STATUS",PREFILLED_LIHEAP_STATUS);
			pageCollection.put("PREFILLED_COUNTABLE_INCOME", PREFILLED_COUNTABLE_INCOME);
			
			//Arjun: End
			
			// santosh added to set the income amount and disable field
			// santosh commented
			/*
			 * int[] driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			 * int driverStatus = (int)
			 * driverManager.getAFBStatus(FwConstants.AFB_DRIVER, "ABUAD",
			 * driverArray); if (driverStatus == FwConstants.DRIVER_COMPLETE){
			 * session.put("disableIncomeAmt", "Y"); APP_PRIR_SRV_Cargo
			 * aPP_PRIR_SRVCargo = aPP_PRIR_SRV_Collection.getCargo();
			 * aBPriorityServiceBO.prefillPriorityService(aPP_PRIR_SRVCargo,
			 * (String)session.get(AppConstants.APP_NUMBER));
			 * 
			 * }
			 */
			// santosh end

			pageCollection.put("APP_PRIR_SRV_Collection",
					aPP_PRIR_SRV_Collection);
			session.put(FwConstants.BEFORE_COLLECTION, pageCollection);
			txnBean.setPageCollection(pageCollection);
			txnBean.setSession(session);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getPriorityServiceQuestions");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getPriorityServiceQuestions", e);
			throw fe;
		}

	}

	/**
	 * Method to store priorty service questions
	 */
	public void storePriorityServiceQuestions(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {
			Map request = txnBean.getRequest();
			Map session = txnBean.getSession();
			Map pageCollection = txnBean.getPageCollection();
			Map beforeMap = null;
			APP_PRIR_SRV_Collection beforeAPP_PRIR_SRV_Collection = null;
			APP_PRIR_SRV_Cargo beforeAPP_PRIR_SRV_Cargo = null;
			APP_PRIR_SRV_Collection pageAPP_PRIR_SRV_Collection = null;
			APP_PRIR_SRV_Cargo pageAPP_PRIR_SRV_Cargo = null;
			FwMessageList messageList = null;
			int[] driverArray = null;
			ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();

			beforeMap = (Map) session.get(FwConstants.BEFORE_COLLECTION);
			beforeAPP_PRIR_SRV_Collection = (APP_PRIR_SRV_Collection) beforeMap
					.get("APP_PRIR_SRV_Collection");
			beforeAPP_PRIR_SRV_Cargo = beforeAPP_PRIR_SRV_Collection.getCargo();
			pageAPP_PRIR_SRV_Collection = (APP_PRIR_SRV_Collection) pageCollection
					.get("APP_PRIR_SRV_Collection");
			pageAPP_PRIR_SRV_Cargo = pageAPP_PRIR_SRV_Collection.getCargo();
			
			String PREFILLED_INCOME= (String)request.get("PREFILLED_INCOME");
			String PREFILLED_EXPENSES= (String)request.get("PREFILLED_EXPENSES");
			//ILIES-253773
			String PREFILLED_CHILD_SUPPORT = (String)request.get("PREFILLED_CHILD_SUPPORT");
			//ILIES-253773
			boolean prefillExpensesFlag=true;
			boolean prefillIncomeFlag=true;
			//ILIES-253773
			boolean prefillChildFlag =true;
			//ILIES-253773
			if(Double.parseDouble(PREFILLED_INCOME)==0){
				prefillIncomeFlag=false;
			}
			
			if(Double.parseDouble(PREFILLED_EXPENSES)==0){
				prefillExpensesFlag=false;
			} 
			//ILIES-253773
			if(Double.parseDouble(PREFILLED_CHILD_SUPPORT)==0){
				prefillChildFlag=false;
			} 
			//ILIES-253773
			
			messageList = aBPriorityServiceBO
					.validatePriorityServiceQuestions(pageAPP_PRIR_SRV_Collection, prefillIncomeFlag, prefillExpensesFlag);
			if (aBPriorityServiceBO.hasMessages()) {
				request.put(FwConstants.MESSAGE_LIST, messageList);
				// request already has afterColl so we need to put afterColl
				// back in the request
				return;
			}
			String pSEFlag = (String) session.get("PSE_FLAG");
			messageList = aBPriorityServiceBO
					.validatePSEligibility(pageAPP_PRIR_SRV_Collection);
			if (aBPriorityServiceBO.hasMessages()) {
				if (!pSEFlag.equals(FwConstants.YES)) {
					request.put(FwConstants.MESSAGE_LIST, messageList);
					session.put("PSE_FLAG", FwConstants.YES);
					return;
				}
			}

			// santosh added for expediatd screen warning message display when
			// income amt doesn't matches
			
			String appNum = (String) session.get(AppConstants.APP_NUMBER);
			// Start: Commented by arpanday: Expedited SNAP: ILIES-174321
			//Commented this logic as Income section will not be displayed in screen when income is given in previous screens
			/*
			boolean skipcounter = false;
			if (appNum != null && appNum.length() > 0) {
				messageList = aBPriorityServiceBO
						.compareIncomeAndDisplayWarningMsg(appNum,
								pageAPP_PRIR_SRV_Cargo.getMo_gr_incm_amt());

				if (messageList != null && messageList.hasMessages()) {
					// santosh
					String reqWarningMsgs = (String) request
							.get(FwConstants.WARNING_MSG_DETAILS);
					if (!this.checkForWarningMesgs(reqWarningMsgs, messageList)) {
						String skipValidate = (String) session
								.get("SKIP_VALIDATE");
						if (skipValidate != null
								&& skipValidate.equals("skipvalidate")) {
							if (!checkForSkipValidation(messageList)) {
								request.put(FwConstants.MESSAGE_LIST,
										messageList);
								pageCollection.put("APP_PRIR_SRV_Collection",
										pageAPP_PRIR_SRV_Collection);
								return;
							} else {
								skipcounter = true;
							}
						} else {

							if (skipValidate == null || skipValidate.equals("")) {
								if (checkForSkipValidation(messageList)) {

									session.put("SKIP_VALIDATE", "skipvalidate");
								}
							}

						}
						if (skipcounter == false) {
							request.put(FwConstants.MESSAGE_LIST, messageList);
							pageCollection.put("APP_PRIR_SRV_Collection",
									pageAPP_PRIR_SRV_Collection);
							return;
						}
					}
				}
			}*/
			//END:  Commented by arpanday: Expedited SNAP: ILIES-174321
			pageAPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) isChanged(
					beforeAPP_PRIR_SRV_Cargo, pageAPP_PRIR_SRV_Cargo);
			// if(pageAPP_PRIR_SRV_Cargo.isDirty()){
			// set APPNUM for pageCargo from session
			pageAPP_PRIR_SRV_Cargo.setApp_num((String) session
					.get(AppConstants.APP_NUMBER));
			// set all the fields of the pageCargo that are not used on the JSP
			if (pageAPP_PRIR_SRV_Cargo.getLqd_aset_ind() == null) {
				pageAPP_PRIR_SRV_Cargo.setLqd_aset_ind("0");
			}
			if (pageAPP_PRIR_SRV_Cargo.getMo_gr_incm_ind() == null) {
				pageAPP_PRIR_SRV_Cargo.setMo_gr_incm_ind("0");
			}
			if (pageAPP_PRIR_SRV_Cargo.getMo_rent_mrtg_ind() == null) {
				pageAPP_PRIR_SRV_Cargo.setMo_rent_mrtg_ind("0");
			}
			if (pageAPP_PRIR_SRV_Cargo.getMo_util_ind() == null) {
				pageAPP_PRIR_SRV_Cargo.setMo_util_ind("0");
			}
			if (pageAPP_PRIR_SRV_Cargo.getRec_cplt_ind() == null) {
				pageAPP_PRIR_SRV_Cargo.setRec_cplt_ind("0");
			}
			
			//ILIES-253773
			if (pageAPP_PRIR_SRV_Cargo.getChild_sprt_amt_ind() == null) {
				pageAPP_PRIR_SRV_Cargo.setChild_sprt_amt_ind("0");
			}
			
			//ILIES-253773		

			// set all null fields of pageCargo to empty strings(null for
			// unselected radio buttons)
			if (pageAPP_PRIR_SRV_Cargo.getRcv_fs_cur_mo_sw() == null) {
				pageAPP_PRIR_SRV_Cargo.setRcv_fs_cur_mo_sw(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getWmen_chld_shlt_sw() == null) {
				pageAPP_PRIR_SRV_Cargo.setWmen_chld_shlt_sw(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getMig_farm_wrkr_sw() == null) {
				pageAPP_PRIR_SRV_Cargo.setMig_farm_wrkr_sw(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getIncm_stop_sw() == null) {
				pageAPP_PRIR_SRV_Cargo.setIncm_stop_sw(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getNew_incm_sw() == null) {
				pageAPP_PRIR_SRV_Cargo.setNew_incm_sw(" ");
			}
			/* added by mkansara ILIES-71628 */

			// set all amount fields to zero when they are empty
			/*
			 * if(pageAPP_PRIR_SRV_Cargo.getMo_gr_incm_amt().equals("")){
			 * pageAPP_PRIR_SRV_Cargo.setMo_gr_incm_amt("0.0"); }
			 * if(pageAPP_PRIR_SRV_Cargo.getLqd_aset_amt().equals("")){
			 * pageAPP_PRIR_SRV_Cargo.setLqd_aset_amt("0.0"); }
			 * if(pageAPP_PRIR_SRV_Cargo.getMo_rent_mrtg_amt().equals("")){
			 * pageAPP_PRIR_SRV_Cargo.setMo_rent_mrtg_amt("0.0"); }
			 * if(pageAPP_PRIR_SRV_Cargo.getMo_util_amt().equals("")){
			 * pageAPP_PRIR_SRV_Cargo.setMo_util_amt("0.0"); }
			 */

			// Sushma start added 6/14
			// Sushma start adding 6/22
			// set all amount fields to zero when they are empty
			if ((pageAPP_PRIR_SRV_Cargo.getMo_gr_incm_amt() == null || pageAPP_PRIR_SRV_Cargo
					.getMo_gr_incm_amt().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getMo_gr_incm_amt()
							.equals("0.00")) {
				pageAPP_PRIR_SRV_Cargo.setMo_gr_incm_amt("0");
			}
			if ((pageAPP_PRIR_SRV_Cargo.getLqd_aset_amt() == null || pageAPP_PRIR_SRV_Cargo
					.getLqd_aset_amt().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getLqd_aset_amt().equals("0.00")) {
				pageAPP_PRIR_SRV_Cargo.setLqd_aset_amt("0");
			}
			if ((pageAPP_PRIR_SRV_Cargo.getMo_rent_mrtg_amt() == null || pageAPP_PRIR_SRV_Cargo
					.getMo_rent_mrtg_amt().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getMo_rent_mrtg_amt().equals(
							"0.00")) {
				pageAPP_PRIR_SRV_Cargo.setMo_rent_mrtg_amt("0");
			}
			if ((pageAPP_PRIR_SRV_Cargo.getMo_util_amt() == null || pageAPP_PRIR_SRV_Cargo
					.getMo_util_amt().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getMo_util_amt().equals("0.00")) {
				pageAPP_PRIR_SRV_Cargo.setMo_util_amt("0");
			}
			// Sushma end adding 6/22
			
			//ILIES-253773
			if ((pageAPP_PRIR_SRV_Cargo.getChild_sprt_amt() == null || pageAPP_PRIR_SRV_Cargo
					.getChild_sprt_amt().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getChild_sprt_amt()
							.equals("0.00")) {
				pageAPP_PRIR_SRV_Cargo.setChild_sprt_amt("0");
			}
			//ILIES-253773
			
			// first
			if (pageAPP_PRIR_SRV_Cargo.getDt_incm_same_grwr() == null
					|| pageAPP_PRIR_SRV_Cargo.getDt_incm_same_grwr().trim()
							.length() == 0) {
				pageAPP_PRIR_SRV_Cargo
						.setDt_incm_same_grwr(AppConstants.HIGH_TIMESTAMP);
			} else {
				pageAPP_PRIR_SRV_Cargo.setDt_incm_same_grwr(displayFormatter
						.getYYYYMMDDTimestamp(pageAPP_PRIR_SRV_Cargo
								.getDt_incm_same_grwr()));
			}
			// second
			if (pageAPP_PRIR_SRV_Cargo.getDt_incm_crnt_mnth() == null
					|| pageAPP_PRIR_SRV_Cargo.getDt_incm_crnt_mnth().trim()
							.length() == 0) {
				pageAPP_PRIR_SRV_Cargo
						.setDt_incm_crnt_mnth(AppConstants.HIGH_TIMESTAMP);
			} else {
				pageAPP_PRIR_SRV_Cargo.setDt_incm_crnt_mnth(displayFormatter
						.getYYYYMMDDTimestamp(pageAPP_PRIR_SRV_Cargo
								.getDt_incm_crnt_mnth()));
			}
			// third
			if (pageAPP_PRIR_SRV_Cargo.getDt_trvl_advc() == null
					|| pageAPP_PRIR_SRV_Cargo.getDt_trvl_advc().trim().length() == 0) {
				pageAPP_PRIR_SRV_Cargo
						.setDt_trvl_advc(AppConstants.HIGH_TIMESTAMP);
			} else {
				pageAPP_PRIR_SRV_Cargo.setDt_trvl_advc(displayFormatter
						.getYYYYMMDDTimestamp(pageAPP_PRIR_SRV_Cargo
								.getDt_trvl_advc()));
			}
			// fourth
			if (pageAPP_PRIR_SRV_Cargo.getDt_final_pay_chk() == null
					|| pageAPP_PRIR_SRV_Cargo.getDt_final_pay_chk().trim()
							.length() == 0) {
				pageAPP_PRIR_SRV_Cargo
						.setDt_final_pay_chk(AppConstants.HIGH_TIMESTAMP);
			} else {
				pageAPP_PRIR_SRV_Cargo.setDt_final_pay_chk(displayFormatter
						.getYYYYMMDDTimestamp(pageAPP_PRIR_SRV_Cargo
								.getDt_final_pay_chk()));
			}

			// Sushma start added 6/22

			if ((pageAPP_PRIR_SRV_Cargo.getAmt_same_grwr() == null || pageAPP_PRIR_SRV_Cargo
					.getAmt_same_grwr().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getAmt_same_grwr().equals("0.00")) {
				pageAPP_PRIR_SRV_Cargo.setAmt_same_grwr("0");

			}
			if ((pageAPP_PRIR_SRV_Cargo.getAmt_crnt_mnth() == null || pageAPP_PRIR_SRV_Cargo
					.getAmt_crnt_mnth().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getAmt_crnt_mnth().equals("0.00")) {
				pageAPP_PRIR_SRV_Cargo.setAmt_crnt_mnth("0");

			}
			if ((pageAPP_PRIR_SRV_Cargo.getAmt_trvl_advc() == null || pageAPP_PRIR_SRV_Cargo
					.getAmt_trvl_advc().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getAmt_trvl_advc().equals("0.00")) {
				pageAPP_PRIR_SRV_Cargo.setAmt_trvl_advc("0");

			}
			if ((pageAPP_PRIR_SRV_Cargo.getAmt_fnal_pay_chk() == null || pageAPP_PRIR_SRV_Cargo
					.getAmt_fnal_pay_chk().trim().length() == 0)
					|| pageAPP_PRIR_SRV_Cargo.getAmt_fnal_pay_chk().equals(
							"0.00")) {
				pageAPP_PRIR_SRV_Cargo.setAmt_fnal_pay_chk("0");

			}
			// Sushma end adding 6/22
			if (pageAPP_PRIR_SRV_Cargo.getIncm_same_grwr_sw() == null
					|| pageAPP_PRIR_SRV_Cargo.getIncm_same_grwr_sw().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setIncm_same_grwr_sw(" ");

			}
			if (pageAPP_PRIR_SRV_Cargo.getIncm_crnt_mnth_sw() == null
					|| pageAPP_PRIR_SRV_Cargo.getIncm_crnt_mnth_sw().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setIncm_crnt_mnth_sw(" ");

			}
			if (pageAPP_PRIR_SRV_Cargo.getTrvl_advc_sw() == null
					|| pageAPP_PRIR_SRV_Cargo.getTrvl_advc_sw().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setTrvl_advc_sw(" ");

			}
			if (pageAPP_PRIR_SRV_Cargo.getLst_only_src_incm_sw() == null
					|| pageAPP_PRIR_SRV_Cargo.getLst_only_src_incm_sw().equals(
							"")) {
				pageAPP_PRIR_SRV_Cargo.setLst_only_src_incm_sw(" ");

			}
			if (pageAPP_PRIR_SRV_Cargo.getLiheap_receive_sw() == null
					|| pageAPP_PRIR_SRV_Cargo.getLiheap_receive_sw().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setLiheap_receive_sw(" ");
			}

			// sushma end added 6/16

			// Sushma end added 6/14
			// sushma Added 6/16
			if (pageAPP_PRIR_SRV_Cargo.getCount_grs_assets_incm_resp() == null
					|| pageAPP_PRIR_SRV_Cargo.getCount_grs_assets_incm_resp()
							.equals("")) {
				pageAPP_PRIR_SRV_Cargo.setCount_grs_assets_incm_resp(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getHeat_utility_exp() == null
					|| pageAPP_PRIR_SRV_Cargo.getHeat_utility_exp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setHeat_utility_exp(" ");
			}
			// smulpuru added septic installation,util installation, none
			if (pageAPP_PRIR_SRV_Cargo.getSeptic_instl_resp() == null
					|| pageAPP_PRIR_SRV_Cargo.getSeptic_instl_resp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setSeptic_instl_resp(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getUtil_instl_resp() == null
					|| pageAPP_PRIR_SRV_Cargo.getUtil_instl_resp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setUtil_instl_resp(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getNone_resp() == null
					|| pageAPP_PRIR_SRV_Cargo.getNone_resp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setNone_resp(" ");
			}

			if (pageAPP_PRIR_SRV_Cargo.getNon_heat_ele_exp() == null
					|| pageAPP_PRIR_SRV_Cargo.getNon_heat_ele_exp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setNon_heat_ele_exp(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getCook_fuel_exp() == null
					|| pageAPP_PRIR_SRV_Cargo.getCook_fuel_exp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setCook_fuel_exp(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getTele_exp() == null
					|| pageAPP_PRIR_SRV_Cargo.getTele_exp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setTele_exp(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getWatsew_exp() == null
					|| pageAPP_PRIR_SRV_Cargo.getWatsew_exp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setWatsew_exp(" ");
			}
			if (pageAPP_PRIR_SRV_Cargo.getTrash_removal_exp() == null
					|| pageAPP_PRIR_SRV_Cargo.getTrash_removal_exp().equals("")) {
				pageAPP_PRIR_SRV_Cargo.setTrash_removal_exp(" ");
			}
			
			// sushma end added 6/16

			
			// Expedited SNAP Added by arpanday: ILIES-174321
			
			double totalExpenses=0;
			//ILIES - 280750 changes start
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getNon_heat_ele_exp() != null && pageAPP_PRIR_SRV_Cargo.getNon_heat_ele_exp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setNon_heat_ele_exp("NE");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getTrash_removal_exp() != null && pageAPP_PRIR_SRV_Cargo.getTrash_removal_exp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setTrash_removal_exp("GR");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getCook_fuel_exp() != null && pageAPP_PRIR_SRV_Cargo.getCook_fuel_exp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setCook_fuel_exp("CF");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getWatsew_exp() != null && pageAPP_PRIR_SRV_Cargo.getWatsew_exp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setWatsew_exp("WS");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getTele_exp() != null && pageAPP_PRIR_SRV_Cargo.getTele_exp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setTele_exp("TP");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getHeat_utility_exp() != null && pageAPP_PRIR_SRV_Cargo.getHeat_utility_exp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setHeat_utility_exp("HT");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getSeptic_instl_resp() != null && pageAPP_PRIR_SRV_Cargo.getSeptic_instl_resp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setSeptic_instl_resp("SI");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getUtil_instl_resp() != null && pageAPP_PRIR_SRV_Cargo.getUtil_instl_resp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setUtil_instl_resp("UT");
			}
			if (pageAPP_PRIR_SRV_Cargo != null && pageAPP_PRIR_SRV_Cargo.getNone_resp() != null && pageAPP_PRIR_SRV_Cargo.getNone_resp().equals("Y")) {
				pageAPP_PRIR_SRV_Cargo.setNone_resp("NN");
			}
			if (prefillExpensesFlag) {
				// Prefilling Housing Bills:
				/*prefilingHouseBillsAndLIHEAP(pageAPP_PRIR_SRV_Cargo, session,
						appNum);*/
				
				if (PREFILLED_EXPENSES != null) {
					totalExpenses = Double.parseDouble(PREFILLED_EXPENSES);
				} else {
					totalExpenses = calculateTotalExpenses(appNum, session);
				}
				// Mapping total Expenses to IES
				pageAPP_PRIR_SRV_Cargo.setMo_rent_mrtg_amt(Double
						.toString(totalExpenses));
			}
			//ILIES - 280750 changes end
			
			if(prefillIncomeFlag){
				double totalIncome=0;
				
				 if(PREFILLED_INCOME !=null){
					 totalIncome=Double.parseDouble(PREFILLED_INCOME);
				 }
				 else{
					double totalOtherIncome=0;
					double totalJobIncome=0;
					double totalSelfEmployment=0;				
					totalOtherIncome=calculateTotalOtherIncome(appNum, session);
					totalJobIncome=calculateTotalJobIncome(appNum, session);
					totalSelfEmployment=calculatetotalSelfEmploymentIncome(appNum, session);
						 
					//Calculating total Income
					totalIncome=totalOtherIncome+totalJobIncome+totalSelfEmployment;
				 }
				 
				 if(totalIncome<0){
					 totalIncome=0; // handled in the case if self employment expenses is too high
				 }			 
				 //Mappint total Income to IES
				 pageAPP_PRIR_SRV_Cargo.setMo_gr_incm_amt(Double.toString(totalIncome));
				 
			} 
			
			//ILIES-253773
			if(prefillChildFlag){
				double child_support_amt = 0;
				
				if (PREFILLED_CHILD_SUPPORT !=null){
					child_support_amt = Double.parseDouble(PREFILLED_CHILD_SUPPORT);
				}
				
				//Mapping child support amount to IES
				
				pageAPP_PRIR_SRV_Cargo.setChild_sprt_amt(Double.toString(child_support_amt));
			}
			//ILIES-253773
			
			//code change for 280700 starts
			String LIHEAP_STATUS = "";
			if(request.get("liheapReceive") != null){
				LIHEAP_STATUS = (String)request.get("liheapReceive"); 
				session.put("LIHEAP_STATUS", LIHEAP_STATUS);
			}
			//code change for 280700 ends
			
			
			// END: added by Arpanday for expedited snap : ILIES-174321

			// Blank page loaded and dirty true(user entered in some filed)
			if (beforeAPP_PRIR_SRV_Cargo.getApp_num() == null) {
				pageAPP_PRIR_SRV_Cargo
						.setRowAction(FwConstants.ROWACTION_INSERT);
			} else {
				pageAPP_PRIR_SRV_Cargo
						.setRowAction(FwConstants.ROWACTION_UPDATE);
			}
			aBPriorityServiceBO
					.storePriorityServiceQuestions(pageAPP_PRIR_SRV_Collection);
			
			//ILIES-280700-Start
			ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
			APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
			APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
			appPrflCargo.setSu_asst_lieap_resp(pageAPP_PRIR_SRV_Cargo.getLiheap_receive_sw());
			appPrflCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
			housingBillsQuestionsBo.storeHousingExpenseQuestions(appPrflColl);
			////ILIES-280700-END

			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			driverManager.makeComplete(FwConstants.AFB_DRIVER,
					(String) request.get(FwConstants.CURRENT_PAGE_ID),
					driverArray, (String) session.get(AppConstants.APP_NUMBER));
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storePriorityServiceQuestions");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storePriorityServiceQuestions", e);
			throw fe;
		}
	}
	
	private void prefilingHouseBillsAndLIHEAP(APP_PRIR_SRV_Cargo pageAPP_PRIR_SRV_Cargo, Map session, String appNum) {

		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		if(appPrflCargo.getSu_asst_lieap_resp()!=null){
			String LIHAPValue=appPrflCargo.getSu_asst_lieap_resp();
			pageAPP_PRIR_SRV_Cargo.setLiheap_receive_sw(LIHAPValue);
			
			if(appPrflCargo.getSu_asst_lieap_resp().equalsIgnoreCase(AppConstants.NO)){
				APP_IN_PRFL_Collection appInPrflCollection=null;
				
				appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
				boolean waterInstallationFlag=false;
				boolean sewerInstallationFlag=false;
				boolean cookingFuelFlag=false;
				boolean nonHeatElectricityFlag=false;
				boolean teltphoneFlag=false;
				boolean garvageRemovalFlag=false;
				boolean utilityInstallationFlag=false;
				boolean heatFlag=false;
				boolean airconditioningFlag=false;
				
				for(int i=0;i<appInPrflCollection.size();i++){
					APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
						
					if(appInCargo.getSu_cst_wtr_resp()!=null && !waterInstallationFlag && (appInCargo.getSu_cst_wtr_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_wtr_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						waterInstallationFlag=true;
					}
					if(appInCargo.getSu_cst_swr_resp()!=null && !sewerInstallationFlag && (appInCargo.getSu_cst_swr_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_swr_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						sewerInstallationFlag=true;
					}
					if(appInCargo.getSu_cst_lpgas_resp()!=null && !cookingFuelFlag && (appInCargo.getSu_cst_lpgas_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_lpgas_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						cookingFuelFlag=true;
						 pageAPP_PRIR_SRV_Cargo.setCook_fuel_exp("CF");
					}
					if(appInCargo.getSu_cst_elec_resp()!=null && !nonHeatElectricityFlag && (appInCargo.getSu_cst_elec_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_elec_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						nonHeatElectricityFlag=true;
						pageAPP_PRIR_SRV_Cargo.setNon_heat_ele_exp("NE");
					}
					if(appInCargo.getSu_cst_phn_resp()!=null && !teltphoneFlag && (appInCargo.getSu_cst_phn_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_phn_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						teltphoneFlag=true;
						pageAPP_PRIR_SRV_Cargo.setTele_exp("TP");
					}
					if(appInCargo.getSu_cst_trsh_resp()!=null && !garvageRemovalFlag && (appInCargo.getSu_cst_trsh_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_trsh_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						garvageRemovalFlag=true;
						pageAPP_PRIR_SRV_Cargo.setTrash_removal_exp("GR");
					}
					if(appInCargo.getSu_cst_istl_resp()!=null && !utilityInstallationFlag && (appInCargo.getSu_cst_istl_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_istl_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						utilityInstallationFlag=true;
						 pageAPP_PRIR_SRV_Cargo.setUtil_instl_resp("UT");
					}
					if(appInCargo.getSu_cst_wood_resp()!=null && !heatFlag && (appInCargo.getSu_cst_wood_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_wood_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						heatFlag=true;
					}
					if(appInCargo.getCool_exp_resp()!=null && !airconditioningFlag && (appInCargo.getCool_exp_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getCool_exp_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
						airconditioningFlag=true;
					}
				}
				
                if (waterInstallationFlag || sewerInstallationFlag)
                {
                    pageAPP_PRIR_SRV_Cargo.setWatsew_exp("WS");
                }
                if (heatFlag || airconditioningFlag)
                {
                    pageAPP_PRIR_SRV_Cargo.setHeat_utility_exp("HT");
                }
			}
		}								
	}

	private double calculatetotalSelfEmploymentIncome(String appNum, Map session) {
		PeopleHandler peopleHandler = (PeopleHandler) session.get(AppConstants.INDIV_MASTER_HANDLER);	
	    INDIVIDUAL_Custom_Collection aIndvCustomColl= peopleHandler.getAllIndividuals();
		
		INDIVIDUAL_Custom_Collection snapHHCollection=getExpeditedSNAPHouseHoldCollection(aIndvCustomColl,appNum);
		APP_IN_PRFL_Collection appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		int snapHHCollectionSize=snapHHCollection.size();
		
		//BO to get collection for Self Employment
		ABJobIncomeBO abJobIncomeBO=new ABJobIncomeBO();
		APP_IN_SELFE_Collection appInSELFECollection=abJobIncomeBO.loadSelfEmploymentDetails(appNum);
		
		String selfEmploymentIncomeFlag=new String(); 
		 double totalSelfEmployment=0;
		 APP_IN_SELFE_Cargo appInSELFECargo=null;
		 APP_IN_SELFE_Collection returnSELFEColl=null;
		 INDIVIDUAL_Custom_Cargo indvCustomCargo=null;
		 APP_IN_PRFL_Cargo  snapHHCargo=null;
		 
		 for(int i=0; i<snapHHCollectionSize;i++){
			 
				indvCustomCargo= (INDIVIDUAL_Custom_Cargo) snapHHCollection.get(i);
				int indvSeqNumber=Integer.parseInt(indvCustomCargo.getIndv_seq_num());					 				 
				snapHHCargo= (APP_IN_PRFL_Cargo) getappINDVCargo(appInPrflCollection, indvSeqNumber);
				
				// Self Employment Mapping
				
				double totalSelfEmploymentIncomeFotThisPerson=0;
				selfEmploymentIncomeFlag=snapHHCargo.getSelf_empl_resp();
				if(selfEmploymentIncomeFlag.equalsIgnoreCase(AppConstants.COMPLETE)){
					
					returnSELFEColl= (APP_IN_SELFE_Collection) getAppInSELFECollection(appInSELFECollection, indvSeqNumber);					
					for(int p=0; p<returnSELFEColl.size(); p++){
						
					appInSELFECargo=returnSELFEColl.getCargo(p);
					
					totalSelfEmploymentIncomeFotThisPerson+=(Double.parseDouble(appInSELFECargo.getAvg_incm_amt())-Double.parseDouble(appInSELFECargo.getExp_amt()));
					}
				}
				totalSelfEmployment+=totalSelfEmploymentIncomeFotThisPerson;
		 }		
		return totalSelfEmployment;
	}

	private double calculateTotalJobIncome(String appNum, Map session) {
		PeopleHandler peopleHandler = (PeopleHandler) session.get(AppConstants.INDIV_MASTER_HANDLER);	
	    INDIVIDUAL_Custom_Collection aIndvCustomColl= peopleHandler.getAllIndividuals();
		
		INDIVIDUAL_Custom_Collection snapHHCollection=getExpeditedSNAPHouseHoldCollection(aIndvCustomColl,appNum);
		APP_IN_PRFL_Collection appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		int snapHHCollectionSize=snapHHCollection.size();
		
		//BO to get collection for Job Income
		ABEmploymentBO employmentDetailsBO = new ABEmploymentBO();
		APP_IN_EMPL_Collection appInEMPLCollection=employmentDetailsBO.loadEmploymentDetail(appNum);
		APP_IN_EMPL_A_WAGE_Collection appInEMPLaWageCollection=employmentDetailsBO.loadsAllEmploymentWageDetail(appNum);
		
		 String[] wageSequences={
				 AppConstants.WAGE_SEQ_OTH1,
				 AppConstants.WAGE_SEQ_OTH2,
				 AppConstants.WAGE_SEQ_ADDITIONAL_PAY,
				 AppConstants.WAGE_SEQ_HOURLY,
				 AppConstants.WAGE_SEQ_SALARY};
		
		 String hourlyPayGatepost=new String();
		 String jobIncomeFlag=new String();
		 double totalJobIncome=0;
		 APP_IN_EMPL_A_WAGE_Cargo [] appINJobIncomeTypes=new APP_IN_EMPL_A_WAGE_Cargo[wageSequences.length];
		 
		 for(int i=0; i<snapHHCollectionSize;i++){
			 
				INDIVIDUAL_Custom_Cargo indvCustomCargo= (INDIVIDUAL_Custom_Cargo) snapHHCollection.get(i);
				int indvSeqNumber=Integer.parseInt(indvCustomCargo.getIndv_seq_num());					 				 
				APP_IN_PRFL_Cargo  snapHHCargo= (APP_IN_PRFL_Cargo) getappINDVCargo(appInPrflCollection, indvSeqNumber);
				// Job Income Mapping
				
				double totalJobIncomeFotThisPerson=0;
				jobIncomeFlag=snapHHCargo.getEmpl_resp();
				if(jobIncomeFlag.equalsIgnoreCase(AppConstants.COMPLETE)){
					
					APP_IN_EMPL_Collection emplIndvCollection= (APP_IN_EMPL_Collection) getAppInEMPLCollection(appInEMPLCollection, indvSeqNumber);
					
				for(int employeeInstance=0; employeeInstance<=emplIndvCollection.size()-1; employeeInstance++){
						APP_IN_EMPL_Cargo appInEMPLCargo= emplIndvCollection.getCargo(employeeInstance);
						int employeeSeqNum=Integer.parseInt(appInEMPLCargo.getEmpl_seq_num());					
					
					double payIncome=0;
					double hourPayAndAdditionalPay=0;
					double bonuscommissionAndTipsPay=0;
					
					for(int n=0; n<wageSequences.length;n++){
						
						appINJobIncomeTypes[n]=getAppInEMPL_A_WAGECargo(appInEMPLaWageCollection, indvSeqNumber,wageSequences[n],employeeSeqNum);
						double salary= Double.parseDouble(appINJobIncomeTypes[n].getAdtl_pay_amt());		
						String jobType=appINJobIncomeTypes[n].getAdtl_pay_typ();
						
						if(wageSequences[n].equalsIgnoreCase(AppConstants.WAGE_SEQ_OTH1) || wageSequences[n].equalsIgnoreCase(AppConstants.WAGE_SEQ_OTH2)){								
								
							bonuscommissionAndTipsPay+=convertFrequencyAndCalculateAmount(salary, appINJobIncomeTypes[n].getAdtl_pay_freq());
							
						}else if(wageSequences[n].equalsIgnoreCase(AppConstants.WAGE_SEQ_ADDITIONAL_PAY) || wageSequences[n].equalsIgnoreCase(AppConstants.WAGE_SEQ_HOURLY)){
							
							double salaryPerweek=salary * Double.parseDouble(appINJobIncomeTypes[n].getAdtl_hrs_qty());
							hourPayAndAdditionalPay+=convertFrequencyAndCalculateAmount(salaryPerweek, AppConstants.PAY_FREQUENCY_WEEKLY);
							
						}else if(wageSequences[n].equalsIgnoreCase(AppConstants.WAGE_SEQ_SALARY)){
					
							payIncome+=convertFrequencyAndCalculateAmount(salary, appInEMPLCargo.getPay_freq_cd());
						}
					
					}
				
					hourlyPayGatepost=appInEMPLCargo.getHour_pay_resp();
					totalJobIncomeFotThisPerson+=bonuscommissionAndTipsPay;
					
					if(hourlyPayGatepost.equalsIgnoreCase(AppConstants.YES)){
						totalJobIncomeFotThisPerson+=hourPayAndAdditionalPay;
					}
					else{
						totalJobIncomeFotThisPerson+=payIncome;
					}
					
				}
				
				totalJobIncome+=totalJobIncomeFotThisPerson;
				}
			}
		return totalJobIncome;
	}

	private double calculateTotalExpenses(String appNum, Map session) {
		 PeopleHandler peopleHandler = (PeopleHandler) session.get(AppConstants.INDIV_MASTER_HANDLER);	
	      INDIVIDUAL_Custom_Collection aIndvCustomColl= peopleHandler.getAllIndividuals();
		
		INDIVIDUAL_Custom_Collection snapHHCollection=getExpeditedSNAPHouseHoldCollection(aIndvCustomColl,appNum);
		APP_IN_PRFL_Collection appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		int snapHHCollectionSize=snapHHCollection.size();	
		
		//BO to get collection for expenses
		ABHousingBillsBO abHousingBillsBO=new ABHousingBillsBO();
		APP_IN_SHLTC_Collection appInSHLTCCollection= (APP_IN_SHLTC_Collection) abHousingBillsBO.loadShelterDetails(appNum);
		
		// Get types from reference Table============		
        String[] filterValue = {"SEL","UP","ML","SA"}; 

        int[] filterColumnId =new int[filterValue.length];
        for(int i=0; i<filterValue.length; i++){
        	filterColumnId[i]=IReferenceConstants.CODE_COLUMN_ID;
        }

        IReferenceTableManager iref = ReferenceTableManager.getInstance();		
		
		int filterMatchCriteria  = IReferenceConstants.FILTER_EXCLUDE_MATCH_ONE;
		
		IReferenceTableData prgmRefData = iref.filterDataOnMultipleColumns("THBT","EN",filterColumnId,filterMatchCriteria, filterValue);
		
		
		String[] shelterType=prgmRefData.getCodeValues();
		
		 HashMap housingBillsSelectedValueMap=new HashMap();
		 double totalExpenses=0;
		 INDIVIDUAL_Custom_Cargo indvCustomCargo=null;
		 APP_IN_PRFL_Cargo  snapHHCargo=null;
		 for(int i=0; i<snapHHCollectionSize;i++){
			 
				indvCustomCargo= (INDIVIDUAL_Custom_Cargo) snapHHCollection.get(i);
				int indvSeqNumber=Integer.parseInt(indvCustomCargo.getIndv_seq_num());					 
				
				snapHHCargo= (APP_IN_PRFL_Cargo) getappINDVCargo(appInPrflCollection, indvSeqNumber);
				
				for(int q=0;q<shelterType.length;q++){
					if(shelterType[q].equalsIgnoreCase("HI")){
						housingBillsSelectedValueMap.put(shelterType[q], snapHHCargo.getSu_cst_home_resp());	// Renter / Homeowner Insurance : HI					
					}else if(shelterType[q].equalsIgnoreCase("MO")){
						housingBillsSelectedValueMap.put(shelterType[q], snapHHCargo.getSu_cst_mtge_resp());	// Mortgate : MO					
					}else if(shelterType[q].equalsIgnoreCase("RT")){
						housingBillsSelectedValueMap.put(shelterType[q], snapHHCargo.getSu_cst_rent_resp());	// Rent : RT						
					}else if(shelterType[q].equalsIgnoreCase("PT")){
						housingBillsSelectedValueMap.put(shelterType[q], snapHHCargo.getSu_cst_tax_resp());			// Property Tax : PT			
					}else if(shelterType[q].equalsIgnoreCase("CO")){
						housingBillsSelectedValueMap.put(shelterType[q], snapHHCargo.getAssociation_fee_resp());		// Condo or Homeowner Association Fees : CO   				
					}else if(shelterType[q].equalsIgnoreCase("OH")){
						housingBillsSelectedValueMap.put(shelterType[q], snapHHCargo.getOther_housing_bill_resp());			//Other : OH			
					}
				}
				
				//Calculating Expenses 
				double totalExpensesForThisPerson=0;
				APP_IN_SHLTC_Cargo appInSHLTCIndvCargo=null;
				APP_IN_SHLTC_Collection appINSHLTCReturnColl=null;
				
				Iterator iterator = housingBillsSelectedValueMap.entrySet().iterator();
				 while (iterator.hasNext()) {
					 Map.Entry mapEntry = (Map.Entry) iterator.next();
					 String mapValue= (String) mapEntry.getValue();
					 String mapKey= (String) mapEntry.getKey();
					 	if(mapValue.equalsIgnoreCase(AppConstants.COMPLETE)){

					 		appINSHLTCReturnColl=getAppInSHLTCIndvCollection(appInSHLTCCollection, indvSeqNumber, mapKey);
							for(int p=0;p<appINSHLTCReturnColl.size();p++){

							appInSHLTCIndvCargo=appINSHLTCReturnColl.getCargo(p);
							totalExpensesForThisPerson+=convertFrequencyAndCalculateAmount(Double.parseDouble(appInSHLTCIndvCargo.getShlt_oblg_amt()), appInSHLTCIndvCargo.getPay_freq());
							
						}
					}
				}
				totalExpenses+=totalExpensesForThisPerson;
		 }
		return totalExpenses;
	}
	
	private double calculateTotalAssets(String appNum, Map session) {
		PeopleHandler peopleHandler = (PeopleHandler) session.get(AppConstants.INDIV_MASTER_HANDLER);	
	    INDIVIDUAL_Custom_Collection aIndvCustomColl= peopleHandler.getAllIndividuals();
	    
	    INDIVIDUAL_Custom_Collection snapHHCollection=getExpeditedSNAPHouseHoldCollection(aIndvCustomColl,appNum);
		APP_IN_PRFL_Collection appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		int snapHHCollectionSize=snapHHCollection.size();	
		
		LiquidAssetBO liquidAssetBo = new LiquidAssetBO();
		APP_IN_LQD_ASET_Collection appInLqdAsetCollection = liquidAssetBo.loadLiquidAssetDetails(appNum);
		ABRegistrationSummaryBO registrationSummaryBO = new ABRegistrationSummaryBO();
	    APP_PGM_RQST_Collection app_PGM_RQST_Collection =registrationSummaryBO.loadProgramSummary(appNum);
		
		double totalAssets = 0;
		INDIVIDUAL_Custom_Cargo indvCustomCargo=null;
		APP_IN_PRFL_Cargo  snapHHCargo=null;
		APP_PGM_RQST_Cargo app_PGM_RQST_Cargo = null;
		
		for(int i=0; i<snapHHCollectionSize;i++){
			 
			indvCustomCargo= (INDIVIDUAL_Custom_Cargo) snapHHCollection.get(i);
			int indvSeqNumber=Integer.parseInt(indvCustomCargo.getIndv_seq_num());					 
			
			snapHHCargo= (APP_IN_PRFL_Cargo) getappINDVCargo(appInPrflCollection, indvSeqNumber);
			APP_IN_LQD_ASET_Cargo appInLQDASETCargo =null;
			APP_IN_LQD_ASET_Collection appInLQDAssetColl=null;
			app_PGM_RQST_Cargo =(APP_PGM_RQST_Cargo) getappPGMRQSTCargo(app_PGM_RQST_Collection, appNum);
			
			appInLQDAssetColl=getAppInLQDASETCollection(appInLqdAsetCollection, indvSeqNumber);
			for(int p=0;p<appInLQDAssetColl.size();p++){
				if(app_PGM_RQST_Cargo.getFs_rqst_ind().equals("1")){
					appInLQDASETCargo=appInLQDAssetColl.getCargo(p);
					totalAssets+= Double.parseDouble(appInLQDASETCargo.getLqd_aset_amt());
				}
			}
		}
		return totalAssets;
	    
	}
	
	private String getFarmerStatus(String appNum, Map session) {
		ABHouseHoldMemberBO houseHoldBo = new ABHouseHoldMemberBO();
		APP_INDV_Collection appIndvColl = houseHoldBo.loadAppIndvColl(appNum);
		APP_INDV_Cargo app_INDV_Cargo;
		
		for(int i=0;i<appIndvColl.size();i++){
			app_INDV_Cargo = (APP_INDV_Cargo) appIndvColl.getCargo(i);
			if(app_INDV_Cargo.getMig_farm_wrkr_sw()!=null && app_INDV_Cargo.getMig_farm_wrkr_sw().equalsIgnoreCase("Y") ){
				 return "Y";
			}
		}
		return "N";
	}
	
	private String getLiHeapStatus(String appNum, Map session) {
		String liHeapValue= "N";
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		if(appPrflCargo.getSu_asst_lieap_resp()!=null){
			 liHeapValue=appPrflCargo.getSu_asst_lieap_resp();
		}
		return liHeapValue;
	}
	
	private String getSewerWaterExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);
		
		APP_IN_PRFL_Collection appInPrflCollection=null;
		
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean sewerWaterFlag=false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_wwt_resp()!=null && !sewerWaterFlag && (appInCargo.getSu_cst_wwt_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_wwt_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				sewerWaterFlag=true;
				return"SI";
			}
		}
		return "";
	}
	
	private String getWaterSewerWellSepticExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);
		
		APP_IN_PRFL_Collection appInPrflCollection=null;
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean waterInstallationFlag=false;
		boolean sewerInstallationFlag=false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_wtr_resp()!=null && !waterInstallationFlag && (appInCargo.getSu_cst_wtr_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_wtr_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				waterInstallationFlag=true;
			}
			if(appInCargo.getSu_cst_swr_resp()!=null && !sewerInstallationFlag && (appInCargo.getSu_cst_swr_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_swr_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				sewerInstallationFlag=true;
			}
		}
		if (waterInstallationFlag || sewerInstallationFlag)
        {
            return "WS";
        }

		return "";
	}

	private String getUtlilityExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);

		APP_IN_PRFL_Collection appInPrflCollection=null;
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean utilityInstallationFlag=false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_istl_resp()!=null && !utilityInstallationFlag && (appInCargo.getSu_cst_istl_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_istl_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				utilityInstallationFlag=true;
				 return "UT";
			}
		}
		return "";
	}
	
	private String getTelephoneExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);
		
		APP_IN_PRFL_Collection appInPrflCollection=null;
		
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean telephoneFlag=false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_phn_resp()!=null && !telephoneFlag && (appInCargo.getSu_cst_phn_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_phn_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				telephoneFlag=true;
				return "TP";
			}
		}
		return "";
	}
	
	private String getGarbageRemovalExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);
		
		APP_IN_PRFL_Collection appInPrflCollection=null;
		
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean garbageRemoval=false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_trsh_resp()!=null && !garbageRemoval && (appInCargo.getSu_cst_trsh_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_trsh_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				garbageRemoval=true;
				return"GR";
			}
		
		}
		return "";
	}
	
	private String getCookFuelExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);
		
		APP_IN_PRFL_Collection appInPrflCollection=null;
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean cookingFuelFlag=false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_lpgas_resp()!=null && !cookingFuelFlag && (appInCargo.getSu_cst_lpgas_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_lpgas_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				cookingFuelFlag=true;
				return("CF");
			}
		
		}
		return "";
	}
	
	private String getHeatExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);
		
		APP_IN_PRFL_Collection appInPrflCollection=null;
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean heatFlag=false;
		boolean airconditioningFlag = false;
		boolean heatAirConditioningFlag = false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_wood_resp()!=null && !heatFlag && (appInCargo.getSu_cst_wood_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_wood_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				heatFlag=true;
			}
			if(appInCargo.getCool_exp_resp()!=null && !airconditioningFlag && (appInCargo.getCool_exp_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getCool_exp_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				airconditioningFlag=true;
			}
		
	}
		
		if (!heatFlag
				&& !airconditioningFlag
				&& ((appPrflCargo.getBill_heat_ac_resp() != null && appPrflCargo
						.getBill_heat_ac_resp().equalsIgnoreCase("Y")) || (appPrflCargo
						.getExcess_heat_ac_resp() != null && appPrflCargo
						.getExcess_heat_ac_resp().equalsIgnoreCase("Y")))) {
			heatAirConditioningFlag = true;
		}
		if (heatFlag || airconditioningFlag || heatAirConditioningFlag)
        	{
				return "HT";
        	}
		
		return "";
	}
	
	private String getNonHeatElectricityExpense(String appNum, Map session) {
		ABHousingBillsQuestionsBO housingBillsQuestionsBo=new ABHousingBillsQuestionsBO();
		APP_PRFL_Collection appPrflColl =(APP_PRFL_Collection) housingBillsQuestionsBo.loadHousingExpenseQuestions(appNum);
		APP_PRFL_Cargo appPrflCargo = appPrflColl.getCargo(0);
		
		ABPriorityServiceBO aBPriorityServiceBO = new ABPriorityServiceBO();
		APP_PRIR_SRV_Collection aPP_PRIR_SRV_Collection = aBPriorityServiceBO.loadPriorityServiceQuestions((String) session.get(AppConstants.APP_NUMBER));
		APP_PRIR_SRV_Cargo aPP_PRIR_SRV_Cargo = (APP_PRIR_SRV_Cargo) getappPRIRSRVCargo(aPP_PRIR_SRV_Collection, appNum);
		
		APP_IN_PRFL_Collection appInPrflCollection=null;
		
		appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		boolean nonHeatElectricityFlag=false;
		
		for(int i=0;i<appInPrflCollection.size();i++){
			APP_IN_PRFL_Cargo appInCargo = (APP_IN_PRFL_Cargo) appInPrflCollection.get(i);
			if(appInCargo.getSu_cst_elec_resp()!=null && !nonHeatElectricityFlag && (appInCargo.getSu_cst_elec_resp().equalsIgnoreCase(AppConstants.COMPLETE) || appInCargo.getSu_cst_elec_resp().equalsIgnoreCase(AppConstants.REQUIRED))){
				nonHeatElectricityFlag=true;
				return "NE";
			}
		
		}
		return "";
	}
	
	private double calculateChildSupportPayment(String appNum, Map session) {
		PeopleHandler peopleHandler = (PeopleHandler) session.get(AppConstants.INDIV_MASTER_HANDLER);	
	    INDIVIDUAL_Custom_Collection aIndvCustomColl= peopleHandler.getAllIndividuals();
	    
	    INDIVIDUAL_Custom_Collection snapHHCollection=getExpeditedSNAPHouseHoldCollection(aIndvCustomColl,appNum);
		APP_IN_PRFL_Collection appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		int snapHHCollectionSize=snapHHCollection.size();	
		
		ABOtherBillsSummaryBO abOtherBillsSummaryBO =new ABOtherBillsSummaryBO();
		APP_IN_SUPPORT_DETAIL_Collection app_IN_SUPPORT_DETAIL_Collection = abOtherBillsSummaryBO.loadChildSupportDetail(appNum);
		
		double childSupportPayments = 0;
		INDIVIDUAL_Custom_Cargo indvCustomCargo=null;
		for(int i=0; i<snapHHCollectionSize;i++){
			 
			indvCustomCargo= (INDIVIDUAL_Custom_Cargo) snapHHCollection.get(i);
			int indvSeqNumber=Integer.parseInt(indvCustomCargo.getIndv_seq_num());					 
			
	
			APP_IN_SUPPORT_DETAIL_Cargo app_IN_SUPPORT_DETAIL_Cargo =null;
			APP_IN_SUPPORT_DETAIL_Collection appInSupportDetailColl=null;
			app_IN_SUPPORT_DETAIL_Cargo =(APP_IN_SUPPORT_DETAIL_Cargo) getAppInSupportDetailCargo(app_IN_SUPPORT_DETAIL_Collection, appNum);
			
			appInSupportDetailColl=getAppInSupportDetailCollection(app_IN_SUPPORT_DETAIL_Collection, indvSeqNumber);
			for(int p=0;p<appInSupportDetailColl.size();p++){
					app_IN_SUPPORT_DETAIL_Cargo=appInSupportDetailColl.getCargo(p);
					if(app_IN_SUPPORT_DETAIL_Cargo.getSupport_type_cd().equals("CS")){
						childSupportPayments+= Double.parseDouble(app_IN_SUPPORT_DETAIL_Cargo.getPaid_amt());
				}
			}
		}
		return childSupportPayments;
	    
	}

	private double calculateTotalOtherIncome(String appNum, Map session) {
		PeopleHandler peopleHandler = (PeopleHandler) session.get(AppConstants.INDIV_MASTER_HANDLER);	
	    INDIVIDUAL_Custom_Collection aIndvCustomColl= peopleHandler.getAllIndividuals();
		
		INDIVIDUAL_Custom_Collection snapHHCollection=getExpeditedSNAPHouseHoldCollection(aIndvCustomColl,appNum);
		APP_IN_PRFL_Collection appInPrflCollection=(APP_IN_PRFL_Collection) session.get(AppConstants.APP_IN_PRFL_MASTER);
		int snapHHCollectionSize=snapHHCollection.size();	
		
		//BO to get collection for other income
		ABOtherIncomeBO abOtherIncomeBO=new ABOtherIncomeBO();
		APP_IN_UEI_Collection appInUEICollection= (APP_IN_UEI_Collection) abOtherIncomeBO.loadOtherIncomeDetails(appNum);
		
		String[] otherIncomeSSI_RSDI_CS_Type={
				 FwConstants.SSI_TYPE,
				 FwConstants.RSDI_TYPE,
				 FwConstants.CHILD_SUPPORT_TYPE};
		
		// Get types from reference Table============		
        String[] filterValue = {"SEL","CS","DV","PS","SS","IN","SI","TA","RB"}; 
		       
        int[] filterColumnId =new int[filterValue.length];
        for(int i=0; i<filterValue.length; i++){
        	filterColumnId[i]=IReferenceConstants.CODE_COLUMN_ID;
        }

		
        IReferenceTableManager iref = ReferenceTableManager.getInstance();
		IReferenceTableData prgmRefData = null;
		
		int filterMatchCriteria  = IReferenceConstants.FILTER_EXCLUDE_MATCH_ONE;

		
		prgmRefData = iref.filterDataOnMultipleColumns("TOIN","EN",filterColumnId,filterMatchCriteria, filterValue);
		
		
		 String[] otherIncomeType=prgmRefData.getCodeValues();
		 
		 String [] otherIncomeSSI_RSDI_ChildSupport_SelectedValues=new String[otherIncomeSSI_RSDI_CS_Type.length];
		 HashMap otherIncomeSelectedValuesMap=new HashMap();
		 String otherIncomeFlag=new String();
		 double totalOtherIncome=0;
		 INDIVIDUAL_Custom_Cargo indvCustomCargo=null;
		 APP_IN_PRFL_Cargo  snapHHCargo=null;
		 APP_IN_UEI_Cargo appInUEICargo=null;
		 APP_IN_UEI_Collection appInUEIOtherColl=null;
		 
		 for(int i=0; i<snapHHCollectionSize;i++){
			 
				indvCustomCargo= (INDIVIDUAL_Custom_Cargo) snapHHCollection.get(i);
				int indvSeqNumber=Integer.parseInt(indvCustomCargo.getIndv_seq_num());					 				 
				snapHHCargo= (APP_IN_PRFL_Cargo) getappINDVCargo(appInPrflCollection, indvSeqNumber);
				
				otherIncomeFlag=snapHHCargo.getOthr_incm_resp(); // Other Income flag on ABOIQ
				
				otherIncomeSSI_RSDI_ChildSupport_SelectedValues[0]=snapHHCargo.getRcv_ssi_sw();//SSI flag on ABOIQ
				otherIncomeSSI_RSDI_ChildSupport_SelectedValues[1]=snapHHCargo.getRcv_ss_resp();//RSDI flag on ABOIQ
				otherIncomeSSI_RSDI_ChildSupport_SelectedValues[2]=snapHHCargo.getBnft_chl_sprt_resp();//Child Support flag on ABOIQ
				
				for(int r=0;r<otherIncomeType.length;r++){
					if(otherIncomeType[r].equalsIgnoreCase("UN")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getBnft_uempl_resp()); // Unemployment Benefits flag on ABUIT : UN
					}else if(otherIncomeType[r].equalsIgnoreCase("PU")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getPand_unemp_asst()); 
					}else if(otherIncomeType[r].equalsIgnoreCase("FP")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getPand_unemp_comp()); 
					}else if(otherIncomeType[r].equalsIgnoreCase("EU")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getPand_emer_comp());
					}else if(otherIncomeType[r].equalsIgnoreCase("MO")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getMony_othr_resp()); // Money from others, such as family or friends : MO
					}else if(otherIncomeType[r].equalsIgnoreCase("WC")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getWork_comp_resp()); // Workers Compensation flag on ABUIT : WC
					}else if(otherIncomeType[r].equalsIgnoreCase("MN")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getAlmy_rcv_resp()); // Alimony/ Spousal Support : MN
					}else if(otherIncomeType[r].equalsIgnoreCase("PE")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getPnsn_retr_resp()); //Pension or Retirement Income : PE
					}else if(otherIncomeType[r].equalsIgnoreCase("RR")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getOthr_incm_rentl_resp()); // Rental Income flag on ABUIT : RR
					}else if(otherIncomeType[r].equalsIgnoreCase("RE")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getResettlement_incm_resp()); // Resettlement Income : RE
					}else if(otherIncomeType[r].equalsIgnoreCase("VE")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getBnft_vet_resp()); // Veteran's Benefits : VE
					}else if(otherIncomeType[r].equalsIgnoreCase("OT")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getOthr_src_resp()); // Other income : OT
					}else if(otherIncomeType[r].equalsIgnoreCase("MA")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getMil_allot_resp()); //Military Allotments : MA
					}else if(otherIncomeType[r].equalsIgnoreCase("DI")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getBnft_dabl_resp()); //Disability Benefits (not from SSA/ SSI ) : DI
					}else if(otherIncomeType[r].equalsIgnoreCase("ID")){
						otherIncomeSelectedValuesMap.put(otherIncomeType[r], snapHHCargo.getIntr_div_resp()); //Interest Payments/ Dividends : ID
					}
						
				}
				
				//Income from SSI, RSDI and Child support
				double totalOtherIncomeForThisPerson=0;
				for(int m=0;m<otherIncomeSSI_RSDI_CS_Type.length;m++){
					if(otherIncomeSSI_RSDI_ChildSupport_SelectedValues[m].equalsIgnoreCase(AppConstants.COMPLETE)){
						
						appInUEIOtherColl= (APP_IN_UEI_Collection) getAppInUEICollection(appInUEICollection, indvSeqNumber, otherIncomeSSI_RSDI_CS_Type[m]);
						for(int p=0;p<appInUEIOtherColl.size();p++){
						
						appInUEICargo= appInUEIOtherColl.getCargo(p);
						totalOtherIncomeForThisPerson+=convertFrequencyAndCalculateAmount(Double.parseDouble(appInUEICargo.getUei_amt()), appInUEICargo.getFreq_cd());
						
						}
					}
				}
				
				//Income from Other Income
				if(otherIncomeFlag.equalsIgnoreCase(AppConstants.COMPLETE)){
				Iterator iterator = otherIncomeSelectedValuesMap.entrySet().iterator();
				 while (iterator.hasNext()) {
					 Map.Entry mapEntry = (Map.Entry) iterator.next();
					 String mapValue= (String) mapEntry.getValue();
					 String mapKey= (String) mapEntry.getKey();
					 	if(mapValue.equalsIgnoreCase(AppConstants.COMPLETE)){

							
								appInUEIOtherColl= (APP_IN_UEI_Collection) getAppInUEICollection(appInUEICollection, indvSeqNumber, mapKey);
								for(int p=0;p<appInUEIOtherColl.size();p++){
									
									appInUEICargo= appInUEIOtherColl.getCargo(p);
									totalOtherIncomeForThisPerson+=convertFrequencyAndCalculateAmount(Double.parseDouble(appInUEICargo.getUei_amt()), appInUEICargo.getFreq_cd());
															
							}												
						}
					}
				}
				totalOtherIncome+=totalOtherIncomeForThisPerson;
					
		 }
		return totalOtherIncome;
	}

	// Expedited SNAP Added by arpanday: ILIES-174321

//Method to get information from Reference tables.
	private String getRefTableDescription(String codeVal, String refTable, int column) {
		if(codeVal==null) {
			codeVal=AppConstants.CLICK_HERE;  
		}
		if(codeVal.trim().equalsIgnoreCase(FwConstants.EMPTY_STRING))
			codeVal=AppConstants.CLICK_HERE;
		
		IReferenceTableManager iref = ReferenceTableManager.getInstance();
		IReferenceTableData refData = iref.getReferenceTableData(refTable,FwConstants.ENGLISH);
		 String[] codeValues = refData.getCodeValues();
		 String[] descriptionValues = refData.getDescriptionValues(column);
		 for(int i=0;i<codeValues.length;i++){
			 if(codeValues[i].equalsIgnoreCase(codeVal)){
				 return descriptionValues[i];
			 }
		 }
		 // By returning null it would help in identifying the potential mismatches in the future as it would break the screen.
	return null;
}

	// Amount/Frequency conversion Method
	private double convertFrequencyAndCalculateAmount(double amount, String codeValue) {
		if (Double.toString(amount) == null) {
			amount = 0;
		}

		double doubleValue = 1;
		String value = getRefTableDescription(codeValue, FwConstants.TPFF, 834);
		if (value != null && !value.equals("")) {
			doubleValue = Double.parseDouble(value);
		}
		return amount * doubleValue;
	}