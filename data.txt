package IVA_Batch;
import egl.core.*;
import CommonMigratedParts.*;
import DataTables.*;
//*** PROGRAM=AMA16A ****
// COMPONENT NAME: AMA16A Ongoing termination Reason Stats by
// Aid Code - D===============
// 
// DESCRIPTION:
// ============
// Statistical report of Disabled
// ongoing cases during the report month
// with details by aid code and termination reason
// 
// 
// ***********************
Program AMA16A type basicProgram //VAGen Info - main batch program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes
  }

  // Data Declarations
  AMA16W AMA16W; // record
  AMA16W-DET AMA16W-DET; // record
  AMA16W-FOOTER AMA16W-FOOTER; // record
  AMA16W-HEAD AMA16W-HEAD; // record
  AMA16W-SUBH AMA16W-SUBH; // record
  CEP01W CEP01W; // record
  FORMATW FORMATW; // record
  GDW GDW; // record
  REP-COMMON REP-COMMON; // record
  REP-DATE REP-DATE; // record
  REP-EOFNOF REP-EOFNOF; // record
  SR-132REP-RECOUT SR-132REP-RECOUT; // record
  SR-AMA16-RECIN SR-AMA16-RECIN; // record
  SR-AMA44-RECIN SR-AMA44-RECIN; // record
  VDBCOMMON VDBCOMMON; // record
  VDBCONTROL VDBCONTROL; // record
  VMESSAGE VMESSAGE; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use VDB00T1 {deleteAfterUse = yes}; // table

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    AMA16P9-MAIN: AMA16P9-MAIN();
  end // end main
end // end AMA16A


// ACCUM REPORT DETAILS
Function AMA16P9-ACUM-DET()
  /* total*/
  AMA16W.WS-TERM-CNT-SUB-TOTAL-DA = AMA16W.WS-TERM-CNT-EM9 + AMA16W.WS-TERM-CNT-IN9 +   AMA16W.WS-TERM-CNT-SI9 + AMA16W.WS-TERM-CNT-PK9 +   AMA16W.WS-TERM-CNT-KB9 + AMA16W.WS-TERM-CNT-WB9 +   AMA16W.WS-TERM-CNT-GC9 + AMA16W.WS-TERM-CNT-SS9 +   AMA16W.WS-TERM-CNT-HD9 + AMA16W.WS-TERM-CNT-HG9 +   AMA16W.WS-TERM-CNT-HR9 + AMA16W.WS-TERM-CNT-CM9;
   /* Begin change for wi# 15116- Ted*/
   /* Hendricks*/
  AMA16W.WS-TERM-CNT-SUB-TOTAL-MB = AMA16W.WS-TERM-CNT-QM9 + AMA16W.WS-TERM-CNT-SL9 +   AMA16W.WS-TERM-CNT-QD9 +    AMA16W.WS-TERM-CNT-QI9 + AMA16W.WS-TERM-CNT-QJ9;

                                   /* End   change for wi# 15116- Ted*/

  AMA16W.WS-TERM-CNT-GR-TOTAL = AMA16W.WS-TERM-CNT-SUB-TOTAL-DA + AMA16W.WS-TERM-CNT-SUB-TOTAL-MB +   AMA16W.WS-TERM-CNT-OBRA;


  /* TOTAL FOR FOOTER*/
  AMA16W.WS-TERM-CNT-AC-TOT-EM9 = AMA16W.WS-TERM-CNT-AC-TOT-EM9   + AMA16W.WS-TERM-CNT-EM9;
  AMA16W.WS-TERM-CNT-AC-TOT-IN9 = AMA16W.WS-TERM-CNT-AC-TOT-IN9   + AMA16W.WS-TERM-CNT-IN9;
  AMA16W.WS-TERM-CNT-AC-TOT-SI9 = AMA16W.WS-TERM-CNT-AC-TOT-SI9   + AMA16W.WS-TERM-CNT-SI9;
  AMA16W.WS-TERM-CNT-AC-TOT-PK9 = AMA16W.WS-TERM-CNT-AC-TOT-PK9   + AMA16W.WS-TERM-CNT-PK9;
  AMA16W.WS-TERM-CNT-AC-TOT-KB9 = AMA16W.WS-TERM-CNT-AC-TOT-KB9   + AMA16W.WS-TERM-CNT-KB9;
  AMA16W.WS-TERM-CNT-AC-TOT-WB9 = AMA16W.WS-TERM-CNT-AC-TOT-WB9   + AMA16W.WS-TERM-CNT-WB9;
  AMA16W.WS-TERM-CNT-AC-TOT-GC9 = AMA16W.WS-TERM-CNT-AC-TOT-GC9   + AMA16W.WS-TERM-CNT-GC9;
  AMA16W.WS-TERM-CNT-AC-TOT-SS9 = AMA16W.WS-TERM-CNT-AC-TOT-SS9   + AMA16W.WS-TERM-CNT-SS9;
  AMA16W.WS-TERM-CNT-AC-TOT-HD9 = AMA16W.WS-TERM-CNT-AC-TOT-HD9   + AMA16W.WS-TERM-CNT-HD9;
  AMA16W.WS-TERM-CNT-AC-TOT-HG9 = AMA16W.WS-TERM-CNT-AC-TOT-HG9   + AMA16W.WS-TERM-CNT-HG9;
  AMA16W.WS-TERM-CNT-AC-TOT-HR9 = AMA16W.WS-TERM-CNT-AC-TOT-HR9   + AMA16W.WS-TERM-CNT-HR9;
  AMA16W.WS-TERM-CNT-AC-TOT-CM9 = AMA16W.WS-TERM-CNT-AC-TOT-CM9   + AMA16W.WS-TERM-CNT-CM9;
  AMA16W.WS-TERM-CNT-SUB-AC-TOT-DA = AMA16W.WS-TERM-CNT-SUB-AC-TOT-DA   + AMA16W.WS-TERM-CNT-SUB-TOTAL-DA;
  AMA16W.WS-TERM-CNT-AC-TOT-QM9 = AMA16W.WS-TERM-CNT-AC-TOT-QM9   + AMA16W.WS-TERM-CNT-QM9;
  AMA16W.WS-TERM-CNT-AC-TOT-SL9 = AMA16W.WS-TERM-CNT-AC-TOT-SL9   + AMA16W.WS-TERM-CNT-SL9;

  /* Begin change for wi# 15116- Ted Hendricks*/

  AMA16W.WS-TERM-CNT-AC-TOT-QI9 = AMA16W.WS-TERM-CNT-AC-TOT-QI9   + AMA16W.WS-TERM-CNT-QI9;
  AMA16W.WS-TERM-CNT-AC-TOT-QJ9 = AMA16W.WS-TERM-CNT-AC-TOT-QJ9   + AMA16W.WS-TERM-CNT-QJ9;

  /* End   change for wi# 15116- Ted Hendricks*/

  AMA16W.WS-TERM-CNT-AC-TOT-QD9 = AMA16W.WS-TERM-CNT-AC-TOT-QD9   + AMA16W.WS-TERM-CNT-QD9;
  AMA16W.WS-TERM-CNT-SUB-AC-TOT-MB = AMA16W.WS-TERM-CNT-SUB-AC-TOT-MB   + AMA16W.WS-TERM-CNT-SUB-TOTAL-MB;
  AMA16W.WS-TERM-CNT-AC-TOT-OBRA = AMA16W.WS-TERM-CNT-AC-TOT-OBRA   + AMA16W.WS-TERM-CNT-OBRA;
  AMA16W.WS-TERM-CNT-GR-AC-TOT = AMA16W.WS-TERM-CNT-GR-AC-TOT   + AMA16W.WS-TERM-CNT-GR-TOTAL;
end // end AMA16P9-ACUM-DET


// ACCUM DETIALS FOR DIST OFC RPT
Function AMA16P9-ACUM-DO()
  /* ***************************** start wi 16615 *************************/
  if (AMA16W.WS-PREV-CLSRE-RSN-CD == "1")
    AMA16W.WS-AMA16-INDEX = 1;
    AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
    AMA16W.WS-DO-REC-FND = "Y";
  else
    if (AMA16W.WS-PREV-CLSRE-RSN-CD == "2")
      AMA16W.WS-AMA16-INDEX = 2;
      AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
      AMA16W.WS-DO-REC-FND = "Y";
    else
      if (AMA16W.WS-PREV-CLSRE-RSN-CD == "3")
        AMA16W.WS-AMA16-INDEX = 3;
        AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
        AMA16W.WS-DO-REC-FND = "Y";
      else
        if (AMA16W.WS-PREV-CLSRE-RSN-CD == "4")
          AMA16W.WS-AMA16-INDEX = 4;
          AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
          AMA16W.WS-DO-REC-FND = "Y";
        else
          if (AMA16W.WS-PREV-CLSRE-RSN-CD == "5")
            AMA16W.WS-AMA16-INDEX = 5;
            AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
            AMA16W.WS-DO-REC-FND = "Y";
          else
            if (AMA16W.WS-PREV-CLSRE-RSN-CD == "6")
              AMA16W.WS-AMA16-INDEX = 6;
              AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
              AMA16W.WS-DO-REC-FND = "Y";
            else
              if (AMA16W.WS-PREV-CLSRE-RSN-CD == "7")
                AMA16W.WS-AMA16-INDEX = 7;
                AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
                AMA16W.WS-DO-REC-FND = "Y";
              else
                if (AMA16W.WS-PREV-CLSRE-RSN-CD == "8")
                  AMA16W.WS-AMA16-INDEX = 8;
                  AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
                  AMA16W.WS-DO-REC-FND = "Y";
                else
                  if (AMA16W.WS-PREV-CLSRE-RSN-CD == "9")
                    AMA16W.WS-AMA16-INDEX = 9;
                    AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
                    AMA16W.WS-DO-REC-FND = "Y";
                  end
                end
              end
            end
          end
        end
      end
    end
  end

  if (AMA16W.WS-DO-REC-FND == "Y")
    AMA16W.WS-DO-REC-FND = "N";
    AMA16W.WS-DO-TERM-RSN[WS-AMA16-INDEX] = AMA16W.WS-TERM-RSN-TRUNC;
    AMA16W.WS-DO-TERM-CNT-EM9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-EM9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-EM9;
    AMA16W.WS-DO-TERM-CNT-IN9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-IN9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-IN9;
    AMA16W.WS-DO-TERM-CNT-SI9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-SI9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SI9;
    AMA16W.WS-DO-TERM-CNT-PK9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-PK9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-PK9;
    AMA16W.WS-DO-TERM-CNT-KB9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-KB9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-KB9;
    AMA16W.WS-DO-TERM-CNT-WB9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-WB9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-WB9;
    AMA16W.WS-DO-TERM-CNT-GC9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-GC9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-GC9;
    AMA16W.WS-DO-TERM-CNT-SS9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-SS9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SS9;
    AMA16W.WS-DO-TERM-CNT-HD9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-HD9[WS-AMA16-INDEX]     + AMA16W.WS-TERM-CNT-HD9;
    AMA16W.WS-DO-TERM-CNT-HG9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-HG9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-HG9;
    AMA16W.WS-DO-TERM-CNT-HR9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-HR9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-HR9;
    AMA16W.WS-DO-TERM-CNT-CM9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-CM9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-CM9;
    AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SUB-TOTAL-DA;
    AMA16W.WS-DO-TERM-CNT-QM9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-QM9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QM9;
    AMA16W.WS-DO-TERM-CNT-SL9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-SL9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SL9;
    AMA16W.WS-DO-TERM-CNT-QD9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-QD9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QD9;
    AMA16W.WS-DO-TERM-CNT-QI9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-QI9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QI9;
    AMA16W.WS-DO-TERM-CNT-QJ9[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-QJ9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QJ9;
    AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX]     + AMA16W.WS-TERM-CNT-SUB-TOTAL-MB;
    AMA16W.WS-DO-TERM-CNT-OBRA[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-OBRA[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-OBRA;
    AMA16W.WS-DO-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX] = AMA16W.WS-DO-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-GR-TOTAL;
    AMA16W.WS-AMA16-INDEX = 0;
  end
  /* ****************************** end wi 16615 *************************/
end // end AMA16P9-ACUM-DO


// ACCUM FOR DIST OFFICE FOOTER
Function AMA16P9-ACUM-DOFOT()
  /* ****************************** start wi 16615 **********************/
  AMA16W.WS-AMA16-INDEX = 1;
  while (AMA16W.WS-AMA16-INDEX <= 9)
    if (AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] == "Y")
      AMA16W.WS-DO-TERM-CNT-AC-TOT-EM9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-EM9       + AMA16W.WS-DO-TERM-CNT-EM9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-IN9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-IN9       + AMA16W.WS-DO-TERM-CNT-IN9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-SI9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-SI9       + AMA16W.WS-DO-TERM-CNT-SI9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-PK9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-PK9       + AMA16W.WS-DO-TERM-CNT-PK9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-KB9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-KB9       + AMA16W.WS-DO-TERM-CNT-KB9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-WB9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-WB9       + AMA16W.WS-DO-TERM-CNT-WB9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-GC9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-GC9       + AMA16W.WS-DO-TERM-CNT-GC9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-SS9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-SS9       + AMA16W.WS-DO-TERM-CNT-SS9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-HD9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-HD9       + AMA16W.WS-DO-TERM-CNT-HD9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-HG9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-HG9       + AMA16W.WS-DO-TERM-CNT-HG9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-HR9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-HR9       + AMA16W.WS-DO-TERM-CNT-HR9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-CM9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-CM9       + AMA16W.WS-DO-TERM-CNT-CM9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-DA = AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-DA       + AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-QM9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-QM9       + AMA16W.WS-DO-TERM-CNT-QM9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-SL9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-SL9       + AMA16W.WS-DO-TERM-CNT-SL9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-QI9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-QI9       + AMA16W.WS-DO-TERM-CNT-QI9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-QJ9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-QJ9       + AMA16W.WS-DO-TERM-CNT-QJ9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-QD9 = AMA16W.WS-DO-TERM-CNT-AC-TOT-QD9       + AMA16W.WS-DO-TERM-CNT-QD9[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-MB = AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-MB       + AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-AC-TOT-OBRA = AMA16W.WS-DO-TERM-CNT-AC-TOT-OBRA       + AMA16W.WS-DO-TERM-CNT-OBRA[WS-AMA16-INDEX];
      AMA16W.WS-DO-TERM-CNT-GR-AC-TOT = AMA16W.WS-DO-TERM-CNT-GR-AC-TOT       + AMA16W.WS-DO-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX];
    end
    AMA16W.WS-AMA16-INDEX = AMA16W.WS-AMA16-INDEX + 1;
  end
  /* ********************************* end wi 16615 **********************/
end // end AMA16P9-ACUM-DOFOT


// ACCUM DETIALS FOR STWIDE REPT
Function AMA16P9-ACUM-ST()
  /* accumulate figures for state wide report*/
  if (AMA16W.WS-PREV-CLSRE-RSN-CD == "1")
    AMA16W.WS-AMA16-INDEX = 1;
    AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
    AMA16W.WS-ST-REC-FND = "Y";
  else
    if (AMA16W.WS-PREV-CLSRE-RSN-CD == "2")
      AMA16W.WS-AMA16-INDEX = 2;
      AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
      AMA16W.WS-ST-REC-FND = "Y";
    else
      if (AMA16W.WS-PREV-CLSRE-RSN-CD == "3")
        AMA16W.WS-AMA16-INDEX = 3;
        AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
        AMA16W.WS-ST-REC-FND = "Y";
      else
        if (AMA16W.WS-PREV-CLSRE-RSN-CD == "4")
          AMA16W.WS-AMA16-INDEX = 4;
          AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
          AMA16W.WS-ST-REC-FND = "Y";
        else
          if (AMA16W.WS-PREV-CLSRE-RSN-CD == "5")
            AMA16W.WS-AMA16-INDEX = 5;
            AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
            AMA16W.WS-ST-REC-FND = "Y";
          else
            if (AMA16W.WS-PREV-CLSRE-RSN-CD == "6")
              AMA16W.WS-AMA16-INDEX = 6;
              AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
              AMA16W.WS-ST-REC-FND = "Y";
            else
              if (AMA16W.WS-PREV-CLSRE-RSN-CD == "7")
                AMA16W.WS-AMA16-INDEX = 7;
                AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
                AMA16W.WS-ST-REC-FND = "Y";
              else
                if (AMA16W.WS-PREV-CLSRE-RSN-CD == "8")
                  AMA16W.WS-AMA16-INDEX = 8;
                  AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
                  AMA16W.WS-ST-REC-FND = "Y";
                else
                  if (AMA16W.WS-PREV-CLSRE-RSN-CD == "9")
                    AMA16W.WS-AMA16-INDEX = 9;
                    AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] = "Y";
                    AMA16W.WS-ST-REC-FND = "Y";
                  end
                end
              end
            end
          end
        end
      end
    end
  end

  if (AMA16W.WS-ST-REC-FND == "Y")
    AMA16W.WS-ST-REC-FND = "N";
    AMA16W.WS-ST-TERM-RSN[WS-AMA16-INDEX] = AMA16W.WS-TERM-RSN-TRUNC;
    AMA16W.WS-ST-TERM-CNT-EM9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-EM9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-EM9;
    AMA16W.WS-ST-TERM-CNT-IN9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-IN9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-IN9;
    AMA16W.WS-ST-TERM-CNT-SI9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-SI9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SI9;
    AMA16W.WS-ST-TERM-CNT-PK9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-PK9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-PK9;
    AMA16W.WS-ST-TERM-CNT-KB9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-KB9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-KB9;
    AMA16W.WS-ST-TERM-CNT-WB9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-WB9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-WB9;
    AMA16W.WS-ST-TERM-CNT-GC9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-GC9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-GC9;
    AMA16W.WS-ST-TERM-CNT-SS9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-SS9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SS9;
    AMA16W.WS-ST-TERM-CNT-HD9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-HD9[WS-AMA16-INDEX]     + AMA16W.WS-TERM-CNT-HD9;
    AMA16W.WS-ST-TERM-CNT-HG9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-HG9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-HG9;
    AMA16W.WS-ST-TERM-CNT-HR9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-HR9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-HR9;
    AMA16W.WS-ST-TERM-CNT-CM9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-CM9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-CM9;
    AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SUB-TOTAL-DA;
    AMA16W.WS-ST-TERM-CNT-QM9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-QM9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QM9;
    AMA16W.WS-ST-TERM-CNT-SL9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-SL9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-SL9;
    AMA16W.WS-ST-TERM-CNT-QD9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-QD9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QD9;

  /* Begin change for wi# 15116- Ted Hendricks*/

    AMA16W.WS-ST-TERM-CNT-QI9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-QI9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QI9;
    AMA16W.WS-ST-TERM-CNT-QJ9[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-QJ9[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-QJ9;

  /* End   change for wi# 15116- Ted Hendricks*/

    AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX]     + AMA16W.WS-TERM-CNT-SUB-TOTAL-MB;
    AMA16W.WS-ST-TERM-CNT-OBRA[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-OBRA[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-OBRA;
    AMA16W.WS-ST-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX] = AMA16W.WS-ST-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX] +     AMA16W.WS-TERM-CNT-GR-TOTAL;
    AMA16W.WS-AMA16-INDEX = 0;
  end
end // end AMA16P9-ACUM-ST


// ACCUM DETAILS FOR STWIDE FOOT
Function AMA16P9-ACUM-STFOT()
  AMA16W.WS-AMA16-INDEX = 1;
  while (AMA16W.WS-AMA16-INDEX <= 9)
    if (AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] == "Y")
      AMA16W.WS-TERM-CNT-AC-TOT-EM9 = AMA16W.WS-TERM-CNT-AC-TOT-EM9       + AMA16W.WS-ST-TERM-CNT-EM9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-IN9 = AMA16W.WS-TERM-CNT-AC-TOT-IN9       + AMA16W.WS-ST-TERM-CNT-IN9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-SI9 = AMA16W.WS-TERM-CNT-AC-TOT-SI9       + AMA16W.WS-ST-TERM-CNT-SI9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-PK9 = AMA16W.WS-TERM-CNT-AC-TOT-PK9       + AMA16W.WS-ST-TERM-CNT-PK9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-KB9 = AMA16W.WS-TERM-CNT-AC-TOT-KB9       + AMA16W.WS-ST-TERM-CNT-KB9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-WB9 = AMA16W.WS-TERM-CNT-AC-TOT-WB9       + AMA16W.WS-ST-TERM-CNT-WB9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-GC9 = AMA16W.WS-TERM-CNT-AC-TOT-GC9       + AMA16W.WS-ST-TERM-CNT-GC9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-SS9 = AMA16W.WS-TERM-CNT-AC-TOT-SS9       + AMA16W.WS-ST-TERM-CNT-SS9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-HD9 = AMA16W.WS-TERM-CNT-AC-TOT-HD9       + AMA16W.WS-ST-TERM-CNT-HD9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-HG9 = AMA16W.WS-TERM-CNT-AC-TOT-HG9       + AMA16W.WS-ST-TERM-CNT-HG9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-HR9 = AMA16W.WS-TERM-CNT-AC-TOT-HR9       + AMA16W.WS-ST-TERM-CNT-HR9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-CM9 = AMA16W.WS-TERM-CNT-AC-TOT-CM9       + AMA16W.WS-ST-TERM-CNT-CM9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-SUB-AC-TOT-DA = AMA16W.WS-TERM-CNT-SUB-AC-TOT-DA       + AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-QM9 = AMA16W.WS-TERM-CNT-AC-TOT-QM9       + AMA16W.WS-ST-TERM-CNT-QM9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-SL9 = AMA16W.WS-TERM-CNT-AC-TOT-SL9       + AMA16W.WS-ST-TERM-CNT-SL9[WS-AMA16-INDEX];

  /* Begin change for wi# 15116- Ted Hendricks*/

      AMA16W.WS-TERM-CNT-AC-TOT-QI9 = AMA16W.WS-TERM-CNT-AC-TOT-QI9       + AMA16W.WS-ST-TERM-CNT-QI9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-QJ9 = AMA16W.WS-TERM-CNT-AC-TOT-QJ9       + AMA16W.WS-ST-TERM-CNT-QJ9[WS-AMA16-INDEX];

  /* End   change for wi# 15116- Ted Hendricks*/

      AMA16W.WS-TERM-CNT-AC-TOT-QD9 = AMA16W.WS-TERM-CNT-AC-TOT-QD9       + AMA16W.WS-ST-TERM-CNT-QD9[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-SUB-AC-TOT-MB = AMA16W.WS-TERM-CNT-SUB-AC-TOT-MB       + AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-AC-TOT-OBRA = AMA16W.WS-TERM-CNT-AC-TOT-OBRA       + AMA16W.WS-ST-TERM-CNT-OBRA[WS-AMA16-INDEX];
      AMA16W.WS-TERM-CNT-GR-AC-TOT = AMA16W.WS-TERM-CNT-GR-AC-TOT       + AMA16W.WS-ST-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX];
    end
    AMA16W.WS-AMA16-INDEX = AMA16W.WS-AMA16-INDEX + 1;
  end
end // end AMA16P9-ACUM-STFOT


// APPL   ADDITIONAL PROCESSING
Function AMA16P9-APPLSPEC()
  /* cbsi start*/
  /* control break check*/
  if ((AMA16W.WS-PREV-OFC-CD != SR-AMA44-RECIN.PCE-OFC-CD))
    if (AMA16W.WS-CLSRE-REC-FND == "Y")
      AMA16W.WS-PREV-AID-CD = SR-AMA44-RECIN.PCE-AID-CD;
      AMA16P9-ACUM-DET();
      AMA16P9-ACUM-DO(); /* wi 16615*/
      AMA16P9-ACUM-ST();
      AMA16P9-POP-DET();
    /* perform process to print the details*/
      AMA16P9-PRN-DETAIL();
      AMA16W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
      AMA16W.WS-CLSRE-REC-FND = "N";
    end
    if (AMA16W.WS-PB-REC-FND == "Y")
      AMA16P9-POP-FOOTER();
      AMA16P9-PRN-FOOTER();
      AMA16W.WS-PB-REC-FND = "N";
    end
  /* ********************************* start wi 16615 *******************/
    /* print district office details*/
    if (AMA16W.WS-DO-PB-REC-FND == "Y")
      AMA16P9-DO-PRN();
      AMA16W.WS-DO-PB-REC-FND = "N";
  /* *********************************  end  wi 16615 *******************/
    end
    AMA16P9-INIT-TOT();
    AMA16P9-INIT-FOTOT();
  /* ********************************* start wi 16615 *******************/
    AMA16P9-INIT-DO();
    AMA16P9-INIT-DOTOT();
  /* *********************************  end  wi 16615 *******************/
    AMA16W.WS-PREV-OFC-CD = SR-AMA44-RECIN.PCE-OFC-CD;
    AMA16W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
    AMA16W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
    AMA16W.WS-OFC-NM = SR-AMA44-RECIN.PCE-OFC-NM;
    REP-COMMON.WS-NEW-PAGE = "Y";
  else
    if ((AMA16W.WS-PREV-CASLD-ID != SR-AMA44-RECIN.PCE-CASLD-ID))
      if (AMA16W.WS-CLSRE-REC-FND == "Y")
        AMA16P9-ACUM-DET();
        AMA16P9-ACUM-DO(); /* wi 16615*/
        AMA16P9-ACUM-ST();
        AMA16P9-POP-DET();
    /* perform process to print the details*/
        AMA16P9-PRN-DETAIL();
        AMA16W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
        AMA16W.WS-CLSRE-REC-FND = "N";
      end
      if (AMA16W.WS-PB-REC-FND == "Y")
        AMA16P9-POP-FOOTER();
        AMA16P9-PRN-FOOTER();
        AMA16W.WS-PB-REC-FND = "N";
      end
    /* reset all total variables*/
      AMA16P9-INIT-TOT();
      AMA16P9-INIT-FOTOT();
      AMA16W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
      AMA16W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
      REP-COMMON.WS-NEW-PAGE = "Y";
    else
      if ((AMA16W.WS-PREV-CLSRE-RSN-CD != SR-AMA44-RECIN.PCE-RSN-CD))
        if (AMA16W.WS-CLSRE-REC-FND == "Y")
          AMA16P9-ACUM-DET();
          AMA16P9-ACUM-DO(); /* wi 16615*/
          AMA16P9-ACUM-ST();
          AMA16P9-POP-DET();
    /* perform process to print the details*/
          AMA16P9-PRN-DETAIL();
          AMA16W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
          AMA16W.WS-CLSRE-REC-FND = "N";
        end
        AMA16P9-INIT-TOT();
        AMA16W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
      end
    end
  end

  AMA16P9-CHK-AIDCD();

  if (AMA16W.WS-CLSRE-REC-FND == "Y")
    AMA16W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
    AMA16W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
  end
  /* cbsi end*/
end // end AMA16P9-APPLSPEC


// CHECK AID CODES
Function AMA16P9-CHK-AIDCD()

  /* Begin change for wi# 15116- Ted Hendricks*/
  /* ** put at beginning to avoid "nested if" limitation ***/

  if (SR-AMA44-RECIN.PCE-AID-CD == "QI9")
    AMA16W.WS-TERM-CNT-QI9 = AMA16W.WS-TERM-CNT-QI9 + 1;
    AMA16W.WS-REC-FOUND = "Y";
    AMA16W.WS-CLSRE-REC-FND = "Y";
    AMA16W.WS-PB-REC-FND = "Y";
    AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
  else
    if (SR-AMA44-RECIN.PCE-AID-CD == "QJ9")
      AMA16W.WS-TERM-CNT-QJ9 = AMA16W.WS-TERM-CNT-QJ9 + 1;
      AMA16W.WS-REC-FOUND = "Y";
      AMA16W.WS-CLSRE-REC-FND = "Y";
      AMA16W.WS-PB-REC-FND = "Y";
      AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
    end
  end

  /* End   change for wi# 15116- Ted Hendricks*/

  if (SR-AMA44-RECIN.PCE-AID-CD == "EM9")
    AMA16W.WS-TERM-CNT-EM9 = AMA16W.WS-TERM-CNT-EM9 + 1;
    AMA16W.WS-REC-FOUND = "Y";
    AMA16W.WS-CLSRE-REC-FND = "Y";
    AMA16W.WS-PB-REC-FND = "Y";
    AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
  else
    if (SR-AMA44-RECIN.PCE-AID-CD == "IN9")
      AMA16W.WS-TERM-CNT-IN9 = AMA16W.WS-TERM-CNT-IN9 + 1;
      AMA16W.WS-REC-FOUND = "Y";
      AMA16W.WS-CLSRE-REC-FND = "Y";
      AMA16W.WS-PB-REC-FND = "Y";
      AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
    else
      if (SR-AMA44-RECIN.PCE-AID-CD == "SI9")
        AMA16W.WS-TERM-CNT-SI9 = AMA16W.WS-TERM-CNT-SI9 + 1;
        AMA16W.WS-REC-FOUND = "Y";
        AMA16W.WS-CLSRE-REC-FND = "Y";
        AMA16W.WS-PB-REC-FND = "Y";
        AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
      else
        if (SR-AMA44-RECIN.PCE-AID-CD == "PK9" || 
        SR-AMA44-RECIN.PCE-AID-CD == "AD9" || 
        SR-AMA44-RECIN.PCE-AID-CD == "WW9" || 
        SR-AMA44-RECIN.PCE-AID-CD == "WS9" || 
        SR-AMA44-RECIN.PCE-AID-CD == "SU9" || 
         /* ****************************************************************/
         /* WDS;04-19-2000;WI#18063 --- ADD NEW PUBLIC-LAW AID CODE 'NO9'*/
         /* ****************************************************************/
        SR-AMA44-RECIN.PCE-AID-CD == "NO9")
          AMA16W.WS-TERM-CNT-PK9 = AMA16W.WS-TERM-CNT-PK9 + 1;
          AMA16W.WS-REC-FOUND = "Y";
          AMA16W.WS-CLSRE-REC-FND = "Y";
          AMA16W.WS-PB-REC-FND = "Y";
          AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
        else
          if (SR-AMA44-RECIN.PCE-AID-CD == "KB9")
            AMA16W.WS-TERM-CNT-KB9 = AMA16W.WS-TERM-CNT-KB9 + 1;
            AMA16W.WS-REC-FOUND = "Y";
            AMA16W.WS-CLSRE-REC-FND = "Y";
            AMA16W.WS-PB-REC-FND = "Y";
            AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
          else
            if (SR-AMA44-RECIN.PCE-AID-CD == "WB9")
              AMA16W.WS-TERM-CNT-WB9 = AMA16W.WS-TERM-CNT-WB9 + 1;
              AMA16W.WS-REC-FOUND = "Y";
              AMA16W.WS-CLSRE-REC-FND = "Y";
              AMA16W.WS-PB-REC-FND = "Y";
              AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
            else
              if (SR-AMA44-RECIN.PCE-AID-CD == "GC9")
                AMA16W.WS-TERM-CNT-GC9 = AMA16W.WS-TERM-CNT-GC9 + 1;
                AMA16W.WS-REC-FOUND = "Y";
                AMA16W.WS-CLSRE-REC-FND = "Y";
                AMA16W.WS-PB-REC-FND = "Y";
                AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
              else
                if (SR-AMA44-RECIN.PCE-AID-CD == "SS9")
                  AMA16W.WS-TERM-CNT-SS9 = AMA16W.WS-TERM-CNT-SS9 + 1;
                  AMA16W.WS-REC-FOUND = "Y";
                  AMA16W.WS-CLSRE-REC-FND = "Y";
                  AMA16W.WS-PB-REC-FND = "Y";
                  AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                else
                  if (SR-AMA44-RECIN.PCE-AID-CD == "HD9")
                    AMA16W.WS-TERM-CNT-HD9 = AMA16W.WS-TERM-CNT-HD9 + 1;
                    AMA16W.WS-REC-FOUND = "Y";
                    AMA16W.WS-CLSRE-REC-FND = "Y";
                    AMA16W.WS-PB-REC-FND = "Y";
                    AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                  else
                    if (SR-AMA44-RECIN.PCE-AID-CD == "HG9")
                      AMA16W.WS-TERM-CNT-HG9 = AMA16W.WS-TERM-CNT-HG9 + 1;
                      AMA16W.WS-REC-FOUND = "Y";
                      AMA16W.WS-CLSRE-REC-FND = "Y";
                      AMA16W.WS-PB-REC-FND = "Y";
                      AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                    else
                      if (SR-AMA44-RECIN.PCE-AID-CD == "HR9")
                        AMA16W.WS-TERM-CNT-HR9 = AMA16W.WS-TERM-CNT-HR9 + 1;
                        AMA16W.WS-REC-FOUND = "Y";
                        AMA16W.WS-CLSRE-REC-FND = "Y";
                        AMA16W.WS-PB-REC-FND = "Y";
                        AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                      else
                        if (SR-AMA44-RECIN.PCE-AID-CD == "CM9")
                          AMA16W.WS-TERM-CNT-CM9 = AMA16W.WS-TERM-CNT-CM9 +                           1;
                          AMA16W.WS-REC-FOUND = "Y";
                          AMA16W.WS-CLSRE-REC-FND = "Y";
                          AMA16W.WS-PB-REC-FND = "Y";
                          AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                        else
                          if (SR-AMA44-RECIN.PCE-AID-CD == "QM9")
                            AMA16W.WS-TERM-CNT-QM9 = AMA16W.WS-TERM-CNT-QM9                             + 1;
                            AMA16W.WS-REC-FOUND = "Y";
                            AMA16W.WS-CLSRE-REC-FND = "Y";
                            AMA16W.WS-PB-REC-FND = "Y";
                            AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                          else
                            if (SR-AMA44-RECIN.PCE-AID-CD == "SL9")
                              AMA16W.WS-TERM-CNT-SL9 = AMA16W.WS-TERM-CNT-SL9 + 1;
                              AMA16W.WS-REC-FOUND = "Y";
                              AMA16W.WS-CLSRE-REC-FND = "Y";
                              AMA16W.WS-PB-REC-FND = "Y";
                              AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                            else
                              if (SR-AMA44-RECIN.PCE-AID-CD == "QD9")
                                AMA16W.WS-TERM-CNT-QD9 = AMA16W.WS-TERM-CNT-QD9 + 1;
                                AMA16W.WS-REC-FOUND = "Y";
                                AMA16W.WS-CLSRE-REC-FND = "Y";
                                AMA16W.WS-PB-REC-FND = "Y";
                                AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                              end
                            end
                          end
                        end
                      end
                    end
                  end
                end
              end
            end
          end
        end
      end
    end
  end

  if (SR-AMA44-RECIN.PCE-AID-CD in AMA16W.WS-OBRA-ARRY)
    AMA16W.WS-TERM-CNT-OBRA = AMA16W.WS-TERM-CNT-OBRA + 1;
    AMA16W.WS-REC-FOUND = "Y";
    AMA16W.WS-CLSRE-REC-FND = "Y";
    AMA16W.WS-PB-REC-FND = "Y";
    AMA16W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
  end
end // end AMA16P9-CHK-AIDCD


// END PROCESS
Function AMA16P9-CLOS-PARA()
  /* cbsi start*/
  exit program;
  /* cbsi end*/
end // end AMA16P9-CLOS-PARA


// POPULATING DIST OF DETAILS
Function AMA16P9-DO-POP-DET()
  /* ***************************** start wi 16615 ***********************/
  /* move retrieved variables to output record*/
  AMA16W-DET.S-TERM-RSN = AMA16W.WS-DO-TERM-RSN[WS-AMA16-INDEX];
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-EM9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-EM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-IN9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-IN9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-SI9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-PK9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-PK9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-KB9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-KB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-WB9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-WB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-GC9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-GC9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-SS9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SS9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-HD9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-HG9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HG9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-HR9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HR9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-CM9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-CM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX];
  AMA16P9-FORMAT5();
  AMA16W-DET.S-TERM-CNT-SUB-TOTAL-DA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-QM9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-SL9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SL9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-QI9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-QJ9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QJ9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-QD9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SUB-TOTAL-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-OBRA[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-OBRA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX];
  AMA16P9-FORMAT5();
  AMA16W-DET.S-TERM-CNT-GR-TOTAL = FORMATW.OUTPUT-CHAR;
  /* *********************************end wi 16615 ********************/
end // end AMA16P9-DO-POP-DET


// PRINT DIST OFC REPORT
Function AMA16P9-DO-PRN()
  /* ************************* START WI 16615 *************************/
  AMA16P9-ACUM-DOFOT();
  AMA16P9-PRN-HEAD(); /* print the header details*/
  AMA16W.WS-DIST-OFC-NM = AMA16W.WS-OFC-NM;
  AMA16P9-PRN-SUBH();
  REP-COMMON.WS-NEW-PAGE = "N";
  AMA16W.WS-AMA16-INDEX = 1;
  while (AMA16W.WS-AMA16-INDEX <= 9)
    if (AMA16W.WS-DO-CLSRE-REC-FND[WS-AMA16-INDEX] == "Y")
      AMA16P9-DO-POP-DET();
      AMA16P9-PRN-DETAIL();
    end
    AMA16W.WS-AMA16-INDEX = AMA16W.WS-AMA16-INDEX + 1;
  end
  AMA16P9-POP-DOFOOT();
  AMA16P9-PRN-FOOTER();
  move "N" to AMA16W.WS-DO-CLSRE-REC-FND[1] for all;
  /* *********************   END WI 16615 ********************/
end // end AMA16P9-DO-PRN


// FORMAT REPORT FIELDS
Function AMA16P9-FORMAT4()
  FORMATW.LENGTH = 4;
  FORMATW.DEC-COUNT = 0;
  FORMATW.FORMAT-FLAG = "N";
  FORMATW.DOLLAR-FLAG = "N";
  REPP9-FORMAT-PROC();
end // end AMA16P9-FORMAT4


// FORMAT REPORT FIELDS
Function AMA16P9-FORMAT5()
  FORMATW.LENGTH = 5;
  FORMATW.DEC-COUNT = 0;
  FORMATW.FORMAT-FLAG = "N";
  FORMATW.DOLLAR-FLAG = "N";
  REPP9-FORMAT-PROC();
end // end AMA16P9-FORMAT5


// INIT DIST OFC RPT DETAILS
Function AMA16P9-INIT-DO()
  /* ***************************** start wi 16615 ***********************/
  move 0 to AMA16W.WS-DO-TERM-CNT-EM9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-IN9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-SI9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-PK9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-KB9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-WB9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-GC9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-SS9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-HD9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-HG9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-HR9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-CM9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-DA[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-QM9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-SL9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-QI9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-QJ9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-QD9[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-SUB-TOTAL-MB[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-OBRA[1] for all;
  move 0 to AMA16W.WS-DO-TERM-CNT-GR-TOTAL[1] for all;
  /* ********************** end wi 16615 *********************************/
end // end AMA16P9-INIT-DO


// INIT DIST OFC FOOTER DTLS
Function AMA16P9-INIT-DOTOT()
  /* ************************* start wi 16615 *****************************/
  AMA16W.WS-DO-TERM-CNT-AC-TOT-EM9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-IN9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-SI9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-PK9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-KB9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-WB9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-GC9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-SS9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-HD9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-HG9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-HR9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-CM9 = 0;
  AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-DA = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-QM9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-SL9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-QI9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-QJ9 = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-QD9 = 0;
  AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-MB = 0;
  AMA16W.WS-DO-TERM-CNT-AC-TOT-OBRA = 0;
  AMA16W.WS-DO-TERM-CNT-GR-AC-TOT = 0;
  /* ***************************** end wi 16615 *************************/
end // end AMA16P9-INIT-DOTOT


// INITIALIZE FOOTER TOTALS
Function AMA16P9-INIT-FOTOT()
  AMA16W.WS-TERM-CNT-AC-TOT-EM9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-IN9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-SI9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-PK9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-KB9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-WB9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-GC9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-SS9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-HD9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-HG9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-HR9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-CM9 = 0;
  AMA16W.WS-TERM-CNT-SUB-AC-TOT-DA = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-QM9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-SL9 = 0;

  /* Begin change for wi# 15116- Ted Hendricks*/

  AMA16W.WS-TERM-CNT-AC-TOT-QI9 = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-QJ9 = 0;

  /* End   change for wi# 15116- Ted Hendricks*/

  AMA16W.WS-TERM-CNT-AC-TOT-QD9 = 0;
  AMA16W.WS-TERM-CNT-SUB-AC-TOT-MB = 0;
  AMA16W.WS-TERM-CNT-AC-TOT-OBRA = 0;
  AMA16W.WS-TERM-CNT-GR-AC-TOT = 0;
end // end AMA16P9-INIT-FOTOT


// INITIALIZE VARIABLES
Function AMA16P9-INIT-PARA()
  /* cbsi start*/
  /* perform process to initialize all additional records*/
  AMA16P9-SET-EMPTY();
  /* set all report variables to initial values*/
  /* ws-page-no      - current printing page number*/
  /* ws-line-no      - current page line no*/
  /* ws-new-page     - a new page indicator*/
  /* ws-max-no-lines - lineage for a standard report frame*/

  REP-COMMON.WS-PAGE-NO = 0;
  REP-COMMON.WS-LINE-NO = 1;
  REP-COMMON.WS-NEW-PAGE = "Y";
  AMA16W.WS-FIRST-TM-IND = "Y";
  AMA16W.WS-REC-FOUND = "N";
  AMA16W.WS-CLSRE-REC-FND = "N";
  AMA16W.WS-PB-REC-FND = "N";
  AMA16W.WS-DO-PB-REC-FND = "N"; /* wi 16615*/
  AMA16W.WS-DO-REC-FND = "N"; /* wi 16615*/
  move "N" to AMA16W.WS-DO-CLSRE-REC-FND[1] for all; /* wi 16615*/
  REP-COMMON.WS-MAX-NO-LINES = 56;

  /* set standard header variables*/

  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  REP-COMMON.WS-DT = GDW.DTL; /* current date*/
  REP-COMMON.WS-YEAR = REP-COMMON.WS-YY;
  REP-COMMON.WS-MONTH = REP-COMMON.WS-MM;
  REP-COMMON.WS-DAY = REP-COMMON.WS-DD;
  REP-COMMON.WS-F1 = "/";
  REP-COMMON.WS-F2 = "/";
  AMA16W-HEAD.UDATE = REP-COMMON.WS-DATE; /* report date*/
  AMA16W-HEAD.UTIME = VGVar.currentFormattedTime; /* current time*/
  AMA16W-HEAD.UAPPL = "AMA16A"; /* report name*/

  /* perform process to initialize constants*/

  AMA16P9-INITCON();

  /* perform process to read input parameter file*/
  /* validate date parameters, mandatory fields for*/
  /* input records*/
  AMA16P9-READIP();

  /* perform  process for validation of input parameters*/
  AMA16P9-VALIDATE();


  /* populate application specific header*/
  AMA16W-HEAD.S-REPYR = AMA16W.WS-RPT-DT-CCYY;

  /* populate  header variables*/

  if ((AMA16W.WS-RPT-DT-MM == 01))
    AMA16W-HEAD.S-REPMTH = "   JANUARY,";
  else
    if ((AMA16W.WS-RPT-DT-MM == 02))
      AMA16W-HEAD.S-REPMTH = "  FEBRUARY,";
    else
      if ((AMA16W.WS-RPT-DT-MM == 03))
        AMA16W-HEAD.S-REPMTH = "     MARCH,";
      else
        if ((AMA16W.WS-RPT-DT-MM == 04))
          AMA16W-HEAD.S-REPMTH = "     APRIL,";
        else
          if ((AMA16W.WS-RPT-DT-MM == 05))
            AMA16W-HEAD.S-REPMTH = "       MAY,";
          else
            if ((AMA16W.WS-RPT-DT-MM == 06))
              AMA16W-HEAD.S-REPMTH = "      JUNE,";
            else
              if ((AMA16W.WS-RPT-DT-MM == 07))
                AMA16W-HEAD.S-REPMTH = "      JULY,";
              else
                if ((AMA16W.WS-RPT-DT-MM == 08))
                  AMA16W-HEAD.S-REPMTH = "    AUGUST,";
                else
                  if ((AMA16W.WS-RPT-DT-MM == 09))
                    AMA16W-HEAD.S-REPMTH = " SEPTEMBER,";
                  else
                    if ((AMA16W.WS-RPT-DT-MM == 10))
                      AMA16W-HEAD.S-REPMTH = "   OCTOBER,";
                    else
                      if ((AMA16W.WS-RPT-DT-MM == 11))
                        AMA16W-HEAD.S-REPMTH = "  NOVEMBER,";
                      else
                        if ((AMA16W.WS-RPT-DT-MM == 12))
                          AMA16W-HEAD.S-REPMTH = "  DECEMBER,";
                        end /* end of if rpt-month = 12*/
                      end /* end of if rpt-month = 11*/
                    end /* end of if rpt-month = 10*/
                  end /* end of if rpt-month = 09*/
                end /* end of if rpt-month = 08*/
              end /* end of if rpt-month = 07*/
            end /* end of if rpt-month = 06*/
          end /* end of if rpt-month = 05*/
        end /* end of if rpt-month = 04*/
      end /* end of if rpt-month = 03*/
    end /* end of if rpt-month = 02*/
  end /* end of if rpt-month = 01*/

  AMA16P9-INIT-VAR();
  /* cbsi end*/
end // end AMA16P9-INIT-PARA


// INITIALIZE REPORT TOTALS
Function AMA16P9-INIT-TOT()
  AMA16W.WS-TERM-CNT-EM9 = 0;
  AMA16W.WS-TERM-CNT-IN9 = 0;
  AMA16W.WS-TERM-CNT-SI9 = 0;
  AMA16W.WS-TERM-CNT-PK9 = 0;
  AMA16W.WS-TERM-CNT-KB9 = 0;
  AMA16W.WS-TERM-CNT-WB9 = 0;
  AMA16W.WS-TERM-CNT-GC9 = 0;
  AMA16W.WS-TERM-CNT-SS9 = 0;
  AMA16W.WS-TERM-CNT-HD9 = 0;
  AMA16W.WS-TERM-CNT-HG9 = 0;
  AMA16W.WS-TERM-CNT-HR9 = 0;
  AMA16W.WS-TERM-CNT-CM9 = 0;
  AMA16W.WS-TERM-CNT-SUB-TOTAL-DA = 0;
  AMA16W.WS-TERM-CNT-QM9 = 0;
  AMA16W.WS-TERM-CNT-SL9 = 0;

  /* Begin change for wi# 15116- Ted Hendricks*/

  AMA16W.WS-TERM-CNT-QI9 = 0;
  AMA16W.WS-TERM-CNT-QJ9 = 0;

  /* End   change for wi# 15116- Ted Hendricks*/

  AMA16W.WS-TERM-CNT-QD9 = 0;
  AMA16W.WS-TERM-CNT-SUB-TOTAL-MB = 0;
  AMA16W.WS-TERM-CNT-OBRA = 0;
  AMA16W.WS-TERM-CNT-GR-TOTAL = 0;
end // end AMA16P9-INIT-TOT


// INITIALIZE ARRAY (OBRA)
Function AMA16P9-INIT-VAR()
  AMA16W.WS-OBRA-ARRY[1] = "AD5";
  AMA16W.WS-OBRA-ARRY[2] = "CM5";
  AMA16W.WS-OBRA-ARRY[3] = "GC5";
  AMA16W.WS-OBRA-ARRY[4] = "HG5";
  AMA16W.WS-OBRA-ARRY[5] = "HD5";
  AMA16W.WS-OBRA-ARRY[6] = "HR5";
  AMA16W.WS-OBRA-ARRY[7] = "IN5";
  AMA16W.WS-OBRA-ARRY[8] = "KB5";
  AMA16W.WS-OBRA-ARRY[9] = "PK5";
  AMA16W.WS-OBRA-ARRY[10] = "QM5";
  AMA16W.WS-OBRA-ARRY[11] = "SI5";
  AMA16W.WS-OBRA-ARRY[12] = "SS5";
  AMA16W.WS-OBRA-ARRY[13] = "SU5";
  AMA16W.WS-OBRA-ARRY[14] = "WB5";
  AMA16W.WS-OBRA-ARRY[15] = "WS5";
  AMA16W.WS-OBRA-ARRY[16] = "WW5";
end // end AMA16P9-INIT-VAR


// INITIALISE CONSTANTS
Function AMA16P9-INITCON()
  /* this process intialises all the reports constants*/
  AMA16W-HEAD.CONSTANT1 = "PAGE-NBR";
  AMA16W-HEAD.CONSTANT2 = "STATE";
  AMA16W-HEAD.CONSTANT3 = "OF";
  AMA16W-HEAD.CONSTANT4 = "NEVADA";
  AMA16W-HEAD.CONSTANT5 = "DATE";
  AMA16W-HEAD.CONSTANT6 = "ONGOING";
  AMA16W-HEAD.CONSTANT7 = "TERMINATION";
  AMA16W-HEAD.CONSTANT8 = "REASON";
  AMA16W-HEAD.CONSTANT9 = "STATISTICS";
  AMA16W-HEAD.CONSTANT10 = "BY";
  AMA16W-HEAD.CONSTANT11 = "AID";
  AMA16W-HEAD.CONSTANT12 = "CODE";
  AMA16W-HEAD.CONSTANT13 = "-";
  AMA16W-HEAD.CONSTANT14 = "DISABLED";
  AMA16W-HEAD.CONSTANT15 = "TIME";
  AMA16W-HEAD.CONSTANT16 = "MONTH";
  AMA16W-HEAD.CONSTANT17 = "OF";
  AMA16W-HEAD.CONSTANT18 = ":";
  AMA16W-SUBH.CONSTANT1 = "LEVEL";
  AMA16W-SUBH.CONSTANT2 = "REASON";
  AMA16W-SUBH.CONSTANT3 = "<---------------------------------";
  AMA16W-SUBH.CONSTANT4 = "-DISABLED------------------------";
  AMA16W-SUBH.CONSTANT5 = "-><----------MED";
  AMA16W-SUBH.CONSTANT6 = "BEN----------->";
  AMA16W-SUBH.CONSTANT7 = "PK9/AD9";
  AMA16W-SUBH.CONSTANT8 = "SUB";
  AMA16W-SUBH.CONSTANT9 = "SUB";
  AMA16W-SUBH.CONSTANT10 = "OBRA";
  AMA16W-SUBH.CONSTANT11 = "GRAND";
  AMA16W-SUBH.CONSTANT12 = "EM9";
  AMA16W-SUBH.CONSTANT13 = "IN9";
  AMA16W-SUBH.CONSTANT14 = "SI9";
  AMA16W-SUBH.CONSTANT15 = "WW9/WS9";
  AMA16W-SUBH.CONSTANT16 = "KB9";
  AMA16W-SUBH.CONSTANT17 = "WB9";
  AMA16W-SUBH.CONSTANT18 = "GC9";
  AMA16W-SUBH.CONSTANT19 = "SS9";
  AMA16W-SUBH.CONSTANT20 = "HD9";
  AMA16W-SUBH.CONSTANT21 = "HG9";
  AMA16W-SUBH.CONSTANT22 = "HR9";
  AMA16W-SUBH.CONSTANT23 = "CM9";
  AMA16W-SUBH.CONSTANT24 = "TOTAL";
  AMA16W-SUBH.CONSTANT25 = "QM9";
  AMA16W-SUBH.CONSTANT26 = "SL9";
  AMA16W-SUBH.CONSTANT27 = "QI9";
  AMA16W-SUBH.CONSTANT28 = "QJ9";
  AMA16W-SUBH.CONSTANT29 = "QD9";
  AMA16W-SUBH.CONSTANT30 = "TOTAL";
  AMA16W-SUBH.CONSTANT31 = "BABY";
  AMA16W-SUBH.CONSTANT32 = "TOTAL";
  /* ******************************************************************/
  /* WDS;04-19-2000;WI#18063 --- ADD NEW PUBLIC-LAW AID CODE 'NO9'*/
  /* ******************************************************************/
  AMA16W-SUBH.CONSTANT33 = "SU9/NO9";
  AMA16W-FOOTER.CONSTANT1 = "------------------------------------";
  AMA16W-FOOTER.CONSTANT2 = "------------------------------------";
  AMA16W-FOOTER.CONSTANT3 = "------------------------------------";
  AMA16W-FOOTER.CONSTANT4 = "----------------------";
  AMA16W-FOOTER.CONSTANT5 = "***";
  AMA16W-FOOTER.CONSTANT6 = "TOTAL";
  AMA16W-FOOTER.CONSTANT7 = "***";
end // end AMA16P9-INITCON


// REPORTS MAIN PARA
Function AMA16P9-MAIN()
  /* cbsi start*/

  /* perform process to initialize variables*/
  AMA16P9-INIT-PARA();

  /* perform process to print the report*/
  AMA16P9-PRINT-PARA();

  /* perform process to close the application*/
  AMA16P9-CLOS-PARA();

  /* cbsi end*/
end // end AMA16P9-MAIN


// POPULATING REPORTS DETAILS
Function AMA16P9-POP-DET()
  /* cbsi start*/
  /* move retrieved variables to output record*/
  AMA16W-DET.S-TERM-RSN = AMA16W.WS-TERM-RSN-TRUNC;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-EM9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-EM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-IN9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-IN9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-SI9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-PK9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-PK9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-KB9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-KB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-WB9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-WB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-GC9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-GC9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-SS9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SS9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-HD9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-HG9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HG9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-HR9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HR9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-CM9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-CM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-SUB-TOTAL-DA;
  AMA16P9-FORMAT5();
  AMA16W-DET.S-TERM-CNT-SUB-TOTAL-DA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-QM9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-SL9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SL9 = FORMATW.OUTPUT-CHAR;

  /* Begin change for wi# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-QI9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-QJ9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QJ9 = FORMATW.OUTPUT-CHAR;

  /* End   change for wi# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-QD9;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-SUB-TOTAL-MB;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SUB-TOTAL-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-OBRA;
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-OBRA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-GR-TOTAL;
  AMA16P9-FORMAT5();
  AMA16W-DET.S-TERM-CNT-GR-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA16P9-POP-DET


// POPULATE REPT FOOTER DETAILS
Function AMA16P9-POP-DOFOOT()
  /* ********************************** start wi 16615 ********************/
  /* move retrieved variables to output record*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-EM9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-EM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-IN9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-IN9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-SI9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-SI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-PK9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-PK9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-KB9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-KB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-WB9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-WB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-GC9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-GC9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-SS9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-SS9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-HD9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-HD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-HG9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-HG9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-HR9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-HR9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-CM9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-CM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-DA;
  AMA16P9-FORMAT5();
  AMA16W-FOOTER.S-TERM-CNT-SUB-AC-TOT-DA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-QM9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-SL9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-SL9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-QI9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-QJ9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QJ9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-QD9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-SUB-AC-TOT-MB;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-SUB-AC-TOT-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-AC-TOT-OBRA;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-OBRA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-DO-TERM-CNT-GR-AC-TOT;
  AMA16P9-FORMAT5();
  AMA16W-FOOTER.S-TERM-CNT-GR-AC-TOT = FORMATW.OUTPUT-CHAR;
  /* *************************** end wi 1665 **********************/
end // end AMA16P9-POP-DOFOOT


// POPULATE REPT FOOTER DETAILS
Function AMA16P9-POP-FOOTER()
  /* cbsi start*/
  /* move retrieved variables to output record*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-EM9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-EM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-IN9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-IN9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-SI9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-SI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-PK9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-PK9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-KB9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-KB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-WB9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-WB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-GC9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-GC9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-SS9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-SS9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-HD9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-HD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-HG9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-HG9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-HR9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-HR9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-CM9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-CM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-SUB-AC-TOT-DA;
  AMA16P9-FORMAT5();
  AMA16W-FOOTER.S-TERM-CNT-SUB-AC-TOT-DA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-QM9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-SL9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-SL9 = FORMATW.OUTPUT-CHAR;

  /* Begin change for wi# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-QI9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-QJ9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QJ9 = FORMATW.OUTPUT-CHAR;

  /* End   change for wi# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-QD9;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-QD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-SUB-AC-TOT-MB;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-SUB-AC-TOT-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-AC-TOT-OBRA;
  AMA16P9-FORMAT4();
  AMA16W-FOOTER.S-TERM-CNT-AC-TOT-OBRA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-TERM-CNT-GR-AC-TOT;
  AMA16P9-FORMAT5();
  AMA16W-FOOTER.S-TERM-CNT-GR-AC-TOT = FORMATW.OUTPUT-CHAR;
end // end AMA16P9-POP-FOOTER


// PROCESS TO PRINT THE REPORT
Function AMA16P9-PRINT-PARA()
  /* cbsi start*/
  AMA16P9-SCAN();

  if (SR-AMA44-RECIN is ioError)
    AMA16P9-PRN-HEAD();
    REP132P9-NRF-PROC();
    AMA16P9-CLOS-PARA();
  end

  /* print all the details retrieved from the data base*/
  while (SR-AMA44-RECIN not ioError)

    if (SR-AMA44-RECIN.PCE-PRGM-CASE-STS == "T")
      if (AMA16W.WS-FIRST-TM-IND == "Y")
        AMA16W.WS-PREV-OFC-CD = SR-AMA44-RECIN.PCE-OFC-CD;
        AMA16W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
        AMA16W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
        AMA16W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
        AMA16W.WS-OFC-NM = SR-AMA44-RECIN.PCE-OFC-NM;
        AMA16W.WS-FIRST-TM-IND = "N";
      end
    /* perform processing specific to the application*/
      AMA16P9-APPLSPEC();

    end
    /* perform process to scan the cursor*/
    AMA16P9-SCAN();
  end /* end of while loop*/

  if (AMA16W.WS-REC-FOUND == "Y")
    if (AMA16W.WS-CLSRE-REC-FND == "Y")
      AMA16W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
      AMA16P9-ACUM-DET();
      AMA16P9-ACUM-DO(); /* WI 16615*/
      AMA16P9-ACUM-ST();
  /* print details for last record*/
  /* perform process to populate the details*/
      AMA16P9-POP-DET();
  /* perform process to print detail screen*/
      AMA16P9-PRN-DETAIL();
    end
    if (AMA16W.WS-PB-REC-FND == "Y")
      AMA16P9-POP-FOOTER();
      AMA16P9-PRN-FOOTER();
    end
    AMA16P9-INIT-TOT();
    AMA16P9-INIT-FOTOT();
    if (AMA16W.WS-DO-PB-REC-FND == "Y")
      AMA16P9-DO-PRN(); /* wi 16615*/
    end
    AMA16P9-ST-PRN();
  /* check if footer and end of report line can fit in the same page*/
    AMA16W.WS-REM-LINES = REP-COMMON.WS-MAX-NO-LINES -     REP-COMMON.WS-LINE-NO;

    if ((AMA16W.WS-REM-LINES < 2))
    /* set print control character to form feed*/
      AMA16P9-PRN-HEAD(); /* print header details*/
    end
  /* print end of report*/
    REP132P9-EOR-PROC();
  /* perform termination process*/
    AMA16P9-CLOS-PARA();
  end

  AMA16P9-PRN-HEAD();
  REP132P9-NRF-PROC();
  /* cbsi end*/
end // end AMA16P9-PRINT-PARA


// PRINT REPORT DETAIL
Function AMA16P9-PRN-DETAIL()
  /* cbsi start*/
  if ((REP-COMMON.WS-NEW-PAGE == "Y"))
    AMA16P9-PRN-HEAD(); /* print the header details*/
    AMA16P9-PRN-SUBH(); /* print the subheader*/
    REP-COMMON.WS-NEW-PAGE = "N"; /* reset new page  indicator*/
  end
  if (REP-COMMON.WS-LINE-NO >= REP-COMMON.WS-MAX-NO-LINES)
    AMA16P9-PRN-HEAD();
    AMA16P9-PRN-SUBH();
  end
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA16W-DET.LINE1;
  WR-132REP-OUT-FILE();
  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";
  /* cbsi end*/
end // end AMA16P9-PRN-DETAIL


// PRINT REPORT FOOTER
Function AMA16P9-PRN-FOOTER()
  /* cbsi start*/
  REP-COMMON.WS-REM1 = REP-COMMON.WS-MAX-NO-LINES - REP-COMMON.WS-LINE-NO;
  if (REP-COMMON.WS-REM1 < 2)
    AMA16P9-PRN-HEAD();
    AMA16P9-PRN-SUBH();
  end
  SR-132REP-RECOUT.PRNT-CC = " ";
  SR-132REP-RECOUT.UFIELD = AMA16W-FOOTER.LINE1;
  WR-132REP-OUT-FILE();
  /* leave 1 line before printing curr line*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA16W-FOOTER.LINE2;
  WR-132REP-OUT-FILE();
  /* cbsi end*/
end // end AMA16P9-PRN-FOOTER


// PRINT REPORT HEADER
Function AMA16P9-PRN-HEAD()
  /* cbsi start*/
  /* increment page-no*/
  REP-COMMON.WS-PAGE-NO = REP-COMMON.WS-PAGE-NO + 1;

  if (REP-COMMON.WS-PAGE-NO > 1)
    SR-132REP-RECOUT.PRNT-CC = "1";
  end
  /* move page-no to header variable*/
  AMA16W-HEAD.UPAGE = REP-COMMON.WS-PAGE-NO-3-4;

  /* move each line of header to map and print*/
  SR-132REP-RECOUT.UFIELD = AMA16W-HEAD.LINE1;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AMA16W-HEAD.LINE2;
  WR-132REP-OUT-FILE();
  if (AMA16W-HEAD.LINE3 != " ")
    SR-132REP-RECOUT.UFIELD = AMA16W-HEAD.LINE3;
    WR-132REP-OUT-FILE();
  end
  /* cbsi end*/
end // end AMA16P9-PRN-HEAD


// PRINTING THE REPORT'S SUB-HEAD
Function AMA16P9-PRN-SUBH()
  /* cbsi start*/
  AMA16W.WS-LEVEL-OFC-NM = AMA16W.WS-OFC-NM-TRUNC;
  AMA16W.WS-LEVEL-CASLD-ID = AMA16W.WS-PREV-CASLD-ID;
  AMA16W-SUBH.S-LEVEL = AMA16W.WS-LEVEL;
  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA16W-SUBH.LINE1;
  WR-132REP-OUT-FILE();

  /* set control character to skip one line before printing curr line*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA16W-SUBH.LINE2;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";
  SR-132REP-RECOUT.UFIELD = AMA16W-SUBH.LINE3;
  WR-132REP-OUT-FILE();

  SR-132REP-RECOUT.UFIELD = AMA16W-SUBH.LINE4;
  WR-132REP-OUT-FILE();
  SR-132REP-RECOUT.UFIELD = AMA16W-SUBH.LINE5;
  WR-132REP-OUT-FILE();

  SR-132REP-RECOUT.PRNT-CC = "0";
  /* cbsi end*/
end // end AMA16P9-PRN-SUBH


// PROCESS TO READ INPUT FILE
Function AMA16P9-READIP()
  /* cbsi start*/
  VDBCONTROL.UPROC-NM = "AMA16P9-READIP";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "SR-AMA16-RECIN";
  try
    get next SR-AMA16-RECIN ;
  end
  /* check if any i/o error has occured*/
  if (SR-AMA16-RECIN is ioError && SR-AMA16-RECIN not endOfFile)
     /* return error code to indicate abnormal ending*/
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA16W.WS-EZERT8 = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA16W.WS-EZERT8-LAST4;
    WCM00P2-TO-CEP01A();
  end

  if (SR-AMA16-RECIN is endOfFile)
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA16W.WS-EZERT8 = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA16W.WS-EZERT8-LAST4;
    WCM00P2-TO-CEP01A();
  end
  /* cbsi end*/
end // end AMA16P9-READIP


// SCAN FILE (SR-AMA44-RECIN)
Function AMA16P9-SCAN()
  /* cbsi start*/
  VDBCONTROL.UPROC-NM = "AMA16P9-READIP";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "SR-AMA44-RECIN";
  try
    get next SR-AMA44-RECIN ;
  end
  /* check if any i/o error has occured*/
  if (SR-AMA44-RECIN is ioError && SR-AMA44-RECIN not endOfFile)
     /* return error code to indicate abnormal ending*/
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA16W.WS-EZERT8 = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA16W.WS-EZERT8-LAST4;
    WCM00P2-TO-CEP01A();
  end
end // end AMA16P9-SCAN


// INITIALIZE ALL RECORDS
Function AMA16P9-SET-EMPTY()
  /* cbsi start*/
  set REP-COMMON empty;
  set REP-EOFNOF empty;
  set REP-DATE empty;
  set AMA16W-DET empty;
  set AMA16W-HEAD empty;
  set AMA16W-SUBH empty;
  set AMA16W-FOOTER empty;
  set VMESSAGE empty;
  set CEP01W empty;
  set VDBCONTROL empty;
  set VDBCOMMON empty;
  set FORMATW empty;
  set AMA16W empty;


  set SR-AMA16-RECIN empty;
  set SR-132REP-RECOUT empty;
  set SR-AMA44-RECIN empty;
  /* cbsi end*/
end // end AMA16P9-SET-EMPTY


// POPULATE DETAIL FOR SW REPORT
Function AMA16P9-ST-POP-DET()
  AMA16W-DET.S-TERM-RSN = AMA16W.WS-ST-TERM-RSN[WS-AMA16-INDEX];
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-EM9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-EM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-IN9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-IN9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-SI9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-PK9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-PK9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-KB9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-KB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-WB9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-WB9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-GC9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-GC9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-SS9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SS9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-HD9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-HG9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HG9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-HR9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-HR9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-CM9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-CM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-DA[WS-AMA16-INDEX];
  AMA16P9-FORMAT5();
  AMA16W-DET.S-TERM-CNT-SUB-TOTAL-DA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-QM9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QM9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-SL9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SL9 = FORMATW.OUTPUT-CHAR;

  /* Begin change for wi# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-QI9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QI9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-QJ9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QJ9 = FORMATW.OUTPUT-CHAR;

  /* End   change for wi# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-QD9[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-QD9 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-SUB-TOTAL-MB[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-SUB-TOTAL-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-OBRA[WS-AMA16-INDEX];
  AMA16P9-FORMAT4();
  AMA16W-DET.S-TERM-CNT-OBRA = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA16W.WS-ST-TERM-CNT-GR-TOTAL[WS-AMA16-INDEX];
  AMA16P9-FORMAT5();
  AMA16W-DET.S-TERM-CNT-GR-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA16P9-ST-POP-DET


// PRINT STWIDE REPORT
Function AMA16P9-ST-PRN()
  AMA16P9-ACUM-STFOT();
  AMA16P9-PRN-HEAD(); /* print the header details*/
  AMA16W.WS-PREV-CASLD-ID = "STATE";
  AMA16W.WS-OFC-NM = "WIDE";
  AMA16P9-PRN-SUBH();
  REP-COMMON.WS-NEW-PAGE = "N";
  AMA16W.WS-AMA16-INDEX = 1;
  while (AMA16W.WS-AMA16-INDEX <= 9)
    if (AMA16W.WS-ST-CLSRE-REC-FND[WS-AMA16-INDEX] == "Y")
      AMA16P9-ST-POP-DET();
      AMA16P9-PRN-DETAIL();
    end
    AMA16W.WS-AMA16-INDEX = AMA16W.WS-AMA16-INDEX + 1;
  end
  AMA16P9-POP-FOOTER();
  AMA16P9-PRN-FOOTER();
end // end AMA16P9-ST-PRN


// VALIDATES  INPUT  PARAMETERS
Function AMA16P9-VALIDATE()
  if (SR-AMA16-RECIN.RPT-DT not numeric)
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA16W.WS-EZERT8 = "        ";
    VMESSAGE.UMSGINS[1] = AMA16W.WS-EZERT8-LAST4;
    VMESSAGE.UMSGCODE = "CEP0043E"; /* INVALID INPUT-PROCESS DATE*/
    WCM00P2-TO-CEP01A();
  end

  AMA16W.WS-TOPREC = SR-AMA16-RECIN.TOPREC;
  /* validation of input month & calculation of start and end date*/
  REP-DATE.WS-IN-RPT-MM = AMA16W.WS-RPT-DT-MM;
  REP-DATE.WS-IN-RPT-CCYY = AMA16W.WS-RPT-DT-CCYY;
  REP-DATE.WS-FLAG = "M";
  REPP9-DATE-PARA();
  if (REP-DATE.WS-DATE-FLAG == 1)
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA16W.WS-EZERT8 = "        ";
    VMESSAGE.UMSGINS[1] = AMA16W.WS-EZERT8-LAST4;
    VMESSAGE.UMSGCODE = "CEP0043E"; /* INVALID INPUT-PROCESS DATE*/
    WCM00P2-TO-CEP01A();
  end

  /* move start and end calculate days to your local storage*/
  AMA16W.WS-RPT-BEG-DT = REP-DATE.WS-START-DATE;
  AMA16W.WS-RPT-END-DT = REP-DATE.WS-END-DATE;
  AMA16W.WS-RPT-YEAR = AMA16W.WS-RPT-BEG-DT-CCYY;
  AMA16W.WS-RPT-MNTH = AMA16W.WS-RPT-BEG-DT-MM;
end // end AMA16P9-VALIDATE


Record AMA16W type basicRecord
  10 WS-REM-LINES num(3) ; 
  10 WS-TOPREC char(80) ; 
    15 WS-RPT-DT num(6) ; 
      20 WS-RPT-DT-CCYY num(4) ; 
      20 WS-RPT-DT-MM num(2) ; 
    15 * char(74) ; 
  10 WS-RPT-BEG-DT char(10) ; 
    15 WS-RPT-BEG-DT-CCYY num(4) ; 
    15 WS-RPT-BEG-DT-F1 char(1) ; 
    15 WS-RPT-BEG-DT-MM num(2) ; 
    15 WS-RPT-BEG-DT-F2 char(1) ; 
    15 WS-RPT-BEG-DT-DD num(2) ; 
  10 WS-RPT-END-DT char(10) ; 
    15 WS-RPT-END-DT-CCYY num(4) ; 
    15 WS-RPT-END-DT-F1 char(1) ; 
    15 WS-RPT-END-DT-MM num(2) ; 
    15 WS-RPT-END-DT-F2 char(1) ; 
    15 WS-RPT-END-DT-DD num(2) ; 
  10 WS-RPT-YEAR smallint ; 
  10 WS-RPT-MNTH smallint ; 
  10 WS-PREV-OFC-CD char(2) ; 
  10 WS-PREV-CLSRE-RSN-CD char(2) ; 
  10 WS-PREV-AID-CD char(3) ; 
  10 WS-DIST-OFC-NM char(37) ; 
    15 WS-PREV-CASLD-ID char(5) ; 
    15 WS-OFC-NM char(32) ; 
      20 WS-OFC-NM-TRUNC char(15) ; 
      20 WS-OFC-NM-F1 char(17) ; 
  10 WS-TERM-RSN char(50) ; 
    15 WS-TERM-RSN-TRUNC char(19) ; 
    15 WS-TERM-RSN-F1 char(31) ; 
  10 WS-LEVEL char(20) ; 
    15 WS-LEVEL-CASLD-ID char(5) ; 
    15 WS-LEVEL-OFC-NM char(15) ; 
  10 WS-FIRST-TM-IND char(1) ; 
  10 WS-AMA16-INDEX num(3) ; 
  10 WS-REC-FOUND char(1) ; 
  10 WS-DO-REC-FND char(1) ; 
  10 WS-ST-REC-FND char(1) ; 
  10 WS-CLSRE-REC-FND char(1) ; 
  10 WS-PB-REC-FND char(1) ; 
  10 WS-DO-PB-REC-FND char(1) ; 
  10 WS-OBRA-ARRY char(3) [16] ; 
  10 WS-DET char(86) ; 
    15 WS-TERM-CNT-EM9 num(4) ; 
    15 WS-TERM-CNT-IN9 num(4) ; 
    15 WS-TERM-CNT-SI9 num(4) ; 
    15 WS-TERM-CNT-PK9 num(4) ; 
    15 WS-TERM-CNT-WB9 num(4) ; 
    15 WS-TERM-CNT-KB9 num(4) ; 
    15 WS-TERM-CNT-GC9 num(4) ; 
    15 WS-TERM-CNT-SS9 num(4) ; 
    15 WS-TERM-CNT-HD9 num(4) ; 
    15 WS-TERM-CNT-HG9 num(4) ; 
    15 WS-TERM-CNT-HR9 num(4) ; 
    15 WS-TERM-CNT-CM9 num(4) ; 
    15 WS-TERM-CNT-SUB-TOTAL-DA num(5) ; 
    15 WS-TERM-CNT-QM9 num(4) ; 
    15 WS-TERM-CNT-SL9 num(4) ; 
    15 WS-TERM-CNT-QI9 num(4) ; 
    15 WS-TERM-CNT-QJ9 num(4) ; 
    15 WS-TERM-CNT-QD9 num(4) ; 
    15 WS-TERM-CNT-SUB-TOTAL-MB num(4) ; 
    15 WS-TERM-CNT-OBRA num(4) ; 
    15 WS-TERM-CNT-GR-TOTAL num(5) ; 
  10 WS-FO-DET char(86) ; 
    15 WS-TERM-CNT-AC-TOT-EM9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-IN9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-SI9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-PK9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-WB9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-KB9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-GC9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-SS9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-HD9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-HG9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-HR9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-CM9 num(4) ; 
    15 WS-TERM-CNT-SUB-AC-TOT-DA num(5) ; 
    15 WS-TERM-CNT-AC-TOT-QM9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-SL9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-QI9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-QJ9 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-QD9 num(4) ; 
    15 WS-TERM-CNT-SUB-AC-TOT-MB num(4) ; 
    15 WS-TERM-CNT-AC-TOT-OBRA num(4) ; 
    15 WS-TERM-CNT-GR-AC-TOT num(5) ; 
  10 WS-FO-DO-DET char(86) ; 
    15 WS-DO-TERM-CNT-AC-TOT-EM9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-IN9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-SI9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-PK9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-WB9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-KB9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-GC9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-SS9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-HD9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-HG9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-HR9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-CM9 num(4) ; 
    15 WS-DO-TERM-CNT-SUB-AC-TOT-DA num(5) ; 
    15 WS-DO-TERM-CNT-AC-TOT-QM9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-SL9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-QI9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-QJ9 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-QD9 num(4) ; 
    15 WS-DO-TERM-CNT-SUB-AC-TOT-MB num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-OBRA num(4) ; 
    15 WS-DO-TERM-CNT-GR-AC-TOT num(5) ; 
  10 WS-DO-DET char(106) [9] ; 
    15 WS-DO-CLSRE-REC-FND char(1) ; 
    15 WS-DO-TERM-RSN char(19) ; 
    15 WS-DO-TERM-CNT-EM9 num(4) ; 
    15 WS-DO-TERM-CNT-IN9 num(4) ; 
    15 WS-DO-TERM-CNT-SI9 num(4) ; 
    15 WS-DO-TERM-CNT-PK9 num(4) ; 
    15 WS-DO-TERM-CNT-WB9 num(4) ; 
    15 WS-DO-TERM-CNT-KB9 num(4) ; 
    15 WS-DO-TERM-CNT-GC9 num(4) ; 
    15 WS-DO-TERM-CNT-SS9 num(4) ; 
    15 WS-DO-TERM-CNT-HD9 num(4) ; 
    15 WS-DO-TERM-CNT-HG9 num(4) ; 
    15 WS-DO-TERM-CNT-HR9 num(4) ; 
    15 WS-DO-TERM-CNT-CM9 num(4) ; 
    15 WS-DO-TERM-CNT-SUB-TOTAL-DA num(5) ; 
    15 WS-DO-TERM-CNT-QM9 num(4) ; 
    15 WS-DO-TERM-CNT-SL9 num(4) ; 
    15 WS-DO-TERM-CNT-QI9 num(4) ; 
    15 WS-DO-TERM-CNT-QJ9 num(4) ; 
    15 WS-DO-TERM-CNT-QD9 num(4) ; 
    15 WS-DO-TERM-CNT-SUB-TOTAL-MB num(4) ; 
    15 WS-DO-TERM-CNT-OBRA num(4) ; 
    15 WS-DO-TERM-CNT-GR-TOTAL num(5) ; 
  10 WS-ST-DET char(106) [9] ; 
    15 WS-ST-CLSRE-REC-FND char(1) ; 
    15 WS-ST-TERM-RSN char(19) ; 
    15 WS-ST-TERM-CNT-EM9 num(4) ; 
    15 WS-ST-TERM-CNT-IN9 num(4) ; 
    15 WS-ST-TERM-CNT-SI9 num(4) ; 
    15 WS-ST-TERM-CNT-PK9 num(4) ; 
    15 WS-ST-TERM-CNT-WB9 num(4) ; 
    15 WS-ST-TERM-CNT-KB9 num(4) ; 
    15 WS-ST-TERM-CNT-GC9 num(4) ; 
    15 WS-ST-TERM-CNT-SS9 num(4) ; 
    15 WS-ST-TERM-CNT-HD9 num(4) ; 
    15 WS-ST-TERM-CNT-HG9 num(4) ; 
    15 WS-ST-TERM-CNT-HR9 num(4) ; 
    15 WS-ST-TERM-CNT-CM9 num(4) ; 
    15 WS-ST-TERM-CNT-SUB-TOTAL-DA num(5) ; 
    15 WS-ST-TERM-CNT-QM9 num(4) ; 
    15 WS-ST-TERM-CNT-SL9 num(4) ; 
    15 WS-ST-TERM-CNT-QI9 num(4) ; 
    15 WS-ST-TERM-CNT-QJ9 num(4) ; 
    15 WS-ST-TERM-CNT-QD9 num(4) ; 
    15 WS-ST-TERM-CNT-SUB-TOTAL-MB num(4) ; 
    15 WS-ST-TERM-CNT-OBRA num(4) ; 
    15 WS-ST-TERM-CNT-GR-TOTAL num(5) ; 
  10 WS-EZERT8 num(8) ; 
    15 WS-EZERT8-FIRST4 char(4) ; 
    15 WS-EZERT8-LAST4 char(4) ; 
end // end AMA16W


Record AMA16W-DET type basicRecord
  10 LINE1 char(132) ; 
    15 S-TERM-RSN char(19) ; 
    15 FILLER1 char(2) ; 
    15 S-TERM-CNT-EM9 char(4) ; 
    15 FILLER2 char(1) ; 
    15 S-TERM-CNT-IN9 char(4) ; 
    15 FILLER3 char(1) ; 
    15 S-TERM-CNT-SI9 char(4) ; 
    15 FILLER4 char(1) ; 
    15 S-TERM-CNT-PK9 char(4) ; 
    15 FILLER5 char(3) ; 
    15 S-TERM-CNT-KB9 char(4) ; 
    15 FILLER6 char(1) ; 
    15 S-TERM-CNT-WB9 char(4) ; 
    15 FILLER7 char(1) ; 
    15 S-TERM-CNT-GC9 char(4) ; 
    15 FILLER8 char(1) ; 
    15 S-TERM-CNT-SS9 char(4) ; 
    15 FILLER9 char(1) ; 
    15 S-TERM-CNT-HD9 char(4) ; 
    15 FILLER10 char(1) ; 
    15 S-TERM-CNT-HG9 char(4) ; 
    15 FILLER11 char(1) ; 
    15 S-TERM-CNT-HR9 char(4) ; 
    15 FILLER12 char(1) ; 
    15 S-TERM-CNT-CM9 char(4) ; 
    15 FILLER13 char(1) ; 
    15 S-TERM-CNT-SUB-TOTAL-DA char(5) ; 
    15 FILLER14 char(1) ; 
    15 S-TERM-CNT-QM9 char(4) ; 
    15 FILLER15 char(1) ; 
    15 S-TERM-CNT-SL9 char(4) ; 
    15 FILLER16 char(1) ; 
    15 S-TERM-CNT-QI9 char(4) ; 
    15 FILLER17 char(1) ; 
    15 S-TERM-CNT-QJ9 char(4) ; 
    15 FILLER18 char(1) ; 
    15 S-TERM-CNT-QD9 char(4) ; 
    15 FILLER19 char(1) ; 
    15 S-TERM-CNT-SUB-TOTAL-MB char(4) ; 
    15 FILLER20 char(2) ; 
    15 S-TERM-CNT-OBRA char(4) ; 
    15 FILLER21 char(1) ; 
    15 S-TERM-CNT-GR-TOTAL char(5) ; 
    15 FILLER22 char(2) ; 
end // end AMA16W-DET


Record AMA16W-FOOTER type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(36) ; 
    15 CONSTANT2 char(36) ; 
    15 CONSTANT3 char(36) ; 
    15 CONSTANT4 char(22) ; 
    15 FILLER1 char(2) ; 
  10 LINE2 char(132) ; 
    15 CONSTANT5 char(3) ; 
    15 FILLER2 char(1) ; 
    15 CONSTANT6 char(5) ; 
    15 FILLER3 char(1) ; 
    15 CONSTANT7 char(3) ; 
    15 FILLER4 char(8) ; 
    15 S-TERM-CNT-AC-TOT-EM9 char(4) ; 
    15 FILLER5 char(1) ; 
    15 S-TERM-CNT-AC-TOT-IN9 char(4) ; 
    15 FILLER6 char(1) ; 
    15 S-TERM-CNT-AC-TOT-SI9 char(4) ; 
    15 FILLER7 char(1) ; 
    15 S-TERM-CNT-AC-TOT-PK9 char(4) ; 
    15 FILLER8 char(3) ; 
    15 S-TERM-CNT-AC-TOT-KB9 char(4) ; 
    15 FILLER9 char(1) ; 
    15 S-TERM-CNT-AC-TOT-WB9 char(4) ; 
    15 FILLER10 char(1) ; 
    15 S-TERM-CNT-AC-TOT-GC9 char(4) ; 
    15 FILLER11 char(1) ; 
    15 S-TERM-CNT-AC-TOT-SS9 char(4) ; 
    15 FILLER12 char(1) ; 
    15 S-TERM-CNT-AC-TOT-HD9 char(4) ; 
    15 FILLER13 char(1) ; 
    15 S-TERM-CNT-AC-TOT-HG9 char(4) ; 
    15 FILLER14 char(1) ; 
    15 S-TERM-CNT-AC-TOT-HR9 char(4) ; 
    15 FILLER15 char(1) ; 
    15 S-TERM-CNT-AC-TOT-CM9 char(4) ; 
    15 FILLER16 char(1) ; 
    15 S-TERM-CNT-SUB-AC-TOT-DA char(5) ; 
    15 FILLER17 char(1) ; 
    15 S-TERM-CNT-AC-TOT-QM9 char(4) ; 
    15 FILLER18 char(1) ; 
    15 S-TERM-CNT-AC-TOT-SL9 char(4) ; 
    15 FILLER19 char(1) ; 
    15 S-TERM-CNT-AC-TOT-QI9 char(4) ; 
    15 FILLER20 char(1) ; 
    15 S-TERM-CNT-AC-TOT-QJ9 char(4) ; 
    15 FILLER21 char(1) ; 
    15 S-TERM-CNT-AC-TOT-QD9 char(4) ; 
    15 FILLER22 char(1) ; 
    15 S-TERM-CNT-SUB-AC-TOT-MB char(4) ; 
    15 FILLER23 char(2) ; 
    15 S-TERM-CNT-AC-TOT-OBRA char(4) ; 
    15 FILLER24 char(1) ; 
    15 S-TERM-CNT-GR-AC-TOT char(5) ; 
    15 FILLER25 char(2) ; 
end // end AMA16W-FOOTER


Record AMA16W-HEAD type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(8) ; 
    15 FILLER1 char(1) ; 
    15 UPAGE char(4) ; 
    15 FILLER2 char(46) ; 
    15 CONSTANT2 char(5) ; 
    15 FILLER3 char(1) ; 
    15 CONSTANT3 char(2) ; 
    15 FILLER4 char(1) ; 
    15 CONSTANT4 char(6) ; 
    15 FILLER5 char(43) ; 
    15 CONSTANT5 char(4) ; 
    15 FILLER6 char(3) ; 
    15 UDATE char(8) ; 
  10 LINE2 char(132) ; 
    15 UAPPL char(8) ; 
    15 FILLER7 char(28) ; 
    15 CONSTANT6 char(7) ; 
    15 FILLER8 char(1) ; 
    15 CONSTANT7 char(11) ; 
    15 FILLER9 char(1) ; 
    15 CONSTANT8 char(6) ; 
    15 FILLER10 char(1) ; 
    15 CONSTANT9 char(10) ; 
    15 FILLER11 char(1) ; 
    15 CONSTANT10 char(2) ; 
    15 FILLER12 char(1) ; 
    15 CONSTANT11 char(3) ; 
    15 FILLER13 char(1) ; 
    15 CONSTANT12 char(4) ; 
    15 FILLER14 char(1) ; 
    15 CONSTANT13 char(1) ; 
    15 FILLER15 char(1) ; 
    15 CONSTANT14 char(8) ; 
    15 FILLER16 char(21) ; 
    15 CONSTANT15 char(4) ; 
    15 FILLER17 char(3) ; 
    15 UTIME char(8) ; 
  10 LINE3 char(132) ; 
    15 FILLER18 char(53) ; 
    15 CONSTANT16 char(5) ; 
    15 FILLER19 char(1) ; 
    15 CONSTANT17 char(2) ; 
    15 FILLER20 char(1) ; 
    15 CONSTANT18 char(1) ; 
    15 FILLER21 char(1) ; 
    15 S-REPMTH char(11) ; 
    15 FILLER22 char(1) ; 
    15 S-REPYR char(4) ; 
    15 FILLER23 char(52) ; 
end // end AMA16W-HEAD


Record AMA16W-SUBH type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(5) ; 
    15 FILLER1 char(1) ; 
    15 S-LEVEL char(19) ; 
    15 FILLER2 char(107) ; 
  10 LINE2 char(132) ; 
    15 CONSTANT2 char(6) ; 
    15 FILLER3 char(14) ; 
    15 CONSTANT3 char(34) ; 
    15 CONSTANT4 char(33) ; 
    15 CONSTANT5 char(16) ; 
    15 FILLER4 char(1) ; 
    15 CONSTANT6 char(15) ; 
    15 FILLER5 char(13) ; 
  10 LINE3 char(132) ; 
    15 FILLER6 char(35) ; 
    15 CONSTANT7 char(7) ; 
    15 FILLER7 char(42) ; 
    15 CONSTANT8 char(3) ; 
    15 FILLER8 char(28) ; 
    15 CONSTANT9 char(3) ; 
    15 FILLER9 char(2) ; 
    15 CONSTANT10 char(4) ; 
    15 FILLER10 char(1) ; 
    15 CONSTANT11 char(5) ; 
    15 FILLER11 char(2) ; 
  10 LINE4 char(132) ; 
    15 FILLER12 char(21) ; 
    15 CONSTANT12 char(3) ; 
    15 FILLER13 char(2) ; 
    15 CONSTANT13 char(3) ; 
    15 FILLER14 char(2) ; 
    15 CONSTANT14 char(3) ; 
    15 FILLER15 char(1) ; 
    15 CONSTANT15 char(7) ; 
    15 FILLER16 char(1) ; 
    15 CONSTANT16 char(3) ; 
    15 FILLER17 char(2) ; 
    15 CONSTANT17 char(3) ; 
    15 FILLER18 char(2) ; 
    15 CONSTANT18 char(3) ; 
    15 FILLER19 char(2) ; 
    15 CONSTANT19 char(3) ; 
    15 FILLER20 char(2) ; 
    15 CONSTANT20 char(3) ; 
    15 FILLER21 char(2) ; 
    15 CONSTANT21 char(3) ; 
    15 FILLER22 char(2) ; 
    15 CONSTANT22 char(3) ; 
    15 FILLER23 char(2) ; 
    15 CONSTANT23 char(3) ; 
    15 FILLER24 char(2) ; 
    15 CONSTANT24 char(5) ; 
    15 FILLER25 char(1) ; 
    15 CONSTANT25 char(3) ; 
    15 FILLER26 char(2) ; 
    15 CONSTANT26 char(3) ; 
    15 FILLER27 char(2) ; 
    15 CONSTANT27 char(3) ; 
    15 FILLER28 char(2) ; 
    15 CONSTANT28 char(3) ; 
    15 FILLER29 char(2) ; 
    15 CONSTANT29 char(3) ; 
    15 FILLER30 char(2) ; 
    15 CONSTANT30 char(5) ; 
    15 FILLER31 char(1) ; 
    15 CONSTANT31 char(4) ; 
    15 FILLER32 char(1) ; 
    15 CONSTANT32 char(5) ; 
    15 FILLER33 char(2) ; 
  10 LINE5 char(132) ; 
    15 FILLER34 char(35) ; 
    15 CONSTANT33 char(7) ; 
    15 FILLER35 char(90) ; 
end // end AMA16W-SUBH


