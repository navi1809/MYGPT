<%--
**************************************************************************************************
Name: [ABSaveAndExit.jsp]	Created By: [Surendra Nath]	Created On: [10/13/2005]
Purpose: [To collect Absent Parent Information]
Modification Logs:
Modified By 			Date				Reason & description
***************************************************************************************************
--%>

<%-- NOT EDITABLE - Fw Page Directive, Imports, and URIs --%>
<%@ include file = "/frameworkIncludes/directives.jsp"%>

<%-- EDITABLE - Page Specific Imports and URIs (You can add code to this section) --%>
<%@ page import="gov.illinois.framework.presentation.entities.FwRadioGroupBean"%>
<%@page import="gov.illinois.access.data.db2.impl.APP_HPE_Cargo"%>
<%-- EDITABLE - Page Specific useBean tags(You can add code to this section) --%>
<%--Made changes by Varshi for ILIES-282108. Save & Exit Changes --%>
<%@page import="gov.illinois.framework.driver.DriverManager"%>
<%@page import ="gov.illinois.framework.driver.IDriver"%>
<%--Made changes by Varshi for ILIES-282108. Save & Exit Changes.END --%>
<jsp:useBean id="radioGroup"
	class="gov.illinois.access.presentation.pageElements.RadioGroup"
	scope="application" />
<jsp:useBean id="APP_HPE_Collection"
	class="gov.illinois.access.data.db2.impl.APP_HPE_Collection"
	scope="request" />
<%-- NOT EDITABLE - Head Tag
Includes the DOCTYPE , META tags, teh form tag, the common JS files and CSS files to include in all the ACCESS JSPs
--%>
<AP:FwHeadTag currentPageID="ABSVE" defaultPageAction="ABSVENext" />

<%-- EDITABLE - Page specific .js or .css files (You can add code to this section) --%>

<%-- NOT EDITABLE - Welcome Tag and Toolbar Tag --%>
<AP:FwWelcomeTag>
	<AP:FwToolbarTag />
</AP:FwWelcomeTag>

<%-- NOT EDITABLE - Framework Hidden Fields --%>
<TL:FwHiddenFieldsTag />

<%-- EDITABLE - Page Specific Hidden Fields (You can add code to this section) --%>

<%--NOT EDITABLE - Message Display Table  --%>
<AP:FwMessageDisplayTag />

<%--NOT EDITABLE - Begin BodyTableTag. --%>
<%--NOT EDITABLE - End BodyTableTag. --%>
<%-- EDITABLE (You can add code to this section) - Page Specific Table(s) - This is each developers area for coding the presentation. --%>
<%
APP_HPE_Cargo appHpeCargo = new APP_HPE_Cargo();
boolean flag = false;
if (APP_HPE_Collection != null && APP_HPE_Collection.size() > 0) {
    appHpeCargo = APP_HPE_Collection.getCargo(0);
    flag = true;
}
boolean userLoggedIn = false;
Map httpSession = (Map) session.getAttribute(FwConstants.HTTP_SESSION);
short[] programKey =(short[])session.getAttribute(FwConstants.AFB_PROGRAM_KEY);
// Define boolean for login status
//Getting secured session from http session
Map securedMap = (Map) httpSession.get(FwConstants.SECURED_SESSION);
if (securedMap != null) {
	//Getting wid from secured session
	String wid = (String) securedMap.get(FwConstants.LDAP_WID);
	// Check login status of user
	if (wid != null) {
		userLoggedIn = true;
	}
}

// Made changes by Varshi for ILIES-282108. Save & Exit Changes -- START
	int pageStatus = 0;
	int[] driverArray = (int[]) session.getAttribute(FwConstants.AFB_DRIVER);
	IDriver driverManager = DriverManager.getInstance();
	pageStatus = driverManager.getAFBStatus(FwConstants.AFB_DRIVER, "ABRGA", driverArray);
	
//Made changes by Varshi for ILIES-282108. Save & Exit Changes -- END

String selectedOption = "";
ArrayList radioBeanList = new ArrayList();
FwRadioGroupBean radioGroupBean = null;
if (!userLoggedIn) {
	radioGroupBean = new FwRadioGroupBean();
	radioGroupBean.setDisplayTextId("30392");
	radioGroupBean.setValue("createAcc");
	if (selectedOption.equals("30392")) {
		radioGroupBean.setSelected(FwConstants.YES);
	}
	radioBeanList.add(radioGroupBean);
}
if (userLoggedIn) {
	radioGroupBean = new FwRadioGroupBean();
	radioGroupBean.setDisplayTextId("30351");
	radioGroupBean.setValue("saveOnly");
	if (selectedOption.equals("30351")) {
		radioGroupBean.setSelected(FwConstants.YES);
	}
	radioBeanList.add(radioGroupBean);
}
//added by ggr
radioGroupBean = new FwRadioGroupBean();
radioGroupBean.setDisplayTextId("36750");
radioGroupBean.setValue("keepWorking");
if (selectedOption.equals("36750")) {
	radioGroupBean.setSelected(FwConstants.YES);
}
radioBeanList.add(radioGroupBean);
//end

//Added By Kumar Karuppanan to show only when FAP selected
// added by Rotanak for BRGUS00287912
if(!flag){
if(appHpeCargo.getAct_hpe() != null && !(appHpeCargo.getAct_hpe().equals("03"))){
if(programKey !=null && (programKey[2] ==1 || programKey[0] ==1 || programKey[1] ==1 || programKey[3] ==1 || programKey[8] ==1)){
	radioGroupBean = new FwRadioGroupBean();
	radioGroupBean.setDisplayTextId("30353");
	radioGroupBean.setValue("submitApp");
	if (selectedOption.equals("30353")) {
		radioGroupBean.setSelected(FwConstants.YES);
	}
	radioBeanList.add(radioGroupBean);
}
} else{
//Made changes by Varshi for ILIES-282108. Save & Exit Changes.
if(programKey !=null && (programKey[2] ==1 || programKey[0] ==1 || programKey[1] ==1 || programKey[3] ==1 || programKey[8] ==1 || programKey[7] ==1) && pageStatus > 1){
	radioGroupBean = new FwRadioGroupBean();
	radioGroupBean.setDisplayTextId("30353");
	radioGroupBean.setValue("submitApp");
	if (selectedOption.equals("30353")) {
		radioGroupBean.setSelected(FwConstants.YES);
	}
	radioBeanList.add(radioGroupBean);
}
}
}

if (!userLoggedIn) {
	radioGroupBean = new FwRadioGroupBean();
	radioGroupBean.setDisplayTextId("30352");
	radioGroupBean.setValue("exitWithoutSaving");
	if (selectedOption.equals("30352")) {
		radioGroupBean.setSelected(FwConstants.YES);
	}
	radioBeanList.add(radioGroupBean);
}
%>

<TABLE role="presentation">
	<TR>
		<TD WIDTH="2%">&nbsp;</TD>
		<TD width="100%"><AP:FwSubsectionTag textID="32140">
			<TABLE WIDTH=100% border=0>
				<TR>
					<TD colspan="2"><AP:FwPageLabelTag textID="30350" /></TD>
				</TR>
				<TR>
					<TD colspan="2" height="10">
				</TR>
				<TR>
					<TD><TL:FwRadioButtonGroupTag
						radioGroupBean="<%=radioBeanList.toArray()%>"
						formName="radioOptions" bean="<%=radioGroup%>" tablecols="1" />
						<% if(programKey !=null && programKey[2] ==1 && programKey[5] ==1){ %>
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<AP:FwPageLabelTag textID="99959" />
						<% }%>
					</TD>

				</TR>
				
			</TABLE>
		</AP:FwSubsectionTag></TD>
	</TR>
</TABLE>
<TABLE WIDTH="100%" BORDER=0 CELLPADDING=0 CELLSPACING=0
	 role="presentation">
	<TR>
		<TD ALIGN="right"><AP:FwButtonCSSTag
			button="<%=AppConstants.BUTTON_BACK2%>" pageAction="ABSVEPrevious"
			name="Back" langButton="true" /> <AP:FwButtonCSSTag styleClass="button-col-dark" 
			button="<%=AppConstants.BUTTON_NEXT1%>" pageAction="ABSVENext"
			name="Next" langButton="true" /></TD>
	</TR>
</TABLE>

<%-- NOT EDITABLE - Legal Disclaimer Table --%>
<AP:FwPageLegalTag />