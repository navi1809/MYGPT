package IVA_Batch;
import egl.core.*;
import CommonMigratedParts.*;
import DataTables.*;
//*** PROGRAM=AMA08A ****
// COMPONENT NAME: AMA08A Intake Denial/Withdrawal Reason-Stats
// by Aid Cod===============
// 
// DESCRIPTION:
// ============
// Statistical report of AGED intake
// cases which  had a denial or withdrawal
// action  during the report month with
// details by aid code and denial/withdrawal
// reason
// 
// 
// ***********************
Program AMA08A type basicProgram //VAGen Info - main batch program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes
  }

  // Data Declarations
  AMA08W AMA08W; // record
  AMA08W-DET AMA08W-DET; // record
  AMA08W-FOOTER AMA08W-FOOTER; // record
  AMA08W-HEAD AMA08W-HEAD; // record
  AMA08W-SUBH AMA08W-SUBH; // record
  CEP01W CEP01W; // record
  FORMATW FORMATW; // record
  GDW GDW; // record
  REP-COMMON REP-COMMON; // record
  REP-DATE REP-DATE; // record
  REP-EOFNOF REP-EOFNOF; // record
  SR-132REP-RECOUT SR-132REP-RECOUT; // record
  SR-AMA08-RECIN SR-AMA08-RECIN; // record
  SR-AMA44-RECIN SR-AMA44-RECIN; // record
  VDBCOMMON VDBCOMMON; // record
  VDBCONTROL VDBCONTROL; // record
  VMESSAGE VMESSAGE; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use VDB00T1 {deleteAfterUse = yes}; // table

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    AMA08P9-MAIN: AMA08P9-MAIN();
  end // end main
end // end AMA08A


// CALULATE REPORT TOTALS
Function AMA08P9-ACUM-DET()
  /* total*/
  AMA08W.WS-TERM-CNT-S-TOTAL-AG = AMA08W.WS-TERM-CNT-EM1 + AMA08W.WS-TERM-CNT-IN1 +   AMA08W.WS-TERM-CNT-SI1 + AMA08W.WS-TERM-CNT-PK1 +   AMA08W.WS-TERM-CNT-WB1 + AMA08W.WS-TERM-CNT-GC1 +   AMA08W.WS-TERM-CNT-SS1 + AMA08W.WS-TERM-CNT-HC1 +   AMA08W.WS-TERM-CNT-HG1 + AMA08W.WS-TERM-CNT-CM1;
   /* Begin change for WI# 15116- Ted*/
   /* Hendricks*/
  AMA08W.WS-TERM-CNT-S-TOTAL-MB = AMA08W.WS-TERM-CNT-QM1 + AMA08W.WS-TERM-CNT-SL1 +    AMA08W.WS-TERM-CNT-QI1 + AMA08W.WS-TERM-CNT-QJ1;

  /* End   change for WI# 15116- Ted Hendricks*/

  AMA08W.WS-TERM-CNT-G-TOTAL = AMA08W.WS-TERM-CNT-S-TOTAL-AG + AMA08W.WS-TERM-CNT-S-TOTAL-MB;


  /* TOTAL FOR FOOTER*/
  AMA08W.WS-TERM-CNT-AC-TOT-EM1 = AMA08W.WS-TERM-CNT-AC-TOT-EM1   + AMA08W.WS-TERM-CNT-EM1;
  AMA08W.WS-TERM-CNT-AC-TOT-IN1 = AMA08W.WS-TERM-CNT-AC-TOT-IN1   + AMA08W.WS-TERM-CNT-IN1;
  AMA08W.WS-TERM-CNT-AC-TOT-SI1 = AMA08W.WS-TERM-CNT-AC-TOT-SI1   + AMA08W.WS-TERM-CNT-SI1;
  AMA08W.WS-TERM-CNT-AC-TOT-PK1 = AMA08W.WS-TERM-CNT-AC-TOT-PK1   + AMA08W.WS-TERM-CNT-PK1;
  AMA08W.WS-TERM-CNT-AC-TOT-WB1 = AMA08W.WS-TERM-CNT-AC-TOT-WB1   + AMA08W.WS-TERM-CNT-WB1;
  AMA08W.WS-TERM-CNT-AC-TOT-GC1 = AMA08W.WS-TERM-CNT-AC-TOT-GC1   + AMA08W.WS-TERM-CNT-GC1;
  AMA08W.WS-TERM-CNT-AC-TOT-SS1 = AMA08W.WS-TERM-CNT-AC-TOT-SS1   + AMA08W.WS-TERM-CNT-SS1;
  AMA08W.WS-TERM-CNT-AC-TOT-HC1 = AMA08W.WS-TERM-CNT-AC-TOT-HC1   + AMA08W.WS-TERM-CNT-HC1;
  AMA08W.WS-TERM-CNT-AC-TOT-HG1 = AMA08W.WS-TERM-CNT-AC-TOT-HG1   + AMA08W.WS-TERM-CNT-HG1;
  AMA08W.WS-TERM-CNT-AC-TOT-CM1 = AMA08W.WS-TERM-CNT-AC-TOT-CM1   + AMA08W.WS-TERM-CNT-CM1;
  AMA08W.WS-TERM-CNT-S-AC-TOT-AG = AMA08W.WS-TERM-CNT-S-AC-TOT-AG   + AMA08W.WS-TERM-CNT-S-TOTAL-AG;
  AMA08W.WS-TERM-CNT-AC-TOT-QM1 = AMA08W.WS-TERM-CNT-AC-TOT-QM1   + AMA08W.WS-TERM-CNT-QM1;
  AMA08W.WS-TERM-CNT-AC-TOT-SL1 = AMA08W.WS-TERM-CNT-AC-TOT-SL1   + AMA08W.WS-TERM-CNT-SL1;

  /* Begin change for WI# 15116- Ted Hendricks*/

  AMA08W.WS-TERM-CNT-AC-TOT-QI1 = AMA08W.WS-TERM-CNT-AC-TOT-QI1   + AMA08W.WS-TERM-CNT-QI1;
  AMA08W.WS-TERM-CNT-AC-TOT-QJ1 = AMA08W.WS-TERM-CNT-AC-TOT-QJ1   + AMA08W.WS-TERM-CNT-QJ1;

  /* End   change for WI# 15116- Ted Hendricks*/

  AMA08W.WS-TERM-CNT-S-AC-TOT-MB = AMA08W.WS-TERM-CNT-S-AC-TOT-MB   + AMA08W.WS-TERM-CNT-S-TOTAL-MB;
  AMA08W.WS-TERM-CNT-G-AC-TOT = AMA08W.WS-TERM-CNT-G-AC-TOT   + AMA08W.WS-TERM-CNT-G-TOTAL;
end // end AMA08P9-ACUM-DET


// CALCULATE DIST OFC DETAILS
Function AMA08P9-ACUM-DO()
  /* ************************* start wi 16615 ****************************/
  /* accumulate figures for district office report*/
  if (AMA08W.WS-PREV-CLSRE-RSN-CD == "1")
    AMA08W.WS-AMA08-INDEX = 1;
    AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
    AMA08W.WS-DO-REC-FND = "Y";
  else
    if (AMA08W.WS-PREV-CLSRE-RSN-CD == "2")
      AMA08W.WS-AMA08-INDEX = 2;
      AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
      AMA08W.WS-DO-REC-FND = "Y";
    else
      if (AMA08W.WS-PREV-CLSRE-RSN-CD == "3")
        AMA08W.WS-AMA08-INDEX = 3;
        AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
        AMA08W.WS-DO-REC-FND = "Y";
      else
        if (AMA08W.WS-PREV-CLSRE-RSN-CD == "4")
          AMA08W.WS-AMA08-INDEX = 4;
          AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
          AMA08W.WS-DO-REC-FND = "Y";
        else
          if (AMA08W.WS-PREV-CLSRE-RSN-CD == "5")
            AMA08W.WS-AMA08-INDEX = 5;
            AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
            AMA08W.WS-DO-REC-FND = "Y";
          else
            if (AMA08W.WS-PREV-CLSRE-RSN-CD == "6")
              AMA08W.WS-AMA08-INDEX = 6;
              AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
              AMA08W.WS-DO-REC-FND = "Y";
            else
              if (AMA08W.WS-PREV-CLSRE-RSN-CD == "7")
                AMA08W.WS-AMA08-INDEX = 7;
                AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
                AMA08W.WS-DO-REC-FND = "Y";
              else
                if (AMA08W.WS-PREV-CLSRE-RSN-CD == "8")
                  AMA08W.WS-AMA08-INDEX = 8;
                  AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
                  AMA08W.WS-DO-REC-FND = "Y";
                else
                  if (AMA08W.WS-PREV-CLSRE-RSN-CD == "9")
                    AMA08W.WS-AMA08-INDEX = 9;
                    AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
                    AMA08W.WS-DO-REC-FND = "Y";
                  end
                end
              end
            end
          end
        end
      end
    end
  end

  if (AMA08W.WS-DO-REC-FND == "Y")
    AMA08W.WS-DO-REC-FND = "N";
    AMA08W.WS-DO-TERM-RSN[WS-AMA08-INDEX] = AMA08W.WS-TERM-RSN-TRUNC;
    AMA08W.WS-DO-TERM-CNT-EM1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-EM1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-EM1;
    AMA08W.WS-DO-TERM-CNT-IN1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-IN1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-IN1;
    AMA08W.WS-DO-TERM-CNT-SI1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-SI1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-SI1;
    AMA08W.WS-DO-TERM-CNT-PK1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-PK1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-PK1;
    AMA08W.WS-DO-TERM-CNT-WB1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-WB1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-WB1;
    AMA08W.WS-DO-TERM-CNT-GC1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-GC1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-GC1;
    AMA08W.WS-DO-TERM-CNT-SS1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-SS1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-SS1;
    AMA08W.WS-DO-TERM-CNT-HC1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-HC1[WS-AMA08-INDEX]     + AMA08W.WS-TERM-CNT-HC1;
    AMA08W.WS-DO-TERM-CNT-HG1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-HG1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-HG1;
    AMA08W.WS-DO-TERM-CNT-CM1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-CM1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-CM1;
    AMA08W.WS-DO-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-S-TOTAL-AG;
    AMA08W.WS-DO-TERM-CNT-QM1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-QM1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-QM1;
    AMA08W.WS-DO-TERM-CNT-SL1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-SL1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-SL1;
    AMA08W.WS-DO-TERM-CNT-QI1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-QI1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-QI1;
    AMA08W.WS-DO-TERM-CNT-QJ1[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-QJ1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-QJ1;
    AMA08W.WS-DO-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX]     + AMA08W.WS-TERM-CNT-S-TOTAL-MB;
    AMA08W.WS-DO-TERM-CNT-G-TOTAL[WS-AMA08-INDEX] = AMA08W.WS-DO-TERM-CNT-G-TOTAL[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-G-TOTAL;
    AMA08W.WS-AMA08-INDEX = 0;
  end
  /* ************************* end wi 16615 *******************************/
end // end AMA08P9-ACUM-DO


// CALC TOTALS FOR STWIDE FOOTER
Function AMA08P9-ACUM-DOFOT()
  AMA08W.WS-AMA08-INDEX = 1;
  while (AMA08W.WS-AMA08-INDEX <= 9)
    if (AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] == "Y")
      AMA08W.WS-DO-TERM-CNT-AC-TOT-EM1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-EM1       + AMA08W.WS-DO-TERM-CNT-EM1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-IN1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-IN1       + AMA08W.WS-DO-TERM-CNT-IN1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-SI1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-SI1       + AMA08W.WS-DO-TERM-CNT-SI1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-PK1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-PK1       + AMA08W.WS-DO-TERM-CNT-PK1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-WB1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-WB1       + AMA08W.WS-DO-TERM-CNT-WB1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-GC1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-GC1       + AMA08W.WS-DO-TERM-CNT-GC1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-SS1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-SS1       + AMA08W.WS-DO-TERM-CNT-SS1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-HC1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-HC1       + AMA08W.WS-DO-TERM-CNT-HC1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-HG1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-HG1       + AMA08W.WS-DO-TERM-CNT-HG1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-CM1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-CM1       + AMA08W.WS-DO-TERM-CNT-CM1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-S-AC-TOT-AG = AMA08W.WS-DO-TERM-CNT-S-AC-TOT-AG       + AMA08W.WS-DO-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-QM1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-QM1       + AMA08W.WS-DO-TERM-CNT-QM1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-SL1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-SL1       + AMA08W.WS-DO-TERM-CNT-SL1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-QI1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-QI1       + AMA08W.WS-DO-TERM-CNT-QI1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-AC-TOT-QJ1 = AMA08W.WS-DO-TERM-CNT-AC-TOT-QJ1       + AMA08W.WS-DO-TERM-CNT-QJ1[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-S-AC-TOT-MB = AMA08W.WS-DO-TERM-CNT-S-AC-TOT-MB       + AMA08W.WS-DO-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX];
      AMA08W.WS-DO-TERM-CNT-G-AC-TOT = AMA08W.WS-DO-TERM-CNT-G-AC-TOT       + AMA08W.WS-DO-TERM-CNT-G-TOTAL[WS-AMA08-INDEX];
    end
    AMA08W.WS-AMA08-INDEX = AMA08W.WS-AMA08-INDEX + 1;
  end
end // end AMA08P9-ACUM-DOFOT


// CALCULATE STWIDE DETAILS
Function AMA08P9-ACUM-ST()
  /* accumulate figures for state wide report*/
  if (AMA08W.WS-PREV-CLSRE-RSN-CD == "1")
    AMA08W.WS-AMA08-INDEX = 1;
    AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
    AMA08W.WS-ST-REC-FND = "Y";
  else
    if (AMA08W.WS-PREV-CLSRE-RSN-CD == "2")
      AMA08W.WS-AMA08-INDEX = 2;
      AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
      AMA08W.WS-ST-REC-FND = "Y";
    else
      if (AMA08W.WS-PREV-CLSRE-RSN-CD == "3")
        AMA08W.WS-AMA08-INDEX = 3;
        AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
        AMA08W.WS-ST-REC-FND = "Y";
      else
        if (AMA08W.WS-PREV-CLSRE-RSN-CD == "4")
          AMA08W.WS-AMA08-INDEX = 4;
          AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
          AMA08W.WS-ST-REC-FND = "Y";
        else
          if (AMA08W.WS-PREV-CLSRE-RSN-CD == "5")
            AMA08W.WS-AMA08-INDEX = 5;
            AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
            AMA08W.WS-ST-REC-FND = "Y";
          else
            if (AMA08W.WS-PREV-CLSRE-RSN-CD == "6")
              AMA08W.WS-AMA08-INDEX = 6;
              AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
              AMA08W.WS-ST-REC-FND = "Y";
            else
              if (AMA08W.WS-PREV-CLSRE-RSN-CD == "7")
                AMA08W.WS-AMA08-INDEX = 7;
                AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
                AMA08W.WS-ST-REC-FND = "Y";
              else
                if (AMA08W.WS-PREV-CLSRE-RSN-CD == "8")
                  AMA08W.WS-AMA08-INDEX = 8;
                  AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
                  AMA08W.WS-ST-REC-FND = "Y";
                else
                  if (AMA08W.WS-PREV-CLSRE-RSN-CD == "9")
                    AMA08W.WS-AMA08-INDEX = 9;
                    AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] = "Y";
                    AMA08W.WS-ST-REC-FND = "Y";
                  end
                end
              end
            end
          end
        end
      end
    end
  end

  if (AMA08W.WS-ST-REC-FND == "Y")
    AMA08W.WS-ST-REC-FND = "N";
    AMA08W.WS-ST-TERM-RSN[WS-AMA08-INDEX] = AMA08W.WS-TERM-RSN-TRUNC;
    AMA08W.WS-ST-TERM-CNT-EM1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-EM1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-EM1;
    AMA08W.WS-ST-TERM-CNT-IN1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-IN1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-IN1;
    AMA08W.WS-ST-TERM-CNT-SI1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-SI1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-SI1;
    AMA08W.WS-ST-TERM-CNT-PK1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-PK1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-PK1;
    AMA08W.WS-ST-TERM-CNT-WB1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-WB1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-WB1;
    AMA08W.WS-ST-TERM-CNT-GC1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-GC1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-GC1;
    AMA08W.WS-ST-TERM-CNT-SS1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-SS1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-SS1;
    AMA08W.WS-ST-TERM-CNT-HC1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-HC1[WS-AMA08-INDEX]     + AMA08W.WS-TERM-CNT-HC1;
    AMA08W.WS-ST-TERM-CNT-HG1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-HG1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-HG1;
    AMA08W.WS-ST-TERM-CNT-CM1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-CM1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-CM1;
    AMA08W.WS-ST-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-S-TOTAL-AG;
    AMA08W.WS-ST-TERM-CNT-QM1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-QM1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-QM1;
    AMA08W.WS-ST-TERM-CNT-SL1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-SL1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-SL1;

  /* Begin change for WI# 15116- Ted Hendricks*/

    AMA08W.WS-ST-TERM-CNT-QI1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-QI1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-QI1;
    AMA08W.WS-ST-TERM-CNT-QJ1[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-QJ1[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-QJ1;

  /* End   change for WI# 15116- Ted Hendricks*/

    AMA08W.WS-ST-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX]     + AMA08W.WS-TERM-CNT-S-TOTAL-MB;
    AMA08W.WS-ST-TERM-CNT-G-TOTAL[WS-AMA08-INDEX] = AMA08W.WS-ST-TERM-CNT-G-TOTAL[WS-AMA08-INDEX] +     AMA08W.WS-TERM-CNT-G-TOTAL;
    AMA08W.WS-AMA08-INDEX = 0;
  end
end // end AMA08P9-ACUM-ST


// CALC TOTALS FOR STWIDE FOOTER
Function AMA08P9-ACUM-STFOT()
  AMA08W.WS-AMA08-INDEX = 1;
  while (AMA08W.WS-AMA08-INDEX <= 9)
    if (AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] == "Y")
      AMA08W.WS-TERM-CNT-AC-TOT-EM1 = AMA08W.WS-TERM-CNT-AC-TOT-EM1       + AMA08W.WS-ST-TERM-CNT-EM1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-IN1 = AMA08W.WS-TERM-CNT-AC-TOT-IN1       + AMA08W.WS-ST-TERM-CNT-IN1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-SI1 = AMA08W.WS-TERM-CNT-AC-TOT-SI1       + AMA08W.WS-ST-TERM-CNT-SI1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-PK1 = AMA08W.WS-TERM-CNT-AC-TOT-PK1       + AMA08W.WS-ST-TERM-CNT-PK1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-WB1 = AMA08W.WS-TERM-CNT-AC-TOT-WB1       + AMA08W.WS-ST-TERM-CNT-WB1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-GC1 = AMA08W.WS-TERM-CNT-AC-TOT-GC1       + AMA08W.WS-ST-TERM-CNT-GC1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-SS1 = AMA08W.WS-TERM-CNT-AC-TOT-SS1       + AMA08W.WS-ST-TERM-CNT-SS1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-HC1 = AMA08W.WS-TERM-CNT-AC-TOT-HC1       + AMA08W.WS-ST-TERM-CNT-HC1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-HG1 = AMA08W.WS-TERM-CNT-AC-TOT-HG1       + AMA08W.WS-ST-TERM-CNT-HG1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-CM1 = AMA08W.WS-TERM-CNT-AC-TOT-CM1       + AMA08W.WS-ST-TERM-CNT-CM1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-S-AC-TOT-AG = AMA08W.WS-TERM-CNT-S-AC-TOT-AG       + AMA08W.WS-ST-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-QM1 = AMA08W.WS-TERM-CNT-AC-TOT-QM1       + AMA08W.WS-ST-TERM-CNT-QM1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-SL1 = AMA08W.WS-TERM-CNT-AC-TOT-SL1       + AMA08W.WS-ST-TERM-CNT-SL1[WS-AMA08-INDEX];

  /* Begin change for WI# 15116- Ted Hendricks*/

      AMA08W.WS-TERM-CNT-AC-TOT-QI1 = AMA08W.WS-TERM-CNT-AC-TOT-QI1       + AMA08W.WS-ST-TERM-CNT-QI1[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-AC-TOT-QJ1 = AMA08W.WS-TERM-CNT-AC-TOT-QJ1       + AMA08W.WS-ST-TERM-CNT-QJ1[WS-AMA08-INDEX];

  /* End   change for WI# 15116- Ted Hendricks*/

      AMA08W.WS-TERM-CNT-S-AC-TOT-MB = AMA08W.WS-TERM-CNT-S-AC-TOT-MB       + AMA08W.WS-ST-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX];
      AMA08W.WS-TERM-CNT-G-AC-TOT = AMA08W.WS-TERM-CNT-G-AC-TOT       + AMA08W.WS-ST-TERM-CNT-G-TOTAL[WS-AMA08-INDEX];
    end
    AMA08W.WS-AMA08-INDEX = AMA08W.WS-AMA08-INDEX + 1;
  end
end // end AMA08P9-ACUM-STFOT


// APPL   ADDITIONAL PROCESSING
Function AMA08P9-APPLSPEC()
  /* cbsi start*/
  /* control break check*/
  if ((AMA08W.WS-PREV-OFC-CD != SR-AMA44-RECIN.PCE-OFC-CD))
    /* increment and print last detail record found*/
    if (AMA08W.WS-CLSRE-REC-FND == "Y")
      AMA08P9-ACUM-DET();
      AMA08P9-ACUM-DO(); /* wi 16615*/
      AMA08P9-ACUM-ST();
      AMA08P9-POP-DET();
      AMA08P9-PRN-DETAIL();
      AMA08W.WS-CLSRE-REC-FND = "N";
      AMA08W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
    end
    /* print last caseload detail record when last read did not contain*/
    /* any reportable details*/
    if (AMA08W.WS-PB-REC-FND == "Y")
      AMA08P9-POP-FOOTER();
      AMA08P9-PRN-FOOTER();
      AMA08W.WS-PB-REC-FND = "N";
    end
  /* ************************* start wi 16615 ****************************/
  /* print district office details*/
    if (AMA08W.WS-DO-PB-REC-FND == "Y")
      AMA08P9-DO-PRN();
      AMA08W.WS-DO-PB-REC-FND = "N";
    end
  /* ************************  end wi 16615   ****************************/
    /* reset all total variables*/
    AMA08P9-INIT-TOT();
    AMA08P9-INIT-FOTOT();
  /* ************************** start wi 16615 ***************************/
    AMA08P9-INIT-DO();
    AMA08P9-INIT-DOTOT();
  /* **************************  end wi 16615 ****************************/
    AMA08W.WS-PREV-OFC-CD = SR-AMA44-RECIN.PCE-OFC-CD;
    AMA08W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
    AMA08W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
    AMA08W.WS-OFC-NM = SR-AMA44-RECIN.PCE-OFC-NM;
    REP-COMMON.WS-NEW-PAGE = "Y";
  else
    if ((AMA08W.WS-PREV-CASLD-ID != SR-AMA44-RECIN.PCE-CASLD-ID))
      if (AMA08W.WS-CLSRE-REC-FND == "Y")
        AMA08P9-ACUM-DET();
        AMA08P9-ACUM-DO(); /* ******wi 16615*/
        AMA08P9-ACUM-ST();
        AMA08P9-POP-DET();
    /* perform process to print the details*/
        AMA08P9-PRN-DETAIL();
        AMA08W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
        AMA08W.WS-CLSRE-REC-FND = "N";
      end
      if (AMA08W.WS-PB-REC-FND == "Y")
        AMA08P9-POP-FOOTER();
        AMA08P9-PRN-FOOTER();
        AMA08W.WS-PB-REC-FND = "N";
      end
    /* reset all total variables*/
      AMA08P9-INIT-TOT();
      AMA08P9-INIT-FOTOT();
      AMA08W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
      AMA08W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
      REP-COMMON.WS-NEW-PAGE = "Y";
    else
      if ((AMA08W.WS-PREV-CLSRE-RSN-CD != SR-AMA44-RECIN.PCE-RSN-CD))
        if (AMA08W.WS-CLSRE-REC-FND == "Y")
          AMA08P9-ACUM-DET();
          AMA08P9-ACUM-DO(); /* wi 16615*/
          AMA08P9-ACUM-ST();
          AMA08P9-POP-DET();
    /* perform process to print the details*/
          AMA08P9-PRN-DETAIL();
          AMA08W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
          AMA08W.WS-CLSRE-REC-FND = "N";
        end
        AMA08P9-INIT-TOT();
        AMA08W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
      end
    end
  end

  AMA08P9-CHK-AIDCD();

  if (AMA08W.WS-CLSRE-REC-FND == "Y")
    AMA08W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
    AMA08W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
  end
  /* cbsi end*/
end // end AMA08P9-APPLSPEC


// CHECK AID CODES
Function AMA08P9-CHK-AIDCD()
  if (SR-AMA44-RECIN.PCE-AID-CD == "EM1")
    AMA08W.WS-TERM-CNT-EM1 = AMA08W.WS-TERM-CNT-EM1 + 1;
    AMA08W.WS-REC-FOUND = "Y";
    AMA08W.WS-CLSRE-REC-FND = "Y";
    AMA08W.WS-PB-REC-FND = "Y";
    AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
  else
    if (SR-AMA44-RECIN.PCE-AID-CD == "IN1")
      AMA08W.WS-TERM-CNT-IN1 = AMA08W.WS-TERM-CNT-IN1 + 1;
      AMA08W.WS-REC-FOUND = "Y";
      AMA08W.WS-CLSRE-REC-FND = "Y";
      AMA08W.WS-PB-REC-FND = "Y";
      AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
    else
      if (SR-AMA44-RECIN.PCE-AID-CD == "SI1")
        AMA08W.WS-TERM-CNT-SI1 = AMA08W.WS-TERM-CNT-SI1 + 1;
        AMA08W.WS-REC-FOUND = "Y";
        AMA08W.WS-CLSRE-REC-FND = "Y";
        AMA08W.WS-PB-REC-FND = "Y";
        AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
      else
        if (SR-AMA44-RECIN.PCE-AID-CD == "PK1" || 
        SR-AMA44-RECIN.PCE-AID-CD == "AD1" || 
        SR-AMA44-RECIN.PCE-AID-CD == "SU1")
          AMA08W.WS-TERM-CNT-PK1 = AMA08W.WS-TERM-CNT-PK1 + 1;
          AMA08W.WS-REC-FOUND = "Y";
          AMA08W.WS-CLSRE-REC-FND = "Y";
          AMA08W.WS-PB-REC-FND = "Y";
          AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
        else
          if (SR-AMA44-RECIN.PCE-AID-CD == "WB1")
            AMA08W.WS-TERM-CNT-WB1 = AMA08W.WS-TERM-CNT-WB1 + 1;
            AMA08W.WS-REC-FOUND = "Y";
            AMA08W.WS-CLSRE-REC-FND = "Y";
            AMA08W.WS-PB-REC-FND = "Y";
            AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
          else
            if (SR-AMA44-RECIN.PCE-AID-CD == "GC1")
              AMA08W.WS-TERM-CNT-GC1 = AMA08W.WS-TERM-CNT-GC1 + 1;
              AMA08W.WS-REC-FOUND = "Y";
              AMA08W.WS-CLSRE-REC-FND = "Y";
              AMA08W.WS-PB-REC-FND = "Y";
              AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
            else
              if (SR-AMA44-RECIN.PCE-AID-CD == "SS1")
                AMA08W.WS-TERM-CNT-SS1 = AMA08W.WS-TERM-CNT-SS1 + 1;
                AMA08W.WS-REC-FOUND = "Y";
                AMA08W.WS-CLSRE-REC-FND = "Y";
                AMA08W.WS-PB-REC-FND = "Y";
                AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
              else
                if (SR-AMA44-RECIN.PCE-AID-CD == "HC1")
                  AMA08W.WS-TERM-CNT-HC1 = AMA08W.WS-TERM-CNT-HC1 + 1;
                  AMA08W.WS-REC-FOUND = "Y";
                  AMA08W.WS-CLSRE-REC-FND = "Y";
                  AMA08W.WS-PB-REC-FND = "Y";
                  AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                else
                  if (SR-AMA44-RECIN.PCE-AID-CD == "HG1")
                    AMA08W.WS-TERM-CNT-HG1 = AMA08W.WS-TERM-CNT-HG1 + 1;
                    AMA08W.WS-REC-FOUND = "Y";
                    AMA08W.WS-CLSRE-REC-FND = "Y";
                    AMA08W.WS-PB-REC-FND = "Y";
                    AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                  else
                    if (SR-AMA44-RECIN.PCE-AID-CD == "CM1")
                      AMA08W.WS-TERM-CNT-CM1 = AMA08W.WS-TERM-CNT-CM1 + 1;
                      AMA08W.WS-REC-FOUND = "Y";
                      AMA08W.WS-CLSRE-REC-FND = "Y";
                      AMA08W.WS-PB-REC-FND = "Y";
                      AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                    else
                      if (SR-AMA44-RECIN.PCE-AID-CD == "QM1")
                        AMA08W.WS-TERM-CNT-QM1 = AMA08W.WS-TERM-CNT-QM1 + 1;
                        AMA08W.WS-REC-FOUND = "Y";
                        AMA08W.WS-CLSRE-REC-FND = "Y";
                        AMA08W.WS-PB-REC-FND = "Y";
                        AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                      else
                        if (SR-AMA44-RECIN.PCE-AID-CD == "SL1")
                          AMA08W.WS-TERM-CNT-SL1 = AMA08W.WS-TERM-CNT-SL1 +                           1;
                          AMA08W.WS-REC-FOUND = "Y";
                          AMA08W.WS-CLSRE-REC-FND = "Y";
                          AMA08W.WS-PB-REC-FND = "Y";
                          AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                        else

  /* Begin change for WI# 15116- Ted Hendricks*/

                          if (SR-AMA44-RECIN.PCE-AID-CD == "QI1")
                            AMA08W.WS-TERM-CNT-QI1 = AMA08W.WS-TERM-CNT-QI1                             + 1;
                            AMA08W.WS-REC-FOUND = "Y";
                            AMA08W.WS-CLSRE-REC-FND = "Y";
                            AMA08W.WS-PB-REC-FND = "Y";
                            AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                          else
                            if (SR-AMA44-RECIN.PCE-AID-CD == "QJ1")
                              AMA08W.WS-TERM-CNT-QJ1 = AMA08W.WS-TERM-CNT-QJ1 +                               1;
                              AMA08W.WS-REC-FOUND = "Y";
                              AMA08W.WS-CLSRE-REC-FND = "Y";
                              AMA08W.WS-PB-REC-FND = "Y";
                              AMA08W.WS-DO-PB-REC-FND = "Y"; /* wi 16615*/
                            end
                          end

  /* End   change for WI# 15116- Ted Hendricks*/

                        end
                      end
                    end
                  end
                end
              end
            end
          end
        end
      end
    end
  end
end // end AMA08P9-CHK-AIDCD


// END PROCESS
Function AMA08P9-CLOS-PARA()
  /* cbsi start*/
  exit program;
  /* cbsi end*/
end // end AMA08P9-CLOS-PARA


// POPULATE DIST OFC DETAILS
Function AMA08P9-DO-POP-DET()
  /* ******************** START WI 16615 **************************/
  AMA08W-DET.S-TERM-RSN = AMA08W.WS-DO-TERM-RSN[WS-AMA08-INDEX];
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-EM1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-EM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-IN1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-IN1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-SI1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-PK1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-PK1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-WB1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-WB1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-GC1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-GC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-SS1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SS1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-HC1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-HC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-HG1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-HG1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-CM1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-CM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX];
  AMA08P9-FORMAT5();
  AMA08W-DET.S-TERM-CNT-S-TOTAL-AG = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-QM1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-SL1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SL1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-QI1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-QJ1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QJ1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-S-TOTAL-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-G-TOTAL[WS-AMA08-INDEX];
  AMA08P9-FORMAT5();
  AMA08W-DET.S-TERM-CNT-G-TOTAL = FORMATW.OUTPUT-CHAR;
  /* ********************************* END WI 16615 *******************/
end // end AMA08P9-DO-POP-DET


// PRINT DIST OFC DETAILS
Function AMA08P9-DO-PRN()
  AMA08P9-ACUM-DOFOT();
  AMA08P9-PRN-HEAD(); /* print the header details*/
  AMA08W.WS-DIST-OFC-NM = AMA08W.WS-OFC-NM;
  AMA08P9-PRN-SUBH();
  REP-COMMON.WS-NEW-PAGE = "N";
  AMA08W.WS-AMA08-INDEX = 1;
  while (AMA08W.WS-AMA08-INDEX <= 9)
    if (AMA08W.WS-DO-CLSRE-REC-FND[WS-AMA08-INDEX] == "Y")
      AMA08P9-DO-POP-DET();
      AMA08P9-PRN-DETAIL();
    end
  /* AMA08W.WS-DO-CLSRE-REC-FND(WS-AMA08-INDEX) = 'N';*/
    AMA08W.WS-AMA08-INDEX = AMA08W.WS-AMA08-INDEX + 1;
  end
  AMA08P9-POP-DOFOOT();
  AMA08P9-PRN-FOOTER();
  move "N" to AMA08W.WS-DO-CLSRE-REC-FND[1] for all;
end // end AMA08P9-DO-PRN


// FORMAT REPORT FIELDS
Function AMA08P9-FORMAT4()
  FORMATW.LENGTH = 4;
  FORMATW.DEC-COUNT = 0;
  FORMATW.FORMAT-FLAG = "N";
  FORMATW.DOLLAR-FLAG = "N";
  REPP9-FORMAT-PROC();
end // end AMA08P9-FORMAT4


// FORMAT REPORT FIELDS
Function AMA08P9-FORMAT5()
  FORMATW.LENGTH = 5;
  FORMATW.DEC-COUNT = 0;
  FORMATW.FORMAT-FLAG = "N";
  FORMATW.DOLLAR-FLAG = "N";
  REPP9-FORMAT-PROC();
end // end AMA08P9-FORMAT5


// INIT DISCTRICT OFC TOTALS
Function AMA08P9-INIT-DO()
  /* ************************ START WI 16615 ****************************88*/
  AMA08W.WS-TERM-RSN = " ";
  move 0 to AMA08W.WS-DO-TERM-CNT-EM1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-IN1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-SI1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-PK1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-WB1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-GC1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-SS1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-HC1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-HG1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-CM1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-S-TOTAL-AG[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-QM1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-SL1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-QI1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-QJ1[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-S-TOTAL-MB[1] for all;
  move 0 to AMA08W.WS-DO-TERM-CNT-G-TOTAL[1] for all;
  /* **************************** end WI 16615 ************************/
end // end AMA08P9-INIT-DO


// INITALIZE DIST OFC FOOTER TOT
Function AMA08P9-INIT-DOTOT()
  AMA08W.WS-DO-TERM-CNT-AC-TOT-EM1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-IN1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-SI1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-PK1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-WB1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-GC1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-SS1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-HC1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-HG1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-CM1 = 0;
  AMA08W.WS-DO-TERM-CNT-S-AC-TOT-AG = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-QM1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-SL1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-QI1 = 0;
  AMA08W.WS-DO-TERM-CNT-AC-TOT-QJ1 = 0;
  AMA08W.WS-DO-TERM-CNT-S-AC-TOT-MB = 0;
  AMA08W.WS-DO-TERM-CNT-G-AC-TOT = 0;
end // end AMA08P9-INIT-DOTOT


// INITALIZE FOOTER TOTALS
Function AMA08P9-INIT-FOTOT()
  AMA08W.WS-TERM-CNT-AC-TOT-EM1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-IN1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-SI1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-PK1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-WB1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-GC1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-SS1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-HC1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-HG1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-CM1 = 0;
  AMA08W.WS-TERM-CNT-S-AC-TOT-AG = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-QM1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-SL1 = 0;

  /* Begin change for WI# 15116- Ted Hendricks*/

  AMA08W.WS-TERM-CNT-AC-TOT-QI1 = 0;
  AMA08W.WS-TERM-CNT-AC-TOT-QJ1 = 0;

  /* End   change for WI# 15116- Ted Hendricks*/

  AMA08W.WS-TERM-CNT-S-AC-TOT-MB = 0;
  AMA08W.WS-TERM-CNT-G-AC-TOT = 0;
end // end AMA08P9-INIT-FOTOT


// INTIALIZE VARIABLES
Function AMA08P9-INIT-PARA()
  /* cbsi start*/
  /* perform process to initialize all additional records*/
  AMA08P9-SET-EMPTY();
  /* set all report variables to initial values*/
  /* ws-page-no      - current printing page number*/
  /* ws-line-no      - current page line no*/
  /* ws-new-page     - a new page indicator*/
  /* ws-max-no-lines - lineage for a standard report frame*/

  REP-COMMON.WS-PAGE-NO = 0;
  REP-COMMON.WS-LINE-NO = 1;
  REP-COMMON.WS-NEW-PAGE = "Y";
  AMA08W.WS-FIRST-TM-IND = "Y";
  AMA08W.WS-REC-FOUND = "N";
  move "N" to AMA08W.WS-DO-CLSRE-REC-FND[1] for all; /* 16615*/
  AMA08W.WS-PB-REC-FND = "N";
  AMA08W.WS-DO-REC-FND = "N"; /* 16615*/
  AMA08W.WS-DO-PB-REC-FND = "N"; /* 16615*/
  REP-COMMON.WS-MAX-NO-LINES = 56;
  /* set standard header variables*/

  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  REP-COMMON.WS-DT = GDW.DTL; /* current date*/
  REP-COMMON.WS-YEAR = REP-COMMON.WS-YY;
  REP-COMMON.WS-MONTH = REP-COMMON.WS-MM;
  REP-COMMON.WS-DAY = REP-COMMON.WS-DD;
  REP-COMMON.WS-F1 = "/";
  REP-COMMON.WS-F2 = "/";
  AMA08W-HEAD.UDATE = REP-COMMON.WS-DATE; /* report date*/
  AMA08W-HEAD.UTIME = VGVar.currentFormattedTime; /* current time*/
  AMA08W-HEAD.UAPPL = "AMA08A"; /* report name*/

  /* perform process to initialize constants*/

  AMA08P9-INITCON();

  /* perform process to read input parameter file*/
  /* validate date parameters, mandatory fields for*/
  /* input records*/
  AMA08P9-READIP();

  /* perform  process for validation of input parameters*/
  AMA08P9-VALIDATE();


  /* populate application specific header*/
  AMA08W-HEAD.S-REPYR = AMA08W.WS-RPT-DT-CCYY;

  /* populate  header variables*/

  if ((AMA08W.WS-RPT-DT-MM == 01))
    AMA08W-HEAD.S-REPMTH = "   JANUARY,";
  else
    if ((AMA08W.WS-RPT-DT-MM == 02))
      AMA08W-HEAD.S-REPMTH = "  FEBRUARY,";
    else
      if ((AMA08W.WS-RPT-DT-MM == 03))
        AMA08W-HEAD.S-REPMTH = "     MARCH,";
      else
        if ((AMA08W.WS-RPT-DT-MM == 04))
          AMA08W-HEAD.S-REPMTH = "     APRIL,";
        else
          if ((AMA08W.WS-RPT-DT-MM == 05))
            AMA08W-HEAD.S-REPMTH = "       MAY,";
          else
            if ((AMA08W.WS-RPT-DT-MM == 06))
              AMA08W-HEAD.S-REPMTH = "      JUNE,";
            else
              if ((AMA08W.WS-RPT-DT-MM == 07))
                AMA08W-HEAD.S-REPMTH = "      JULY,";
              else
                if ((AMA08W.WS-RPT-DT-MM == 08))
                  AMA08W-HEAD.S-REPMTH = "    AUGUST,";
                else
                  if ((AMA08W.WS-RPT-DT-MM == 09))
                    AMA08W-HEAD.S-REPMTH = " SEPTEMBER,";
                  else
                    if ((AMA08W.WS-RPT-DT-MM == 10))
                      AMA08W-HEAD.S-REPMTH = "   OCTOBER,";
                    else
                      if ((AMA08W.WS-RPT-DT-MM == 11))
                        AMA08W-HEAD.S-REPMTH = "  NOVEMBER,";
                      else
                        if ((AMA08W.WS-RPT-DT-MM == 12))
                          AMA08W-HEAD.S-REPMTH = "  DECEMBER,";
                        end /* end of if rpt-month = 12*/
                      end /* end of if rpt-month = 11*/
                    end /* end of if rpt-month = 10*/
                  end /* end of if rpt-month = 09*/
                end /* end of if rpt-month = 08*/
              end /* end of if rpt-month = 07*/
            end /* end of if rpt-month = 06*/
          end /* end of if rpt-month = 05*/
        end /* end of if rpt-month = 04*/
      end /* end of if rpt-month = 03*/
    end /* end of if rpt-month = 02*/
  end /* end of if rpt-month = 01*/

  /* cbsi end*/
end // end AMA08P9-INIT-PARA


// INTIALIZE REPORT TOTALS
Function AMA08P9-INIT-TOT()
  AMA08W.WS-TERM-CNT-EM1 = 0;
  AMA08W.WS-TERM-CNT-IN1 = 0;
  AMA08W.WS-TERM-CNT-SI1 = 0;
  AMA08W.WS-TERM-CNT-PK1 = 0;
  AMA08W.WS-TERM-CNT-WB1 = 0;
  AMA08W.WS-TERM-CNT-GC1 = 0;
  AMA08W.WS-TERM-CNT-SS1 = 0;
  AMA08W.WS-TERM-CNT-HC1 = 0;
  AMA08W.WS-TERM-CNT-HG1 = 0;
  AMA08W.WS-TERM-CNT-CM1 = 0;
  AMA08W.WS-TERM-CNT-S-TOTAL-AG = 0;
  AMA08W.WS-TERM-CNT-QM1 = 0;
  AMA08W.WS-TERM-CNT-SL1 = 0;

  /* Begin change for WI# 15116- Ted Hendricks*/

  AMA08W.WS-TERM-CNT-QI1 = 0;
  AMA08W.WS-TERM-CNT-QJ1 = 0;

  /* End   change for WI# 15116- Ted Hendricks*/

  AMA08W.WS-TERM-CNT-S-TOTAL-MB = 0;
  AMA08W.WS-TERM-CNT-G-TOTAL = 0;
end // end AMA08P9-INIT-TOT


// INITIALISE CONSTANTS
Function AMA08P9-INITCON()
  /* this process intialises all the reports constants*/
  AMA08W-HEAD.CONSTANT1 = "PAGE-NBR";
  AMA08W-HEAD.CONSTANT2 = "STATE";
  AMA08W-HEAD.CONSTANT3 = "OF";
  AMA08W-HEAD.CONSTANT4 = "NEVADA";
  AMA08W-HEAD.CONSTANT5 = "DATE";
  AMA08W-HEAD.CONSTANT6 = "ONGOING";
  AMA08W-HEAD.CONSTANT7 = "TERMINATION";
  AMA08W-HEAD.CONSTANT8 = "REASON";
  AMA08W-HEAD.CONSTANT9 = "STATISTICS";
  AMA08W-HEAD.CONSTANT10 = "BY";
  AMA08W-HEAD.CONSTANT11 = "AID";
  AMA08W-HEAD.CONSTANT12 = "CODE";
  AMA08W-HEAD.CONSTANT13 = "-";
  AMA08W-HEAD.CONSTANT14 = "AGED";
  AMA08W-HEAD.CONSTANT15 = "TIME";
  AMA08W-HEAD.CONSTANT16 = "MONTH";
  AMA08W-HEAD.CONSTANT17 = "OF";
  AMA08W-HEAD.CONSTANT18 = ":";
  AMA08W-SUBH.CONSTANT1 = "LEVEL";
  AMA08W-SUBH.CONSTANT2 = "REASON";
  AMA08W-SUBH.CONSTANT3 = "<-----------------------------------";
  AMA08W-SUBH.CONSTANT4 = "-----AGED----------------------";
  AMA08W-SUBH.CONSTANT5 = "><----------MED";
  AMA08W-SUBH.CONSTANT6 = "BEN---------->";
  AMA08W-SUBH.CONSTANT7 = "SUB";
  AMA08W-SUBH.CONSTANT8 = "SUB";
  AMA08W-SUBH.CONSTANT9 = "GRAND";
  AMA08W-SUBH.CONSTANT10 = "EM1";
  AMA08W-SUBH.CONSTANT11 = "IN1";
  AMA08W-SUBH.CONSTANT12 = "SI1";
  AMA08W-SUBH.CONSTANT13 = "PK1/AD1/SU1";
  AMA08W-SUBH.CONSTANT14 = "WB1";
  AMA08W-SUBH.CONSTANT15 = "GC1";
  AMA08W-SUBH.CONSTANT16 = "SS1";
  AMA08W-SUBH.CONSTANT17 = "HC1";
  AMA08W-SUBH.CONSTANT18 = "HG1";
  AMA08W-SUBH.CONSTANT19 = "CM1";
  AMA08W-SUBH.CONSTANT20 = "TOTAL";
  AMA08W-SUBH.CONSTANT21 = "QM1";
  AMA08W-SUBH.CONSTANT22 = "SL1";
  AMA08W-SUBH.CONSTANT23 = "QI1";
  AMA08W-SUBH.CONSTANT24 = "QJ1";
  AMA08W-SUBH.CONSTANT25 = "TOTAL";
  AMA08W-SUBH.CONSTANT26 = "TOTAL";
  AMA08W-FOOTER.CONSTANT1 = "------------------------------------";
  AMA08W-FOOTER.CONSTANT2 = "------------------------------------";
  AMA08W-FOOTER.CONSTANT3 = "------------------------------------";
  AMA08W-FOOTER.CONSTANT4 = "-----------------------------";
  AMA08W-FOOTER.CONSTANT5 = "***";
  AMA08W-FOOTER.CONSTANT6 = "TOTAL";
end // end AMA08P9-INITCON


// REPORTS MAIN PARA
Function AMA08P9-MAIN()
  /* cbsi start*/

  /* perform process to initialize variables*/
  AMA08P9-INIT-PARA();

  /* perform process to print the report*/
  AMA08P9-PRINT-PARA();

  /* perform process to close the application*/
  AMA08P9-CLOS-PARA();

  /* cbsi end*/
end // end AMA08P9-MAIN


// POPULATING REPORTS DETAILS
Function AMA08P9-POP-DET()
  /* cbsi start*/
  /* move retrieved variables to output record*/
  AMA08W-DET.S-TERM-RSN = AMA08W.WS-TERM-RSN-TRUNC;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-EM1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-EM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-IN1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-IN1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-SI1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-PK1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-PK1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-WB1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-WB1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-GC1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-GC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-SS1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SS1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-HC1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-HC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-HG1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-HG1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-CM1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-CM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-S-TOTAL-AG;
  AMA08P9-FORMAT5();
  AMA08W-DET.S-TERM-CNT-S-TOTAL-AG = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-QM1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-SL1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SL1 = FORMATW.OUTPUT-CHAR;

  /* Begin change for WI# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-QI1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-QJ1;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QJ1 = FORMATW.OUTPUT-CHAR;

  /* End   change for WI# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-S-TOTAL-MB;
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-S-TOTAL-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-G-TOTAL;
  AMA08P9-FORMAT5();
  AMA08W-DET.S-TERM-CNT-G-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA08P9-POP-DET


// POPULATE DO REPORT FOOTER
Function AMA08P9-POP-DOFOOT()
  /* *********************** start wi 16615 *****************************/
  /* move retrieved variables to district office output record*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-EM1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-EM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-IN1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-IN1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-SI1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-SI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-PK1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-PK1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-WB1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-WB1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-GC1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-GC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-SS1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-SS1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-HC1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-HC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-HG1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-HG1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-CM1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-CM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-S-AC-TOT-AG;
  AMA08P9-FORMAT5();
  AMA08W-FOOTER.S-TERM-CNT-S-AC-TOT-AG = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-QM1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-QM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-SL1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-SL1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-QI1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-AC-TOT-QJ1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-QJ1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-S-AC-TOT-MB;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-S-AC-TOT-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-DO-TERM-CNT-G-AC-TOT;
  AMA08P9-FORMAT5();
  AMA08W-FOOTER.S-TERM-CNT-G-AC-TOT = FORMATW.OUTPUT-CHAR;
  /* ****************************** end WI 16615 ***************************/
end // end AMA08P9-POP-DOFOOT


// POPULATE REPORT FOOTER
Function AMA08P9-POP-FOOTER()
  /* cbsi start*/
  /* move retrieved variables to output record*/
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-EM1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-EM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-IN1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-IN1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-SI1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-SI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-PK1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-PK1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-WB1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-WB1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-GC1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-GC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-SS1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-SS1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-HC1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-HC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-HG1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-HG1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-CM1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-CM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-S-AC-TOT-AG;
  AMA08P9-FORMAT5();
  AMA08W-FOOTER.S-TERM-CNT-S-AC-TOT-AG = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-QM1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-QM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-SL1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-SL1 = FORMATW.OUTPUT-CHAR;

  /* Begin change for WI# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-QI1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-AC-TOT-QJ1;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-AC-TOT-QJ1 = FORMATW.OUTPUT-CHAR;

  /* End   change for WI# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-S-AC-TOT-MB;
  AMA08P9-FORMAT4();
  AMA08W-FOOTER.S-TERM-CNT-S-AC-TOT-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-TERM-CNT-G-AC-TOT;
  AMA08P9-FORMAT5();
  AMA08W-FOOTER.S-TERM-CNT-G-AC-TOT = FORMATW.OUTPUT-CHAR;
end // end AMA08P9-POP-FOOTER


// PROCESS TO PRINT THE REPORT
Function AMA08P9-PRINT-PARA()
  /* cbsi start*/
  AMA08P9-SCAN();

  if (SR-AMA44-RECIN is ioError)
    AMA08P9-PRN-HEAD();
    REP132P9-NRF-PROC();
    AMA08P9-CLOS-PARA();
  end

  /* print all the details retrieved from the data base*/
  while (SR-AMA44-RECIN not ioError)

    if (SR-AMA44-RECIN.PCE-PRGM-CASE-STS == "T")
      if (AMA08W.WS-FIRST-TM-IND == "Y")
        AMA08W.WS-PREV-OFC-CD = SR-AMA44-RECIN.PCE-OFC-CD;
        AMA08W.WS-PREV-CASLD-ID = SR-AMA44-RECIN.PCE-CASLD-ID;
        AMA08W.WS-PREV-CLSRE-RSN-CD = SR-AMA44-RECIN.PCE-RSN-CD;
        AMA08W.WS-OFC-NM = SR-AMA44-RECIN.PCE-OFC-NM;
        AMA08W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
        AMA08W.WS-FIRST-TM-IND = "N";
      end
    /* perform processing specific to the application*/
      AMA08P9-APPLSPEC();

    end
    /* perform process to scan the cursor*/
    AMA08P9-SCAN();
  end /* end of while loop*/

  if (AMA08W.WS-REC-FOUND == "Y")
    if (AMA08W.WS-CLSRE-REC-FND == "Y")
      AMA08W.WS-TERM-RSN = SR-AMA44-RECIN.PCE-RSN;
      AMA08P9-ACUM-DET();
      AMA08P9-ACUM-DO(); /* ******* WI 16615*/
      AMA08P9-ACUM-ST();
  /* print details for last record*/
  /* perform process to populate the details*/
      AMA08P9-POP-DET();
  /* perform process to print detail screen*/
      AMA08P9-PRN-DETAIL();
    end
    if (AMA08W.WS-PB-REC-FND == "Y")
      AMA08P9-POP-FOOTER();
      AMA08P9-PRN-FOOTER();
    end
    AMA08P9-INIT-TOT();
    AMA08P9-INIT-FOTOT();
    if (AMA08W.WS-DO-PB-REC-FND == "Y")
      AMA08P9-DO-PRN(); /* wi 16615*/
    end
    AMA08P9-ST-PRN();
  /* check if footer and end of report line can fit in the same page*/
    AMA08W.WS-REM-LINES = REP-COMMON.WS-MAX-NO-LINES -     REP-COMMON.WS-LINE-NO;

    if ((AMA08W.WS-REM-LINES < 2))
    /* set print control character to form feed*/
      AMA08P9-PRN-HEAD(); /* print header details*/
    end
  /* print end of report*/
    REP132P9-EOR-PROC();
  /* perform termination process*/
    AMA08P9-CLOS-PARA();
  end

  AMA08P9-PRN-HEAD();
  REP132P9-NRF-PROC();
  /* cbsi end*/
end // end AMA08P9-PRINT-PARA


// PRINT'S  DETAIL LINES
Function AMA08P9-PRN-DETAIL()
  /* cbsi start*/
  if ((REP-COMMON.WS-NEW-PAGE == "Y"))
    AMA08P9-PRN-HEAD(); /* print the header details*/
    AMA08P9-PRN-SUBH(); /* print the subheader*/
    REP-COMMON.WS-NEW-PAGE = "N"; /* reset new page  indicator*/
  end
  if (REP-COMMON.WS-LINE-NO >= REP-COMMON.WS-MAX-NO-LINES)
    AMA08P9-PRN-HEAD();
    AMA08P9-PRN-SUBH();
  end
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA08W-DET.LINE1;
  WR-132REP-OUT-FILE();
  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";
  /* cbsi end*/
end // end AMA08P9-PRN-DETAIL


// PRINT REPORT FOOTER
Function AMA08P9-PRN-FOOTER()
  /* cbsi start*/
  REP-COMMON.WS-REM1 = REP-COMMON.WS-MAX-NO-LINES - REP-COMMON.WS-LINE-NO;
  if (REP-COMMON.WS-REM1 < 2)
    AMA08P9-PRN-HEAD();
    AMA08P9-PRN-SUBH();
  end
  SR-132REP-RECOUT.PRNT-CC = " ";
  SR-132REP-RECOUT.UFIELD = AMA08W-FOOTER.LINE1;
  WR-132REP-OUT-FILE();
  /* leave 1 line before printing curr line*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA08W-FOOTER.LINE2;
  WR-132REP-OUT-FILE();
  /* cbsi end*/
end // end AMA08P9-PRN-FOOTER


// PRINT REPORT HEADER
Function AMA08P9-PRN-HEAD()
  /* cbsi start*/
  /* increment page-no*/
  REP-COMMON.WS-PAGE-NO = REP-COMMON.WS-PAGE-NO + 1;

  if (REP-COMMON.WS-PAGE-NO > 1)
    SR-132REP-RECOUT.PRNT-CC = "1";
  end
  /* move page-no to header variable*/
  AMA08W-HEAD.UPAGE = REP-COMMON.WS-PAGE-NO-3-4;

  /* move each line of header to map and print*/
  SR-132REP-RECOUT.UFIELD = AMA08W-HEAD.LINE1;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";

  SR-132REP-RECOUT.UFIELD = AMA08W-HEAD.LINE2;
  WR-132REP-OUT-FILE();
  if (AMA08W-HEAD.LINE3 != " ")
    SR-132REP-RECOUT.UFIELD = AMA08W-HEAD.LINE3;
    WR-132REP-OUT-FILE();
  end

  /* cbsi end*/
end // end AMA08P9-PRN-HEAD


// PRINTING THE REPORT'S SUB-HEAD
Function AMA08P9-PRN-SUBH()
  /* cbsi start*/
  AMA08W.WS-LEVEL-OFC-NM = AMA08W.WS-OFC-NM-TRUNC;
  AMA08W.WS-LEVEL-CASLD-ID = AMA08W.WS-PREV-CASLD-ID;
  AMA08W-SUBH.S-LEVEL = AMA08W.WS-LEVEL;
  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA08W-SUBH.LINE1;
  WR-132REP-OUT-FILE();

  /* set control character to skip one line before printing curr line*/
  SR-132REP-RECOUT.PRNT-CC = "0";
  SR-132REP-RECOUT.UFIELD = AMA08W-SUBH.LINE2;
  WR-132REP-OUT-FILE();

  /* reset control character*/
  SR-132REP-RECOUT.PRNT-CC = " ";
  SR-132REP-RECOUT.UFIELD = AMA08W-SUBH.LINE3;
  WR-132REP-OUT-FILE();

  SR-132REP-RECOUT.UFIELD = AMA08W-SUBH.LINE4;
  WR-132REP-OUT-FILE();

  SR-132REP-RECOUT.PRNT-CC = "0";
  /* cbsi end*/
end // end AMA08P9-PRN-SUBH


// PROCESS TO READ INPUT FILE
Function AMA08P9-READIP()
  /* cbsi start*/
  VDBCONTROL.UPROC-NM = "AMA08P9-READIP";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "SR-AMA08-RECIN";
  try
    get next SR-AMA08-RECIN ;
  end
  /* check if any i/o error has occured*/
  if (SR-AMA08-RECIN is ioError && SR-AMA08-RECIN not endOfFile)
     /* return error code to indicate abnormal ending*/
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA08W.WS-EZERT8 = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA08W.WS-EZERT8-LAST4;
    WCM00P2-TO-CEP01A();
  end
  if (SR-AMA08-RECIN is endOfFile)
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA08W.WS-EZERT8 = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA08W.WS-EZERT8-LAST4;
    WCM00P2-TO-CEP01A();
  end
  /* cbsi end*/
end // end AMA08P9-READIP


// FILE SCAN
Function AMA08P9-SCAN()
  /* cbsi start*/
  VDBCONTROL.UPROC-NM = "AMA08P9-SCAN";
  VDBCONTROL.UPROC-OPT = "SCAN";
  VDBCONTROL.UPROC-OBJ = "SR-AMA44-RECIN";
  try
    get next SR-AMA44-RECIN ;
  end
  /* check if any i/o error has occured*/
  if (SR-AMA44-RECIN is ioError && SR-AMA44-RECIN not endOfFile)
     /* return error code to indicate abnormal ending*/
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA08W.WS-EZERT8 = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AMA08W.WS-EZERT8-LAST4;
    WCM00P2-TO-CEP01A();
  end
end // end AMA08P9-SCAN


// INITIALIZE ALL RECORDS
Function AMA08P9-SET-EMPTY()
  /* cbsi start*/
  set REP-COMMON empty;
  set REP-EOFNOF empty;
  set REP-DATE empty;
  set AMA08W-DET empty;
  set AMA08W-HEAD empty;
  set AMA08W-SUBH empty;
  set AMA08W-FOOTER empty;
  set VMESSAGE empty;
  set CEP01W empty;
  set VDBCONTROL empty;
  set VDBCOMMON empty;
  set FORMATW empty;
  set AMA08W empty;

  /* set all serial records empty*/
  /* note - use sr-132rep-recout or sr-80rep-recout if your*/
  /* serial file format is 132 or 80 respectively*/

  set SR-AMA08-RECIN empty;
  set SR-132REP-RECOUT empty;
  set SR-AMA44-RECIN empty;
  /* cbsi end*/
end // end AMA08P9-SET-EMPTY


// POPULATE STWIDE DETAILS
Function AMA08P9-ST-POP-DET()
  AMA08W-DET.S-TERM-RSN = AMA08W.WS-ST-TERM-RSN[WS-AMA08-INDEX];
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-EM1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-EM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-IN1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-IN1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-SI1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-PK1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-PK1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-WB1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-WB1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-GC1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-GC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-SS1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SS1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-HC1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-HC1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-HG1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-HG1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-CM1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-CM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-S-TOTAL-AG[WS-AMA08-INDEX];
  AMA08P9-FORMAT5();
  AMA08W-DET.S-TERM-CNT-S-TOTAL-AG = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-QM1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QM1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-SL1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-SL1 = FORMATW.OUTPUT-CHAR;

  /* Begin change for WI# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-QI1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QI1 = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-QJ1[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-QJ1 = FORMATW.OUTPUT-CHAR;

  /* End   change for WI# 15116- Ted Hendricks*/

  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-S-TOTAL-MB[WS-AMA08-INDEX];
  AMA08P9-FORMAT4();
  AMA08W-DET.S-TERM-CNT-S-TOTAL-MB = FORMATW.OUTPUT-CHAR;
  set FORMATW empty;
  FORMATW.INPUT-NUMBER = AMA08W.WS-ST-TERM-CNT-G-TOTAL[WS-AMA08-INDEX];
  AMA08P9-FORMAT5();
  AMA08W-DET.S-TERM-CNT-G-TOTAL = FORMATW.OUTPUT-CHAR;
  /* cbsi end*/
end // end AMA08P9-ST-POP-DET


// PRINT STWIDE REPORT
Function AMA08P9-ST-PRN()
  AMA08P9-ACUM-STFOT();
  AMA08P9-PRN-HEAD(); /* print the header details*/
  AMA08W.WS-PREV-CASLD-ID = "STATE";
  AMA08W.WS-OFC-NM = "WIDE";
  AMA08P9-PRN-SUBH();
  REP-COMMON.WS-NEW-PAGE = "N";
  AMA08W.WS-AMA08-INDEX = 1;
  while (AMA08W.WS-AMA08-INDEX <= 9)
    if (AMA08W.WS-ST-CLSRE-REC-FND[WS-AMA08-INDEX] == "Y")
      AMA08P9-ST-POP-DET();
      AMA08P9-PRN-DETAIL();
    end
    AMA08W.WS-AMA08-INDEX = AMA08W.WS-AMA08-INDEX + 1;
  end
  AMA08P9-POP-FOOTER();
  AMA08P9-PRN-FOOTER();
end // end AMA08P9-ST-PRN


// VALIDATES  INPUT  PARAMETERS
Function AMA08P9-VALIDATE()
  if (SR-AMA08-RECIN.RPT-DT not numeric)
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA08W.WS-EZERT8 = "        ";
    VMESSAGE.UMSGINS[1] = AMA08W.WS-EZERT8-LAST4;
    VMESSAGE.UMSGCODE = "CEP0043E"; /* INVALID INPUT-PROCESS DATE*/
    WCM00P2-TO-CEP01A();
  end
  AMA08W.WS-TOPREC = SR-AMA08-RECIN.TOPREC;
  /* validation of input month & calculation of start and end date*/
  REP-DATE.WS-IN-RPT-MM = AMA08W.WS-RPT-DT-MM;
  REP-DATE.WS-IN-RPT-CCYY = AMA08W.WS-RPT-DT-CCYY;
  REP-DATE.WS-FLAG = "M";
  REPP9-DATE-PARA();
  if (REP-DATE.WS-DATE-FLAG == 1)
    VMESSAGE.UMSGCODE-JCL-ERR = 10;
    AMA08W.WS-EZERT8 = "        ";
    VMESSAGE.UMSGINS[1] = AMA08W.WS-EZERT8-LAST4;
    VMESSAGE.UMSGCODE = "CEP0043E"; /* INVALID INPUT-PROCESS DATE*/
    WCM00P2-TO-CEP01A();
  end

  /* move start and end calculate days to your local storage*/
  AMA08W.WS-RPT-BEG-DT = REP-DATE.WS-START-DATE;
  AMA08W.WS-RPT-END-DT = REP-DATE.WS-END-DATE;
  AMA08W.WS-RPT-YEAR = AMA08W.WS-RPT-BEG-DT-CCYY;
  AMA08W.WS-RPT-MNTH = AMA08W.WS-RPT-BEG-DT-MM;
end // end AMA08P9-VALIDATE


Record AMA08W type basicRecord
  10 WS-REM-LINES num(3) ; 
  10 WS-TOPREC char(80) ; 
    15 WS-RPT-DT num(6) ; 
      20 WS-RPT-DT-CCYY num(4) ; 
      20 WS-RPT-DT-MM num(2) ; 
    15 * char(74) ; 
  10 WS-RPT-BEG-DT char(10) ; 
    15 WS-RPT-BEG-DT-CCYY num(4) ; 
    15 WS-RPT-BEG-DT-F1 char(1) ; 
    15 WS-RPT-BEG-DT-MM num(2) ; 
    15 WS-RPT-BEG-DT-F2 char(1) ; 
    15 WS-RPT-BEG-DT-DD num(2) ; 
  10 WS-RPT-END-DT char(10) ; 
    15 WS-RPT-END-DT-CCYY num(4) ; 
    15 WS-RPT-END-DT-F1 char(1) ; 
    15 WS-RPT-END-DT-MM num(2) ; 
    15 WS-RPT-END-DT-F2 char(1) ; 
    15 WS-RPT-END-DT-DD num(2) ; 
  10 WS-RPT-YEAR smallint ; 
  10 WS-RPT-MNTH smallint ; 
  10 WS-PREV-OFC-CD char(2) ; 
  10 WS-PREV-CLSRE-RSN-CD char(2) ; 
  10 WS-PREV-AID-CD char(3) ; 
  10 WS-DIST-OFC-NM char(37) ; 
    15 WS-PREV-CASLD-ID char(5) ; 
    15 WS-OFC-NM char(32) ; 
      20 WS-OFC-NM-TRUNC char(15) ; 
      20 WS-OFC-NM-F1 char(17) ; 
  10 WS-TERM-RSN char(50) ; 
    15 WS-TERM-RSN-TRUNC char(19) ; 
    15 WS-TERM-RSN-F1 char(31) ; 
  10 WS-LEVEL char(20) ; 
    15 WS-LEVEL-CASLD-ID char(5) ; 
    15 WS-LEVEL-OFC-NM char(15) ; 
  10 WS-FIRST-TM-IND char(1) ; 
  10 WS-AMA08-INDEX num(3) ; 
  10 WS-REC-FOUND char(1) ; 
  10 WS-CLSRE-REC-FND char(1) ; 
  10 WS-ST-REC-FND char(1) ; 
  10 WS-DO-REC-FND char(1) ; 
  10 WS-PB-REC-FND char(1) ; 
  10 WS-DO-PB-REC-FND char(1) ; 
  10 WS-DET char(70) ; 
    15 WS-TERM-CNT-EM1 num(4) ; 
    15 WS-TERM-CNT-IN1 num(4) ; 
    15 WS-TERM-CNT-SI1 num(4) ; 
    15 WS-TERM-CNT-PK1 num(4) ; 
    15 WS-TERM-CNT-WB1 num(4) ; 
    15 WS-TERM-CNT-GC1 num(4) ; 
    15 WS-TERM-CNT-SS1 num(4) ; 
    15 WS-TERM-CNT-HC1 num(4) ; 
    15 WS-TERM-CNT-HG1 num(4) ; 
    15 WS-TERM-CNT-CM1 num(4) ; 
    15 WS-TERM-CNT-S-TOTAL-AG num(5) ; 
    15 WS-TERM-CNT-QM1 num(4) ; 
    15 WS-TERM-CNT-SL1 num(4) ; 
    15 WS-TERM-CNT-QI1 num(4) ; 
    15 WS-TERM-CNT-QJ1 num(4) ; 
    15 WS-TERM-CNT-S-TOTAL-MB num(4) ; 
    15 WS-TERM-CNT-G-TOTAL num(5) ; 
  10 WS-FO-DET char(70) ; 
    15 WS-TERM-CNT-AC-TOT-EM1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-IN1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-SI1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-PK1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-WB1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-GC1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-SS1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-HC1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-HG1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-CM1 num(4) ; 
    15 WS-TERM-CNT-S-AC-TOT-AG num(5) ; 
    15 WS-TERM-CNT-AC-TOT-QM1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-SL1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-QI1 num(4) ; 
    15 WS-TERM-CNT-AC-TOT-QJ1 num(4) ; 
    15 WS-TERM-CNT-S-AC-TOT-MB num(4) ; 
    15 WS-TERM-CNT-G-AC-TOT num(5) ; 
  10 WS-DO-DET char(90) [9] ; 
    15 WS-DO-CLSRE-REC-FND char(1) ; 
    15 WS-DO-TERM-RSN char(19) ; 
    15 WS-DO-TERM-CNT-EM1 num(4) ; 
    15 WS-DO-TERM-CNT-IN1 num(4) ; 
    15 WS-DO-TERM-CNT-SI1 num(4) ; 
    15 WS-DO-TERM-CNT-PK1 num(4) ; 
    15 WS-DO-TERM-CNT-WB1 num(4) ; 
    15 WS-DO-TERM-CNT-GC1 num(4) ; 
    15 WS-DO-TERM-CNT-SS1 num(4) ; 
    15 WS-DO-TERM-CNT-HC1 num(4) ; 
    15 WS-DO-TERM-CNT-HG1 num(4) ; 
    15 WS-DO-TERM-CNT-CM1 num(4) ; 
    15 WS-DO-TERM-CNT-S-TOTAL-AG num(5) ; 
    15 WS-DO-TERM-CNT-QM1 num(4) ; 
    15 WS-DO-TERM-CNT-SL1 num(4) ; 
    15 WS-DO-TERM-CNT-QI1 num(4) ; 
    15 WS-DO-TERM-CNT-QJ1 num(4) ; 
    15 WS-DO-TERM-CNT-S-TOTAL-MB num(4) ; 
    15 WS-DO-TERM-CNT-G-TOTAL num(5) ; 
  10 WS-FO-DO-DET char(70) ; 
    15 WS-DO-TERM-CNT-AC-TOT-EM1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-IN1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-SI1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-PK1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-WB1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-GC1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-SS1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-HC1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-HG1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-CM1 num(4) ; 
    15 WS-DO-TERM-CNT-S-AC-TOT-AG num(5) ; 
    15 WS-DO-TERM-CNT-AC-TOT-QM1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-SL1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-QI1 num(4) ; 
    15 WS-DO-TERM-CNT-AC-TOT-QJ1 num(4) ; 
    15 WS-DO-TERM-CNT-S-AC-TOT-MB num(4) ; 
    15 WS-DO-TERM-CNT-G-AC-TOT num(5) ; 
  10 WS-ST-DET char(90) [9] ; 
    15 WS-ST-CLSRE-REC-FND char(1) ; 
    15 WS-ST-TERM-RSN char(19) ; 
    15 WS-ST-TERM-CNT-EM1 num(4) ; 
    15 WS-ST-TERM-CNT-IN1 num(4) ; 
    15 WS-ST-TERM-CNT-SI1 num(4) ; 
    15 WS-ST-TERM-CNT-PK1 num(4) ; 
    15 WS-ST-TERM-CNT-WB1 num(4) ; 
    15 WS-ST-TERM-CNT-GC1 num(4) ; 
    15 WS-ST-TERM-CNT-SS1 num(4) ; 
    15 WS-ST-TERM-CNT-HC1 num(4) ; 
    15 WS-ST-TERM-CNT-HG1 num(4) ; 
    15 WS-ST-TERM-CNT-CM1 num(4) ; 
    15 WS-ST-TERM-CNT-S-TOTAL-AG num(5) ; 
    15 WS-ST-TERM-CNT-QM1 num(4) ; 
    15 WS-ST-TERM-CNT-SL1 num(4) ; 
    15 WS-ST-TERM-CNT-QI1 num(4) ; 
    15 WS-ST-TERM-CNT-QJ1 num(4) ; 
    15 WS-ST-TERM-CNT-S-TOTAL-MB num(4) ; 
    15 WS-ST-TERM-CNT-G-TOTAL num(5) ; 
  10 WS-EZERT8 num(8) ; 
    15 WS-EZERT8-FIRST4 char(4) ; 
    15 WS-EZERT8-LAST4 char(4) ; 
end // end AMA08W


Record AMA08W-DET type basicRecord
  10 LINE1 char(132) ; 
    15 S-TERM-RSN char(19) ; 
    15 FILLER1 char(2) ; 
    15 S-TERM-CNT-EM1 char(4) ; 
    15 FILLER2 char(1) ; 
    15 S-TERM-CNT-IN1 char(4) ; 
    15 FILLER3 char(1) ; 
    15 S-TERM-CNT-SI1 char(4) ; 
    15 FILLER4 char(4) ; 
    15 S-TERM-CNT-PK1 char(4) ; 
    15 FILLER5 char(5) ; 
    15 S-TERM-CNT-WB1 char(4) ; 
    15 FILLER6 char(1) ; 
    15 S-TERM-CNT-GC1 char(4) ; 
    15 FILLER7 char(1) ; 
    15 S-TERM-CNT-SS1 char(4) ; 
    15 FILLER8 char(1) ; 
    15 S-TERM-CNT-HC1 char(4) ; 
    15 FILLER9 char(1) ; 
    15 S-TERM-CNT-HG1 char(4) ; 
    15 FILLER10 char(1) ; 
    15 S-TERM-CNT-CM1 char(4) ; 
    15 FILLER11 char(4) ; 
    15 S-TERM-CNT-S-TOTAL-AG char(5) ; 
    15 FILLER12 char(2) ; 
    15 S-TERM-CNT-QM1 char(4) ; 
    15 FILLER13 char(1) ; 
    15 S-TERM-CNT-SL1 char(4) ; 
    15 FILLER14 char(1) ; 
    15 S-TERM-CNT-QI1 char(4) ; 
    15 FILLER15 char(1) ; 
    15 S-TERM-CNT-QJ1 char(4) ; 
    15 FILLER16 char(3) ; 
    15 S-TERM-CNT-S-TOTAL-MB char(4) ; 
    15 FILLER17 char(5) ; 
    15 S-TERM-CNT-G-TOTAL char(5) ; 
    15 FILLER18 char(8) ; 
end // end AMA08W-DET


Record AMA08W-FOOTER type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(36) ; 
    15 CONSTANT2 char(36) ; 
    15 CONSTANT3 char(36) ; 
    15 CONSTANT4 char(23) ; 
    15 FILLER1 char(1) ; 
  10 LINE2 char(132) ; 
    15 CONSTANT5 char(3) ; 
    15 FILLER2 char(1) ; 
    15 CONSTANT6 char(5) ; 
    15 FILLER3 char(12) ; 
    15 S-TERM-CNT-AC-TOT-EM1 char(4) ; 
    15 FILLER4 char(1) ; 
    15 S-TERM-CNT-AC-TOT-IN1 char(4) ; 
    15 FILLER5 char(1) ; 
    15 S-TERM-CNT-AC-TOT-SI1 char(4) ; 
    15 FILLER6 char(4) ; 
    15 S-TERM-CNT-AC-TOT-PK1 char(4) ; 
    15 FILLER7 char(5) ; 
    15 S-TERM-CNT-AC-TOT-WB1 char(4) ; 
    15 FILLER8 char(1) ; 
    15 S-TERM-CNT-AC-TOT-GC1 char(4) ; 
    15 FILLER9 char(1) ; 
    15 S-TERM-CNT-AC-TOT-SS1 char(4) ; 
    15 FILLER10 char(1) ; 
    15 S-TERM-CNT-AC-TOT-HC1 char(4) ; 
    15 FILLER11 char(1) ; 
    15 S-TERM-CNT-AC-TOT-HG1 char(4) ; 
    15 FILLER12 char(1) ; 
    15 S-TERM-CNT-AC-TOT-CM1 char(4) ; 
    15 FILLER13 char(4) ; 
    15 S-TERM-CNT-S-AC-TOT-AG char(5) ; 
    15 FILLER14 char(2) ; 
    15 S-TERM-CNT-AC-TOT-QM1 char(4) ; 
    15 FILLER15 char(1) ; 
    15 S-TERM-CNT-AC-TOT-SL1 char(4) ; 
    15 FILLER16 char(1) ; 
    15 S-TERM-CNT-AC-TOT-QI1 char(4) ; 
    15 FILLER17 char(1) ; 
    15 S-TERM-CNT-AC-TOT-QJ1 char(4) ; 
    15 FILLER18 char(3) ; 
    15 S-TERM-CNT-S-AC-TOT-MB char(4) ; 
    15 FILLER19 char(5) ; 
    15 S-TERM-CNT-G-AC-TOT char(5) ; 
    15 FILLER20 char(8) ; 
end // end AMA08W-FOOTER


Record AMA08W-HEAD type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(8) ; 
    15 FILLER1 char(1) ; 
    15 UPAGE char(4) ; 
    15 FILLER2 char(46) ; 
    15 CONSTANT2 char(5) ; 
    15 FILLER3 char(1) ; 
    15 CONSTANT3 char(2) ; 
    15 FILLER4 char(1) ; 
    15 CONSTANT4 char(6) ; 
    15 FILLER5 char(43) ; 
    15 CONSTANT5 char(4) ; 
    15 FILLER6 char(3) ; 
    15 UDATE char(8) ; 
  10 LINE2 char(132) ; 
    15 UAPPL char(8) ; 
    15 FILLER7 char(31) ; 
    15 CONSTANT6 char(7) ; 
    15 FILLER8 char(1) ; 
    15 CONSTANT7 char(11) ; 
    15 FILLER9 char(1) ; 
    15 CONSTANT8 char(6) ; 
    15 FILLER10 char(1) ; 
    15 CONSTANT9 char(10) ; 
    15 FILLER11 char(1) ; 
    15 CONSTANT10 char(2) ; 
    15 FILLER12 char(1) ; 
    15 CONSTANT11 char(3) ; 
    15 FILLER13 char(1) ; 
    15 CONSTANT12 char(4) ; 
    15 FILLER14 char(1) ; 
    15 CONSTANT13 char(1) ; 
    15 FILLER15 char(1) ; 
    15 CONSTANT14 char(4) ; 
    15 FILLER16 char(22) ; 
    15 CONSTANT15 char(4) ; 
    15 FILLER17 char(3) ; 
    15 UTIME char(8) ; 
  10 LINE3 char(132) ; 
    15 FILLER18 char(53) ; 
    15 CONSTANT16 char(5) ; 
    15 FILLER19 char(1) ; 
    15 CONSTANT17 char(2) ; 
    15 FILLER20 char(1) ; 
    15 CONSTANT18 char(1) ; 
    15 FILLER21 char(1) ; 
    15 S-REPMTH char(11) ; 
    15 FILLER22 char(1) ; 
    15 S-REPYR char(4) ; 
    15 FILLER23 char(52) ; 
end // end AMA08W-HEAD


Record AMA08W-SUBH type basicRecord
  10 LINE1 char(132) ; 
    15 CONSTANT1 char(5) ; 
    15 FILLER1 char(1) ; 
    15 S-LEVEL char(19) ; 
    15 FILLER2 char(107) ; 
  10 LINE2 char(127) ; 
    15 CONSTANT2 char(6) ; 
    15 FILLER3 char(14) ; 
    15 CONSTANT3 char(36) ; 
    15 CONSTANT4 char(31) ; 
    15 CONSTANT5 char(15) ; 
    15 FILLER4 char(1) ; 
    15 CONSTANT6 char(14) ; 
    15 FILLER5 char(10) ; 
  10 LINE3 char(128) ; 
    15 FILLER6 char(82) ; 
    15 CONSTANT7 char(3) ; 
    15 FILLER7 char(26) ; 
    15 CONSTANT8 char(3) ; 
    15 FILLER8 char(5) ; 
    15 CONSTANT9 char(5) ; 
    15 FILLER9 char(4) ; 
  10 LINE4 char(132) ; 
    15 FILLER10 char(21) ; 
    15 CONSTANT10 char(3) ; 
    15 FILLER11 char(2) ; 
    15 CONSTANT11 char(3) ; 
    15 FILLER12 char(2) ; 
    15 CONSTANT12 char(3) ; 
    15 FILLER13 char(2) ; 
    15 CONSTANT13 char(11) ; 
    15 FILLER14 char(2) ; 
    15 CONSTANT14 char(3) ; 
    15 FILLER15 char(2) ; 
    15 CONSTANT15 char(3) ; 
    15 FILLER16 char(2) ; 
    15 CONSTANT16 char(3) ; 
    15 FILLER17 char(2) ; 
    15 CONSTANT17 char(3) ; 
    15 FILLER18 char(2) ; 
    15 CONSTANT18 char(3) ; 
    15 FILLER19 char(2) ; 
    15 CONSTANT19 char(3) ; 
    15 FILLER20 char(4) ; 
    15 CONSTANT20 char(5) ; 
    15 FILLER21 char(3) ; 
    15 CONSTANT21 char(3) ; 
    15 FILLER22 char(2) ; 
    15 CONSTANT22 char(3) ; 
    15 FILLER23 char(2) ; 
    15 CONSTANT23 char(3) ; 
    15 FILLER24 char(2) ; 
    15 CONSTANT24 char(3) ; 
    15 FILLER25 char(3) ; 
    15 CONSTANT25 char(5) ; 
    15 FILLER26 char(4) ; 
    15 CONSTANT26 char(5) ; 
    15 FILLER27 char(8) ; 
end // end AMA08W-SUBH


