"Phase 3
IN 14: Create a new  real time service complete the match resolution - Get match details (Phase3). This includes
1. Sending a JSON request to NAC with the details of the final decision taken in IEES for the duplicate match in IEES.
2. Capturing the response returned from NAC for further validations and displaying the data on screen.
3. Updating WP screens with the response sent from NAC.
4. Implementing a retry mechanism in case of failures."
"Phase 3
Create a new real timeservice for the Match Resolution - Update as State's Disposition with NAC (Phase3). This includes
1. Sending a JSON request to NAC with the details of the initial action taken in IEES once a match is identified.
2. Capturing the response returned from NAC for further validations and displaying the data on screen.
3. Updating WP screens with the response sent from NAC.
4. Implementing a retry mechanism in case of failures."
"Phase 3
Create a new real timeservice for the Match Resolution - Get matches (Phase3). This includes
1. Sending a JSON request to NAC with the details of the initial action taken in IEES once a match is identified.
2. Capturing the response returned with all the match details available on NAC.
3. Updating WP screens with the results and creating a task for the outstanding matches.
4. Implementing a retry mechanism in case of failures."
"Phase 3
Paris Interstate inbound batch changes to exclude states which has implemented NAC based on RT configuration"
"Phase 3
Create new day0 scripts to access the new report from WP.
Create a new universe table to store data related to matched individuals.
Create a new SP to fetch individual details , case , region and other related columns for matched individuals."
"Phase 3
Create a new report to show the details of the individuals whose duplicate participation call or match resolution call failied after processing the failsafe batch."
"Phase 3
Create a new report to show total number of NAC Matches and along with the individuals who matched and the Individual details like Name, Case #, IndvID, Region etc."





Functional Requirements	
#	Description
1	"Build a NAC Bulk upload interface to send the SNAP participants to NAC. The interface should handle the below process: 
1. A batch to pick all the SNAP data as per the selection criteira and convert all the data to a secure cryptographic hash through a Privacy Preserving Record Linkage (PPRL) process.
2. A batch to write the records to a .csv file.
3. Transfer the file to the NAC server using the upload information API and get the status of the uploaded file."
2	The SNAP participants data (Name, DOB, SSN) should be converted to a secure cryptographic hash through a Privacy Preserving Record Linkage (PPRL) process before being sent to NAC in the bulk upload interface. 
3	Build a new API - "The upload information API", to transfer the bulk upload data from IEES to NAC and get the status of the bulk upload file.
4	Create a process to handle the response codes sent from NAC for the build upload along with a retry mechanism.
5	Build a new Webservice - "Query for Duplicate Participant ", to interface real time with NAC to check for matches and prevent duplicate participation. 
6	NAC webservice can be invoked for an individual on all case modes on multiple screens and a standalone NAC screen.
7	"The NAC request sent from IEES to NAC should  contain the individual details along with the hash ID generated through PPRL process.
The response from NAC will contain the individual details along with the match and benefit details. "
8	Create a process to handle the response codes sent from NAC to IEES in the webservice.
9	Systematic process to take action and or generate VCL for a match received from NAC. 
10	Build a new API - "Match Resolution API", to take appropriate action when a match is identified in NAC.
11	Create a process to send the request and handle the response codes sent from NAC to IEES in the Match resolution API.
12	Changes to the current PARIS interface. Exclude SNAP records from states in the PARIS interface who are already onboarded into NAC to elimate duplicate matches. 
13	NAC should be triggered for SNAP from WP on all case modes systematically and On-Demand.
14	A new NAC screen or update the exisiting screen to view the NAC results details. 
15	A new NAC section will be added in the State & Federal data sources screen. 
16	On the Data collection screens an option to invoke NAC services should be added. 
17	Whenever a NAC call is made, a call log must be retained with the date and time of the last call on the screen. This will be used for auditing purposes.
18	Create a new Task for the worker for NAC matches.
19	For Match Resolution, add a screen to capture details on the action taken in IEES to be sent to NAC.
20	If the NAC was triggered successfully in current day, then NAC will not be triggered again. The screen should display the latest run result. (If a match is found within the ‘X’ days, we will not be triggering NAC). Add validations to restrict/allow NAC calls.
21	Add changes to the current task closure batch to close PARIS match task when a NAC match is received. 
22	Add Security Mapping for New screen 
23	Update eligibility rules to Pend/ Deny/ Close SNAP per business and policy requirements. 
24	Update eligibility batch to Pend/ Deny/ Close SNAP per business and policy requirements. 
25	For NAC Match, the benefits should be pended for verification. 
26	Terminate or deny the SNAP EDG or exclude the member (if non-HOH) when the verification is not provided by the client within 10 days.
27	Existing SNAP RFI notice will be triggered for the new VCL that will be created for NAC match. This notice will also contain verbiage that this verification is being requested based on match we received from NAC. 
28	Existing SNAP denial/discontinuance notice will be triggered when RFI is not returned on time.
29	A report to display the total number of NAC Matches on the 'Report Month' selected by the user along with the  individuals who matched and the Individual details like Name, Case #, IndvID, Region etc.
30	Develop a training plan and train workers on using the NAC webservice to verify duplicate participation and take appropriate action when a match is identified.  









National Accuracy
Clearinghouse (NAC)
Group 6 Technology Deep Dive
April 2024
Today’s Topics
2
TERMS &
CONCEPTS
DEVELOPMENT
OVERVIEW
PREPARING YOUR
UPLOAD FILES
USING NAC REST
APIS
NAC
ENVIRONMENTS
IP WHITELISTING QUESTIONS &
NEXT STEPS
Business Process Connection
3
How Tech Development Relates to Business Processes
• Frequency of extracting data: Once per working day
• Process of data extraction:
• Will this process be automated or manual?
• What time of day will this process initiate?
• What optional data elements will be included?
• How will the VI flag be handled?
4
NAC Terms & Concepts
5
Active Participant
6
An active participant is
an individual who is
certified to receive SNAP
benefits for the current
monthly benefit cycle on
the day when the bulk
upload file is being
generated.
Application Programming Interface (API)
7
Stands for Application Programming
Interface.
This is an interface or "connection" between
two technical system that allows them to
perform certain actions.
As part of implementing the NAC, States will
connect via the NAC APIs to upload
participants or find matches.
This requires a technical team with access to
connect the NAC with the State's eligibility
systems.
API Key / Subscription Key
8
A code given by the API owner (FNS) to the API consumer (a State agency) to allow use of the API and
identify the consumer.
Readiness Testing Per API
Develop
Bulk
Upload API
Complete
Bulk
Upload
Readiness
Testing
Develop
Duplicate
Participant
API
Complete
Duplicate
Participant
Readiness
Testing
Develop
Match Res
API
Complete
Match Res
Readiness
Testing
9
*If Available
Readiness Testing Per API
Purpose
• To evaluate whether a
portion of the State's NAC
integration is ready to go
live
• Testing is completed in our
preprod environment
When
• Conducted after your team
completes development of
each API
• Testing happens over an 8-
day period
• States are able to test at
their own pace/frequency
throughout the 8 days
What
• A series of test cases that
evaluate the State’s NAC
integration
• Examples:
• Created generated hashes
using the NAC PPRL
process
• Completing uploads
• Creating matches
10
Daily Upload / Bulk Upload File
11
To ensure real-time matching and up-to-date information, States will upload a bulk
file with all active participantsinto the NAC each day.
Automated Monthly Bulk Matches
12
The Monthly Bulk Match is
an automated monthly
upload of all active SNAP
participants. It queries the
NAC data matching
elements of all active
participants on the day of
the upload to identify
duplicate participation
across all States that are
active in the NAC.
PPRL for Cryptographic Hashing of PII
13
You’ll have to extract and
convert your SNAP
participant data.
The NAC team has normalization
requirements to ensure
accuracy of data.
Development Overview
14
15
Implementing the NAC has three main
requirements:
Upload Information
about SNAP
participants to
the NAC
Conduct queries against the
NAC to discover matches and
prevent duplicate
participation
Take appropriate
action when
matches are found
NAC API Development
Bulk Upload API
• Export active participant data from your Eligibility System
• Normalize data
• Apply cryptographic hash
• Develop active participant bulk upload to the NAC
16
NAC API Development
Duplicate Participant API
• Develop query capability
• Receive email notifications for NAC Matches and NAC Match Updates
• Develop trigger logic for NAC Notices within your Eligibility System
oNotice of Match Result
oCombined Notice of Match Result and Adverse Action
17
NAC API Development
Match Res API (coming soon)
• Resolve the match within your eligibility system
• Make the necessary front-end changes within your
Eligibility System
• Call Match Res API to update a match within your
Eligibility System and the NAC.
18
Preparing Your Upload Files
19
Steps to Prepare for Upload
Extract SNAP Participant Information
Normalize the SSN, DOB, and Last Name (the “PII”)
Concatenate and Hash the PII
Format the CSV
20
SNAP participant data State agencies need to export:
21
Name
DOB
SSN
Normalization
22
Please check the provided
documentation on
Normalization for more rules
and examples.
Last Name Normalization Rules
1. Convert to lower case
2. Replace hyphens with a space
3. Replace multiple spaces with one space
4. Trim any spaces at the start and end of the last name
5. Remove suffixes (only removes a single suffix at the end
of the name):
1. Roman numerals i-ix
2. Variations of junior: junior, jr, jr., jnr
3. Variations of senior: senior, sr, sr., snr
6. Remove any character that is not an ASCII space (0x20)
or in the range [a-z] (0x61-0x70)
7. Validate that the resulting value is at least one ASCII
character in length
Normalization needs to be
completed in the order listed
Concatenation & Hashing
23
von neumann,1903-12-28,012-34-5678
PPRL
function
byron,1815-12-10,234-56-7890
turing,1912-06-23,000-11-2222
bc3c340c1f708e1b2cae8d126b36f676...
c1375ae8411855374f46102392bc7a8b...
c342cdb7d4ad65f3467f1ab056f1f9c6...
Plain text participant PII Secure hash
First, you will need to
combine all the PII together
in a string.
Then it will be hashed using
SHA-512.
CSV Formatting
24
The CSV for upload consists of header columns
and rows of hashed participant information.
Please check the provided
Import-schema to make sure
your headers and field data
are formatted appropriately!
While excel is the easiest way to view a sample
CSV, please know it is also the easiest way to
corrupt a CSV file for upload! Do not use Excel for
file edits!
If you are looking to test
validation, we can help you
with a bash script for testing.
Upload File Examples
• Pre-processed Plain-text File of Participant Data
• Post-processed File Ready for Upload
25
Using NAC REST APIs
26
REST APIs
• Your State System will use the APIs to
o Perform Daily Uploads
o Check the Status of Uploads
o Query for Duplicate Participation
• The State System will make requests to the NAC API endpoints
• JSON is used for operation request and/or response bodies
27
Subscription Keys
28
API Subscription Keys allow for authentication
and authorization of an API endpoint. These keys
are provided after completion of an ISA and the
environment’s FNS-674.
Subscription Keys for production require
completion of readiness test cases before they
can be exchanged.
Please remember to have the ISA reviewed and signed as
quickly as possible so we can share the API Subscription
Keys!
Demo • API Specifications: Upload, Duplicate Participant • Postman Examples • Upload Endpoint • Get Upload Status Endpoint • Duplicate Participation Endpoint
29
Demo • NAC Web App
30
NAC Environments
31
NAC Environments
The following environments are used by State agencies to move through the NAC onboarding process up to daily
Production use, and by development teams to implement and test new features and functionality. mary
Dev Environment Test Environment PreProd Environment
USDA National Accuracy Clearinghouse
U.S. DEPARTMENT OF AGRICULTURE
4 Prod Environment
This environment is used by NAC developers. It is continually in lux
and there's no guarantee of functionality or reliability.
For the NAC team stable ment to perform QA For the NAC team, this is the primary environment for QA and UAT. For the NAC States,this is where the fi
NAC Developers
Daily
For States, this is the environment to initially explorethe NAC, see
new features before they are migrated to PreProd,and conduct their
For States, this is where readiness testing is conducted prior to
migrating any nev to the Prod erviranmen
own development work.
8
NAC Project Managers
8
State Projeci Managers
Weekly
How Can States Prepare to Use Each Environment?
A complete list of the steps required for States to use the NAC is included inthe State Readiness Integration
Tracker; this is a high level look at the key activities as they relate to each environmen Upload Iteadiness
N/A
N/A
8
NAC Developers Quality Assurance
State Developers
8
FNS Stakeholders NAC Project Managers
8
Quality Assurance
8 8
State Project Managers State Team Leads State Developers State Testers
Every 2-3 months
Develop active participant export,
deidentification, and bulkk upload process
Conduct Readiness Testing
Develop duplicate participant query
Integrate duplicate participant query into
State eligibility system
Conduct Readiness Testing
*In order environment, your State Project Manager will need to receive the API Keys and should, in turn, provide them to the State Technical Lead
8
FNS Stakeholders
8
State Users
8
Federal Quality Control
8
State Quality Control
Every 3-4 months
Upon successfully completing Readiness
Testing,begin automated daily participant upload
Upon successfully completing Readiness
Testing securely exchange the API key
for production for the matching
capability
33
NAC Environment
How Can States Prepare to Use
Each Environment?
The NAC environments are used by State agencies to move
through the NAC onboarding process up to daily Production
use, and by development teams to implement and test new
features and functionality.
34
NAC Environment
How Can States Prepare to Use
Each Environment?
The NAC environments are used by State agencies to move
through the NAC onboarding process up to daily Production
use, and by development teams to implement and test new
features and functionality.
35
NAC Environment The NAC environments are used by State agencies to move
through the NAC onboarding process up to daily Production
use, and by development teams to implement and test new
features and functionality.
How Can States Prepare to Use
Each Environment?
36
NAC Environment
How Can States Prepare to Use
Each Environment?
The NAC environments are used by State agencies to move
through the NAC onboarding process up to daily Production
use, and by development teams to implement and test new
features and functionality.
IP Whitelisting
37
IP Whitelisting
IP Whitelisting is a standard security practice for restricting access
within a network. For all types of IP Whitelisting each group provides
specific IP Addresses or Ranges that are allowed for use.
38
With In-bound IP Whitelisting,
NAC restricts access from the
States
With Out-bound IP
Whitelisting, the State
restricts access to the NAC
NAC Restricts State (In-Bound)
For our Bulk Upload API, NAC must restrict usage
to specific State IP Addresses. This is a security
requirement.
The NAC Team will reach out to request the
allowed IPs for preproduction and production.
This will be included in a list maintained by NAC.
Only systems with IPs in this list can successfully
submit uploads to the NAC.
You can think of in-bound IP whitelisting like a “lock”. Bulk
Upload API is “locked” to all those who aren’t on our list.
State Restricts NAC (Out-Bound)
State agency security teams may require that
access to the NAC is restricted.
To implement that restriction, the NAC Team
recommends the following:
• If able, please use our URL instead:
• https://api.nac.usda.gov
• If unable, please use our static IP:
• Provided upon request
• If both options are not possible and your
organization requires IP whitelisting, please let
our team know
You can think of out-bound IP whitelisting like a “door”. Your
state agency security team may “close” the door to NAC by
default. By working with them, you can “open” the door to
NAC, allowing you to use our APIs.
Questions / Discussion
Please share your concerns too! We can always parking lot items and
send response via email if needed or address at our next meeting.
41
Next Steps
42
Next Steps
1. Complete FNS-674 and ISA by 4/15
2. Start upload API development by 4/22
• Business Process Deep Dive: Tuesday, April 9th 12:30-1:00 pm ET
• Timeline & Business Process Workshop Deep Dive: Tuesday, April 16th
from 1:00-2:30 pm ET
43
Thank you!
For anything you need, please email the
NAC project team inbox:
sm.fn.nacteam@usda.gov.
44



