// PROCESS REPORT
Function AIN30P9-PROC-REP()
  /* CREATED DUE TO PTR 4782*/
  /* BEGIN*/
  if (AIN30W.WS-KNOWN-TO-NOMADS-CODE == "N")
    return;
  end
  AIN30P9-BR-PROC();
  /* PTR 2444 BEGIN*/
  /* THE WS-CHECK-SSN-CD IS MOVED TO AIN30A-01-VERIFIED-CD.*/
  AIN30A-01-VERIFIED-CODE = AIN30W.WS-NOMADS-VERIF-CODE;
  /* PTR 2444*/
  AIN30P9-BDR-PROC();
  AIN30P9-IVABI-PROC();
  /* PTR 4782 END*/
end // end AIN30P9-PROC-REP


// PROCESS UPDATE
Function AIN30P9-PROC-UPD()
  set H2-PERSON empty;
  H2-PERSON.UPI = AIN30W.WS-PREV-UPI;
  AIN30P9-READ-S01();
  if (sysVar.sqlData.sqlcode == 0)
    if (H2-PERSON.SSN-VRFN-STS-CD != "V")
      if (H2-PERSON.SSN == AIN30W.WS-PREV-SSN)
        H2-PERSON.UPI = AIN30W.WS-PREV-UPI;
        H2-PERSON.SSN-VRFN-STS-CD = AIN30W.WS-NOMADS-VERIF-CODE;
        H2-PERSON.SSN-SRC-CD = "SSA";
        AIN30P9-U01-PROC();

  /* ****************** WI 24622:WNMLS:2003-04-01 START ********************/
        if (sysVar.sqlData.sqlcode == 0)
          AIN30P9-TRIG-MMIS();
        end
  /* ****************** WI 24622:WNMLS:2003-04-01 END **********************/

      else
        H2-ALTERNATE-SSN.ALT-SSN = AIN30W.WS-PREV-SSN;
        H2-ALTERNATE-SSN.UPI = AIN30W.WS-PREV-UPI;
        AIN30P9-READ-S05();
        if (sysVar.sqlData.sqlcode == 0)
          if (H2-ALTERNATE-SSN.VRFN-FG == "V")
          else
            H2-ALTERNATE-SSN.VRFN-FG = AIN30W.WS-CHECK-SSN-CD;
            H2-ALTERNATE-SSN.VRFN-SRC = "SSA";
            AIN30P9-U02-PROC();
          end
        end
      end
    end
  end
end // end AIN30P9-PROC-UPD


// MAIN PROC. XFER CNTL TO PROC
Function AIN30P9-PROCESS()
  /* RESTRUCTURED DUE TO PTR 4782*/
  /* BEGIN*/
  /*  */
  if (SR-QSIF-REC.SVES-INPUT-SSN == AIN30W.WS-PREV-SSN || 
  AIN30W.WS-FIRST-TIME-FLAG == "T")
    AIN30W.WS-FIRST-TIME-FLAG = "F";
    AIN30P9-PROC-DATA();
    AIN30P9-PROC-REP();
  else
    AIN30P9-PROC-UPD();

    AIN30W.WS-NOMADS-VERIF-CODE = " ";
    AIN30W.WS-CHECK-SSN-CD = " ";

    AIN30P9-PROC-DATA();
    AIN30P9-PROC-REP();
  end
  /*  */
  /* WI23728 CHANGE# 4/4 START ==> WS-CURRENT-UPI, WS-PREV-UPI & WS-PREV-SSN*/
  /* UPDATED IN AIN30P9-READ-SIF*/
  /*  */
  AIN30W.WS-PREV-UPI = AIN30W.WS-CURRENT-UPI;
  /* MOVE SR-QSIF-REC.SVES-UPI TO AIN30W.WS-PREV-UPI;*/
  /* WI23728 CHANGE# 4/4 END*/
  AIN30W.WS-PREV-SSN = SR-QSIF-REC.SVES-INPUT-SSN;
  AIN30W.WS-PREV-REC-STAT = SR-QSIF-REC.SVES-PERSON-NR;
  /*  */
  /* PTR 4782 END*/
end // end AIN30P9-PROCESS


// Obtain IVA Case Memb/ NCP Flag
Function AIN30P9-READ-S01()
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30P9-READ-S01";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-PERSON";
  /*  */
  try
    get H2-PERSON singleRow
      with #sql{
        select MODFR, MID_NM, FRST_NM, LST_NM, SSN, NCP_FG, CST_FG,
            CHD_FG, IVA_CASE_MBR_FG, SSN_VRFN_STS_CD
        from TWNPERSON T1
        WHERE UPI = :UPI
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into MODFR, MID-NM, FRST-NM, LST-NM, SSN, NCP-FG, CST-FG,
           CHD-FG, IVA-CASE-MBR-FG, SSN-VRFN-STS-CD ;
  end
  /*  */
  VDBCOMMON.UNRF = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN30P9-READ-S01


// Obtain Case Details
Function AIN30P9-READ-S03()
  /*  */
  VDBCONTROL.UPROC-NM = "AIN30P9-READ-S03";
  VDBCONTROL.UPROC-OBJ = "H2-3-CMH-FAC-SPT";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-3-CMH-FAC-SPT";
  try
    get H2-3-CMH-FAC-SPT
      with #sql{
        select DISTINCT
            T1.UPI,
            T2.OFC_CD,
            T2.CASLD_ID,
            T3.NOMADS_USRID
        from TWNCASE_MEMBER_HST T1,
             TWNFAM_CASELD_CASE T2,
             TWNSUP_UNT_POS_HST T3
        WHERE     T1.UPI = :UPI
        AND       T1.PRD_BEG_DT <= :PRD-BEG-DT
        AND       T1.PRD_END_DT >= :PRD-END-DT
        AND       T1.ICI = T2.ICI
        AND       T2.OFC_CD =T3.OFC_CD
        AND       T2.PRGM_OFC_TYPE = T3.PRGM_OFC_TYPE
        AND       T2.SPRVS_UNIT = T3.SPRVS_UNIT
        AND       T2.PSN_NMB = T3.PSN_NMB
        AND       T3.ASMNT_BEG_DT BETWEEN '0001-01-01' AND :ASMNT-BEG-DT
        AND       T3.ASMNT_END_DT BETWEEN :ASMNT-BEG-DT AND '9999-12-31'
        ORDER BY 1
        FOR FETCH ONLY
      }
      into UPI,
           OFC-CD,
           CASLD-ID,
           NOMADS-USRID ;
  end
  /*  */
end // end AIN30P9-READ-S03


// Obtain Case Details
Function AIN30P9-READ-S03X()
  /*  */
  WDB00PI();

  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30P9-READ-S03X";
  VDBCONTROL.UPROC-OBJ = "H2-3-CMH-FAC-SPT";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCOMMON.USQLREC = "H2-3-CMH-FAC-SPT";
  try
    open AIN30P9-READ-S03X_RSI01
      with #sql{
        select T1.ICI,
            T2.OFC_CD,
            T2.CASLD_ID,
            T3.NOMADS_USRID
        from TWNCASE_MEMBER_HST T1,
             TWNFAM_CASELD_CASE T2,
             TWNSUP_UNT_POS_HST T3
        WHERE     T1.UPI = :UPI
        AND       T1.PRD_BEG_DT <= :PRD-BEG-DT
        AND       T1.PRD_END_DT >= :PRD-END-DT
        AND       T1.ICI = T2.ICI
        AND       T2.OFC_CD =T3.OFC_CD
        AND       T2.PRGM_OFC_TYPE = T3.PRGM_OFC_TYPE
        AND       T2.SPRVS_UNIT = T3.SPRVS_UNIT
        AND       T2.PSN_NMB = T3.PSN_NMB
        AND       T3.ASMNT_BEG_DT BETWEEN '0001-01-01' AND :ASMNT-BEG-DT
        AND       T3.ASMNT_END_DT BETWEEN :ASMNT-BEG-DT AND '9999-12-31'
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into ICI,
           OFC-CD,
           CASLD-ID,
           NOMADS-USRID
      for H2-3-CMH-FAC-SPT ;
  end
  /*  */
  REPP9-SQL-CHKERR();
  /*  */
end // end AIN30P9-READ-S03X


// Obtain Alt SSN Verfn  Flag
Function AIN30P9-READ-S05()
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30P9-READ-S05";
  VDBCONTROL.UPROC-OBJ = "H2-ALTERNATE-SSN";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-ALTERNATE-SSN";
  /*  */
  try
    get H2-ALTERNATE-SSN singleRow
      with #sql{
        select VRFN_FG
        from twnalternate_ssn T1
        WHERE UPI = :UPI
        AND ALT_SSN = :ALT-SSN
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into VRFN-FG ;
  end
  /*  */
  VDBCOMMON.UNRF = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
end // end AIN30P9-READ-S05


// INQUIRE NMDT SSN VRFDTL
Function AIN30P9-READ-S06()
  VDBCONTROL.UPROC-NM = "AIN30P9-READ-S06";
  VDBCONTROL.UPROC-OBJ = "H2-NMDT-SSN-VRFDTL";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-NMDT-SSN-VRFDTL";
  /*  */
  try
    get H2-NMDT-SSN-VRFDTL singleRow
      with #sql{
        select SSN_STS
        from twnnmdt_ssn_vrfdtl T1
        WHERE UPI = :UPI
        AND TEMP_SSN = :TEMP-SSN
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into SSN-STS ;
  end
  /*  */
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
end // end AIN30P9-READ-S06


// Obtain IVA Case Memb/ NCP Flag
Function AIN30P9-READ-S07()
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30P9-READ-S07";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-PERSON";
  /*  */
  try
    get H2-PERSON singleRow
      with #sql{
        select COUNT(*)
        from TWNPERSON T1
        WHERE UPI = :UPI AND SSN = :SSN
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into WS-RECORD-COUNT ;
  end
  /*  */
  VDBCOMMON.UNRF = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN30P9-READ-S07


// Obtain ICIs FOR UPI
Function AIN30P9-READ-S08()
  /*  */
  WDB00PI();

  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30P9-READ-S08";
  VDBCONTROL.UPROC-OBJ = "H3-CASE-MEMBER-HST";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCOMMON.USQLREC = "H3-CASE-MEMBER-HST";
  try
    open AIN30P9-READ-S08_RSI01
      with #sql{
        select T1.ICI
        from TWNCASE_MEMBER_HST T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE
          T1.UPI = :UPI
          AND T1.PRD_BEG_DT <= :PRD-BEG-DT
          AND T1.PRD_END_DT >= :PRD-END-DT
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into ICI
      for H3-CASE-MEMBER-HST ;
  end
  /*  */
  REPP9-SQL-CHKERR();
  /*  */
end // end AIN30P9-READ-S08


// Read SVES Input File
Function AIN30P9-READ-SIF()
  /* CHANGE HISTORY*/
  /* -------------------------------------------*/
  /* DATE           PGR          DESCRIPTION*/
  /* -------------------------------------------*/
  /* 01-27-95      TBST184        CREATION*/

  AIN30W.WS-VERIFY-FG = "N";
  /*  */
  try
    get next SR-QSIF-REC ;
  end
  /*  */
  if (SR-QSIF-REC is ioError && SR-QSIF-REC not endOfFile)
    VDBCONTROL.UPROC-NM = "AIN30P9-READ-SIF";
    VDBCONTROL.UPROC-OBJ = "SR-QSIF-REC";
    VDBCONTROL.UPROC-OPT = "SCAN";
    AIN30W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AIN30W.WS-ERR-LAST-FOUR;
    VMESSAGE.UMSGINS[2] = "AIN30A";

    VDBCONTROL.UMSQLCODE = 0;

    /* the following conditions are added to move the corresponding*/
    /* error message*/
    /*  */
    if (SR-QSIF-REC is fileNotAvailable)
      VDBCONTROL.UEZESQRRM = "FILE IS NOT AVAILABLE";
    else
      if (SR-QSIF-REC is fileNotFound)
        VDBCONTROL.UEZESQRRM = "FILE NOT FOUND";
      else
        if (SR-QSIF-REC is invalidFormat)
          VDBCONTROL.UEZESQRRM = "FILE FORMAT MISMATCH";
        end /* ** end check for format mismatch*/
      end /* ** end check for file not found*/
    end /* ** end check for file not available*/
    WCM00P2-TO-CEP01A();
  end

  AIN30W.WS-CASE-NUMBER = SR-QSIF-REC.SVES-CASE-NUMBER;
  if (AIN30W.WS-SVES-UPI is numeric)
    H2-PERSON.UPI = SR-QSIF-REC.SVES-UPI;
    AIN30Q97-S97();
    if (sysVar.sqlData.sqlcode == 0)
    /*  */
    /* WI23728 CHANGE# 1 OF 4 START ==> RETAIN NUMIDENT'S UPI & SSN*/
    /*  */
      AIN30W.WS-CURRENT-UPI = SR-QSIF-REC.SVES-UPI;
    /* WI23728 CHANGE# 1 OF 4 *** END ****/
      AIN30W.WS-VERIFY-FG = "Y";
    end
  else
    SR-QSIF-REC.SVES-UPI = 0;
  end

  if (AIN30W.WS-VERIFY-FG == "N")
    set H2-PERSON empty;
    H2-PERSON.SSN = SR-QSIF-REC.SVES-INPUT-SSN;
    AIN30Q98-S98();
    if (sysVar.sqlData.sqlcode == 0)
    /*  */
    /* WI23728 CHANGE# 2 OF 4 START ==> RETAIN TWNPERSON'S UPI & SSN*/
    /*  */
      AIN30W.WS-CURRENT-UPI = H2-PERSON.UPI;
    /* WI23728 CHANGE# 2 OF 4 *** END ****/
      SR-QSIF-REC.SVES-UPI = H2-PERSON.UPI;
      AIN30W.WS-VERIFY-FG = "Y";
    else
      set H2-ALTERNATE-SSN empty;
      H2-ALTERNATE-SSN.ALT-SSN = SR-QSIF-REC.SVES-INPUT-SSN;
      AIN30Q99-S99();
      if (sysVar.sqlData.sqlcode == 0)
    /*  */
    /* WI23728 CHANGE# 3 OF 4 START ==> RETAIN TWNALTERNATE'S UPI & SSN*/
    /*  */
        AIN30W.WS-CURRENT-UPI = H2-ALTERNATE-SSN.UPI;
    /* WI23728 CHANGE# 3 OF 4 *** END ****/
        SR-QSIF-REC.SVES-UPI = H2-ALTERNATE-SSN.UPI;
        AIN30W.WS-VERIFY-FG = "Y";
      end
    end
  end
  /*  */
end // end AIN30P9-READ-SIF


// Read table DCC & SPT
Function AIN30P9-S01-PROC()
  /*  */
  VDBCOMMON.USQLREC = "H2-2-DCC-SPT";
  VDBCONTROL.UPROC-OBJ = "H2-2-DCC-SPT";
  VDBCONTROL.UPROC-NM = "AIN30P9-S01-PROC";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  /*  */
  try
    get H2-2-DCC-SPT
      with #sql{
        select T2.OFC_CD, T2.NOMADS_USRID
        from twnivd_caseld_case T1,
             twnsup_unt_pos_hst T2
        WHERE T1.UPI = :UPI AND
              T1.CASE_SUFX = 'A' AND
              T1.OFC_CD = T2.OFC_CD AND
              T1.PRGM_OFC_TYPE = T2.PRGM_OFC_TYPE AND
              T1.SPRVS_UNIT = T2.SPRVS_UNIT AND
              T1.PSN_NMB = T2.PSN_NMB AND
              T1.CASELD_IND = 'N' AND
              T2.ASMNT_BEG_DT BETWEEN
                     '0001-01-01' AND :AIN30W.WS-PROCESS-DATE AND
              T2.ASMNT_END_DT BETWEEN
                     :AIN30W.WS-PROCESS-DATE  AND '9999-12-31'
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into OFC-CD, NOMADS-USRID ;
  end
  /*  */
end // end AIN30P9-S01-PROC


// SCAN AIN30P9-READ-S03X
Function AIN30P9-SCAN-S03X()

  VDBCONTROL.UACCTYP = "R";
  VDBCONTROL.UPROC-OBJ = "H2-3-CMH-FAC-SPT";
  VDBCONTROL.UPROC-NM = "AIN30P9-SCAN-S03X";
  VDBCONTROL.UPROC-OPT = "SCAN"; /* OC-NM;*/
  VDBCOMMON.USQLREC = "H2-3-CMH-FAC-SPT";
  try
    get next H2-3-CMH-FAC-SPT ;
  end
  /*  */
  REPP9-SQL-CHKERR();
end // end AIN30P9-SCAN-S03X


// SCAN AIN30P9-READ-S08
Function AIN30P9-SCAN-S08()

  VDBCONTROL.UACCTYP = "R";
  VDBCONTROL.UPROC-OBJ = "H3-CASE-MEMBER-HST";
  VDBCONTROL.UPROC-NM = "AIN30P9-SCAN-S08";
  VDBCONTROL.UPROC-OPT = "SCAN"; /* OC-NM;*/
  VDBCOMMON.USQLREC = "H3-CASE-MEMBER-HST";
  try
    get next H3-CASE-MEMBER-HST ;
  end
  /*  */
  REPP9-SQL-CHKERR();
end // end AIN30P9-SCAN-S08


// INQUIRE DCC SPT
Function AIN30P9-SETINQ-S04()
  /*  */
  VDBCONTROL.UPROC-NM = "AIN30P9-SETINQ-S04";
  VDBCONTROL.UPROC-OBJ = "H2-2-DCC-SPT";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  VDBCOMMON.USQLREC = "H2-2-DCC-SPT";
  /*  */
  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  try
    get H2-2-DCC-SPT
      with #sql{
        select T1.OFC_CD,
            T1.CASLD_ID,
            T2.NOMADS_USRID
        from twnivd_caseld_case T1,
             twnsup_unt_pos_hst T2
        WHERE       T1.UPI = :UPI
        AND         T1.CASLD_EFF_DT = (SELECT MAX(T1.CASLD_EFF_DT)
                                          FROM  TWNIVD_CASELD_CASE T1
                                            WHERE T1.UPI = :UPI
                                       )
        AND         T1.PRGM_OFC_TYPE = T2.PRGM_OFC_TYPE
         --
         -----------------CHANGES DUE TO PTR # 3100 BEGIN----------------*/
         --
         -- AND  (:AIN30W.WS-PROC-DT BETWEEN T2.ASMNT_BEG_DT AND T2.ASMNT_END_DT)
        AND  T2.ASMNT_BEG_DT BETWEEN '0001-01-01' AND :AIN30W.WS-PROC-DT
        AND  T2.ASMNT_END_DT BETWEEN :AIN30W.WS-PROC-DT AND '9999-12-31'
         --
         -----------------CHANGES DUE TO PTR # 3100 END------------------*/
         --
        AND         T1.OFC_CD = T2.OFC_CD
        AND         T1.SPRVS_UNIT = T2.SPRVS_UNIT
        AND         T1.PSN_NMB = T2.PSN_NMB
        AND         T1.CASELD_IND = :CASELD-IND
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into OFC-CD,
           CASLD-ID,
           NOMADS-USRID ;
  end
  /*  */
end // end AIN30P9-SETINQ-S04


// LUW for DB Access PTR8934
Function AIN30P9-TCONIOL1()
  /* -------------------------------------------------------*/
  /* This process serves as the Logical Unit of Work (LUW)*/
  /* for the Database application.*/
  /* -------------------------------------------------------*/
  /* Perform standard database application initialization*/
  WDB00PI();
  /*  */
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  /*  */
  /* Perform process to insert data*/
  AIN30P9-TCONIOP1();
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
end // end AIN30P9-TCONIOL1


// Control Retrieve Data PTR8934
Function AIN30P9-TCONIOP1()
  /* -----------------------------------------------------*/
  /* This process Inserts data into the TWNIVD-CONTACTS*/
  /* table for the Database application.*/
  /* ------------------------------------------------------*/
  /* Perform process to insert data*/
  AIN30P9-TCONIOQ1();
end // end AIN30P9-TCONIOP1


// ADD TWNIVD-CONTACTS PTR8934
Function AIN30P9-TCONIOQ1()
  /* ------------------------------------------------------*/
  /* This process performs an ADD on the TWNIVD-CONTACTS*/
  /* table to write a row of data.*/
  /* ------------------------------------------------------*/
  /*  */
  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CONTACTS";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CONTACTS";
  VDBCONTROL.UPROC-NM = "AIN30P9-TCONIOQ1";
  VDBCONTROL.UPROC-OPT = "ADD";
  /*  */
  /* CALL DATEAPP GDW,VDBCONTROL,VMESSAGE (NOMAPS;*/
  try
    add H2-IVD-CONTACTS
      with #sql{
        insert into TWNIVD_CONTACTS
        (UPI, CASE_SUFX, CRTD_TS, CASE_FUNC_AREA, CNTCT_TYPE, CNTCT_SRC,
            CASE_SPCFC_IND, WRKR_ID, CNTCT_TXT)
        values (:UPI, :CASE-SUFX, :CRTD-TS, :CASE-FUNC-AREA, :CNTCT-TYPE,
            :CNTCT-SRC, :CASE-SPCFC-IND, :WRKR-ID, :CNTCT-TXT)
      } ;
  end
  /*  */
  /* Increment count of rows inserted*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
end // end AIN30P9-TCONIOQ1


// POPULATE MMIS & CALL AIF25A
Function AIN30P9-TRIG-MMIS()
  /* ****************** WI 24622:WNMLS:2003-04-01 *************************/
  /* POPULATE AIF25W1 WITH DATA FOR MMIS TRIGGER TABLE, TWNMMIS_TRIGGER.*/
  /* CALL AIF25A TO POPULATE TABLE.*/
  /* H2-PERSON.UPI IS USED IN THIS PROCESS, BECAUSE IT IS USED BY*/
  /* AIN30P9-U01-PROC, THE TRIGGERING UPDATE.*/
  /* **********************************************************************/

  set H3-CASE-MEMBER-HST empty;
  H3-CASE-MEMBER-HST.UPI = H2-PERSON.UPI;
  H3-CASE-MEMBER-HST.PRD-BEG-DT = AIN30W.WS-PROC-DT;
  H3-CASE-MEMBER-HST.PRD-END-DT = AIN30W.WS-PROC-DT;

  AIN30P9-READ-S08();
  if (sysVar.sqlData.sqlcode == 0)
    AIN30P9-SCAN-S08();

    while (sysVar.sqlData.sqlcode == 0)

      set AIF25W1 empty;

      AIF25W1.CALLING-PRGM = "AIN30A";
      AIF25W1.ICI = H3-CASE-MEMBER-HST.ICI;
      AIF25W1.UPI = H2-PERSON.UPI;
      AIF25W1.DEMO-FLAG = "Y";

      call "AIF25A" (VDBCONTROL, VMESSAGE, AIF25W1);

      if (VDBCONTROL.URC > 104)
        WCM00P2-TO-CEP01A();
      end

      AIN30P9-SCAN-S08();

    end /* WHILE*/
  end /* IF*/
end // end AIN30P9-TRIG-MMIS


// Update SSN Verified Status
Function AIN30P9-U01-PROC()
  /* CHANGE HISTORY*/
  /* --------------------------------------------*/
  /* DATE           PGR          DESCRIPTION*/
  /* -------------------------------------------*/
  /* 01-27-95      TBST184        CREATION*/
  /*  */
  VDBCONTROL.UPROC-NM = "AIN30P9-U01-PROC";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCONTROL.UPROC-OPT = "SQLEXEC";
  VDBCOMMON.USQLREC = "H2-PERSON";
  /*  */
  try
    execute update 
      #sql{
        UPDATE
          TWNPERSON T1
        SET
           SSN_VRFN_STS_CD = :SSN-VRFN-STS-CD,
           SSN_SRC_CD      = :SSN-SRC-CD
        WHERE UPI = :UPI
      }
      for H2-PERSON ; // model = update
  end
  /*  */
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  /*  */
end // end AIN30P9-U01-PROC


// Update Alt SSN Verifn Status
Function AIN30P9-U02-PROC()
  /*  */
  VDBCONTROL.UPROC-NM = "AIN30P9-U02-PROC";
  VDBCONTROL.UPROC-OBJ = "H2-ALTERNATE-SSN";
  VDBCONTROL.UPROC-OPT = "SQLEXEC";
  VDBCOMMON.USQLREC = "H2-ALTERNATE-SSN";
  /*  */
  /* ---------------CHANGES DUE TO PTR # 3100 BEGIN----------------*/
  /*  */
  H2-ALTERNATE-SSN.VRFN-DT = AIN30W.WS-PROC-DT;
  /*  */
  /* ---------------CHANGES DUE TO PTR # 3100 END------------------*/
  /*  */
  try
    execute update 
      #sql{
        UPDATE
          TWNALTERNATE_SSN T1
        SET
          VRFN_SRC= :VRFN-SRC,
          VRFN_FG = :VRFN-FG,
         --
         -----------------CHANGES DUE TO PTR # 3100 BEGIN----------------*/
         --
          VRFN_DT = :VRFN-DT
         --
         -----------------CHANGES DUE TO PTR # 3100 END------------------*/
         --
        WHERE   UPI=:UPI
        AND     ALT_SSN=:ALT-SSN
      }
      for H2-ALTERNATE-SSN ; // model = update
  end
  /*  */
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  /*  */
end // end AIN30P9-U02-PROC


// Update info-rcvd-dt field
Function AIN30P9-U04-PROC()
  /* CHANGE HISTORY*/
  /* --------------------------------------------*/
  /* DATE           PGR          DESCRIPTION*/
  /* -------------------------------------------*/
  /* 01-27-95      TBST184        CREATION*/
  /*  */
  VDBCONTROL.UPROC-NM = "AIN30P9-U09-PROC";
  VDBCONTROL.UPROC-OBJ = "H2-LCTE-ACTVY";
  VDBCONTROL.UPROC-OPT = "SQLEXEC";
  VDBCOMMON.USQLREC = "H2-LCTE-ACTVY";
  /*  */
  try
    execute update 
      #sql{
        UPDATE
          TWNLCTE_ACTVY T1
        SET
           INFO_RCVD_DT = :AIN30W.WS-PROC-DT
        WHERE     UPI = :UPI
              AND CASE_SUFX = :CASE-SUFX
              AND RQST_SQ_NMB = :RQST-SQ-NMB
              AND LOC_SRC_CD = :LOC-SRC-CD
              AND INFO_RQSTD_TS > '0001-01-02-00.00.00.000001'
              AND RQST_SENT_DT <> '0001-01-01'
              AND INFO_RCVD_DT = '0001-01-01'
      }
      for H2-LCTE-ACTVY ; // model = update
  end
  /*  */
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
  /*  */
  /*  */
  VDBCOMMON.UNRF = "N";
  VDBCOMMON.UDUP = "Y";
  /*  */
  /* Perform DBM error processing*/
  WDB00PE-SQLERR();
  /*  */
end // end AIN30P9-U04-PROC


// LOGIC TO UPD/INS ALT SSN DATA
Function AIN30P9-UP-ALT-SSN()
  /*  */
  /* --------------PTR# 2444 CHANGE BEGIN March 14, 1996--------------*/
  /*  */
  /* fcr triggers are created here if alt-ssn is added per wi13442*/
  AIN30W.WS-ALT-SSN-FLG = "N";
  WS-INDEX = 1;
  /*  */
  while (WS-INDEX <= 5
   && SR-QSIF-REC.SVES-VERIFIED-SSN[WS-INDEX] != " ")
    /*  */
    H2-ALTERNATE-SSN.ALT-SSN = SR-QSIF-REC.SVES-VERIFIED-SSN[WS-INDEX];
    H2-ALTERNATE-SSN.UPI = SR-QSIF-REC.SVES-UPI;
    /*  */
    AIN30P9-READ-S05();
    /*  */
    if (H2-ALTERNATE-SSN not ioError)
      H2-ALTERNATE-SSN.VRFN-FG = "V";
      H2-ALTERNATE-SSN.VRFN-SRC = "SSA";
      /*  */
      AIN30P9-U02-PROC();
      /*  */
    else
      H2-PERSON.SSN = SR-QSIF-REC.SVES-VERIFIED-SSN[WS-INDEX];
      H2-PERSON.UPI = SR-QSIF-REC.SVES-UPI;
      AIN30W.WS-RECORD-COUNT = 0;
      AIN30P9-READ-S07();
      /*  */
      if (AIN30W.WS-RECORD-COUNT > 0)
  /* WI 18910 begin*/
        set H2-PERSON empty;
        H2-PERSON.UPI = SR-QSIF-REC.SVES-UPI;
        AIN30P9-READ-S01();
        if (sysVar.sqlData.sqlcode == 0)
          if (H2-PERSON.SSN-VRFN-STS-CD == "V")
          else
            H2-PERSON.UPI = SR-QSIF-REC.SVES-UPI;
            H2-PERSON.SSN-VRFN-STS-CD = "V";
  /* MOVE 'SSA' TO H2-PERSON.SSN-VRFN-STS-CD;*/
            H2-PERSON.SSN-SRC-CD = "SSA";
  /* WI 18910 end*/
            AIN30P9-U01-PROC();

  /* ****************** WI 24622:WNMLS:2003-04-01 START ********************/
            if (sysVar.sqlData.sqlcode == 0)
              AIN30P9-TRIG-MMIS();
            end
  /* ****************** WI 24622:WNMLS:2003-04-01 END **********************/

          end
        end
        /*  */
      else
        H2-ALTERNATE-SSN.VRFN-FG = "V";
        H2-ALTERNATE-SSN.VRFN-SRC = "SSA";
        H2-ALTERNATE-SSN.VRFN-DT = AIN30W.WS-PROC-DT;
        /*  */
        AIN30P9-I03-PROC();
        AIN30W.WS-ALT-SSN-FLG = "Y";
        /*  */
      end
    end
    WS-INDEX = WS-INDEX + 1;
  end /* While*/
end // end AIN30P9-UP-ALT-SSN


// UPDATE LOCATE TABLE
Function AIN30P9-UPD-LOCATE()
  /*  */
  /* --------------------------ptr 7148 begin------------------------------*/
  /* After NUMIDENT data is processed, the locate activity table should*/
  /* be updated with the date information was received from NUMIDENT.*/

  set H2-LCTE-ACTVY empty;

  H2-LCTE-ACTVY.UPI = SR-QSIF-REC.SVES-UPI;
  H2-LCTE-ACTVY.CASE-SUFX = "A";
  H2-LCTE-ACTVY.LOC-SRC-CD = "NUMID";
  H2-LCTE-ACTVY.RQST-SQ-NMB = 1;
  H2-LCTE-ACTVY.INFO-RCVD-DT = AIN30W.WS-PROC-DT;
  AIN30P9-U04-PROC();
  if (VDBCONTROL.URC >= 104)
    WCM00P2-TO-CEP01A();
  end

  /*  */
end // end AIN30P9-UPD-LOCATE


// UPDARE NUMIDENT SSN VERF TABLE
Function AIN30P9-UPD-U03()
  VDBCONTROL.UPROC-NM = "AIN30P9-UPD-U03";
  VDBCONTROL.UPROC-OBJ = "H2-NMDT-SSN-VRFDTL";
  VDBCONTROL.UPROC-OPT = "SQLEXEC";
  VDBCOMMON.USQLREC = "H2-NMDT-SSN-VRFDTL";
  /*  */
  /* ---------------CHANGES DUE TO PTR # 3100 BEGIN----------------*/
  /*  */
  H2-NMDT-SSN-VRFDTL.PROCESS-DT = AIN30W.WS-PROC-DT;
  /*  */
  /* ---------------CHANGES DUE TO PTR # 3100 END------------------*/
  /*  */
  try
    execute update 
      #sql{
        UPDATE
          TWNNMDT_SSN_VRFDTL T1
        SET
          SSN_STS    = :SSN-STS,
         --
         -----------------CHANGES DUE TO PTR # 3100 BEGIN----------------*/
         --
          PROCESS_DT = :PROCESS-DT
         --
         -----------------CHANGES DUE TO PTR # 3100 END------------------*/
         --
        WHERE UPI = :UPI
        AND TEMP_SSN = :TEMP-SSN
      }
      for H2-NMDT-SSN-VRFDTL ; // model = update
  end
  /*  */
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWW = VDBCONTROL.UROWW + 1;
  end
end // end AIN30P9-UPD-U03


// Create Verified Names
Function AIN30P9-WVN-PROC()
  /* -------------------------------------------------------*/
  /* Create Verified Name Records.                         */
  /* -------------------------------------------------------*/
  /*  */
  set H2-VRFD-NAMES empty;
  H2-VRFD-NAMES.ALT-SSN = SR-QSIF-REC.SVES-INPUT-SSN;
  H2-VRFD-NAMES.AKA-LST-NM = SR-QSIF-REC.SVES-INPUT-SURNAME;
  H2-VRFD-NAMES.AKA-MID-NM = SR-QSIF-REC.SVES-INPUT-INITIAL;
  H2-VRFD-NAMES.AKA-FRST-NM = SR-QSIF-REC.SVES-INPUT-GIVEN-NAME;
  H2-VRFD-NAMES.UPI = SR-QSIF-REC.SVES-UPI;
  H2-VRFD-NAMES.AKA-MODFR = " ";
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "W";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  AIN30P9-I02-PROC();
  /*  */
  VDBCOMMON.UDUP = "Y";
  /*  */
  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
end // end AIN30P9-WVN-PROC


// GET CASE SUFIX
Function AIN30Q02-S02()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "AIN30Q02-S02";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  /*  */
  try
    open AIN30Q02-S02_RSI01
      with #sql{
        select NCP_UPI, CASE_SUFX
        from TWNIVD_CASE T1
        WHERE
          NCP_UPI          = :NCP-UPI
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into NCP-UPI, CASE-SUFX
      for H2-IVD-CASE ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q02-S02


// GET CASE SUFIX
Function AIN30Q02-S02-SCAN()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "AIN30Q02-S02-SCAN";
  VDBCONTROL.UPROC-OPT = "SCAN";
  /*  */
  try
    get next H2-IVD-CASE ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q02-S02-SCAN


// GET CASE SUFIX
Function AIN30Q03-S03()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "AIN30Q02-S02";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  /*  */
  try
    open AIN30Q03-S03_RSI01
      with #sql{
        select NCP_UPI, CASE_SUFX
        from TWNIVD_CASE T1
        WHERE
          CST_UPI          = :CST-UPI
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into NCP-UPI, CASE-SUFX
      for H2-IVD-CASE ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q03-S03


// GET CASE SUFIX
Function AIN30Q03-S03-SCAN()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "AIN30Q02-S02-SCAN";
  VDBCONTROL.UPROC-OPT = "SCAN";
  /*  */
  try
    get next H2-IVD-CASE ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q03-S03-SCAN


// GET CASE SUFIX
Function AIN30Q04-S04()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-NM = "AIN30Q03-S03";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  /*  */
  try
    open AIN30Q04-S04_RSI01
      with #sql{
        select NCP_UPI, CASE_SUFX
        from TWNIVD_CASE_CHILD T1
        WHERE
          CHD_UPI     = :CHD-UPI
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into NCP-UPI, CASE-SUFX
      for H2-IVD-CASE-CHILD ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end

  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q04-S04


// GET CASE SUFIX
Function AIN30Q04-S04-SCAN()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-NM = "AIN30Q03-S03-SCAN";
  VDBCONTROL.UPROC-OPT = "SCAN";
  /*  */
  try
    get next H2-IVD-CASE-CHILD ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q04-S04-SCAN


// GET ncp_upi from cst_upi
Function AIN30Q05-IDC()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "AIN30Q05-IDC";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  /*  */
  try
    open AIN30Q05-IDC_RSI01
      with #sql{
        select NCP_UPI, case_sufx
        from TWNIVD_CASE T1
        WHERE
          CST_UPI          = :CST-UPI
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into NCP-UPI, CASE-SUFX
      for H2-IVD-CASE ;
  end
  /*  */
  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q05-IDC


// GET CASE SUFIX
Function AIN30Q05-IDC-SCAN()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE";
  VDBCONTROL.UPROC-NM = "AIN30Q05-IDC-SCAN";
  VDBCONTROL.UPROC-OPT = "SCAN";
  /*  */
  try
    get next H2-IVD-CASE ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q05-IDC-SCAN


// GET ncp_upi from chd_upi
Function AIN30Q06-DCC()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-NM = "AIN30Q06-DCC";
  VDBCONTROL.UPROC-OPT = "SETINQ";
  /*  */
  try
    open AIN30Q06-DCC_RSI01
      with #sql{
        select NCP_UPI, CASE_SUFX
        from TWNIVD_CASE_CHILD T1
        where
              chd_upi = :CHD-UPI
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }      
      into NCP-UPI, CASE-SUFX
      for H2-IVD-CASE-CHILD ;
  end
  /*  */
  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q06-DCC


// GET NCP-UPI FROM CHILD UPI
Function AIN30Q06-DCC-SCAN()
  /*  */
  /* NOMADS BEGIN*/
  /*  */
  /* -----------------------------------------------------------*/
  /* Change History*/
  /* ==============*/
  /* DATE        NAME        DESCRIPTION*/
  /* ----        -----       ----------*/
  /* 28 Apr 1998   WNMAA       CREATION*/
  /* -----------------------------------------------------------*/
  /*  */
  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";

  /* Move name of SQL row record used to common record*/
  VDBCOMMON.USQLREC = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-OBJ = "H2-IVD-CASE-CHILD";
  VDBCONTROL.UPROC-NM = "AIN30Q06-DCC-SCAN";
  VDBCONTROL.UPROC-OPT = "SCAN";
  /*  */
  try
    get next H2-IVD-CASE-CHILD ;
  end
  /*  */
  /* Increment count of rows retrieved*/
  if (sysVar.sqlData.sqlcode == 0)
    VDBCONTROL.UROWR = VDBCONTROL.UROWR + 1;
  end
  VDBCOMMON.UNRF = "Y";
  VDBCOMMON.UDUP = "N";

  WDB00PE-SQLERR();

  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end

  /*  */
  /* NOMADS BEGIN*/
  /*  */
end // end AIN30Q06-DCC-SCAN


// inquiry
Function AIN30Q97-S97()

  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30Q01-S97";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-PERSON";
  try
    get H2-PERSON singleRow
      with #sql{
        select SSN
        from TWNPERSON T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE UPI = :UPI
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into SSN ;
  end

  VDBCOMMON.UNRF = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN30Q97-S97


// inquiry
Function AIN30Q98-S98()

  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30Q01-S01";
  VDBCONTROL.UPROC-OBJ = "H2-PERSON";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-PERSON";
  try
    get H2-PERSON singleRow
      with #sql{
        select UPI
        from TWNPERSON T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE SSN = :SSN
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into UPI ;
  end

  VDBCOMMON.UNRF = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
end // end AIN30Q98-S98


// INQUIRY
Function AIN30Q99-S99()

  WDB00PI();
  VDBCONTROL.UACCTYP = "R";
  VDBCOMMON.UAPPLNAM = "AIN30A";
  VDBCONTROL.UPROC-NM = "AIN30Q02-S02";
  VDBCONTROL.UPROC-OBJ = "H2-ALTERNATE-SSN";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCOMMON.USQLREC = "H2-ALTERNATE-SSN";
  try
    get H2-ALTERNATE-SSN
      with #sql{
        select UPI, ALT_SSN, VRFN_SRC, VRFN_FG, VRFN_DT
        from twnalternate_ssn T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE ALT_SSN = :ALT-SSN
        FOR FETCH ONLY
         --** INSERT ORDER BY CLAUSE HERE **
      }
      into UPI, ALT-SSN, VRFN-SRC, VRFN-FG, VRFN-DT ;
  end

  VDBCOMMON.UNRF = "Y";
  /*  */
  WDB00PE-SQLERR();
  /*  */
  if (VDBCONTROL.URC > 104)
    WCM00P2-TO-CEP01A();
  end
  /*  */
end // end AIN30Q99-S99


Record AIN30W type basicRecord
  10 WS-VERIFICATION-CODE char(1) ; 
  10 WS-UPI char(9) ; 
  10 WS-INDEX num(2) ; 
  10 WS-OFC-CD char(2) ; 
  10 WS-DOB char(6) ; 
    15 WS-DOB-MO char(2) ; 
    15 WS-DOB-DY char(2) ; 
    15 WS-DOB-YR char(2) ; 
  10 WS-DOB-CC char(4) ; 
    15 WS-DOB-CC1 char(2) ; 
    15 WS-DOB-YY1 char(2) ; 
  10 WS-DATE2 char(8) ; 
    15 WS-DATE2-MM2 char(2) ; 
    15 WS-DATE2-DD2 char(2) ; 
    15 WS-DATE2-YY2 char(4) ; 
  10 WS-EXIT-SSN-PROC char(1) ; 
  10 WS-ERR-CD char(8) ; 
    15 WS-ERR-FIRST-FOUR char(4) ; 
    15 WS-ERR-LAST-FOUR char(4) ; 
  10 WS-PROCESS-TS char(26) ; 
    15 WS-PROCESS-DATE char(10) ; 
    15 WS-PROCESS-TIME char(16) ; 
  10 WS-PROC-DT char(10) ; 
    20 WS-PROC-DT-CC char(2) ; 
    20 WS-PROC-DT-YY char(2) ; 
    20 WS-PROC-DT-SEP-1 char(1) ; 
    20 WS-PROC-DT-MM char(2) ; 
    20 WS-PROC-DT-SEP-2 char(1) ; 
    20 WS-PROC-DT-DD char(2) ; 
  10 WS-CURR-DT char(10) ; 
    15 WS-CURR-DT-CCYY num(4) ; 
      20 WS-CURR-DT-CC num(2) ; 
      20 WS-CURR-DT-YY num(2) ; 
    15 WS-CURR-DT-SEP-1 char(1) ; 
    15 WS-CURR-DT-MM num(2) ; 
    15 WS-CURR-DT-SEP-2 char(1) ; 
    15 WS-CURR-DT-DD num(2) ; 
  10 WS-PROC-DT-F char(8) ; 
    20 WS-PROC-DT-F-MM char(2) ; 
    20 WS-PROC-DT-F-DD char(2) ; 
    20 WS-PROC-DT-F-CC char(2) ; 
    20 WS-PROC-DT-F-YY char(2) ; 
  10 WS-PROBLEM-CODE-DESC char(20) ; 
    20 WS-PROBLEM-DESC char(18) ; 
    20 WS-PROBLEM-CODE char(2) ; 
  10 WS-NOMADS-VERIF-CODE char(1) ; 
  10 WS-CHECK-SSN-CD char(1) ; 
  10 WS-KNOWN-TO-NOMADS-CODE char(1) ; 
  10 WS-UPDATE-FLAG char(1) ; 
  10 WS-FIRST-TIME-FLAG char(1) ; 
  10 WS-PREV-SSN char(9) ; 
  10 WS-PREV-UPI int ; 
  10 WS-PREV-REC-STAT char(2) ; 
  10 WS-RECORD-COUNT smallint ; 
  10 WS-ALT-SSN-FLG char(1) ; 
  10 WS-NCP-UPI num(9) ; 
  10 WS-NCP-SUFFIX char(1) ; 
  10 WS-VERIFY-UPI char(9) ; 
  10 WS-VERIFY-FG char(1) ; 
  10 WS-NUMIDENT-VERF-3-DT char(45) ; 
    20 WS-NUMIDENT-DATE char(10) ; 
      25 WS-NUMIDENT-DATE-MM char(2) ; 
      25 * char(1) ; 
      25 WS-NUMIDENT-DATE-DD char(2) ; 
      25 * char(1) ; 
      25 WS-NUMIDENT-DATE-YY char(4) ; 
    20 WS-NUMIDENT-FILLER char(35) ; 
  10 WS-CASE-NUMBER char(10) ; 
    15 * char(1) ; 
    15 WS-SVES-UPI char(9) ; 
  10 WS-CRE-ALERT-FG char(1) ; 
  10 WS-CLOG-TS char(26) ; 
    15 WS-CLOG-DATE char(10) ; 
    15 WS-CLOG-TIME char(16) ; 
  10 WS-CLOG-ACTVY-DESC char(60) ; 
    15 WS-CLOG-ACTVY-TEXT char(41) ; 
    15 WS-CLOG-ACTVY-DOD char(10) ; 
      20 WS-CLOG-ACTVY-DOD-MM char(2) ; 
      20 WS-CLOG-ACTVY-DOD-FIL1 char(1) ; 
      20 WS-CLOG-ACTVY-DOD-DD char(2) ; 
      20 WS-CLOG-ACTVY-DOD-FIL2 char(1) ; 
      20 WS-CLOG-ACTVY-DOD-CCYY char(4) ; 
    15 * char(9) ; 
  10 WS-SVES-VERFD-DATA char(45) ; 
    15 WS-SVES-DOD char(10) ; 
    15 * char(35) ; 
  10 WS-CURRENT-UPI int ; 
  10 WS-SSN char(9) ; 
    15 WS-SSN-3 char(3) ; 
    15 WS-SSN-2 char(2) ; 
    15 WS-SSN-4 char(4) ; 
  10 WS-CLOG-ACTVY-SSN-DESC char(60) ; 
    15 WS-CLOG-ACTVY-SSN-TEXT char(34) ; 
    15 WS-CLOG-ACTVY-SSN char(11) ; 
      20 WS-CLOG-ACTVY-SSN-3 char(3) ; 
      20 WS-CLOG-ACTVY-SSN-FIL1 char(1) ; 
      20 WS-CLOG-ACTVY-SSN-2 char(2) ; 
      20 WS-CLOG-ACTVY-SSN-FIL2 char(1) ; 
      20 WS-CLOG-ACTVY-SSN-4 char(4) ; 
    15 * char(15) ; 
end // end AIN30W


Record AIN30W1 type basicRecord
  10 PCAL-ALERT char(37) ; 
    15 PCAL-ALERT-CD num(6) ; 
    15 PCAL-CASE-ID char(10) ; 
      20 PCAL-UPI num(9) ; 
      20 PCAL-SUFX char(1) ; 
    15 PCAL-ALERT-ACTION char(1) ; 
    15 PCAL-DISPL-DT char(10) ; 
    15 PCAL-DUE-DT char(10) ; 
end // end AIN30W1


Record AIN30W2 type basicRecord
  10 WS-CNTR num(3) ; 
  10 WS-DATE char(10) ; 
    15 WS-DATE-MM char(2) ; 
    15 WS-DATE-FILL1 char(1) ; 
    15 WS-DATE-DD char(2) ; 
    15 WS-DATE-FILL2 char(1) ; 
    15 WS-DATE-CCYY char(4) ; 
  10 WS-CONCAT-STR char(285) ; 
    15 WS-CONCAT-TXT char(65) ; 
    15 WS-TRACK-INFO char(220) ; 
      20 WS-VAR3 char(6) ; 
      20 WS-VAR4 char(22) ; 
      20 WS-VAR5 char(17) ; 
      20 WS-VAR6 char(17) ; 
      20 WS-VAR7 char(3) ; 
      20 WS-VAR1 char(7) ; 
      20 WS-VAR2 char(9) ; 
      20 WS-VAR8 char(25) ; 
      20 WS-VAR9 char(1) ; 
      20 WS-VAR10 char(31) ; 
      20 WS-ALTER-SSN char(11) [5] ; 
        25 WS-ALT-SSN char(9) ; 
        25 WS-COMMA char(2) ; 
      20 WS-VAR11 char(17) ; 
      20 WS-DOB char(10) ; 
  10 WS-CNTCT-TXT char(285) ; 
    15 WS-CNTCT-TXT-1 char(100) ; 
    15 WS-CNTCT-TXT-2 char(100) ; 
    15 WS-CNTCT-TXT-3 char(85) ; 
end // end AIN30W2