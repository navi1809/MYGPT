package gov.illinois.access.business.services;

import gov.illinois.access.business.customEntities.APP_ABS_PRNT_Cust_Collection;
import gov.illinois.access.business.customEntities.INDIVIDUAL_Custom_Cargo;
import gov.illinois.access.business.customEntities.INDIVIDUAL_Custom_Collection;
import gov.illinois.access.business.entities.APP_AR_LG_CNTC_Cargo;
import gov.illinois.access.business.entities.APP_AUTH_REP_Cargo;
import gov.illinois.access.business.entities.APP_AUTH_REP_Collection;
import gov.illinois.access.business.entities.APP_FILE_HELP_Cargo;
import gov.illinois.access.business.entities.APP_FILE_HELP_Collection;
import gov.illinois.access.business.entities.APP_HSHL_RLT_Cargo;
import gov.illinois.access.business.entities.APP_HSHL_RLT_Collection;
import gov.illinois.access.business.entities.APP_INDV_Cargo;
import gov.illinois.access.business.entities.APP_INDV_Collection;
import gov.illinois.access.business.entities.APP_IN_ABSNP_Collection;
import gov.illinois.access.business.entities.APP_IN_DC_E_Collection;
import gov.illinois.access.business.entities.APP_IN_EMPL_A_WAGE_Cargo;
import gov.illinois.access.business.entities.APP_IN_EMPL_A_WAGE_Collection;
import gov.illinois.access.business.entities.APP_IN_EMPL_Cargo;
import gov.illinois.access.business.entities.APP_IN_EMPL_Collection;
import gov.illinois.access.business.entities.APP_IN_LQD_ASET_Cargo;
import gov.illinois.access.business.entities.APP_IN_LQD_ASET_Collection;
import gov.illinois.access.business.entities.APP_IN_MEDICAL_COVERAGE_Collection;
import gov.illinois.access.business.entities.APP_IN_MEDICAL_DETAIL_Collection;
import gov.illinois.access.business.entities.APP_IN_MEDICAL_DISABILITY_Collection;
import gov.illinois.access.business.entities.APP_IN_MI_CHILD_EXPENSE_Collection;
import gov.illinois.access.business.entities.APP_IN_PRFL_Cargo;
import gov.illinois.access.business.entities.APP_IN_PRFL_Collection;
import gov.illinois.access.business.entities.APP_IN_SELFE_Cargo;
import gov.illinois.access.business.entities.APP_IN_SELFE_Collection;
import gov.illinois.access.business.entities.APP_IN_SHLTC_Cargo;
import gov.illinois.access.business.entities.APP_IN_SHLTC_Collection;
import gov.illinois.access.business.entities.APP_IN_SUPPORT_DETAIL_Cargo;
import gov.illinois.access.business.entities.APP_IN_SUPPORT_DETAIL_Collection;
import gov.illinois.access.business.entities.APP_IN_UEI_Cargo;
import gov.illinois.access.business.entities.APP_IN_UEI_Collection;
import gov.illinois.access.business.entities.APP_NURSING_ADDRESS_Cargo;
import gov.illinois.access.business.entities.APP_NURSING_ADDRESS_Collection;
import gov.illinois.access.business.entities.APP_PGM_RQST_Cargo;
import gov.illinois.access.business.entities.APP_PGM_RQST_Collection;
import gov.illinois.access.business.entities.APP_PRFL_Cargo;
import gov.illinois.access.business.entities.APP_PRFL_Collection;
import gov.illinois.access.business.entities.APP_PRIR_SRV_Cargo;
import gov.illinois.access.business.entities.APP_PRIR_SRV_Collection;
import gov.illinois.access.business.entities.APP_RETRO_RQST_Cargo;
import gov.illinois.access.business.entities.APP_RETRO_RQST_Collection;
import gov.illinois.access.business.entities.APP_RGST_Cargo;
import gov.illinois.access.business.entities.APP_RGST_Collection;
import gov.illinois.access.business.entities.APP_RQST_Cargo;
import gov.illinois.access.business.entities.APP_RQST_Collection;
import gov.illinois.access.business.rules.ABAbsentParentBO;
import gov.illinois.access.business.rules.ABCdcBo;
import gov.illinois.access.business.rules.ABDependentCareBO;
import gov.illinois.access.business.rules.ABEmploymentBO;
import gov.illinois.access.business.rules.ABHouseHoldMemberBO;
import gov.illinois.access.business.rules.ABHouseholdMembersSummaryBO;
import gov.illinois.access.business.rules.ABHousingBillsBO;
import gov.illinois.access.business.rules.ABHousingBillsQuestionsBO;
import gov.illinois.access.business.rules.ABHpeAttestationBO;
import gov.illinois.access.business.rules.ABJobIncomeBO;
import gov.illinois.access.business.rules.ABMAHealthyKidsBO;
import gov.illinois.access.business.rules.ABMedicalCoverageDetailsBO;
import gov.illinois.access.business.rules.ABMedicalDetailsBO;
import gov.illinois.access.business.rules.ABMedicalDisabilityApplicationDetailsBO;
import gov.illinois.access.business.rules.ABMedicareBO;
import gov.illinois.access.business.rules.ABNonEnergySerBO;
import gov.illinois.access.business.rules.ABOtherBillsSummaryBO;
import gov.illinois.access.business.rules.ABOtherIncomeBO;
import gov.illinois.access.business.rules.ABPriorityServiceBO;
import gov.illinois.access.business.rules.ABProgramInformationBO;
import gov.illinois.access.business.rules.ABRegistrationBO;
import gov.illinois.access.business.rules.ABRegistrationSummaryBO;
import gov.illinois.access.business.rules.ABRelevanceBO;
import gov.illinois.access.business.rules.ABSERAssistanceBO;
import gov.illinois.access.business.rules.ABSERBurialDetailsBO;
import gov.illinois.access.business.rules.assets.LiquidAssetBO;
import gov.illinois.access.business.rules.benefitcase.ContactInformationBO;
import gov.illinois.access.business.rules.help.HelpWithApplicationBO;
import gov.illinois.access.business.utility.StringUtils;
import gov.illinois.access.business.validation.afb.details.ABCONValidator;
import gov.illinois.access.business.validation.afb.types.ABHWAValidator;
import gov.illinois.access.data.db2.impl.APP_HPE_Cargo;
import gov.illinois.access.data.db2.impl.APP_HPE_Collection;
import gov.illinois.access.management.applications.IAppProfileManager;
import gov.illinois.access.management.applications.IApplicationManager;
import gov.illinois.access.management.constants.AppConstants;
import gov.illinois.access.management.individuals.PeopleHandler;
import gov.illinois.access.management.util.IndivTypeSeqBean;
import gov.illinois.access.navigation.AFBNavigationBO;
import gov.illinois.access.presentation.entities.listview.ABHelpWithApplicationSummaryListView;
import gov.illinois.access.presentation.entities.listview.ABNursingRegistrationSummaryListView;
import gov.illinois.access.presentation.entities.listview.ABRegistrationSummaryListview;
import gov.illinois.framework.business.entities.FwTransaction;
import gov.illinois.framework.business.entities.ICargoCollection;
import gov.illinois.framework.driver.FwPageManager;
import gov.illinois.framework.driver.IPage;
import gov.illinois.framework.exceptions.FwException;
import gov.illinois.framework.exceptions.FwWrappedException;
import gov.illinois.framework.management.configuration.FwConfigurationManager;
import gov.illinois.framework.management.constants.FwConstants;
import gov.illinois.framework.management.logging.ILog;
import gov.illinois.framework.management.messages.FwMessageList;
import gov.illinois.framework.management.references.IReferenceConstants;
import gov.illinois.framework.management.references.IReferenceTableData;
import gov.illinois.framework.management.references.IReferenceTableManager;
import gov.illinois.framework.management.references.ReferenceTableManager;
import gov.illinois.framework.management.util.FwDataCriteria;
import gov.illinois.framework.presentation.entities.listview.IListviewFormatter;
import gov.illinois.access.management.applications.ApplicationManager;

import java.util.ArrayList;
import java.util.Arrays;
import java.util.HashMap;
import java.util.Iterator;
import java.util.List;
import java.util.Map;
/**
 * RegistrationEJBBean - SessionFacade Object skeleton auto generated -
 * Architecture Team
 * 
 * @Creation Date :Wed Dec 21 18:39:43 CST 2005 Modified By: Modified on:
 */
public class RegistrationEJBBean extends AppSessionBean {

	/**
	 * Constructor
	 */
	public RegistrationEJBBean() {
	}

	/**
	 * Comment here
	 */
	public void getWelcome(FwTransaction txnBean) throws javax.ejb.EJBException {

		try {

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getWelcome");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getWelcome", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void storeWelcome(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeWelcome");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeWelcome", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void getWelcomeBack(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {
			Map session = txnBean.getSession();
			Map pageCollection = txnBean.getPageCollection();
			ABRegistrationSummaryBO regSummaryBO = new ABRegistrationSummaryBO();
			ABHpeAttestationBO hpeAttestBo = new ABHpeAttestationBO();
			APP_RQST_Cargo appRqstCargo = null;
			String appNum = (String) session.get(AppConstants.APP_NUMBER);
			APP_RQST_Collection appRqstColl = regSummaryBO
					.loadRequestSummary(appNum);
			if (appRqstColl != null && !appRqstColl.isEmpty()) {
				appRqstCargo = appRqstColl.getCargo(0);
			}
			APP_HPE_Cargo appHpeCargo = new APP_HPE_Cargo();
			APP_HPE_Collection appHpeColl = hpeAttestBo
					.loadAppHpeSummary(appNum);
			if (appHpeColl != null && !appHpeColl.isEmpty()) {
				appHpeCargo = appHpeColl.getCargo(0);
			}
			pageCollection.put("APP_HPE_COLLECTION", appHpeColl);
			pageCollection.put("APP_RQST_Collecion", appRqstColl);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getWelcomeBack");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getWelcomeBack", e);
			throw fe;
		}
	}

	/**
	 * Comment herer
	 */
	public void storeWelcomeBack(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeWelcomeBack");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeWelcomeBack", e);
			throw fe;
		}
	}

	/**
	 * This method load the registration summary page
	 * 
	 * @param txnBean
	 *            gov.wisconsin.framework.business.entities.FwTransaction
	 * @author govinpr
	 */
	public void getRegistrationSummary(FwTransaction txnBean) throws javax.ejb.EJBException {
		try {
			Map session = txnBean.getSession();
			// Map request = txnBean.getRequest();
			Map pageCollection = txnBean.getPageCollection();
			ABHouseHoldMemberBO houseHoldBo = new ABHouseHoldMemberBO();
			// Getting appNum from session
			String appNumber = (String) session.get(AppConstants.APP_NUMBER);
			Map httpSessionMap = (Map) session.get(FwConstants.HTTP_SESSION);
			String languageCd = (String) httpSessionMap
					.get(AppConstants.LANGUAGE);
			ABRegistrationSummaryBO registrationSummaryBO = new ABRegistrationSummaryBO();
			ABSERAssistanceBO assistanceBO = new ABSERAssistanceBO();
			// Added by Uma for Nursing Facility BRGUS00287916
			ABMedicalDetailsBO detailsBO = new ABMedicalDetailsBO();
			String shortFormType = detailsBO.checkMAShortFormType(appNumber);
			if (shortFormType != null && shortFormType.length() > 0 && shortFormType.equalsIgnoreCase(AppConstants.MA_NURSING_FACILITY)) {
				APP_NURSING_ADDRESS_Collection addressColl = new APP_NURSING_ADDRESS_Collection();
				APP_NURSING_ADDRESS_Cargo addressCargo = new APP_NURSING_ADDRESS_Cargo();
				addressColl = detailsBO.loadSpouseAddress(appNumber,
						AppConstants.MA_NURSING_FACILITY);
				if (addressColl != null && !addressColl.isEmpty()) {
					for (int i = 0; i < addressColl.size(); i++) {
						addressCargo = addressColl.getCargo(i);
						if (addressCargo.getAddr_type_cd().equalsIgnoreCase(
								shortFormType)) {
							break;
						}
					}
					ABNursingRegistrationSummaryListView nursingListviewbean = new ABNursingRegistrationSummaryListView();
					nursingListviewbean.setLanguage(languageCd);
					nursingListviewbean.setDisplayData(addressColl);
					nursingListviewbean.setName("ABNursingRegistrationSummaryListView_ListView");
					nursingListviewbean.setPageSize(10);
					boolean sortableCols[] = new boolean[6];
					nursingListviewbean.setSortableColumns(sortableCols);
					int[] dataType = { IListviewFormatter.stringCol, IListviewFormatter.stringCol, IListviewFormatter.stringCol, IListviewFormatter.stringCol, IListviewFormatter.stringCol, IListviewFormatter.stringCol };
					nursingListviewbean.setColDataType(dataType);
					pageCollection.put( "ABNursingRegistrationSummaryListView_ListView", nursingListviewbean);
				}
			} else {// End BRGUS00287916
				// Calling business object to load the application registration
				// information
				APP_RGST_Collection appRgstCollection = registrationSummaryBO.loadRegistrationSummary(appNumber);
				// call the set DisplayData
				ABRegistrationSummaryListview listviewbean = new ABRegistrationSummaryListview();
				listviewbean.setLanguage(languageCd);
				listviewbean.setDisplayData(appRgstCollection);
				// uniquely name the listview
				listviewbean.setName("ABRegistrationSummaryListview_ListView");
				// this oen for the paging
				listviewbean.setPageSize(10);
				// define the columns to be sorted on takes a boolean array
				boolean sortableCols[] = new boolean[7];
				listviewbean.setSortableColumns(sortableCols);
				// specify the type of the columns in listview
				int[] dataType = { IListviewFormatter.stringCol,
						IListviewFormatter.stringCol,
						IListviewFormatter.stringCol,
						IListviewFormatter.stringCol,
						IListviewFormatter.stringCol,
						IListviewFormatter.stringCol,
						IListviewFormatter.stringCol };
				listviewbean.setColDataType(dataType);
				pageCollection.put("ABRegistrationSummaryListview_ListView", listviewbean);
			}

			// For Help With Application Summary -- starts
			// call BO to get AR/LG contact infotmation
			// Commented by Rashmi to retrieve information in APP_AUTH_REP
			// APP_AR_LG_CNTC_Collection cntcInfoColl = new
			// APP_AR_LG_CNTC_Collection();
			APP_AUTH_REP_Collection cntcInfoColl = new APP_AUTH_REP_Collection();
			String helpOptionSelected = "0";
			String[] options = { "3", "4", "5" }; // 3->Auth Rep ; 4->Legal
													// Guardian ; 5->Power of
													// Attorney
			List optionTypeList = Arrays.asList(options);
			helpOptionSelected = registrationSummaryBO.loadHelpWithApplSummary(appNumber);
			if (optionTypeList.contains(helpOptionSelected)) {
				cntcInfoColl = registrationSummaryBO.getContactInfoSummary(appNumber);
			}

			// by sushma
			/*
			 * String helpOptionSelected = "3"; cntcInfoColl =
			 * registrationSummaryBO.getContactInfoSummary(appNumber);
			 */
			// by sushma
			ABHelpWithApplicationSummaryListView helpListView = new ABHelpWithApplicationSummaryListView();
			helpListView.setLanguage(languageCd);
			helpListView.setOptionSelected(helpOptionSelected);
			helpListView.setDisplayData(cntcInfoColl);
			helpListView.setName("ABRegistrationSummaryListview_HelpDetails");

			int[] dataTypes = { IListviewFormatter.stringCol,
					IListviewFormatter.stringCol, IListviewFormatter.stringCol,
					IListviewFormatter.stringCol };
			helpListView.setColDataType(dataTypes);
			pageCollection.put("ABRegistrationSummaryListview_HelpDetails",
					helpListView);
			session.put("INFO_TYPE", helpOptionSelected);
			// For Help With Application Summary -- ends

			// Loading program section
			short[] programKeyArray = (short[]) session
					.get(FwConstants.AFB_PROGRAM_KEY);
			// APP_PGM_RQST_Collection appPgmRqstCollection =
			// registrationSummaryBO.loadProgramSummary(appNumber);
			APP_PGM_RQST_Collection appPgmRqstCollection = new APP_PGM_RQST_Collection();
			APP_PGM_RQST_Cargo appPgmRqstCargo = new APP_PGM_RQST_Cargo();
			appPgmRqstCargo.setApp_num(appNumber);
			appPgmRqstCargo.setFma_rqst_ind(String.valueOf(programKeyArray[0]));
			appPgmRqstCargo.setFpw_rqst_ind(String.valueOf(programKeyArray[1]));
			appPgmRqstCargo.setFs_rqst_ind(String.valueOf(programKeyArray[2]));
			appPgmRqstCargo.setHc_rqst_ind(String.valueOf(programKeyArray[3]));
			appPgmRqstCargo.setSer_rqst_ind(String.valueOf(programKeyArray[5]));
			appPgmRqstCargo.setSer_burial_request_ind(String
					.valueOf(programKeyArray[6]));
			appPgmRqstCargo.setMedicare_rqst_ind(String
					.valueOf(programKeyArray[7]));
			appPgmRqstCargo.setFpp_rqst_ind(String.valueOf(programKeyArray[8]));
			if (AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo
					.getSer_rqst_ind())) {
				APP_PGM_RQST_Collection appPgmRqstCollforEdi = assistanceBO
						.getAppPgmRqstDeatils(appNumber);
				APP_PGM_RQST_Cargo appPrmRqstCargoForEdi = appPgmRqstCollforEdi
						.getCargo(0);
				appPgmRqstCargo.setEdi_acceptable_sw(appPrmRqstCargoForEdi
						.getEdi_acceptable_sw());
			}
			appPgmRqstCollection.add(appPgmRqstCargo);

			pageCollection.put("APP_PGM_RQST_Collection", appPgmRqstCollection);

			// Calling business object to load application request information
			APP_RQST_Collection appRqstCollection = registrationSummaryBO.loadRequestSummary(appNumber);
			boolean disbleCount = registrationSummaryBO.disableCount(appNumber);
			pageCollection.put("DISABLE_COUNT", disbleCount);
			

			//Added by smejiaibarra (ILIES-172363)
			Map beforeColl = (Map) session.get(FwConstants.BEFORE_COLLECTION);
			PeopleHandler peopleHandler = (PeopleHandler)session.get(AppConstants.INDIV_MASTER_HANDLER);
			String peopleInYourHome = AppConstants.EMPTY_STRING;
			//Modified by Priyanka Baddam for ILIES-282237 : Added Null fix.
			if(peopleHandler == null){
				peopleHandler=new PeopleHandler();
				peopleHandler.loadPeopleHandler(appNumber);
				 session.put(AppConstants.INDIV_MASTER_HANDLER,peopleHandler);
				}
			//ILIES-282237 changes end
			int hhmemberscount = houseHoldBo.loadHouseholdCount(appNumber);
			//ILIES-311795 starts here
			APP_RQST_Cargo appRqstCargo = houseHoldBo.getAppRqstForHH(appNumber);
			if(hhmemberscount > 0 && appNumber != null){
				//If one or more individuals was removed from the application
				INDIVIDUAL_Custom_Collection indvCustColltemp = peopleHandler.getInAndOutOfHomeIndividuals(appNumber);				
				peopleInYourHome = houseHoldBo.loadMaxSeqNum(appNumber) == hhmemberscount ? Integer.toString(indvCustColltemp.size()) : Integer.toString(hhmemberscount);
				
			}else{peopleInYourHome = "SEL";}
			if(null!=appRqstCargo && null!=appRqstCargo.getHshl_indv_in_cnt() && Integer.parseInt(appRqstCargo.getHshl_indv_in_cnt()) > 0){
			session.put(FwConstants.PEOPLEINYOURHOME, appRqstCargo.getHshl_indv_in_cnt());
			}
			else{
			session.put(FwConstants.PEOPLEINYOURHOME, peopleInYourHome);
			}
			//Changes for ILIES-314994 - START 
			if(null!=appRqstCargo && null!=appRqstCargo.getHshl_indv_out_cnt() && Integer.parseInt(appRqstCargo.getHshl_indv_out_cnt()) >= 0){
			session.put("taxFile" ,appRqstCargo.getHshl_indv_out_cnt());
			}
			if(null!=appRqstCargo && null!=appRqstCargo.getTax_claim_dep_cnt() && Integer.parseInt(appRqstCargo.getTax_claim_dep_cnt()) >= 0){
			//Changes for ILIES-314994 - END 
			session.put("taxDependent", appRqstCargo.getTax_claim_dep_cnt());
			} // ILIES-311795 ends here
			pageCollection.put(FwConstants.MA_BACK_DTD_MTS, dateRoutine.getBackDatedMonths(fwDate.getDate()));
			pageCollection.put(FwConstants.APP_RQST_COLLECTION, appRqstCollection);

			String providerInterface = FwConfigurationManager.getInstance()
					.getEnvironmentProperty(AppConstants.PROVIDER_INTERFACE_SW);
			pageCollection.put(FwConstants.PROVIDER_INTERFACE, providerInterface);
			// Putting page collection into session
			session.put(FwConstants.BEFORE_COLLECTION, pageCollection);

			ABRegistrationBO regBo = new ABRegistrationBO();
			//Added by Priyanka Baddam for ILIES-282237 : Removing the values from session.
			regBo.clearSessionOfWarningMsgOnSaveAndExitFunc(session);
			 //ILIES-282237 changes end here

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID(FwConstants.GET_REGISTRATION_SUMMARY);
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			throw createFwException(this.getClass().getName(),
					FwConstants.GET_REGISTRATION_SUMMARY, e);
		}
	}

	/**
	 * This method stores the registration summary page
	 * 
	 * @param txnBean
	 *            gov.wisconsin.framework.business.entities.FwTransaction
	 * @author govinpr
	 */
	public void storeRegistrationSummary(FwTransaction txnBean)
			throws javax.ejb.EJBException {


		try {
			Map session = txnBean.getSession();
			Map request = txnBean.getRequest();
			Map pageCollection = txnBean.getPageCollection();
			ABPriorityServiceBO abPriSerBO = new ABPriorityServiceBO();
			String appNumber = (String) session.get(AppConstants.APP_NUMBER);
			boolean maSelectedFlag = false;
			boolean maOnlyAfterFlag = false;
			ABRegistrationBO regBo = new ABRegistrationBO();//Added by Priyanka Baddam for ILIES-282237.

			Map beforeCollection = (Map) session
					.get(FwConstants.BEFORE_COLLECTION);
			//smejiaibarra (ILIES-172363): ABRGS was deleted, we don't have in this point a new pageCollection.
			pageCollection = beforeCollection;
			// Assingning before cargo collection from before collection
			APP_PGM_RQST_Collection appPgmRqstBeforeColl = (APP_PGM_RQST_Collection) beforeCollection
					.get("APP_PGM_RQST_Collection");
			APP_PGM_RQST_Cargo appPgmRqstBeforeCargo = appPgmRqstBeforeColl
					.getCargo(0);

			if (appPgmRqstBeforeCargo.getFma_rqst_ind().equals(
					AppConstants.PROGRAM_SELECTED)) {
				maSelectedFlag = true;
			}

			APP_RQST_Collection appRqstBeforeColl = (APP_RQST_Collection) beforeCollection
					.get(FwConstants.APP_RQST_COLLECTION);
			APP_RQST_Cargo appRqstBeforeCargo = appRqstBeforeColl.getCargo(0);

			// Getting after cargo, collection from page collection
			APP_PGM_RQST_Collection appPgmRqstAfterColl = (APP_PGM_RQST_Collection) pageCollection
					.get("APP_PGM_RQST_Collection");
			APP_PGM_RQST_Cargo appPgmRqstAfterCargo = appPgmRqstAfterColl
					.getCargo(0);
			appPgmRqstAfterCargo.setApp_num(appPgmRqstBeforeCargo.getApp_num());

			APP_RQST_Collection appRqstAfterColl = (APP_RQST_Collection) pageCollection
					.get(FwConstants.APP_RQST_COLLECTION);
			APP_RQST_Cargo appRqstAfterCargo = appRqstAfterColl.getCargo(0);

			// Initializing driver components
			int[] driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			String currentPageId = (String) request
					.get(FwConstants.CURRENT_PAGE_ID);
			int pageStatus = driverManager.getAFBStatus(FwConstants.AFB_DRIVER,
					(String) request.get(FwConstants.CURRENT_PAGE_ID),
					driverArray);

			// Setting "0", if program not selected
			if (appPgmRqstAfterCargo.getFma_rqst_ind() == null) {
				appPgmRqstAfterCargo
						.setFma_rqst_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			if (appPgmRqstAfterCargo.getFpw_rqst_ind() == null) {
				appPgmRqstAfterCargo
						.setFpw_rqst_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			if (appPgmRqstAfterCargo.getFs_rqst_ind() == null) {
				appPgmRqstAfterCargo
						.setFs_rqst_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			if (appPgmRqstAfterCargo.getSer_rqst_ind() == null) {
				appPgmRqstAfterCargo
						.setSer_rqst_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			// mvanlenten - added for IL
			if (appPgmRqstAfterCargo.getMedicare_rqst_ind() == null) {
				appPgmRqstAfterCargo
						.setMedicare_rqst_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			// Rotanak added
			if (appPgmRqstAfterCargo.getHc_rqst_ind() == null) {
				appPgmRqstAfterCargo
						.setHc_rqst_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			if (appPgmRqstAfterCargo.getSer_burial_request_ind() == null) {
				appPgmRqstAfterCargo
						.setSer_burial_request_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			if (appPgmRqstAfterCargo.getFpp_rqst_ind() == null || "N".equalsIgnoreCase(appPgmRqstAfterCargo.getFpp_rqst_ind())
				 || "0".equalsIgnoreCase(appPgmRqstAfterCargo.getFpp_rqst_ind()) || "3".equalsIgnoreCase(appPgmRqstAfterCargo.getFpp_rqst_ind())) {
				appPgmRqstAfterCargo.setFpp_rqst_ind(AppConstants.PROGRAM_NOT_SELECTED);
			}
			// end

			boolean setFilingDate = false;
			if (session.containsKey(FwConstants.EST_FILING_DATE_OPTION)
					&& session.get(FwConstants.EST_FILING_DATE_OPTION).equals("30349")) {
				setFilingDate = true;
			}

			// Schedule/Unshedule pages upon Fs selection/deselection
			if (appPgmRqstAfterCargo.getFs_rqst_ind() != null
					&& appPgmRqstAfterCargo.getFs_rqst_ind().charAt(0) == '1') {
				// Making the pages required only, if the FS has been selected
				// in the summary page
				if ((AppConstants.PROGRAM_NOT_SELECTED)
						.equals(appPgmRqstBeforeCargo.getFs_rqst_ind())) {
					appPgmRqstAfterCargo
							.setFs_rqst_ind(AppConstants.PROGRAM_SELECTED);
				}
			} else {
				// Making the pages not required when the FS has been unselected
				// in the summary
				if ((AppConstants.PROGRAM_SELECTED)
						.equals(appPgmRqstBeforeCargo.getFs_rqst_ind())) {
				}
			}
			// Getting instance of BO
			ABRegistrationSummaryBO registrationSummaryBO = new ABRegistrationSummaryBO();

			// before storing the values in the database we need to do the cargo
			// Comparison
			boolean programAddedFlag = false;
			boolean secFlag = false;
			if (!setFilingDate) {
				appPgmRqstAfterCargo = (APP_PGM_RQST_Cargo) isChanged(
						appPgmRqstBeforeCargo, appPgmRqstAfterCargo);
				if (appPgmRqstAfterCargo.isDirty()) {
					// he updated the some information on this page that's why
					// we are updating the information
					if (!appPgmRqstAfterCargo.getFma_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFma_rqst_ind())) {
						if (appPgmRqstAfterCargo.getFma_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					
					//Fpp
					if (appPgmRqstAfterCargo.getFpp_rqst_ind()!=null && !appPgmRqstAfterCargo.getFpp_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFpp_rqst_ind())) {
						if (appPgmRqstAfterCargo.getFpp_rqst_ind()!=null && appPgmRqstAfterCargo.getFpp_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					
					
					if (!appPgmRqstAfterCargo.getFpw_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFpw_rqst_ind())) {
						if (appPgmRqstAfterCargo.getFpw_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					if (!appPgmRqstAfterCargo.getFs_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFs_rqst_ind())) {
						if (appPgmRqstAfterCargo.getFs_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					if (!appPgmRqstAfterCargo.getSer_rqst_ind().equals(
							appPgmRqstBeforeCargo.getSer_rqst_ind())) {
						if (appPgmRqstAfterCargo.getSer_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					// rotanak added
					if (!appPgmRqstAfterCargo.getSer_burial_request_ind()
							.equals(appPgmRqstBeforeCargo
									.getSer_burial_request_ind())) {
						if (appPgmRqstAfterCargo.getSer_burial_request_ind()
								.equals(AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					if (!appPgmRqstAfterCargo.getHc_rqst_ind().equals(
							appPgmRqstBeforeCargo.getHc_rqst_ind())) {
						if (appPgmRqstAfterCargo.getHc_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					if (!appPgmRqstAfterCargo.getMedicare_rqst_ind().equals(
							appPgmRqstBeforeCargo.getMedicare_rqst_ind())) {
						if (appPgmRqstAfterCargo.getMedicare_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							programAddedFlag = true;
						}
					}
					// end
				}

				if (programAddedFlag) {
					if (request.get(FwConstants.INFORMATIONAL_MESSAGE) != null) {
						secFlag = true;
						programAddedFlag = false;
					} else {
						request.put(FwConstants.INFORMATIONAL_MESSAGE, "Y");
					}
				}
			}

			if ((appPgmRqstAfterCargo.getFma_rqst_ind().equals(
					AppConstants.PROGRAM_SELECTED) || appPgmRqstAfterCargo
					.getMedicare_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED))
					// mvanlenten - changed medicare to proper value
					// &&
					// (appPgmRqstAfterCargo.getFpw_rqst_ind().equals(AppConstants.PROGRAM_NOT_SELECTED)
					&& appPgmRqstAfterCargo.getFs_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)
					&& appPgmRqstAfterCargo.getSer_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)
					&& appPgmRqstAfterCargo.getSer_burial_request_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)
					&& appPgmRqstAfterCargo.getHc_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {

				maOnlyAfterFlag = true;
			}

			// Validating the summary page. Removed by smejiaibarra - ILIES-172363
			//registrationSummaryBO.validateRegistrationInfo(
			//Validating for ABPHH (ILIES-172363)
			String peopleSelection = (String) request.get(FwConstants.PEOPLEINYOURHOME);
			String taxSelection = (String) request.get("taxFile");
			int taxCount = taxSelection!=null?Integer.parseInt(taxSelection):0;
			registrationSummaryBO.validatePeopleInHome(peopleSelection,taxSelection);
            //added by Priyanka Baddam for ILIES-282237 cloned the collection
			APP_RQST_Collection appColl = new APP_RQST_Collection();
			APP_RQST_Cargo appCargo = new APP_RQST_Cargo();
			if(null!=peopleSelection && !peopleSelection.trim().equalsIgnoreCase("SEL")){
				String totalCnt = String.valueOf(Integer.parseInt(peopleSelection) + taxCount);
				appCargo.setHshl_indv_ct(totalCnt);
			}
			appColl.add(appCargo);
			//ILIES- 282237 changes end

			if (registrationSummaryBO.hasMessages()) {
				// request.put(FwConstants.MESSAGE_LIST,
				boolean warningMsgFlag = false;
				String reqWarningMsgs = (String) request
						.get(FwConstants.WARNING_MSG_DETAILS);
				warningMsgFlag = this.checkForWarningMesgs(reqWarningMsgs,
						registrationSummaryBO.getMessageList());
				if (!warningMsgFlag) {
					if (secFlag) {
						registrationSummaryBO.addMessageCode(AppConstants.ADD_MESSAGE_CODE_20063);
					}

					request.put(FwConstants.MESSAGE_LIST,
							registrationSummaryBO.getMessageList());
					pageCollection.put(FwConstants.MA_BACK_DTD_MTS,
							beforeCollection.get(FwConstants.MA_BACK_DTD_MTS));
					pageCollection
							.put("ABRegistrationSummaryListview_ListView",
									beforeCollection
											.get("ABRegistrationSummaryListview_ListView"));
					// Added by Uma for Nursing Facility BRGUS00287916
					pageCollection
							.put("ABNursingRegistrationSummaryListView_ListView",
									beforeCollection
											.get("ABNursingRegistrationSummaryListView_ListView"));
					pageCollection.put(FwConstants.APP_RQST_COLLECTION, appRqstAfterColl);
					pageCollection.put("APP_PGM_RQST_Collection",
							appPgmRqstAfterColl);
					String providerInterface = FwConfigurationManager
							.getInstance().getEnvironmentProperty(
									AppConstants.PROVIDER_INTERFACE_SW);
					pageCollection.put(FwConstants.PROVIDER_INTERFACE, providerInterface);
					pageCollection
							.put("ABRegistrationSummaryListview_HelpDetails",
									beforeCollection
											.get("ABRegistrationSummaryListview_HelpDetails"));
					session.put("INFO_TYPE", session.get("INFO_TYPE")
							.toString());
					//Added by Priyanka Baddam for ILIES-282237 : Added collection in the request.
					request.put(FwConstants.PAGE_COLL_0, appColl);
					request.put(FwConstants.NUMBER_OF_COLLECTIONS_FOR_WARNING_MSG, 1);
					return;
				}
			}
			// Deleting household relationship details of the individual
			ABHouseHoldMemberBO houseHoldMemberBo = new ABHouseHoldMemberBO();
			
			//Changes for ILIES-314994 - START 
			int countNum = 0;
			if(peopleSelection != null && !peopleSelection.trim().equalsIgnoreCase("")) {
				countNum = Integer.parseInt(peopleSelection);
			}
			String outOfHouse = (String) request.get("taxFile");
			if(outOfHouse != null && !outOfHouse.trim().equalsIgnoreCase("") && Integer.parseInt(outOfHouse) > 0) {
				countNum += Integer.parseInt(outOfHouse);
			}
			
			APP_INDV_Collection existIndvColl = registrationSummaryBO.existingIndv(appNumber);
			if(existIndvColl != null && !existIndvColl.isEmpty()){
				//Changes for ILIES-314994 - END 	
				if(countNum < existIndvColl.size()){
					APP_INDV_Collection deleteIndvColl = new APP_INDV_Collection();
					for(int i = countNum; i < existIndvColl.size(); i++){
						APP_INDV_Cargo cargo = existIndvColl.getCargo(i);
						cargo.setRlvn_ind("2");
						cargo.setRowAction(FwConstants.ROWACTION_UPDATE);
						deleteIndvColl.addCargo(cargo);
						houseHoldMemberBo.deleteHouseholdRelations(cargo.getIndv_seq_num(),appNumber);
					}
					deleteIndvColl.persist(FwConstants.DAO);
				}
			}
			
			
			
			// Checking for any changes of program selections on the page since
			// load
			appPgmRqstAfterCargo = (APP_PGM_RQST_Cargo) this.isChanged(
					appPgmRqstBeforeCargo, appPgmRqstAfterCargo);


			boolean fsRequested = false;
			boolean fpwRequested = false;
			boolean fmaRequested = false;
			boolean fppRequested = false;
			boolean fsDeRequested = false;
			boolean fpwDeRequested = false;
			boolean fmaDeRequested = false;
			boolean fppDeRequested = false;
			boolean serRequested = false;
			boolean serDeRequested = false;
			boolean medicareRequest = false;
			boolean medicareDeRequest = false;

			boolean serBurialRequested = false;
			boolean serBurialDeRequested = false;
			boolean cashRequested = false;
			boolean cashDeRequested = false;

			boolean appPgmRqstIsDirty = false;
			short[] programKeyArray = (short[]) session.get(FwConstants.AFB_PROGRAM_KEY);
			// Save the program req collection, if there are any changes
			if (appPgmRqstAfterCargo.isDirty()) {
				appPgmRqstIsDirty = true;
				// he updated the some information on this page that's why we
				// are updating the information
				if (!appPgmRqstAfterCargo.getFma_rqst_ind().equals(
						appPgmRqstBeforeCargo.getFma_rqst_ind())) {
					if (appPgmRqstAfterCargo.getFma_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber,
								FwConstants.FMA_INDEX, programKeyArray);
						fmaDeRequested = true;
					} else {
						programManager.addProgram(appNumber,
								FwConstants.FMA_INDEX, programKeyArray);
						fmaRequested = true;
					}
				}
				//FPP
				if (appPgmRqstAfterCargo.getFpp_rqst_ind()!=null && !appPgmRqstAfterCargo.getFpp_rqst_ind().equals(
						appPgmRqstBeforeCargo.getFpp_rqst_ind())) {
					if (appPgmRqstAfterCargo.getFpp_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber,
								FwConstants.FPP_INDEX, programKeyArray);
						fppDeRequested = true;
					} else {
						programManager.addProgram(appNumber,
								FwConstants.FPP_INDEX, programKeyArray);
						fppRequested = true;
					}
				}
				
				
				if (!appPgmRqstAfterCargo.getFpw_rqst_ind().equals(
						appPgmRqstBeforeCargo.getFpw_rqst_ind())) {
					if (appPgmRqstAfterCargo.getFpw_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber,
								FwConstants.FPW_INDEX, programKeyArray);
						fpwDeRequested = true;
					} else {
						programManager.addProgram(appNumber,
								FwConstants.FPW_INDEX, programKeyArray);
						fpwRequested = true;
					}
				}
				if (!appPgmRqstAfterCargo.getFs_rqst_ind().equals(
						appPgmRqstBeforeCargo.getFs_rqst_ind())) {
					if (appPgmRqstAfterCargo.getFs_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber,
								FwConstants.FS_INDEX, programKeyArray);
						fsDeRequested = true;
					} else {
						programManager.addProgram(appNumber,
								FwConstants.FS_INDEX, programKeyArray);
						fsRequested = true;
					}
				}
				if (!appPgmRqstAfterCargo.getSer_rqst_ind().equals(
						appPgmRqstBeforeCargo.getSer_rqst_ind())) {
					if (appPgmRqstAfterCargo.getSer_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber,
								FwConstants.SER_INDEX, programKeyArray);
						serDeRequested = true;
					} else {
						programManager.addProgram(appNumber,
								FwConstants.SER_INDEX, programKeyArray);
						programManager
								.updateAppPgmRqstForSER(appPgmRqstAfterCargo);
						serRequested = true;
					}
				}
				// rotanak added afb expansion
				if (!appPgmRqstAfterCargo.getSer_burial_request_ind().equals(
						appPgmRqstBeforeCargo.getSer_burial_request_ind())) {
					if (appPgmRqstAfterCargo.getSer_burial_request_ind()
							.equals(AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber,
								FwConstants.SER_BURIAL_INDEX, programKeyArray);
						serBurialDeRequested = true;
					} else {
						programManager.addProgram(appNumber,
								FwConstants.SER_BURIAL_INDEX, programKeyArray);
						serBurialRequested = true;
					}
				}
				if (!appPgmRqstAfterCargo.getHc_rqst_ind().equals(
						appPgmRqstBeforeCargo.getHc_rqst_ind())) {
					if (appPgmRqstAfterCargo.getHc_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber,
								FwConstants.HC_INDEX, programKeyArray);
						cashDeRequested = true;
					} else {
						programManager.addProgram(appNumber,
								FwConstants.HC_INDEX, programKeyArray);
						cashRequested = true;
					}
				}
				if (!appPgmRqstAfterCargo.getMedicare_rqst_ind().equals(
						appPgmRqstBeforeCargo.getMedicare_rqst_ind())) {
					short index = 7;
					if (appPgmRqstAfterCargo.getMedicare_rqst_ind().equals(
							AppConstants.PROGRAM_NOT_SELECTED)) {
						programManager.removeProgram(appNumber, index,
								programKeyArray);
						medicareDeRequest = true;
					} else {
						programManager.addProgram(appNumber, index,
								programKeyArray);
						medicareRequest = true;
					}
				}
				// end
			}
			if(appPgmRqstAfterCargo.getFma_rqst_ind().equals(AppConstants.PROGRAM_SELECTED)){
				programManager.addProgram(appNumber,FwConstants.FMA_INDEX,programKeyArray);
				fmaRequested = true;
			}
			if(appPgmRqstAfterCargo.getFpp_rqst_ind()!=null && appPgmRqstAfterCargo.getFpp_rqst_ind().equals(AppConstants.PROGRAM_SELECTED)){
				programManager.addProgram(appNumber,FwConstants.FPP_INDEX,programKeyArray);
				fppRequested = true;
			}
			if(appPgmRqstAfterCargo.getFs_rqst_ind().equals(AppConstants.PROGRAM_SELECTED)){
				programManager.addProgram(appNumber,FwConstants.FS_INDEX,programKeyArray);
				fsRequested = true;
			}
			if(appPgmRqstAfterCargo.getHc_rqst_ind().equals(AppConstants.PROGRAM_SELECTED)){
				programManager.addProgram(appNumber,FwConstants.HC_INDEX,programKeyArray);
				cashRequested = true;
			}
			if(appPgmRqstAfterCargo.getMedicare_rqst_ind().equals(AppConstants.PROGRAM_SELECTED)){
				programManager.addProgram(appNumber,FwConstants.MSP_INDEX,programKeyArray);
				medicareRequest = true;
			}

			if ((appPgmRqstBeforeCargo.getEdi_acceptable_sw() != null)
					&& (!appPgmRqstAfterCargo.getEdi_acceptable_sw().equals(
							appPgmRqstBeforeCargo.getEdi_acceptable_sw()))) {
				programManager.updateAppPgmRqstForSER(appPgmRqstAfterCargo);
			}

			// mvanlenten - adding medicare savings program to flow. Following
			// medical assistance flow(FmaRequested)
			// if app program request is dirty
			if (appPgmRqstIsDirty) {
				if (!setFilingDate) {
					if (fsRequested || fpwRequested || fmaRequested
							|| medicareRequest) {
						String[] requiredPages = { AppConstants.ABHMD, AppConstants.ABHHQ, AppConstants.ABOIQ,
								AppConstants.ABJIQ, AppConstants.ABOEQ, AppConstants.ABHMS, AppConstants.ABJIS, AppConstants.ABOIS,
								AppConstants.ABESM, AppConstants.ABHIS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}
					// Modified by Sai Katta #BRGUS00288688
					if (fsRequested) {
						String[] requiredPages = { AppConstants.ABPPS, AppConstants.ABPSQ, AppConstants.ABHEQ,
								AppConstants.ABHES };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}

					// start of BRGUS00287295 by rotanak
					if (cashRequested) {
						// start of BRGUS00287912 by rotanak
						//Delete ABCBS page per Usability Release 3ILIES-173330
						String[] requiredPages = { AppConstants.ABMAC,AppConstants.ABHEQ,
								AppConstants.ABHES };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}
					// end of BRGUS00287295 by rotanak

					// If only MA is selected then make the short form selection
					// screen required - RobbinsE1
					if ((fmaRequested || maOnlyAfterFlag || medicareRequest)
							&& !(fsRequested || fpwRequested || serRequested
									|| serBurialRequested || cashRequested)) {
						String[] requiredPages = { AppConstants.ABPPS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}// End RobbinsE1

					if (maOnlyAfterFlag) {
						String[] requiredPages = { AppConstants.ABPPS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					} else {
						String[] notRequiredPages = { AppConstants.ABMSF };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notRequiredPages,
								driverArray, appNumber);
					}

					if (fmaRequested) {
						String[] requiredPages = { AppConstants.ABATS,AppConstants.ABMDQ,AppConstants.ABMDS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}

					// start of BRGUS00287295 by rotanak
					if (fpwRequested) {
						String[] requiredPages = { AppConstants.ABCCR, AppConstants.ABCCS, AppConstants.ABHEQ,
								AppConstants.ABHES };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}
					// end of BRGUS00287295 by rotanak

					if (serRequested) {
						String[] requiredPages = { AppConstants.ABSHS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}

					if (fsDeRequested || fpwDeRequested || fmaDeRequested
							|| medicareDeRequest || fppDeRequested) {
						String[] requiredPages = { AppConstants.ABHMD, AppConstants.ABHMS, AppConstants.ABJIS,
								AppConstants.ABOIS, AppConstants.ABATS, AppConstants.ABHES, AppConstants.ABESM, AppConstants.ABHIS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}
					// Modified by Sai Katta #BRGUS00288688
					if (fsDeRequested) {
						// Defect ILIES-125988 , ABHEQ page is required for SNAP
						// and Cash Program
						if (appPgmRqstAfterCargo.getHc_rqst_ind().equals(
								AppConstants.PROGRAM_SELECTED)) {
							String[] notRequiredPages = { AppConstants.ABPSQ, AppConstants.ABSCT,
									AppConstants.ABSCD, AppConstants.ABUCT, AppConstants.ABUCD };
							driverManager.makeAbsoluteNotRequired(
									FwConstants.AFB_DRIVER, notRequiredPages,
									driverArray, appNumber);
						} else {
							String[] notRequiredPages = { AppConstants.ABPSQ, AppConstants.ABHEQ,
									AppConstants.ABSCT, AppConstants.ABSCD, AppConstants.ABUCT, AppConstants.ABUCD, AppConstants.ABHES };
							driverManager.makeAbsoluteNotRequired(
									FwConstants.AFB_DRIVER, notRequiredPages,
									driverArray, appNumber);
						}

						// PCR# 33903 -- Delte Priority Service Details if FS
						// request unselected.
						abPriSerBO.deletePriorityServiceQuestions(appNumber);
					}

					if (serDeRequested) {
						String[] notRequiredPages = { AppConstants.ABSHS, AppConstants.ABPNG,
								AppConstants.ABHNG, AppConstants.ABDFG, AppConstants.ABPHD, AppConstants.ABHDR, AppConstants.ABSPD,
								AppConstants.ABHEL, AppConstants.ABPED, AppConstants.ABEDR, AppConstants.ABFUR, AppConstants.ABSNH,
								AppConstants.ABNTS, AppConstants.ABSRD, AppConstants.ABSOD, AppConstants.ABSUD, AppConstants.ABPTH,
								AppConstants.ABSSS };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notRequiredPages,
								driverArray, appNumber);
						// PCR# 33903 -- Delte Priority Service Details if FS
						// request unselected.
					}
					if (serBurialRequested) {
						String[] requiredPages = { AppConstants.ABBAR, AppConstants.ABSBI, AppConstants.ABSBD,
								AppConstants.ABSDB, AppConstants.ABBRS, AppConstants.ABHEQ, AppConstants.ABHES };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}

					// rotanak added
					if (serBurialDeRequested) {
						String[] notRequiredPages = { AppConstants.ABBAR, AppConstants.ABSBI,
								AppConstants.ABSBD, AppConstants.ABSDB, AppConstants.ABBRS };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notRequiredPages,
								driverArray, appNumber);
					}

					if (fpwDeRequested) {
						String[] requiredPages = { AppConstants.ABCCR, AppConstants.ABCAP, AppConstants.ABCDI,
								AppConstants.ABCCD, AppConstants.ABCCS };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, requiredPages,
								driverArray, appNumber);
						// update and delete
						updateCDCInformation(session, appNumber);
					}
					// start of BRGUS00287912 by rotanak
					if (cashDeRequested) {
						//Delete ABCBS page per Usability Release 3ILIES-173330
						String[] notrequiredPages = { AppConstants.ABWSS, AppConstants.ABMAC };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notrequiredPages,
								driverArray, appNumber);
					}

					boolean cashMedicalSelected = false;
					boolean isMedicalSelected = false;

					if (appPgmRqstAfterCargo.getFma_rqst_ind().equals(
							AppConstants.PROGRAM_SELECTED)
							&& appPgmRqstAfterCargo.getHc_rqst_ind().equals(
									AppConstants.PROGRAM_SELECTED)) {
						cashMedicalSelected = true;
					}
					// ILIES-136018 - ravrajendran ABE - Aged and/or Disabled
					// Application does not queue Asset Screens - Start
					if (appPgmRqstAfterCargo.getFma_rqst_ind().equals(
							AppConstants.PROGRAM_SELECTED)) {
						isMedicalSelected = true;
					}
					short[] programKey = (short[])session.get(FwConstants.AFB_PROGRAM_KEY);
					if(cashMedicalSelected || isMedicalSelected || programManager.isMSPProgramRequested(programKey))
					{
						// ILIES-136018 - ravrajendran ABE - Aged and/or
						// Disabled Application does not queue Asset Screens -
						// END
						String[] reqPages = { AppConstants.ABLAQ, AppConstants.ABLAS, AppConstants.ABOAQ,
								AppConstants.ABOAS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								reqPages, driverArray, appNumber);
					} else {
						String[] notreqPages = {  AppConstants.ABOAQ,
								AppConstants.ABOAS };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notreqPages,
								driverArray, appNumber);
					}
					// ILIES-133651 - ravrajendran - ABE - SSA Edits (State
					// List) - Asset screens - Complete Application Development
					// - END

					// end Added by Uma to unschedule assets when only CDC is
					// selected End
					// PCR 35052 For not to show Empl Strike, Emp details for
					// strike and dependant care detail pages
					int currentpageStatus = driverManager.getAFBStatus(
							FwConstants.AFB_DRIVER, currentPageId, driverArray);
					if (fsDeRequested
							&& currentpageStatus != FwConstants.DRIVER_REQUIRED) {
						String[] notRequiredPages = null;
						boolean onlyStrike = true; // we need to find out if
													// there is only strike
													// selected
						short[] questionsFieldArrayStrike = { IApplicationManager.ON_STRIKE };
						short[] questionsFieldArrayDC = { IApplicationManager.DEPENDENT_CARE };
						APP_IN_PRFL_Collection appInPrflColl = (APP_IN_PRFL_Collection) session
								.get(AppConstants.APP_IN_PRFL_MASTER);
						ABEmploymentBO empBO = new ABEmploymentBO();
						APP_IN_EMPL_Collection empColl = empBO
								.loadEmploymentDetail(appNumber);
						APP_IN_EMPL_Collection empStrikeColl = new APP_IN_EMPL_Collection();
						APP_IN_EMPL_A_WAGE_Collection empStrikeWagesColl = new APP_IN_EMPL_A_WAGE_Collection();
						APP_IN_EMPL_A_WAGE_Collection empStrikeWagesDeleteColl = new APP_IN_EMPL_A_WAGE_Collection();
						// delete if there is record enteret in the APP_IN_DC_E
						// for this app number
						ABDependentCareBO aBDependentCareBO = new ABDependentCareBO();
						APP_IN_DC_E_Collection depCareColl = aBDependentCareBO
								.loadDependentCareDetails(appNumber);
						APP_IN_DC_E_Collection depCareCollnew = new APP_IN_DC_E_Collection();
						if (depCareColl != null && !depCareColl.isEmpty()) {
							for (int i = 0; i < depCareColl.size(); i++) {
								depCareColl.getResult(i).setRowAction(
										FwConstants.ROWACTION_DELETE);
								depCareCollnew.addCargo(depCareColl
										.getResult(i));
								applicationManager.persist(appNumber,
										depCareColl.getResult(i)
												.getIndv_seq_num(),
										questionsFieldArrayDC,
										new String[] { "N" });
								for (int j = 0; j < appInPrflColl.size(); j++) {
									// update session collection for this change
									if (appInPrflColl.getCargo(j).getApp_num()
											.equals(appNumber)
											&& appInPrflColl
													.getCargo(j)
													.getIndv_seq_num()
													.equals(depCareColl
															.getResult(i)
															.getIndv_seq_num())) {
										appInPrflColl.getCargo(j)
												.setDpnd_care_resp("N");
									}
								}
							}
							// deletes enteries from that table
							aBDependentCareBO
									.storeDependentCareDetails(depCareCollnew);
						}

						// logic for Strike income
						for (int i = 0; i < empColl.size(); i++) {
							if (empColl.getCargo(i).getEmpl_typ().equals("S")) {
								String indvSeqNum = empColl.getCargo(i)
										.getIndv_seq_num();
								// this loop updates the session collection as
								// corresponding table updated
								for (int j = 0; j < appInPrflColl.size(); j++) {
									if (appInPrflColl.getCargo(j).getApp_num()
											.equals(appNumber)
											&& appInPrflColl.getCargo(j)
													.getIndv_seq_num()
													.equals(indvSeqNum)) {
										appInPrflColl.getCargo(j)
												.setOn_strk_sw("N");
									}
								}
								// here we need to updated the frofile table as
								// "N" for strike field
								applicationManager.persist(appNumber,
										indvSeqNum, questionsFieldArrayStrike,
										new String[] { "N" });
								empColl.getCargo(i).setRowAction(
										FwConstants.ROWACTION_DELETE);
								empStrikeColl.addCargo(empColl.getCargo(i));
								// now for wages
								empBO.loadEmploymentWageDetail(
										empStrikeWagesColl, appNumber,
										indvSeqNum, empColl.getCargo(i)
												.getEmpl_seq_num());
								empStrikeWagesDeleteColl
										.addAll(empStrikeWagesColl);
							} else {
								onlyStrike = false; // if there is any record
													// exits other then strike,
													// onlystrike will be false
							}
						}
						// we need to delete the sitrike records from employee
						// details table
						empBO.storeEmploymentDetails(empStrikeColl);
						// now if we have wages details - than we have to delete
						// them too
						if (empStrikeWagesDeleteColl != null
								&& !empStrikeWagesDeleteColl.isEmpty()) {
							int wagesCollsize = empStrikeWagesDeleteColl.size();
							for (int i = 0; i < wagesCollsize; i++) {// set row
																		// action
																		// as
																		// delete
																		// for
																		// each
																		// cargo
								empStrikeWagesDeleteColl.getCargo(i)
										.setRowAction(
												FwConstants.ROWACTION_DELETE);
							}
							// now call persist method to delete wages details
							// for Strike income
							empBO.storeEmploymentWageDetails(empStrikeWagesDeleteColl);
						}

						if (onlyStrike) {// if there is only strike selected we
											// need to make not required
											// these,"ABDCD","ABEDT", two pages
							notRequiredPages = new String[] { AppConstants.ABDCD, AppConstants.ABEDT };

						} else {
							notRequiredPages = new String[] { AppConstants.ABDCD }; // if
																			// there
																			// is
																			// more
																			// employement
																			// optionsexists,
																			// we
																			// only
																			// need
																			// dependent
																			// care
																			// not
																			// required
						}
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notRequiredPages,
								driverArray, appNumber);

					}

					if (serDeRequested
							&& currentpageStatus != FwConstants.DRIVER_REQUIRED) {
						updateSerRequestedInfromation(session, appNumber,
								driverArray);
					}

					if (serBurialDeRequested
							&& currentpageStatus != FwConstants.DRIVER_REQUIRED) {

						ABSERBurialDetailsBO burialBO = new ABSERBurialDetailsBO();
						// Deleting the Request Collection
						burialBO.deleteSERBurialRqstDetails(appNumber);

						short[] fieldName = { IApplicationManager.BURIAL_REQUEST_RESP };

						APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
								.get(AppConstants.APP_IN_PRFL_MASTER);
						for (int i = 0; i < appInPrflCollSession.size(); i++) {
							appInPrflCollSession.getCargo(i)
									.setBurial_request_resp("N");
							applicationManager.persist(appNumber,
									appInPrflCollSession.getCargo(i)
											.getIndv_seq_num(), fieldName,
									new String[] { "N" });
						}
						String[] notRequiredPages = { AppConstants.ABBAR, AppConstants.ABSBI,
								AppConstants.ABSBD, AppConstants.ABSDB, AppConstants.ABBRS };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notRequiredPages,
								driverArray, appNumber);
					}
					if ((fmaDeRequested || medicareDeRequest)
							&& currentpageStatus != FwConstants.DRIVER_REQUIRED) {

						ABMedicalDetailsBO appInMedDetBO = new ABMedicalDetailsBO();
						ABMedicalCoverageDetailsBO appInMedCvgBO = new ABMedicalCoverageDetailsBO();
						ABMedicalDisabilityApplicationDetailsBO appInMedDblBO = new ABMedicalDisabilityApplicationDetailsBO();
						ABMAHealthyKidsBO healthyKidsBO = new ABMAHealthyKidsBO();

						APP_IN_MEDICAL_DETAIL_Collection earlyOnColl = appInMedDetBO
								.loadMedicalDetailsAFB(appNumber,
										AppConstants.EARLY_ON);
						if (earlyOnColl != null && !earlyOnColl.isEmpty()) {
							appInMedDetBO.deleteMedicalDetails(earlyOnColl,
									AppConstants.EARLY_ON);
						}
						APP_IN_MEDICAL_DETAIL_Collection speEduColl = appInMedDetBO
								.loadMedicalDetailsAFB(appNumber,
										AppConstants.SPECIAL_EDUCATION);
						if (speEduColl != null && !speEduColl.isEmpty()) {
							appInMedDetBO.deleteMedicalDetails(speEduColl,
									AppConstants.SPECIAL_EDUCATION);
						}
						APP_IN_MEDICAL_DETAIL_Collection rehabColl = appInMedDetBO
								.loadMedicalDetailsAFB(appNumber,
										AppConstants.REHAB_SERVICE);
						if (rehabColl != null && !rehabColl.isEmpty()) {
							appInMedDetBO.deleteMedicalDetails(rehabColl,
									AppConstants.REHAB_SERVICE);
						}
						APP_IN_MEDICAL_COVERAGE_Collection medCvgColl = appInMedCvgBO
								.loadMedicalCoverageDetails(appNumber);
						if (medCvgColl != null && !medCvgColl.isEmpty()) {
							appInMedCvgBO.deleteMedicalCoverage(medCvgColl);
						}
						APP_IN_MEDICAL_DISABILITY_Collection medDblColl = appInMedDblBO
								.loadDisabilityApplicationDetails(appNumber);
						if (medDblColl != null && !medDblColl.isEmpty()) {
							appInMedDblBO
									.deleteDisabilityApplication(medDblColl);
						}

						APP_IN_MI_CHILD_EXPENSE_Collection appInMiChExpCC = healthyKidsBO
								.loadHealthyKidsDetails(appNumber);
						if (appInMiChExpCC != null && !appInMiChExpCC.isEmpty()) {
							healthyKidsBO
									.deleteAllHealthyKidsDetails(appInMiChExpCC);
						}

						short[] fieldName = {
								IApplicationManager.DOMESTIC_VIOLENCE_VICTIM_RESP,
								IApplicationManager.IMMUNIZATION_RESP,
								IApplicationManager.SPECIAL_HEALTH_SERVICE_RESP,
								IApplicationManager.EARLY_ON_RESP,
								IApplicationManager.SPECIAL_EDUCATION_CLASS_RESP,
								IApplicationManager.ALCOHOL_DRUG_TREATMENT_RESP,
								IApplicationManager.MI_REHAB_RESP,
								IApplicationManager.CARETAKER_RESP,
								IApplicationManager.MEDICAL_COVERAGE_RESP,
								IApplicationManager.APPLIED_FOR_DISABILITY_RESP,
								IApplicationManager.SOCIAL_SECURITY_RESP,
								IApplicationManager.SUPPLEMENTAL_INCOME_RESP,
								IApplicationManager.OTHER_DISABILITY_RESP,
								IApplicationManager.STATE_HEALTH_INSURANCE_SW,
								IApplicationManager.PLAN_FIRST_MEDICARE_SW,
								IApplicationManager.CHILD_SUPPORT_SW,
								IApplicationManager.CHILD_CARE_SW,
								IApplicationManager.PAST_HEALTH_INSURANCE_SW,
								IApplicationManager.SPECIAL_HEALTH_CARE_SW,
								IApplicationManager.RENTAL_PROPERTY_EXP_SW,
								IApplicationManager.HEALTH_INSURANCE_SW,
								IApplicationManager.COURT_ORDERED_GUARDIAN_SW,
								IApplicationManager.PLAN_FIRST_MEDICAL_SW,
								IApplicationManager.PAST_CASH_MEDICAL_SW,
								IApplicationManager.PLAN_FIRST_MEDICAID_SW,
								IApplicationManager.PLAN_FIRST_OTHER_HEALTH_SW };

						APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
								.get(AppConstants.APP_IN_PRFL_MASTER);

						for (int i = 0; i < appInPrflCollSession.size(); i++) {
							APP_IN_PRFL_Cargo cargo = appInPrflCollSession
									.getCargo(i);
							cargo.setDomestic_violence_victim_resp("N");
							cargo.setImmunization_resp("N");
							cargo.setSpecial_health_service_resp("N");
							cargo.setEarly_on_resp("N");
							cargo.setSpecial_education_class_resp("N");
							cargo.setOp_aoda_tmt_rcv_sw("N");
							cargo.setMi_rehab_resp("N");
							cargo.setCaretaker_resp("N");
							cargo.setMedical_coverage_resp("N");
							cargo.setApplied_for_disability_resp("N");
							cargo.setSocial_security_resp("N");
							cargo.setSupplemental_income_resp("N");
							cargo.setOther_disability_resp("N");
							cargo.setHealth_insurance_sw("N");
							cargo.setPast_health_insurance_sw("N");
							cargo.setState_health_insurance_sw("N");
							cargo.setSpecial_health_care_sw("N");
							cargo.setPast_cash_medical_sw("N");
							cargo.setChild_support_sw("N");
							cargo.setCourt_ordered_guardian_sw("N");
							cargo.setChild_care_sw("N");
							cargo.setRental_property_exp_sw("N");
							cargo.setPlan_first_medicaid_sw("N");
							cargo.setPlan_first_medical_sw("N");
							cargo.setPlan_first_medicare_sw("N");
							cargo.setPlan_first_other_health_sw("N");

							applicationManager
									.persist(appNumber,
											cargo.getIndv_seq_num(), fieldName,
											new String[] { "N", "N", "N", "N",
													"N", "N", "N", "N", "N",
													"N", "N", "N", "N", "N",
													"N", "N", "N", "N", "N",
													"N", "N", "N", "N", "N",
													"N", "N" });

						}
						String[] notRequiredPages = { AppConstants.ABMSF, 
								AppConstants.ABMEA, AppConstants.ABMRE, AppConstants.ABMDD, AppConstants.ABMCD, AppConstants.ABMDT,
								AppConstants.ABMDA, AppConstants.ABMDS, AppConstants.ABHKQ, AppConstants.ABHKE, AppConstants.ABHKC,
								AppConstants.ABHKG, AppConstants.ABHKR, AppConstants.ABHCC, AppConstants.ABPFQ, AppConstants.ABNFI };
						driverManager.makeAbsoluteNotRequired(
								FwConstants.AFB_DRIVER, notRequiredPages,
								driverArray, appNumber);

					}

					if ((maSelectedFlag && currentpageStatus != FwConstants.DRIVER_REQUIRED)
							&& (fsRequested || fpwRequested || serRequested
									|| serBurialRequested || cashRequested)) {

						if (appRqstBeforeCargo.getMa_short_form_cd() != null
								&& (appRqstBeforeCargo.getMa_short_form_cd()
										.equalsIgnoreCase(
												AppConstants.MA_HEALTHY_KIDS)
										|| appRqstBeforeCargo
												.getMa_short_form_cd()
												.equalsIgnoreCase(
														AppConstants.MA_PLAN_FIRST) || appRqstBeforeCargo
										.getMa_short_form_cd()
										.equalsIgnoreCase(
												AppConstants.MA_NURSING_FACILITY))) {

							ABMAHealthyKidsBO healthyKidsBO = new ABMAHealthyKidsBO();

							APP_IN_MI_CHILD_EXPENSE_Collection appInMiChExpCC = healthyKidsBO
									.loadHealthyKidsDetails(appNumber);

							if (appInMiChExpCC != null
									&& !appInMiChExpCC.isEmpty()) {
								healthyKidsBO
										.deleteAllHealthyKidsDetails(appInMiChExpCC);
							}

							short[] fieldName = {

									IApplicationManager.STATE_HEALTH_INSURANCE_SW,
									IApplicationManager.PLAN_FIRST_MEDICARE_SW,
									IApplicationManager.CHILD_SUPPORT_SW,
									IApplicationManager.CHILD_CARE_SW,
									IApplicationManager.PAST_HEALTH_INSURANCE_SW,
									IApplicationManager.SPECIAL_HEALTH_CARE_SW,
									IApplicationManager.RENTAL_PROPERTY_EXP_SW,
									IApplicationManager.HEALTH_INSURANCE_SW,
									IApplicationManager.COURT_ORDERED_GUARDIAN_SW,
									IApplicationManager.PLAN_FIRST_MEDICAL_SW,
									IApplicationManager.PAST_CASH_MEDICAL_SW,
									IApplicationManager.PLAN_FIRST_MEDICAID_SW,
									IApplicationManager.PLAN_FIRST_OTHER_HEALTH_SW };

							APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
									.get(AppConstants.APP_IN_PRFL_MASTER);

							if (appInPrflCollSession != null) {

								for (int i = 0; i < appInPrflCollSession.size(); i++) {
									APP_IN_PRFL_Cargo cargo = appInPrflCollSession
											.getCargo(i);

									cargo.setHealth_insurance_sw("N");
									cargo.setPast_health_insurance_sw("N");
									cargo.setState_health_insurance_sw("N");
									cargo.setSpecial_health_care_sw("N");
									cargo.setPast_cash_medical_sw("N");
									cargo.setChild_support_sw("N");
									cargo.setCourt_ordered_guardian_sw("N");
									cargo.setChild_care_sw("N");
									cargo.setRental_property_exp_sw("N");
									cargo.setPlan_first_medicaid_sw("N");
									cargo.setPlan_first_medical_sw("N");
									cargo.setPlan_first_medicare_sw("N");
									cargo.setPlan_first_other_health_sw("N");

									applicationManager.persist(appNumber,
											cargo.getIndv_seq_num(), fieldName,
											new String[] { "N", "N", "N", "N",
													"N", "N", "N", "N", "N",
													"N", "N", "N", "N" });

								}
							}

							String[] notRequiredPages = { AppConstants.ABMSF,
									AppConstants.ABHKQ, AppConstants.ABHKE, AppConstants.ABHKC, AppConstants.ABHKG,
									AppConstants.ABHKR, AppConstants.ABHCC, AppConstants.ABPFQ, AppConstants.ABNFI };
							driverManager.makeAbsoluteNotRequired(
									FwConstants.AFB_DRIVER, notRequiredPages,
									driverArray, appNumber);

						} else if (appRqstAfterCargo.getMa_short_form_cd() != null
								&& appRqstAfterCargo.getMa_short_form_cd()
										.equalsIgnoreCase(AppConstants.ONLY_MA)) {

							String[] notRequiredPages = { AppConstants.ABMSF };
							driverManager.makeAbsoluteNotRequired(
									FwConstants.AFB_DRIVER, notRequiredPages,
									driverArray, appNumber);
						}
					}
					if (cashRequested) {
						String[] requiredPages = { AppConstants.ABMDQ, AppConstants.ABMDS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}

					if (fsRequested || fpwRequested || serRequested
							|| serBurialRequested || cashRequested
							|| medicareRequest) {
						ABProgramInformationBO programInfoBo = new ABProgramInformationBO();
						APP_RQST_Collection appRqstColl = programInfoBo
								.loadProgramInformation(appNumber);
						if (appRqstColl != null && !appRqstColl.isEmpty()) {
							APP_RQST_Cargo appRqstCargo = appRqstColl
									.getCargo(0);
							appRqstCargo.setMa_short_form_cd(null);
							appRqstCargo
									.setRowAction(FwConstants.ROWACTION_UPDATE);
							appRqstColl.add(appRqstCargo);
							appRqstColl.persist(FwConstants.DAO);
						}
					}

					// Updated Code to schedule ABMDS page for Medical
					// Assistance also along with all other programs.
					// To Fix Production issue # ILIES-131182
					if (fmaRequested
							|| medicareRequest
							|| AppConstants.PROGRAM_SELECTED
									.equals(appPgmRqstAfterCargo
											.getFs_rqst_ind())
							|| AppConstants.PROGRAM_SELECTED
									.equals(appPgmRqstAfterCargo
											.getFpw_rqst_ind())
							|| AppConstants.PROGRAM_SELECTED
									.equals(appPgmRqstAfterCargo
											.getSer_burial_request_ind())
							|| AppConstants.PROGRAM_SELECTED
									.equals(appPgmRqstAfterCargo
											.getSer_rqst_ind())
							|| AppConstants.PROGRAM_SELECTED
									.equals(appPgmRqstAfterCargo
											.getHc_rqst_ind())
							|| AppConstants.PROGRAM_SELECTED
									.equals(appPgmRqstAfterCargo
											.getMedicare_rqst_ind())) {
						String[] requiredPages = { AppConstants.ABMDQ, AppConstants.ABMDS };
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								requiredPages, driverArray, appNumber);
					}

				}
			} else {
				if (fsRequested) {
					String[] requiredPages = { AppConstants.ABPPS, AppConstants.ABPSQ };
					driverManager.makeRequired(FwConstants.AFB_DRIVER,
							requiredPages, driverArray, appNumber);
				} else if (fsDeRequested) {
					String[] notRequiredPages = { AppConstants.ABPPS, AppConstants.ABPSQ };
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);
					// PCR# 33903 -- Delte Priority Service Details if FS
					// request unselected.
					abPriSerBO.deletePriorityServiceQuestions(appNumber);
				}
			}

			short[] programKey =(short[]) session.get(FwConstants.AFB_PROGRAM_KEY);
			if(appPgmRqstAfterCargo.getFma_rqst_ind().equals(AppConstants.PROGRAM_SELECTED)){
				driverManager.makeRequired(FwConstants.AFB_DRIVER,new String[]{AppConstants.ABMDQ,AppConstants.ABMDS},driverArray,appNumber);
			}
			if(programManager.isMSPOnlyProgramRequested(programKey)){
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,new String[]{AppConstants.ABMDQ,AppConstants.ABMDS},driverArray,appNumber);
			}
			//fpp
			if(programManager.isFPPOnlyProgramRequested(programKeyArray)){
				String[] notRequiredPages = {AppConstants.ABESM, AppConstants.ABMDQ,AppConstants.ABMDS,AppConstants.ABPRG,AppConstants.ABHHQ,AppConstants.ABWSS,AppConstants.ABAPD,AppConstants.ABCHI,AppConstants.ABSAP,AppConstants.ABAPI,AppConstants.ABADS,AppConstants.ABHEQ,AppConstants.ABHES,AppConstants.ABATS,AppConstants.ABSEN,AppConstants.ABHIS,AppConstants.ABMAC,AppConstants.ABPSQ};
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,notRequiredPages,driverArray,appNumber);
				
				String[] requiredPages = {AppConstants.ABHMD,AppConstants.ABHMS, AppConstants.ABJIS, AppConstants.ABOIS, AppConstants.ABUAD};
				driverManager.makeRequired(FwConstants.AFB_DRIVER,requiredPages,driverArray,appNumber);
			}
			// Making the current page complete in the driver
			driverManager.makeComplete(FwConstants.AFB_DRIVER, currentPageId,
					driverArray, appNumber);
			session.remove(FwConstants.INFO_TYPE);
			//smejiaibarra (ILIES-172363) - Store in session number of individuals in the home
			ABRegistrationBO registrationBo = new ABRegistrationBO();
			pageCollection = registrationBo.loadPersonalInformation(appNumber);
			txnBean.setPageCollection(pageCollection);
			int peopleInYourHome = 0;
			PeopleHandler peopleHandler = null;
			if (session.get(AppConstants.INDIV_MASTER_HANDLER) == null) {
				// now we are loading the people handler
				peopleHandler = new PeopleHandler();
				peopleHandler.loadPeopleHandler(appNumber);
				session.put(AppConstants.INDIV_MASTER_HANDLER, peopleHandler);
			}
			if(request.get(FwConstants.PEOPLEINYOURHOME) != null){
				 peopleInYourHome = Integer.parseInt((String) request.get(FwConstants.PEOPLEINYOURHOME));
				 session.put(FwConstants.PEOPLEINYOURHOME,Integer.toString(peopleInYourHome));
			}
			 // ILIES-311795 starts here
			String taxFile = (String) request.get("taxFile");
			String taxDependent = (String) request.get("taxDependent");
			//if people in your home count not null
			ABHouseHoldMemberBO houseHoldBo = new ABHouseHoldMemberBO();
			int totalCount = peopleInYourHome;
			if(null!=taxFile){
				totalCount=totalCount+Integer.parseInt(taxFile);
			}
			if(totalCount > 0){
				if(totalCount > houseHoldBo.loadHouseholdCount(appNumber)|| totalCount < houseHoldBo.loadHouseholdCount(appNumber) ){
					driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER, AppConstants.ABHMD, driverArray,appNumber);
					driverManager.makeRequired(FwConstants.AFB_DRIVER, AppConstants.ABHMD, driverArray,appNumber);
					if(beforeCollection.containsKey(AppConstants.PEOPLE_COUNT)){
						beforeCollection.put(AppConstants.PEOPLE_COUNT,Integer.toString(peopleInYourHome));
					}
					// ILIES-311795 ends here
				}
				if(null!=taxFile && null!=taxDependent){
					int totalPeople=peopleInYourHome+Integer.parseInt(taxFile);
					houseHoldBo.storeHouseholdMemberDetailForTax(appNumber,Integer.toString(peopleInYourHome),Integer.toString(totalPeople),
							taxFile,taxDependent);
				}
				else{
					//houseHoldBo.storeHouseholdMemberDetail(appNumber,Integer.toString(peopleInYourHome));
					houseHoldBo.storeHouseholdMemberDetailForTax(appNumber,String.valueOf(peopleInYourHome),Integer.toString(peopleInYourHome),
							String.valueOf(0),String.valueOf(0));
					
				}
								
			}
			//ILIES-282108 Changes made by Uma Rani to queue ABPSS
			driverManager.makeComplete(FwConstants.AFB_DRIVER, AppConstants.ABPPS,driverArray, appNumber);
			//Added by Priyanka Baddam for ILIES-282237 : Removing the values from session.
			regBo.clearSessionOfWarningMsgOnSaveAndExitFunc(session);
			//ILIES-282237 changes end here

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID(FwConstants.STORE_REGISTRATION_SUMMARY);
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			throw createFwException(this.getClass().getName(),
					FwConstants.STORE_REGISTRATION_SUMMARY, e);
		}
	
	}

	/**
	 * @param session
	 * @param appNumber
	 */
	private void updateSerRequestedInfromation(Map session, String appNumber,
			int[] driverArray) {
		// TODO Auto-generated method stub
		ABSERAssistanceBO serBo = new ABSERAssistanceBO();
		ABNonEnergySerBO nonEnergyBo = new ABNonEnergySerBO();
		// Deleting the Request Collection
		serBo.deleteSerDetails(appNumber);
		nonEnergyBo.deleteNonEnergySerDetails(appNumber);
		short[] fieldName = { IApplicationManager.SER_RQST_IND,
				IApplicationManager.SER_HE_RESP,
				IApplicationManager.SER_HD_RESP,
				IApplicationManager.SER_EB_RESP,
				IApplicationManager.SER_ED_RESP,
				IApplicationManager.SER_FR_RESP,
				IApplicationManager.SER_HOME_REPAIR_RESP,
				IApplicationManager.SER_RELOCATION_EXPENSE_RESP,
				IApplicationManager.SER_HOME_OWNERSHIP_RESP,
				IApplicationManager.SER_NON_ENERGY_UTILITY_RESP,
				IApplicationManager.SER_PREVENT_EVICTION_RESP,
				IApplicationManager.SER_RELOCATION_RENT_RESP,
				IApplicationManager.SER_SECURITY_DEPOSIT_RESP,
				IApplicationManager.SER_MOVING_EXPENSE_RESP,
				IApplicationManager.SER_MORTGAGE_RESP,
				IApplicationManager.SER_PROPERTY_TAX_RESP,
				IApplicationManager.SER_HOME_INSURANCE_RESP,
				IApplicationManager.SER_MOBILE_HOME_RESP,
				IApplicationManager.SER_LEIN_FILING_RESP,
				IApplicationManager.SER_COOKING_GAS_RESP,
				IApplicationManager.SER_WATER_SEWAGE_RESP,
				IApplicationManager.SER_DEPOSIT_RECONNECT_RESP };
		applicationManager.persist(appNumber, "1", fieldName, new String[] {
				"N", "N", "N", "N", "N", "N", "N", "N", "N", "N", "N", "N",
				"N", "N", "N", "N", "N", "N", "N", "N", "N", "N" });
		APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
				.get(AppConstants.APP_IN_PRFL_MASTER);
		if (appInPrflCollSession != null && appInPrflCollSession.size() > 0) {
			appInPrflCollSession.getCargo(0).setSer_he_resp("N");
			appInPrflCollSession.getCargo(0).setSer_hd_resp("N");
			appInPrflCollSession.getCargo(0).setSer_eb_resp("N");
			appInPrflCollSession.getCargo(0).setSer_ed_resp("N");
			appInPrflCollSession.getCargo(0).setSer_fr_resp("N");
			appInPrflCollSession.getCargo(0).setSer_rqst_ind("N");
			// for non-energy SER
			appInPrflCollSession.getCargo(0).setSer_home_repair_resp("N");
			appInPrflCollSession.getCargo(0)
					.setSer_relocation_expense_resp("N");
			appInPrflCollSession.getCargo(0).setSer_home_ownership_resp("N");
			appInPrflCollSession.getCargo(0)
					.setSer_non_energy_utility_resp("N");
			appInPrflCollSession.getCargo(0).setSer_cooking_gas_resp("N");
			appInPrflCollSession.getCargo(0).setSer_water_sewage_resp("N");
			appInPrflCollSession.getCargo(0).setSer_deposit_reconnect_resp("N");
			appInPrflCollSession.getCargo(0).setSer_prevent_eviction_resp("N");
			appInPrflCollSession.getCargo(0).setSer_relocation_rent_resp("N");
			appInPrflCollSession.getCargo(0).setSer_security_deposit_resp("N");
			appInPrflCollSession.getCargo(0).setSer_moving_expense_resp("N");
			appInPrflCollSession.getCargo(0).setSer_mortgage_resp("N");
			appInPrflCollSession.getCargo(0).setSer_property_tax_resp("N");
			appInPrflCollSession.getCargo(0).setSer_home_insurance_resp("N");
			appInPrflCollSession.getCargo(0).setSer_mobile_home_resp("N");
			appInPrflCollSession.getCargo(0).setSer_lein_filing_resp("N");

		}
		String[] notRequiredPages = { "ABSHS", "ABPNG", "ABHNG", "ABDFG",
				"ABPHD", "ABHDR", "ABSPD", "ABHEL", "ABPED", "ABEDR", "ABFUR",
				"ABSNH", "ABNTS", "ABSRD", "ABSOD", "ABSUD", "ABPTH", "ABSSS" };
		driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
				notRequiredPages, driverArray, appNumber);
	}

	/**
	 * @param session
	 * @param appNumber
	 */
	private void updateCDCInformation(Map session, String appNumber) {
		// TODO Auto-generated method stub
		ABCdcBo cdcBo = new ABCdcBo();
		APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
				.get(AppConstants.APP_IN_PRFL_MASTER);
		APP_IN_PRFL_Cargo appInPrflCargo = null;
		short[] fieldName = { IApplicationManager.APPROVED_ACTIVITY_RESP,
				IApplicationManager.NEED_CHILD_CARE_RESP,
				IApplicationManager.WORK_ACTIVITY_RESP,
				IApplicationManager.HIGH_SCHOOL_ACTIVITY_RESP,
				IApplicationManager.EMPLOYMENT_ACTIVITY_RESP,
				IApplicationManager.HEALTH_ACTIVITY_RESP };
		if (appInPrflCollSession != null && appInPrflCollSession.size() > 0) {
			for (int i = 0; i < appInPrflCollSession.size(); i++) {
				appInPrflCargo = appInPrflCollSession.getCargo(i);
				appInPrflCargo
						.setApproved_activity_resp(IApplicationManager.DEFAULT_APP_IN_PRFL_SW);
				appInPrflCargo
						.setNeed_child_care_resp(IApplicationManager.DEFAULT_APP_IN_PRFL_SW);
				appInPrflCargo
						.setWork_activity_resp(IApplicationManager.DEFAULT_APP_IN_PRFL_SW);
				appInPrflCargo
						.setHigh_school_activity_resp(IApplicationManager.DEFAULT_APP_IN_PRFL_SW);
				appInPrflCargo
						.setEmployment_activity_resp(IApplicationManager.DEFAULT_APP_IN_PRFL_SW);
				appInPrflCargo
						.setHealth_activity_resp(IApplicationManager.DEFAULT_APP_IN_PRFL_SW);

				applicationManager.persist(appNumber,
						appInPrflCargo.getIndv_seq_num(), fieldName,
						new String[] { "N", "N", "N", "N", "N", "N" });
			}
		}

		cdcBo.deleteProviderDetails(appNumber);
	}

	/**
	 * This method load the Registration Details page for modification
	 * 
	 * @param txnBean
	 *            gov.wisconsin.framework.business.entities.FwTransaction
	 * @author govinpr
	 */
	public void changeRegistrationDetail(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {
			Map pageCollection = txnBean.getPageCollection();
			// Map request = txnBean.getRequest();
			// String indvSeqNum = null;
			IndivTypeSeqBean indivTypeSeqBean = new IndivTypeSeqBean();
			// APP_RGST_Collection appRgstColl =
			// (APP_RGST_Collection)pageCollection.get("APP_RGST_Collection");
			indivTypeSeqBean.setIndivSeqNum("1");
			pageCollection.put(FwConstants.DETAIL_KEY_BEAN, indivTypeSeqBean);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("changeRegistrationDetail");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"changeRegistrationDetail", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void getRegistrationInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		Map session = txnBean.getSession();
		Map pageCollection = null;
		String appNumber = null;
		PeopleHandler peopleHandler = null;
		int[] driverArray = null;
		try {
			appNumber = (String) session.get(AppConstants.APP_NUMBER);
			// Added by sushma june 24
			// session.put("SKIP_VALIDATE","");
			// Added by sushma june 24
			// we need to get the page data from the data base
			ABRegistrationBO registrationBo = new ABRegistrationBO();
			pageCollection = registrationBo
					.loadRegistrationInformation(appNumber);
			txnBean.setPageCollection(pageCollection);
			if (session.get(AppConstants.INDIV_MASTER_HANDLER) == null
					&& !pageCollection.isEmpty()) {
				// now we are loading the people handler
				peopleHandler = new PeopleHandler();
				peopleHandler.loadPeopleHandler(appNumber);
				session.put(AppConstants.INDIV_MASTER_HANDLER, peopleHandler);
			}

			// setting an indicator for age and birth section display
			// if house hold members is completed then we are not display age
			// and gender
			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			int status = driverManager.getAFBStatus(FwConstants.AFB_DRIVER,
					"ABHMD", driverArray);
			if (status == FwConstants.DRIVER_REQUIRED
					|| status == FwConstants.DRIVER_NOT_REQUIRED) {
				pageCollection.put("AgeGenderDisplay", FwConstants.YES);
			} else {
				pageCollection.put("AgeGenderDisplay", FwConstants.NO);
			}
			session.put(FwConstants.BEFORE_COLLECTION, pageCollection);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getRegistrationInformation");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getRegistrationInformation", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void storeRegistrationInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		Map session = txnBean.getSession();
		Map request = txnBean.getRequest();
		Map pageCollection = txnBean.getPageCollection();
		int[] driverArray = null;
		String appNumber = null;
		Map beforeMap = null;
		APP_INDV_Collection appIndvColl = null;
		APP_INDV_Collection appIndvBeforeColl = null;
		APP_INDV_Cargo appIndvCargo = null;
		APP_INDV_Cargo appIndvBeforeCargo = null;
		APP_RGST_Collection appRgstColl = null;
		APP_RGST_Collection appRgstBeforeColl = null;
		APP_RGST_Cargo appRgstCargo = null;
		APP_RGST_Cargo appRgstBeforeCargo = null;
		FwMessageList validateInfo = null;
		PeopleHandler peopleHandler = null;
		ABRegistrationBO registrationBo = null;
		try {

			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			appNumber = (String) session.get(AppConstants.APP_NUMBER);
			beforeMap = (Map) session.get(FwConstants.BEFORE_COLLECTION);
			appIndvColl = (APP_INDV_Collection) pageCollection
					.get("APP_INDV_Collection");
			appRgstColl = (APP_RGST_Collection) pageCollection
					.get("APP_RGST_Collection");
			registrationBo = new ABRegistrationBO();
			peopleHandler = (PeopleHandler) session
					.get(AppConstants.INDIV_MASTER_HANDLER);

			// here i am getting the before collections
			String ageGenderInd = FwConstants.NO;
			if (beforeMap != null) {
				ageGenderInd = (String) beforeMap.get("AgeGenderDisplay");
				appRgstBeforeColl = (APP_RGST_Collection) beforeMap
						.get("APP_RGST_Collection");
				appIndvBeforeColl = (APP_INDV_Collection) beforeMap
						.get("APP_INDV_Collection");
			}

			if (appIndvColl != null && !appIndvColl.isEmpty()) //Modified by Gauresh for ILIES-282110: SONAR fixes
			{
				appIndvCargo = appIndvColl.getCargo(0);
			}
			if (appRgstColl != null && !appRgstColl.isEmpty()) //Modified by Gauresh for ILIES-282110: SONAR fixes
			{
				appRgstCargo = appRgstColl.getCargo(0);
			}

			if (ageGenderInd.equals(FwConstants.NO)) {
				String birthDate = "";
				String confirmBrthDt = "";
				if(appIndvBeforeColl != null){
					appIndvBeforeCargo = appIndvBeforeColl.getCargo(0);
					appIndvCargo.setSex_ind(appIndvBeforeCargo.getSex_ind());
					// Conversion of date to timestamp for the ILIES project
					appIndvCargo.setBrth_dt(displayFormatter
							.getMMDDYYYYTimestamp(appIndvBeforeCargo.getBrth_dt()));
				}
				// Added for ILIES-125822: avtsingh
				if (!appIndvCargo.getBrth_dt().trim().equals("")
						&& appIndvCargo.getBrth_dt().length() >= 10) {
					birthDate = appIndvCargo.getBrth_dt().substring(0, 10);
					appIndvCargo.setBrth_dt(birthDate);
				}
				if (appIndvBeforeCargo.getConfm_brth_dt() != null
						|| appIndvBeforeCargo.getConfm_brth_dt().trim()
								.length() != 0) {
					appIndvCargo.setConfm_brth_dt(displayFormatter
							.getMMDDYYYYTimestamp(appIndvBeforeCargo
									.getConfm_brth_dt()));
					if (!appIndvCargo.getConfm_brth_dt().trim().equals("")
							&& appIndvCargo.getConfm_brth_dt().length() >= 10) {
						confirmBrthDt = appIndvCargo.getConfm_brth_dt()
								.substring(0, 10);
						appIndvCargo.setConfm_brth_dt(confirmBrthDt);
					}
				}
				// patch by rotanak
				// Conversion of date to timestamp for the ILIES project
				appIndvCargo.setDt_leave_facty(displayFormatter
						.getMMDDYYYYTimestamp(appIndvBeforeCargo
								.getDt_leave_facty()));
				appIndvCargo.setAlien_entry_dt(displayFormatter
						.getMMDDYYYYTimestamp(appIndvBeforeCargo
								.getAlien_entry_dt()));
			}
			// Added by sushma june 25

			if (appRgstCargo != null && appRgstCargo.getLang_cd() == null) {
				appRgstCargo.setLang_cd(" ");

			} else {
				appRgstCargo.setLang_cd(appRgstCargo.getLang_cd());
			}

			// Added by sushma june 25
			//Modified by Gauresh for ILIES-282110: setting lang_cd
			if(appIndvCargo!=null && appIndvCargo.getLang_cd()== null){
				appIndvCargo.setLang_cd(" ");
			}else{
				appIndvCargo.setLang_cd(appIndvCargo.getLang_cd());
			}
			//ILIES-282110: change ends here

			// added july 7
			String tempcounty = appRgstCargo.getCnty_num();
			//Modified by Gauresh for ILIES-282110: SONAR fixes- removed unused variable and declaring constant
			session.put(AppConstants.COUNTY_NUM, tempcounty);

			// added july 7

			// Added by Sushma july14
			if (appRgstCargo.getDays_at_address_num() == null
					|| appRgstCargo.getDays_at_address_num().trim().length() == 0) {
				appRgstCargo.setDays_at_address_num("0");
			} else {
				appRgstCargo.setDays_at_address_num(appRgstCargo
						.getDays_at_address_num());
			}
			// Added by Sushma july14
			appRgstCargo.setHshl_home_phn_num(concatenatePhoneNumber(request,
					"homePhone"));
			appRgstCargo.setHshl_work_phn_num(concatenatePhoneNumber(request,
					"workPhone"));
			appRgstCargo.setHshl_cell_phn_num(concatenatePhoneNumber(request,
					"cellPhone"));
			appRgstCargo.setMsg_phn_num(concatenatePhoneNumber(request,
					"messagePhone"));

			if (appIndvCargo != null && appIndvCargo.getBrth_dt().length() < 10) {

				// Added by Kumar Karuppanan to make mm/dd/yyyy as separate
				// boxes WR#BRGUS00308248 - Start
				appIndvCargo.setBrth_dt(concatenateDate(request,
						"groupDateOfBirth"));
				appIndvCargo.setConfm_brth_dt(concatenateDate(request,
						"confirmGroupDateOfBirth"));
				// Added by Kumar Karuppanan to make mm/dd/yyyy as separate
				// boxes WR#BRGUS00308248 - End
			}
			//Modified by Gauresh for ILIES-282110: SONAR fixes- declaring constant
			if (request.get(AppConstants.TRIBAL_LANDS) != null) {
				String tribe = (String) request.get(AppConstants.TRIBAL_LANDS);
				if (!tribe.equals("SEL")) {
					appRgstCargo.setCnty_num(tribe);
				}
			}

			// added for IL ILIES-69318
			//Modified by Gauresh for ILIES-282110: SONAR fixes- declaring constant
			if (request.get(AppConstants.SOCIAL_SECURITY) != null) {
				String ssnNum = (String) request.get(AppConstants.SOCIAL_SECURITY);
				appIndvCargo.setSsn_num(ssnNum);
			}

			// Added for the ILIES project
			// start of by rotanak
			String ageRequiredFlag = AppConstants.NO;
			if (session.containsKey(AppConstants.AGE_REQUIRED_FLAG))
				ageRequiredFlag = (String) session
						.get(AppConstants.AGE_REQUIRED_FLAG);
			// end of by rotanak

			// validating the data
			// Sushma added
			boolean skipcounter = false;
			// Sushma ended

			// WR #BRGUS00315705--Weijian Li-- MI Bridges Data Services
			// changes--201208
			String curPageID = "";
			String prePageID = "";
			if (request != null)
				curPageID = (String) (request.get(FwConstants.CURRENT_PAGE_ID) == null ? ""
						: request.get(FwConstants.CURRENT_PAGE_ID));
			if (request != null)
				prePageID = (String) (request.get(FwConstants.PREVIOUS_PAGE_ID) == null ? ""
						: request.get(FwConstants.PREVIOUS_PAGE_ID));
			validateInfo = registrationBo.validateRegistrationInformation(
					appRgstCargo, appIndvCargo, ageGenderInd, ageRequiredFlag,
					curPageID, prePageID);
			// end of WR #BRGUS00315705--Weijian Li-- MI Bridges Data Services
			// changes--201208

			if (validateInfo != null && validateInfo.hasMessages()) {

				String reqWarningMsgs = (String) request
						.get(FwConstants.WARNING_MSG_DETAILS);
				if (!this.checkForWarningMesgs(reqWarningMsgs,
						registrationBo.getMessageList())) {

					// Sushma start added
					String skipValidate = (String) session.get("SKIP_VALIDATE");

					if (skipValidate != null
							&& skipValidate.equals("skipvalidate")) {

						if (!checkForSkipValidation(validateInfo)) {
							request.put(FwConstants.MESSAGE_LIST, validateInfo);
							pageCollection.put("APP_INDV_Collection",
									appIndvColl);
							pageCollection
									.put("AgeGenderDisplay", ageGenderInd);
							pageCollection.put("APP_RGST_Collection",
									appRgstColl);
							return;
						} else {
							skipcounter = true;
						}
					} else {
						//Modified by Gauresh for ILIES-282110: SONAR fixes-merging 2-if statements
						if (skipValidate == null || skipValidate.equals("") && (checkForSkipValidation(validateInfo))) {
								session.put("SKIP_VALIDATE", "skipvalidate");
						}

					}
					//Modified by Gauresh for ILIES-282110: SONAR fixes
					if (skipcounter) {
						// Sushma end added

						request.put(FwConstants.MESSAGE_LIST, validateInfo);
						pageCollection.put("APP_INDV_Collection", appIndvColl);
						pageCollection.put("AgeGenderDisplay", ageGenderInd);
						pageCollection.put("APP_RGST_Collection", appRgstColl);
						return;
					}
				}

			}