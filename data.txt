AFBNavigationBO bo = new AFBNavigationBO(); 
			bo.persitAppRqstBackDtMonths(appNumber);
		}catch (FwException fe) {
			log(ILog.ERROR,	 " RegistrationEJBBean:: fppDeRqst :: appNumber:" +appNumber);
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("fppDeRqst");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			log(ILog.ERROR,	 " RegistrationEJBBean:: fppDeRqst :: appNumber:" +appNumber);
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"fppDeRqst", e);
			throw fe;
		}
		
	}
	
	
	

	// method to store Help With Application
	public void storeHelpWithApplications(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		try {
			log(ILog.INFO,
					"RegistrationEJBBean::storeHelpWithApplications:Start");
			Map session = txnBean.getSession();
			Map request = txnBean.getRequest();
			Map pageCollection = txnBean.getPageCollection();
			int[] driverArray = null;
			String appNumber = null;
			Map beforeColl = null;
			int currentPageStatus = 0;
			String pageId = null;
			APP_FILE_HELP_Collection appHelpBeforeColl = null;
			APP_FILE_HELP_Collection appHelpColl = null;
			APP_FILE_HELP_Cargo appHelpCargo = null;
			APP_FILE_HELP_Cargo appHelpBeforeCargo = null;
			FwMessageList validateInfo = null;

			// Get the status of the Driver from Session
			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			// Get the current Page Id from the Request
			pageId = (String) request.get(FwConstants.CURRENT_PAGE_ID);
			// Get the APP_NUM from the Session
			appNumber = (String) session.get(AppConstants.APP_NUMBER);
			// Get the before Collection from the Session
			beforeColl = (Map) session.get(FwConstants.BEFORE_COLLECTION);
			// Get the Status of the page from driver manager
			currentPageStatus = driverManager.getAFBStatus(
					FwConstants.AFB_DRIVER, pageId, driverArray);

			if (beforeColl.containsKey("APP_FILE_HELP_Collection")) {
				appHelpBeforeColl = (APP_FILE_HELP_Collection) beforeColl
						.get("APP_FILE_HELP_Collection");
			}
			if (pageCollection.containsKey("APP_FILE_HELP_Collection")) {
				appHelpColl = (APP_FILE_HELP_Collection) pageCollection
						.get("APP_FILE_HELP_Collection");
			}

			HelpWithApplicationBO helpBo = new HelpWithApplicationBO();
			ABHWAValidator helpValidatorObj = new ABHWAValidator();
			if (appHelpColl != null && !appHelpColl.isEmpty()) {
				appHelpCargo = appHelpColl.getCargo(0);
				// Now calling the validate method
				validateInfo = helpValidatorObj
						.validateHelpWithApplication(appHelpCargo);
				if (validateInfo != null && validateInfo.hasMessages()) {
					String reqWarningMsgs = (String) request
							.get(FwConstants.WARNING_MSG_DETAILS);
					if (!this.checkForWarningMesgs(reqWarningMsgs,
							helpBo.getMessageList())) {
						request.put(FwConstants.MESSAGE_LIST, validateInfo);
						pageCollection.put("APP_FILE_HELP_Collection",
								appHelpColl);
						return;
					}
				}
				// check and set default values
				appHelpCargo.setApp_num(appNumber);

				if (appHelpCargo.getHelp_indv_ind() == null)
					appHelpCargo.setHelp_indv_ind("0");
				
				//By Anwar
				if(appHelpCargo.getApply_for_yourself_resp() == null){
					appHelpCargo.setApply_for_yourself_resp("N");
				}

				// by sushma
				/* appHelpCargo.setHelp_indv_ind("3"); */
				// by sushma

				// new change by Yogendra
				// (!appHelpCargo.getHelp_indv_ind().equalsIgnoreCase( "2"))
				
				if (appHelpCargo.getCase_access_rqst_sw() == null ) {
				   appHelpCargo.setCase_access_rqst_sw(" "); 
				  }
				 

				String agencyNumberEntered = appHelpCargo.getAgcy_num();

				if (agencyNumberEntered == null
						|| agencyNumberEntered.equals("")){
					appHelpCargo.setAgcy_num("0");
				}

				// Checking the Before Collection is Null or Not
				if (appHelpBeforeColl != null) {
					appHelpBeforeCargo = appHelpBeforeColl.getCargo(0);

					// Now I am comparing the Cargos
					appHelpCargo = (APP_FILE_HELP_Cargo) isChanged(
							appHelpBeforeCargo, appHelpCargo);
					if (appHelpCargo.isDirty()) {
						appHelpCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
						helpBo.storeHelpWithApplication(appHelpColl);
						helpBo.checkContactInfo(appHelpCargo,
								appHelpBeforeCargo);// yogendra
					}
				} else {

					APP_FILE_HELP_Cargo appFileHelpCargo = helpBo
							.loadHelpWithApplication(appNumber);

					if (appFileHelpCargo.getApp_num() != null) {
						appHelpCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
						helpBo.storeHelpWithApplication(appHelpColl);
					} else {
						// We need to insert new record to the data base
						appHelpCargo.setRowAction(FwConstants.ROWACTION_INSERT);
						helpBo.storeHelpWithApplication(appHelpColl);
					}
				}
			}
			// check selected option for driver flow only on click of next
			// Changed by Rashmi for Driver Flow in Access Page
			String checkOptionStr = null;
			if (appHelpCargo != null && appHelpCargo.getHelp_indv_ind() != null)
				checkOptionStr = appHelpCargo.getHelp_indv_ind().trim();

			// if(checkOptionStr.equals("1") || checkOptionStr.equals("2") ||
			// checkOptionStr.equals("3") || checkOptionStr.equals("4") ||
			// checkOptionStr.equals("5")){
			if (checkOptionStr != null && checkOptionStr.equals("3")) {
				driverManager.makeRequired(FwConstants.AFB_DRIVER, "ABCON",
						driverArray, appNumber);
			} else {
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						"ABCON", driverArray, appNumber);
			}
			txnBean.setPageCollection(pageCollection);
			// set current page as completed - C to driver
			driverManager.makeComplete(FwConstants.AFB_DRIVER, "ABHWA",
					driverArray, appNumber);

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeHelpWithApplications");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeHelpWithApplications", e);
			throw fe;
		}
	}// end of storeHelpWithApplications

	/**
	 * @param txnBean
	 * @throws javax.ejb.EJBException
	 */
	public void addHelpWithApplications(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		try {
			Map session = txnBean.getSession();
			Map request = txnBean.getRequest();
			Map pageCollection = txnBean.getPageCollection();
			// String helpIndicator = "0";
			int[] driverArray = null;
			String appNumber = (String) session.get(AppConstants.APP_NUMBER);
			APP_FILE_HELP_Collection helpColl = (APP_FILE_HELP_Collection) pageCollection
					.get("APP_FILE_HELP_Collection");
			APP_FILE_HELP_Cargo helpCargo = new APP_FILE_HELP_Cargo();
			HelpWithApplicationBO helpBO = new HelpWithApplicationBO();
			FwMessageList validateInfo = null;
			if (!helpColl.isEmpty()) {
				helpCargo = helpColl.getCargo(0);
			}
			// Added by sushma
			helpCargo.setHelp_indv_ind("3");
			// Added by sushma
			// helpIndicator = helpCargo.getHelp_indv_ind();
			ABHWAValidator helpValidator = new ABHWAValidator();
			validateInfo = helpValidator
					.validateAddHelpWithApplication(helpCargo);
			if (validateInfo != null && validateInfo.hasMessages()) {
				request.put(FwConstants.MESSAGE_LIST, validateInfo);
				pageCollection.put("APP_FILE_HELP_Collection", helpColl);
				txnBean.setPageCollection((Map) session
						.get(FwConstants.BEFORE_COLLECTION));
				return;
			}

			helpCargo.setApp_num(appNumber);
			helpCargo.setAgcy_num("0");
			helpCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
			helpBO.storeHelpWithApplication(helpColl);

			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			driverManager.makeRequired(FwConstants.AFB_DRIVER, "ABCON",
					driverArray, appNumber);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("addHelpWithApplications");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"addHelpWithApplications", e);
			throw fe;
		}

	}// end of addHelpWithApplications

	/**
	 * @param txnBean
	 * @throws javax.ejb.EJBException
	 */
	public void changeHelpWithApplications(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		try {
			Map session = txnBean.getSession();
			Map pageCollection = txnBean.getPageCollection();
			int[] driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);

			APP_FILE_HELP_Collection helpColl = new APP_FILE_HELP_Collection();
			HelpWithApplicationBO helpBO = new HelpWithApplicationBO();
			String appNumber = (String) session.get(AppConstants.APP_NUMBER);
			helpColl.addCargo(helpBO.loadHelpWithApplication(appNumber));
			pageCollection.put("APP_FILE_HELP_Collection", helpColl);

			driverManager.makeRequired(FwConstants.AFB_DRIVER, "ABHMS",
					driverArray, appNumber);

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("changeHelpWithApplications");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"changeHelpWithApplications", e);
			throw fe;
		}

	}// end of changeHelpWithApplications

	/**
	 * @param txnBean
	 * @throws javax.ejb.EJBException
	 */
	public void deleteHelpWithApplications(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		try {
			Map session = txnBean.getSession();
			// String helpOptionSelected = "";
			String helpOptionSelected = "3";
			// helpOptionSelected = session.get("INFO_TYPE").toString();
			String appNumber = (String) session.get(AppConstants.APP_NUMBER);
			ABHWAValidator helpValidator = new ABHWAValidator();
			Map request = txnBean.getRequest();
			Map pageCollection = txnBean.getPageCollection();
			APP_FILE_HELP_Collection helpColl = (APP_FILE_HELP_Collection) pageCollection
					.get("APP_FILE_HELP_Collection");
			APP_FILE_HELP_Cargo helpCargo = new APP_FILE_HELP_Cargo();
			// added june 26
			helpCargo.setHelp_indv_ind("3");
			// added june 26
			String applName = "Your";
			String repType = "";
			HelpWithApplicationBO helpBO = new HelpWithApplicationBO();

			/*
			 * if(helpOptionSelected.equals("1")) repType = "Friend and Family";
			 * else if(helpOptionSelected.equals("2")) repType =
			 * "Staff person or Volunteer"; else
			 * if(helpOptionSelected.equals("3"))
			 */
			repType = "Authorized Representative";
			/*
			 * else if(helpOptionSelected.equals("4")) repType =
			 * "Legal Guardian"; else if(helpOptionSelected.equals("5")) repType
			 * = "Power of Attorney";
			 */

			PeopleHandler peopleHandler = (PeopleHandler) session
					.get(AppConstants.INDIV_MASTER_HANDLER);
			applName = peopleHandler.getFirstName("1");
			helpValidator.validateEraseRepresentativeInfo(applName, repType);
			if (helpValidator.hasMessages()) {
				// request.put(FwConstants.MESSAGE_LIST,
				// programInformationBO.getMessageList());
				boolean warningMsgFlag = false;
				String reqWarningMsgs = (String) request
						.get(FwConstants.WARNING_MSG_DETAILS);
				warningMsgFlag = this.checkForWarningMesgs(reqWarningMsgs,
						helpValidator.getMessageList());
				if (!this.checkForWarningMesgs(reqWarningMsgs,
						helpValidator.getMessageList())) {
					request.put(FwConstants.MESSAGE_LIST,
							helpValidator.getMessageList());
					pageCollection.put("APP_FILE_HELP_Collection", helpColl);
					session.put("INFO_TYPE", helpOptionSelected);
					txnBean.setPageCollection((Map) session
							.get(FwConstants.BEFORE_COLLECTION));
					setValuesForCard(request,session,appNumber,peopleHandler);
					return;
				}
			}
			helpBO.deleteHelpWithApplications(appNumber, helpOptionSelected);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("deleteHelpWithApplications");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"deleteHelpWithApplications", e);
			throw fe;
		}

	}// end of deleteHelpWithApplications

	/**
	 * Comment here
	 */
	public void getContactInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {
			Map pageColl = txnBean.getPageCollection();
			Map session = txnBean.getSession();
			Map request = txnBean.getRequest();
			String optSelected = null;
			String optType = null;
			APP_AUTH_REP_Collection arColl = null;
			APP_FILE_HELP_Collection helpColl = new APP_FILE_HELP_Collection();
			APP_FILE_HELP_Cargo helpCargo = null;
			ContactInformationBO objBO = new ContactInformationBO();

			String currentPageID = (String) request
					.get(FwConstants.CURRENT_PAGE_ID);
			int[] driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			int driverStatus = (int) driverManager.getAFBStatus(
					FwConstants.AFB_DRIVER, currentPageID, driverArray);
			String appNum = (String) session.get(AppConstants.APP_NUMBER);

			HelpWithApplicationBO helpBO = new HelpWithApplicationBO();
			helpCargo = helpBO.loadHelpWithApplication(appNum);

			optSelected = helpCargo.getHelp_indv_ind();

			if (optSelected.equals("1"))
				optType = "FF";
			if (optSelected.equals("2"))
				optType = "SPAV";
			if (optSelected.equals("3"))
				optType = "FR";
			else if (optSelected.equals("4"))
				optType = "LG";
			else if (optSelected.equals("5"))
				optType = "POA";

			pageColl.put("INFO_TYPE", optType);
			helpColl.addCargo(helpCargo);
			pageColl.put("APP_FILE_HELP_Collection", helpColl);

			if (driverStatus == FwConstants.DRIVER_COMPLETE
					|| driverStatus == FwConstants.DRIVER_VISIT_AGAIN) {
				// lgColl = objBO.getLGContactInfo(appNum);
				// pageColl.put("APP_AR_LG_CNTC_Collection",lgColl);

				if (optSelected.equals("3")) {
					arColl = objBO.getARContactInfo(appNum);
					pageColl.put("APP_AUTH_REP_Collection", arColl);
				}
			}
			txnBean.setPageCollection(pageColl);
			session.put(FwConstants.BEFORE_COLLECTION, pageColl);

			// to deal with Program Key in session - at this stage Program Key
			// Array contais Zero values.
			// make any one value in the array to 1 and set it back to original
			// one after calling getComponents()
			short[] orgProgramKeyArray = (short[]) session
					.get(FwConstants.AFB_PROGRAM_KEY);
			int size = 5;
			short[] tempProgramKeyArray = new short[size];
			tempProgramKeyArray[0] = 1;
			session.put(FwConstants.AFB_PROGRAM_KEY, tempProgramKeyArray);
			componentManager.getComponents(
					(String) (request.get(FwConstants.CURRENT_PAGE_ID)),
					txnBean);
			session.put(FwConstants.AFB_PROGRAM_KEY, orgProgramKeyArray);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getContactInformation");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getContactInformation", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void storeContactInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

			String appNumber = "";
			boolean authRepPersistFlag = false;
			Map session = txnBean.getSession();
			Map request = txnBean.getRequest();
			Map pageCollection = txnBean.getPageCollection();
			FwMessageList validateInfo = null;
			// FwMessageList validateInfoAR = null;
			boolean componentFlag = false;
			// String optSelected = (String)session.get("INFO_TYPE");
			String optSelected = (String) pageCollection.get("INFO_TYPE");

			// Common Collection & Cargo
			// APP_AR_LG_CNTC_Collection appLGColl = new
			// APP_AR_LG_CNTC_Collection();
			APP_AR_LG_CNTC_Cargo appLGCargo = new APP_AR_LG_CNTC_Cargo();

			// APP_AR_LG_CNTC_Collection appLGBeforeColl = new
			// APP_AR_LG_CNTC_Collection();

			// Auth Rep Carog and Collection
			APP_AUTH_REP_Collection appAuthRepColl = new APP_AUTH_REP_Collection();
			APP_AUTH_REP_Cargo appAuthRepCargo = new APP_AUTH_REP_Cargo();

			APP_AUTH_REP_Collection appAuthRepBeforeColl = new APP_AUTH_REP_Collection();

			Map beforeColl = (Map) session.get(FwConstants.BEFORE_COLLECTION);
			ContactInformationBO contInfoBO = new ContactInformationBO();
			ABCONValidator conValidatorObj = new ABCONValidator();
			optSelected = (String) beforeColl.get("INFO_TYPE");

			/*
			 * if(beforeColl.containsKey("APP_AR_LG_CNTC_Collection")){
			 * appLGBeforeColl =(APP_AR_LG_CNTC_Collection)beforeColl.get(
			 * "APP_AR_LG_CNTC_Collection"); }
			 * if(pageCollection.containsKey("APP_AR_LG_CNTC_Collection")){
			 * appLGColl =(APP_AR_LG_CNTC_Collection)pageCollection.get(
			 * "APP_AR_LG_CNTC_Collection"); }
			 */
			// Spouse details Before Collection
			if (beforeColl.containsKey("APP_AUTH_REP_Collection")) {
				appAuthRepBeforeColl = (APP_AUTH_REP_Collection) beforeColl
						.get("APP_AUTH_REP_Collection");
			}
			if (pageCollection.containsKey("APP_AUTH_REP_Collection")) {
				appAuthRepColl = (APP_AUTH_REP_Collection) pageCollection
						.get("APP_AUTH_REP_Collection");
			}

			appNumber = (String) session.get(AppConstants.APP_NUMBER);

			List componentList = (ArrayList) beforeColl
					.get(FwConstants.PAGE_COMPONENT_LIST);

			if (componentList.contains("365")) {
				componentFlag = true;
			}

			if (appAuthRepColl != null && appAuthRepColl.size() > 0) {
				appAuthRepCargo = appAuthRepColl.getCargo(0);
				appAuthRepCargo.setPhn_num(concatenatePhoneNumber(request,
						"phoneNumber"));
			}

			if (componentFlag) {
				if (appAuthRepColl != null && appAuthRepColl.size() > 0) {
					appAuthRepCargo = appAuthRepColl.getCargo(0);
					boolean isAddress = false;
					if ((appAuthRepCargo.getL1_adr() != null && !appAuthRepCargo
							.getL1_adr().trim().equals(""))
							|| (appAuthRepCargo.getL2_adr() != null && !appAuthRepCargo
									.getL2_adr().trim().equals(""))) {
						isAddress = true;
					}
					boolean isRecCpltInd = false;
					if (appAuthRepCargo.getCity_adr() != null
							&& !appAuthRepCargo.getCity_adr().trim().equals("")
							&& appAuthRepCargo.getEmail_adr() != null
							&& !appAuthRepCargo.getEmail_adr().trim()
									.equals("")
							&& appAuthRepCargo.getZip_adr() != null
							&& !appAuthRepCargo.getZip_adr().trim().equals("")
							&& appAuthRepCargo.getFiling_rep_fst_nam() != null
							&& !appAuthRepCargo.getFiling_rep_fst_nam().trim()
									.equals("")
							&& appAuthRepCargo.getFiling_rep_last_nam() != null
							&& !appAuthRepCargo.getFiling_rep_last_nam().trim()
									.equals("")
							&& appAuthRepCargo.getAppl_fst_nam() != null
							&& !appAuthRepCargo.getAppl_fst_nam().trim()
									.equals("")
							&& appAuthRepCargo.getAuth_rep_fst_nam() != null
							&& !appAuthRepCargo.getAuth_rep_fst_nam().trim()
									.equals("")
							&& appAuthRepCargo.getAuth_rep_last_nam() != null
							&& !appAuthRepCargo.getAuth_rep_last_nam().trim()
									.equals("")) {
						isRecCpltInd = true;
					}
					if (isRecCpltInd && isAddress) {
						appLGCargo.setRec_cplt_ind("1");
					} else {
						appLGCargo.setRec_cplt_ind("0");
					}
					appAuthRepCargo.setApp_num(appNumber);
					if (appAuthRepCargo.getAppl_esign_ind() == null)
						appAuthRepCargo.setAppl_esign_ind("0");
					if (appAuthRepCargo.getAuth_rep_esign_ind() == null)
						appAuthRepCargo.setAuth_rep_esign_ind("0");
					if (appAuthRepCargo.getWitn_esign_ind() == null)
						appAuthRepCargo.setWitn_esign_ind("0");
				}
				// }
				// Now calling the validate method
				Map httpSessionMap = (Map) session
						.get(FwConstants.HTTP_SESSION);
				String language = (String) httpSessionMap
						.get(AppConstants.LANGUAGE);
				validateInfo = conValidatorObj.validateLGContactInfo(
						appAuthRepCargo, componentFlag, optSelected, language);
				if (validateInfo != null && validateInfo.hasMessages()) {
					request.put(FwConstants.MESSAGE_LIST, validateInfo);
					// pageCollection.put("APP_AR_LG_CNTC_Collection",appLGColl);
					pageCollection.put("APP_AUTH_REP_Collection",
							appAuthRepColl);
					pageCollection.put("INFO_TYPE", optSelected);
					pageCollection.put(FwConstants.PAGE_COMPONENT_LIST,
							beforeColl.get(FwConstants.PAGE_COMPONENT_LIST));
					return;
				}

				if (componentFlag) {
					if (appAuthRepBeforeColl != null
							&& appAuthRepBeforeColl.size() > 0) {

						// compare cargos
						appAuthRepCargo = (APP_AUTH_REP_Cargo) isChanged(
								appAuthRepBeforeColl.getCargo(0),
								appAuthRepCargo);
						if (appAuthRepCargo.isDirty()) {
							appAuthRepCargo
									.setRowAction(FwConstants.ROWACTION_UPDATE);
							authRepPersistFlag = true;
						}
					} else {
						appAuthRepCargo
								.setRowAction(FwConstants.ROWACTION_INSERT);
						authRepPersistFlag = true;
					}
					if (appAuthRepCargo.getAppl_fst_nam() == null
							|| appAuthRepCargo.getAppl_fst_nam().trim()
									.length() == 0) {
						appAuthRepCargo.setAppl_fst_nam(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getAppl_last_nam() == null
							|| appAuthRepCargo.getAppl_last_nam().trim()
									.length() == 0) {
						appAuthRepCargo.setAppl_last_nam(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getAppl_mid_init() == null
							|| appAuthRepCargo.getAppl_mid_init().trim()
									.length() == 0) {
						appAuthRepCargo.setAppl_mid_init(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getAuth_rep_fst_nam() == null
							|| appAuthRepCargo.getAuth_rep_fst_nam().trim()
									.length() == 0) {
						appAuthRepCargo.setAuth_rep_fst_nam(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getAuth_rep_last_nam() == null
							|| appAuthRepCargo.getAuth_rep_last_nam().trim()
									.length() == 0) {
						appAuthRepCargo.setAuth_rep_last_nam(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getAuth_rep_mid_init() == null
							|| appAuthRepCargo.getAuth_rep_mid_init().trim()
									.length() == 0) {
						appAuthRepCargo.setAuth_rep_mid_init(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getMa_fs_auth_rep_nam() == null
							|| appAuthRepCargo.getMa_fs_auth_rep_nam().trim()
									.length() == 0) {
						appAuthRepCargo
								.setMa_fs_auth_rep_nam(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getWitn_fst_nam() == null
							|| appAuthRepCargo.getWitn_fst_nam().trim()
									.length() == 0) {
						appAuthRepCargo.setWitn_fst_nam(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getWitn_last_nam() == null
							|| appAuthRepCargo.getWitn_last_nam().trim()
									.length() == 0) {
						appAuthRepCargo.setWitn_last_nam(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getWitn_mid_init() == null
							|| appAuthRepCargo.getWitn_mid_init().trim()
									.length() == 0) {
						appAuthRepCargo.setWitn_mid_init(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getBrg_crd_rcv_ind() == null
							|| appAuthRepCargo.getBrg_crd_rcv_ind().trim()
									.length() == 0) {
						appAuthRepCargo.setBrg_crd_rcv_ind(FwConstants.SPACE);
					}
					if (appAuthRepCargo.getRep_code() == null
							|| appAuthRepCargo.getRep_code().trim().length() == 0) {
						appAuthRepCargo.setRep_code(optSelected);
					}

					if (appAuthRepCargo.getSta_adr() == null
							|| appAuthRepCargo.getSta_adr().trim().length() == 0) {
						appAuthRepCargo.setSta_adr("WI");
					}
				}

				//
				/*
				 * appLGCargo.setApp_num(appNumber);
				 * 
				 * if(appLGCargo.getLtr_rcv_ind() == null ||
				 * appLGCargo.getLtr_rcv_ind().length() == 0 )
				 * appLGCargo.setLtr_rcv_ind(FwConstants.SPACE);
				 * if(appLGCargo.getLtr_lang_cd() == null ||
				 * appLGCargo.getLtr_lang_cd().length() == 0)
				 * appLGCargo.setLtr_lang_cd(FwConstants.SPACE);
				 * 
				 * if(optSelected.equals("AR") || optSelected.equals("POA")){
				 * if(appLGCargo.getLtr_rcv_ind().trim().length() == 0){
				 * appLGCargo.setRec_cplt_ind("0"); }else{
				 * appLGCargo.setRec_cplt_ind("1"); } }else{
				 * appLGCargo.setRec_cplt_ind("1"); }
				 * 
				 * if(appLGCargo.getEmail_adr() == null ||
				 * appLGCargo.getEmail_adr().length() == 0){
				 * appLGCargo.setEmail_adr(FwConstants.SPACE); }
				 * if(appLGCargo.getL2_adr() == null ||
				 * appLGCargo.getL2_adr().length() == 0){
				 * appLGCargo.setL2_adr(FwConstants.SPACE); }
				 * if(appLGCargo.getLtr_lang_cd() == null ||
				 * appLGCargo.getLtr_lang_cd().length() == 0){
				 * appLGCargo.setLtr_lang_cd(FwConstants.SPACE); }
				 * if(appLGCargo.getLtr_rcv_ind() == null ||
				 * appLGCargo.getLtr_rcv_ind().length() == 0){
				 * appLGCargo.setLtr_rcv_ind(FwConstants.SPACE); }
				 * if(appLGCargo.getMid_init() == null ||
				 * appLGCargo.getMid_init().length() == 0){
				 * appLGCargo.setMid_init(FwConstants.SPACE); }
				 * if(appLGCargo.getPhn_extn_num() == null ||
				 * appLGCargo.getPhn_extn_num().length() == 0){
				 * appLGCargo.setPhn_extn_num(FwConstants.SPACE); }
				 * 
				 * //Checking the Before Collection is Null or Not
				 * if(appLGBeforeColl != null && appLGBeforeColl.size()>0){
				 * appLGBeforeCargo = appLGBeforeColl.getCargo(0); //Now I am
				 * comparing the Cargos appLGCargo =
				 * (APP_AR_LG_CNTC_Cargo)isChanged(appLGBeforeCargo,appLGCargo);
				 * if(appLGCargo.isDirty()){
				 * appLGCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
				 * lGuardRersistFlag = true; } } else{ //We need to insert new
				 * record to the data base
				 * appLGCargo.setRowAction(FwConstants.ROWACTION_INSERT);
				 * lGuardRersistFlag = true; }
				 */

				// call persist method
				// Commented by Rashmi
				/*
				 * if(lGuardRersistFlag && !authRepPersistFlag)//persist only
				 * APP_AR_LG_CNTC_Collection
				 * contInfoBO.storeContactInfo(appLGColl, appAuthRepColl, 1);
				 * else if(authRepPersistFlag && !lGuardRersistFlag)//persist
				 * only APP_AUTH_REP_Collection
				 * contInfoBO.storeContactInfo(appLGColl, appAuthRepColl, 2);
				 * else if(lGuardRersistFlag && authRepPersistFlag)//persist
				 * both contInfoBO.storeContactInfo(appLGColl, appAuthRepColl,
				 * 3);
				 */
				if (authRepPersistFlag)// persist only APP_AR_LG_CNTC_Collection
					contInfoBO.storeContactInfo(appAuthRepColl);
			}
			int[] driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			// set current page as completed - C to driver
			driverManager.makeComplete(FwConstants.AFB_DRIVER, "ABCON",
					driverArray, appNumber);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeContactInformation");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeContactInformation", e);
			throw fe;
		}
	}

	public void getMailingAddressDetail(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		Map session = txnBean.getSession();
		Map pageCollection = txnBean.getPageCollection();

		Map addressmailingMap = null;
		String countyno = (String) session.get("CountyNum");
		ABRegistrationBO abregistrationbo = new ABRegistrationBO();

		addressmailingMap = abregistrationbo.getofficeaddress(countyno);
		pageCollection.put("OFFICE_ADDRESSES", addressmailingMap);

	}

	public void storeMailingAddressDetail(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		try {
			// APP_RGST_Cargo appRgstCargo = new APP_RGST_Cargo();
			// Map sqlMap = new HashMap();
			// Map addressmailingMap = new HashMap();
			Map session = txnBean.getSession();
			Map request = txnBean.getRequest();
			// Map pageCollection = txnBean.getPageCollection();
			int[] driverArray = null;
			String appNumber = null;
			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);

			// Get the APP_NUM from the Session
			appNumber = (String) session.get(AppConstants.APP_NUMBER);
			String tsrcAppInd = AppConstants.SRC_APP_IND_AFB;
			// added july 10
			ABRegistrationBO abregistrationbo = new ABRegistrationBO();
			String selectedofficenum = (String) request.get("OFFICE_ADDR");

			// String radioselect1 = (String)session.get("RadioSelect");
			session.put("RadioSelect", selectedofficenum);
			// Modified by Vikram <WR-BRGUS00315703>
			String countynum = (String) session.get("CountyNum");
			abregistrationbo.getselectedofficeaddress(selectedofficenum,
					appNumber, tsrcAppInd, countynum);
			// End
			// added july 10
			String currentPageId = (String) request
					.get(FwConstants.CURRENT_PAGE_ID);
			// driverManager.makeComplete(FwConstants.AFB_DRIVER,"ABEFD",driverArray,appNumber);
			driverManager.makeComplete(FwConstants.AFB_DRIVER, currentPageId,
					driverArray, appNumber);

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeMailingAddressDetail");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeMailingAddressDetail", e);
			throw fe;
		}
	}

	/**
	 * This method is used to store MA Short Form Information
	 * 
	 * @param txnBean
	 * @throws javax.ejb.EJBException
	 */
	public void storeMedicalShortFormInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		Map session = txnBean.getSession();
		Map request = txnBean.getRequest();
		Map pageCollection = txnBean.getPageCollection();

		APP_IN_PRFL_Collection appInPrflSession = (APP_IN_PRFL_Collection) session
				.get(AppConstants.APP_IN_PRFL_MASTER);

		FwMessageList validateInfo = null;
		int[] driverArray = null;
		String appNumber = null;
		Map beforeMap = null;

		APP_RQST_Collection appRqstColl = null;
		APP_RQST_Cargo appRqstCargo = null;

		try {
			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			appNumber = (String) session.get(AppConstants.APP_NUMBER);

			if (pageCollection.containsKey("APP_RQST_Collection")) {
				appRqstColl = (APP_RQST_Collection) pageCollection
						.get("APP_RQST_Collection");
				appRqstCargo = appRqstColl.getCargo(0);
			}

			ABProgramInformationBO programInfoBo = new ABProgramInformationBO();
			// here we are validating the user has selected a short form
			validateInfo = programInfoBo
					.validateShortFormSelection(appRqstCargo);
			if (validateInfo != null && validateInfo.hasMessages()) {
				String reqWarningMsgs = (String) request
						.get(FwConstants.WARNING_MSG_DETAILS);
				if (!this.checkForWarningMesgs(reqWarningMsgs,
						programInfoBo.getMessageList())) {
					request.put(FwConstants.MESSAGE_LIST, validateInfo);
					appRqstColl = new APP_RQST_Collection();
					appRqstColl.add(appRqstCargo);
					pageCollection.put("APP_RQST_Collection", appRqstColl);
					return;
				}
			}

			APP_RQST_Collection rqstRecordColl = programInfoBo
					.loadProgramInformation(appNumber);
			APP_RQST_Cargo rqstRecordCargo = rqstRecordColl.getCargo(0);

			// when change the MA request
			boolean isMaRqstChanged = false;
			String beforeMAType = null;
			if(rqstRecordCargo != null)
				beforeMAType = rqstRecordCargo.getMa_short_form_cd();
			if (beforeMAType != null
					&& !beforeMAType.equals(appRqstCargo.getMa_short_form_cd())) {

				isMaRqstChanged = true;
			}
            if(appRqstCargo != null){
            	rqstRecordCargo.setMa_short_form_cd(appRqstCargo
    					.getMa_short_form_cd());
            }

			rqstRecordCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
			rqstRecordColl.add(rqstRecordCargo);
			rqstRecordColl.persist(FwConstants.DAO);
			String[] hkPages = { "ABHKQ", "ABHKE", "ABMDS" };
			// Adde by uma BRGUS00288181
			String[] pfPages = { "ABPFQ", "ABHKE", "ABMDS" };
			String[] nfPages = { "ABNFI" };
			String[] maPages = { "ABMDQ", "ABMDS" };
			// Added by Indrani - for Assets getting included for PF and healthy
			// kids.
			// String[] assetPages = {"ABLAQ","ABLAS","ABOAQ","ABOAS"};
			String[] assetPages = { "ABLAQ", "ABLAD", "ABLAT", "ABLAS",
					"ABLIT", "ABLID", "ABBAT", "ABBAD", "ABAAT", "ABPPD",
					"ABVAT", "ABVAD", "ABRPT", "ABRPD", "ABOAQ", "ABOAS" };
			// Added by Uma for MA Short Forms BRGUS00288048
			String[] otherBills = { "ABOEQ" };
			// Modified by Sai Katta #BRGUS00288688
			String[] housingBills = { "ABHEQ", "ABHES" };

			// schedule the MA request
			if (appRqstCargo.getMa_short_form_cd().equals(
					AppConstants.MA_HEALTHY_KIDS)) {
				driverManager.makeRequired(FwConstants.AFB_DRIVER, hkPages,
						driverArray, appNumber);
				// Added by Uma for MA Short Forms BRGUS00288048
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						assetPages, driverArray, appNumber);
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						otherBills, driverArray, appNumber);
			} else if (appRqstCargo.getMa_short_form_cd().equals(
					AppConstants.MA_PLAN_FIRST)) {
				driverManager.makeRequired(FwConstants.AFB_DRIVER, pfPages,
						driverArray, appNumber);
				// Added by Uma for MA Short Forms BRGUS00288048
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						assetPages, driverArray, appNumber);
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						otherBills, driverArray, appNumber);
			} else if (appRqstCargo.getMa_short_form_cd().equals(
					AppConstants.MA_NURSING_FACILITY)) {
				driverManager.makeRequired(FwConstants.AFB_DRIVER, nfPages,
						driverArray, appNumber);
				// start of BRGUS00287295 by rotanak
				// make the registration infromation page not required
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						"ABRGI", driverArray, appNumber);
				// end of BRGUS00287295 by rotanak
				// Added by Uma for MA Short Forms BRGUS00288048
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						otherBills, driverArray, appNumber);
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						housingBills, driverArray, appNumber);

			} else if (appRqstCargo.getMa_short_form_cd().equals(
					AppConstants.ONLY_MA)) {
				driverManager.makeRequired(FwConstants.AFB_DRIVER, maPages,
						driverArray, appNumber);
				// Added by Uma for MA Short Forms BRGUS00288048
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						housingBills, driverArray, appNumber);
			}

			short[] programKey = (short[])session.get(FwConstants.AFB_PROGRAM_KEY);
			if(programManager.isMSPOnlyProgramRequested(programKey)){
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,new String[]{"ABMDQ","ABMDS"},driverArray,appNumber);
			}
			// unschedule the before ma request
			if (isMaRqstChanged) {
				if (beforeMAType.equals(AppConstants.MA_HEALTHY_KIDS)) {
					// Changed by Sanjeeva Nemani WR BRGUS00288830- Start
					String[] notRequiredPages = null;
					if (appRqstCargo.getMa_short_form_cd().equals(
							AppConstants.MA_PLAN_FIRST)) {
						notRequiredPages = new String[] { "ABHKQ" };
					} else {

						notRequiredPages = new String[] { "ABHKQ", "ABHKE",
								"ABHKC", "ABHKG", "ABHKR", "ABHCC" };
					}
					// Changed by Sanjeeva Nemani WR BRGUS00288830 - End
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);
					ABMAHealthyKidsBO healthyKidsBO = new ABMAHealthyKidsBO();

					APP_IN_MI_CHILD_EXPENSE_Collection appInMiChExpCC = healthyKidsBO
							.loadHealthyKidsDetails(appNumber);
					if (appInMiChExpCC != null && appInMiChExpCC.size() > 0) {
						healthyKidsBO
								.deleteAllHealthyKidsDetails(appInMiChExpCC);
					}

					short[] fieldName = { IApplicationManager.CHILD_SUPPORT_SW,
							IApplicationManager.CHILD_CARE_SW,
							IApplicationManager.PAST_HEALTH_INSURANCE_SW,
							IApplicationManager.SPECIAL_HEALTH_CARE_SW,
							IApplicationManager.RENTAL_PROPERTY_EXP_SW,
							IApplicationManager.HEALTH_INSURANCE_SW,
							IApplicationManager.COURT_ORDERED_GUARDIAN_SW,
							IApplicationManager.STATE_HEALTH_INSURANCE_SW,
							IApplicationManager.PAST_CASH_MEDICAL_SW, };

					if (appInPrflSession != null && appInPrflSession.size() > 0) {
						for (int i = 0; i < appInPrflSession.size(); i++) {
							APP_IN_PRFL_Cargo cargo = appInPrflSession
									.getCargo(i);

							cargo.setHealth_insurance_sw("N");
							cargo.setPast_health_insurance_sw("N");
							cargo.setState_health_insurance_sw("N");
							cargo.setSpecial_health_care_sw("N");
							cargo.setPast_cash_medical_sw("N");
							cargo.setChild_support_sw("N");
							cargo.setCourt_ordered_guardian_sw("N");
							cargo.setChild_care_sw("N");
							cargo.setRental_property_exp_sw("N");

							applicationManager.persist(appNumber,
									cargo.getIndv_seq_num(), fieldName,
									new String[] { "N", "N", "N", "N", "N",
											"N", "N", "N", "N" });
						}
					}
				} else if (beforeMAType.equals(AppConstants.MA_PLAN_FIRST)) {
					// Changed by Sanjeeva Nemani WR BRGUS00288830 - Start
					String[] notRequiredPages = null;
					if (appRqstCargo.getMa_short_form_cd().equals(
							AppConstants.MA_HEALTHY_KIDS)) {
						notRequiredPages = new String[] { "ABPFQ" };
					} else {
						notRequiredPages = new String[] { "ABPFQ", "ABHKE",
								"ABHKC", "ABHKG", "ABHKR", "ABHCC" };
					}
					// Changed by Sanjeeva Nemani WR BRGUS00288830- End
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);
					// Adde by Uma for BRGUS00288181
					ABMAHealthyKidsBO healthyKidsBO = new ABMAHealthyKidsBO();

					APP_IN_MI_CHILD_EXPENSE_Collection appInMiChExpCC = healthyKidsBO
							.loadHealthyKidsDetails(appNumber);
					if (appInMiChExpCC != null && appInMiChExpCC.size() > 0) {
						healthyKidsBO
								.deleteAllHealthyKidsDetails(appInMiChExpCC);
					}
					short[] fieldName = {
							IApplicationManager.PLAN_FIRST_MEDICAL_SW,
							IApplicationManager.PLAN_FIRST_MEDICARE_SW,
							IApplicationManager.PLAN_FIRST_MEDICAID_SW,
							IApplicationManager.PLAN_FIRST_OTHER_HEALTH_SW,
							IApplicationManager.CHILD_SUPPORT_SW,
							IApplicationManager.CHILD_CARE_SW,
							IApplicationManager.COURT_ORDERED_GUARDIAN_SW,
							IApplicationManager.RENTAL_PROPERTY_EXP_SW };

					if (appInPrflSession != null && appInPrflSession.size() > 0) {
						for (int i = 0; i < appInPrflSession.size(); i++) {
							APP_IN_PRFL_Cargo cargo = appInPrflSession
									.getCargo(i);

							cargo.setPlan_first_medicaid_sw("N");
							cargo.setPlan_first_medical_sw("N");
							cargo.setPlan_first_medicare_sw("N");
							cargo.setPlan_first_other_health_sw("N");
							cargo.setChild_support_sw("N");
							cargo.setCourt_ordered_guardian_sw("N");
							cargo.setChild_care_sw("N");
							cargo.setRental_property_exp_sw("N");

							applicationManager.persist(appNumber,
									cargo.getIndv_seq_num(), fieldName,
									new String[] { "N", "N", "N", "N", "N",
											"N", "N", "N" });
						}
					}

				} else if (beforeMAType
						.equals(AppConstants.MA_NURSING_FACILITY)) {

					String[] notRequiredPages = { "ABNFI" };
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);
					driverManager.makeRequired(FwConstants.AFB_DRIVER, "ABRGI",
							driverArray, appNumber);

					// leaving for nursing facility
				} else if (beforeMAType.equals(AppConstants.ONLY_MA)) {
					// Modified by Sai Katta #BRGUS00288688
					String[] notRequiredPages = { "ABMDQ", "ABMEA", "ABMRE",
							"ABMDD", "ABMCD", "ABMDT", "ABMDA", "ABHEQ",
							"ABHES" };
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);

					ABMedicalDetailsBO appInMedDetBO = new ABMedicalDetailsBO();
					ABMedicalCoverageDetailsBO appInMedCvgBO = new ABMedicalCoverageDetailsBO();
					ABMedicalDisabilityApplicationDetailsBO appInMedDblBO = new ABMedicalDisabilityApplicationDetailsBO();

					APP_IN_MEDICAL_DETAIL_Collection earlyOnColl = appInMedDetBO
							.loadMedicalDetailsAFB(appNumber,
									AppConstants.EARLY_ON);
					if (earlyOnColl != null && earlyOnColl.size() > 0) {
						appInMedDetBO.deleteMedicalDetails(earlyOnColl,
								AppConstants.EARLY_ON);
					}
					APP_IN_MEDICAL_DETAIL_Collection speEduColl = appInMedDetBO
							.loadMedicalDetailsAFB(appNumber,
									AppConstants.SPECIAL_EDUCATION);
					if (speEduColl != null && speEduColl.size() > 0) {
						appInMedDetBO.deleteMedicalDetails(speEduColl,
								AppConstants.SPECIAL_EDUCATION);
					}
					APP_IN_MEDICAL_DETAIL_Collection rehabColl = appInMedDetBO
							.loadMedicalDetailsAFB(appNumber,
									AppConstants.REHAB_SERVICE);
					if (rehabColl != null && rehabColl.size() > 0) {
						appInMedDetBO.deleteMedicalDetails(rehabColl,
								AppConstants.REHAB_SERVICE);
					}
					APP_IN_MEDICAL_COVERAGE_Collection medCvgColl = appInMedCvgBO
							.loadMedicalCoverageDetails(appNumber);
					if (medCvgColl != null && medCvgColl.size() > 0) {
						appInMedCvgBO.deleteMedicalCoverage(medCvgColl);
					}
					APP_IN_MEDICAL_DISABILITY_Collection medDblColl = appInMedDblBO
							.loadDisabilityApplicationDetails(appNumber);
					if (medDblColl != null && medDblColl.size() > 0) {
						appInMedDblBO.deleteDisabilityApplication(medDblColl);
					}

					short[] fieldName = {
							IApplicationManager.DOMESTIC_VIOLENCE_VICTIM_RESP,
							IApplicationManager.IMMUNIZATION_RESP,
							IApplicationManager.SPECIAL_HEALTH_SERVICE_RESP,
							IApplicationManager.EARLY_ON_RESP,
							IApplicationManager.SPECIAL_EDUCATION_CLASS_RESP,
							IApplicationManager.ALCOHOL_DRUG_TREATMENT_RESP,
							IApplicationManager.MI_REHAB_RESP,
							IApplicationManager.CARETAKER_RESP,
							IApplicationManager.MEDICAL_COVERAGE_RESP,
							IApplicationManager.APPLIED_FOR_DISABILITY_RESP,
							IApplicationManager.SOCIAL_SECURITY_RESP,
							IApplicationManager.SUPPLEMENTAL_INCOME_RESP,
							IApplicationManager.OTHER_DISABILITY_RESP };

					if (appInPrflSession != null && appInPrflSession.size() > 0) {
						for (int i = 0; i < appInPrflSession.size(); i++) {
							APP_IN_PRFL_Cargo currentCargo = appInPrflSession
									.getCargo(i);

							applicationManager.persist(appNumber,
									currentCargo.getIndv_seq_num(), fieldName,
									new String[] { "N", "N", "N", "N", "N",
											"N", "N", "N", "N", "N", "N", "N",
											"N" });

							currentCargo.setDomestic_violence_victim_resp("N");
							currentCargo.setImmunization_resp("N");
							currentCargo.setSpecial_health_service_resp("N");
							currentCargo.setEarly_on_resp("N");
							currentCargo.setSpecial_education_class_resp("N");
							currentCargo.setOp_aoda_tmt_rcv_sw("N");
							currentCargo.setMi_rehab_resp("N");
							currentCargo.setCaretaker_resp("N");
							currentCargo.setMedical_coverage_resp("N");
							currentCargo.setApplied_for_disability_resp("N");
							currentCargo.setSocial_security_resp("N");
							currentCargo.setSupplemental_income_resp("N");
							currentCargo.setOther_disability_resp("N");
						}
					}

				}
			}

			String currentPageId = (String) request
					.get(FwConstants.CURRENT_PAGE_ID);
			// driverManager.makeComplete(FwConstants.AFB_DRIVER,"ABEFD",driverArray,appNumber);
			driverManager.makeComplete(FwConstants.AFB_DRIVER, currentPageId,
					driverArray, appNumber);

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeMedicalShortFormInformation");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeMedicalShortFormInformation", e);
			throw fe;
		}
	}

	/**
	 * This method is used to get MA Short Form Information
	 * 
	 * @param txnBean
	 * @throws javax.ejb.EJBException
	 */
	public void getMedicalShortFormInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		Map session = txnBean.getSession();
		Map request = txnBean.getRequest();
		Map pageCollection = txnBean.getPageCollection();

		int[] driverArray = null;
		String appNumber = null;

		try {
			appNumber = (String) session.get(AppConstants.APP_NUMBER);
			ABProgramInformationBO programInfoBo = new ABProgramInformationBO();
			APP_RQST_Collection appRqstColl = programInfoBo
					.loadProgramInformation(appNumber);
			pageCollection.put("APP_RQST_Collection", appRqstColl);
			txnBean.setPageCollection(pageCollection);
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getMedicalShortFormInformation");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getMedicalShortFormInformation", e);
			throw fe;
		}

	}
	
	private void setValuesForCard(Map request,Map session,String appNumber,PeopleHandler peopleHandler){
		//Loading and merging APP_RGST in ABHMD (ILIES-174329)
		ABRegistrationBO registrationBo = new ABRegistrationBO();
		ABHouseHoldMemberBO houseHoldBo = new ABHouseHoldMemberBO();
		ABAbsentParentBO absentParentBo = new ABAbsentParentBO();
		ABHouseholdMembersSummaryBO householdMembersSummaryBO = new ABHouseholdMembersSummaryBO();
		Map httpSession = (Map) session.get(FwConstants.HTTP_SESSION);
		String languageCd = (String)httpSession.get(AppConstants.LANGUAGE);
		// Forming individual sequence array 		
		INDIVIDUAL_Custom_Collection indvColl = peopleHandler.getSortedIndividualsByIndvSeqNum();
		int indvCollSize = indvColl.size();
		String[] indvSeq = new String[indvCollSize]; 			
		// Getting all indv seq numbers
		for(int i=0;i<indvCollSize;i++){ 
			indvSeq[i] = indvColl.getResult(i).getIndv_seq_num();
		}
		// Calling business object to load the household relationship information list view
		INDIVIDUAL_Custom_Collection indvAllColl = peopleHandler.sortIndividuals(peopleHandler.getInAndOutOfHomeIndividuals(appNumber));
		int indvAllCollSize = indvAllColl.size();
		String[] indvAllSeq = new String[indvAllCollSize]; 
		for(int i=0;i<indvAllCollSize;i++){ 
			indvAllSeq[i] = indvAllColl.getResult(i).getIndv_seq_num();
		}
		APP_HSHL_RLT_Collection appHshlRltCollection = householdMembersSummaryBO.loadHouseholdRelationshipsSummary(appNumber, indvAllSeq);
		appHshlRltCollection = this.sortRelationshipCargoOnIndvSeq(appHshlRltCollection);
		//Absent parent info
		APP_IN_ABSNP_Collection appInAbsnpCollection = absentParentBo.loadAppInAbsnpDetail(appNumber);
		
		Map registration_map = registrationBo.loadAddressContactInformation(appNumber);
		APP_RGST_Collection rgst_collection = registration_map.size() > 0 ? (APP_RGST_Collection) registration_map.get("APP_RGST_Collection") : new APP_RGST_Collection();
		APP_RGST_Cargo registration_info = rgst_collection.size() > 0 ? (APP_RGST_Cargo) rgst_collection.get(0) : new APP_RGST_Cargo();
		APP_INDV_Collection appIndvColl = houseHoldBo.loadAppIndvColl(appNumber);
		short[] programKeyArray = (short[])session.get(FwConstants.AFB_PROGRAM_KEY);
		Map<String,String> program_array = new HashMap<String,String>();
		IPage pageManager = FwPageManager.createInstance();
		program_array.put("2",programKeyArray[2]== 1 ? pageManager.getDisplayText(30377, languageCd) : FwConstants.EMPTY_STRING);
		program_array.put("3",programKeyArray[3]== 1 ? pageManager.getDisplayText(80187, languageCd) : FwConstants.EMPTY_STRING);
		program_array.put("7",programKeyArray[7]== 1 ? pageManager.getDisplayText(98710, languageCd) : FwConstants.EMPTY_STRING);
		program_array.put("0",programKeyArray[0]== 1 ? pageManager.getDisplayText(80134, languageCd) : FwConstants.EMPTY_STRING);
		program_array.put("8",programKeyArray[8]== 1 ? pageManager.getDisplayText(1800087, languageCd) : FwConstants.EMPTY_STRING);

		//Approved representative info 
		APP_AUTH_REP_Collection rprInfoColl = new APP_AUTH_REP_Collection();
		ABRegistrationSummaryBO registrationSummaryBO = new ABRegistrationSummaryBO();
		String helpOptionSelected = "0";
		String[] options = { "3", "4", "5" }; // 3->Auth Rep ; 4->Legal
												// Guardian ; 5->Power of
												// Attorney
		List optionTypeList = Arrays.asList(options);
		helpOptionSelected = registrationSummaryBO.loadHelpWithApplSummary(appNumber);
		if (optionTypeList.contains(helpOptionSelected)) {// call BO to get
															// Contact Info
															// Colleation
			rprInfoColl = registrationSummaryBO.getContactInfoSummary(appNumber);
		}
		request.put("APP_AUTH_REP_COLLECTION",rprInfoColl);
		//Absent parent info
		APP_ABS_PRNT_Cust_Collection appAbsPrntCustCollection = householdMembersSummaryBO.loadOtherParentSummary(appNumber, indvSeq);
		request.put("APP_ABS_PRNT_Cust_COLLECTION",appAbsPrntCustCollection);
		
		request.put("registration_info",registration_info);
		request.put("appIndvColl", appIndvColl);
		request.put("appHshlRltCollection", appHshlRltCollection);
		request.put("program_array",program_array);
		request.put("appInAbsnpCollection",appInAbsnpCollection);
		request.put("indvAllColl", indvAllColl);
	
	}
	
	/**
	* Method sort the relationship cargos in a sequence order of indv seq num
	*@param appHshlRltColl gov.wisconsin.access.business.entities.APP_HSHL_RLT_Collection
	*@param sortedRetionshipColl gov.wisconsin.access.business.entities.APP_HSHL_RLT_Collection
	*@author govinpr 
	*/
	private APP_HSHL_RLT_Collection sortRelationshipCargoOnIndvSeq(APP_HSHL_RLT_Collection appHshlRltColl) throws javax.ejb.EJBException {

		try {
			APP_HSHL_RLT_Collection sortedRetionshipColl = new APP_HSHL_RLT_Collection();
			APP_HSHL_RLT_Cargo tempCargo = null; 
			boolean found = false;			
			if(appHshlRltColl != null ){
				if(appHshlRltColl.size() > 1){
					int appHshlRltCollSize = appHshlRltColl.size();
					for(int i=0;i<appHshlRltCollSize;i++){
						int indSeq = Integer.parseInt(appHshlRltColl.getCargo(i).getSrc_indv_seq_num());
						for(int j=0;j<appHshlRltCollSize;j++){
							int tempSeq = Integer.parseInt(appHshlRltColl.getCargo(j).getSrc_indv_seq_num());
							if(indSeq > tempSeq){
								indSeq = tempSeq;
								tempCargo = appHshlRltColl.getCargo(j);
								found = true;
							}
						}
						if(!found){
							tempCargo = appHshlRltColl.getCargo(i);
							found = false;
						}
						if(tempCargo != null) {
							sortedRetionshipColl.addCargo(tempCargo);
							appHshlRltColl.remove(tempCargo);
							i--;
							appHshlRltCollSize--;
							tempCargo = null;
							found = false;
						}
					}
					if(appHshlRltColl.size() > 0) {
						sortedRetionshipColl.addAll(appHshlRltColl);
					}
				}else{
					sortedRetionshipColl = appHshlRltColl;
				}
			}
			return sortedRetionshipColl;
		} catch(FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("sortRelationshipCargoOnIndvSeq");
			we.setFwException(fe);
			throw we;
		} catch(Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(), "sortRelationshipCargoOnIndvSeq", e);
			throw fe;
		}
	}


}