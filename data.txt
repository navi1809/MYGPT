private APP_IN_SELFE_Collection getAppInSELFECollection(APP_IN_SELFE_Collection appInSELFECollection, int indvSeqNumber) {
		APP_IN_SELFE_Collection returnSELFEColl=new APP_IN_SELFE_Collection();
			for(int i=0;i<appInSELFECollection.size();i++){
				APP_IN_SELFE_Cargo returnSELFECargo= (APP_IN_SELFE_Cargo) appInSELFECollection.get(i);
							int cargo_indv_seq_num=Integer.parseInt(returnSELFECargo.getIndv_seq_num());
							if(cargo_indv_seq_num==indvSeqNumber){
								returnSELFEColl.addCargo(returnSELFECargo);
							}
				}
			return returnSELFEColl;
	}

	private APP_IN_SHLTC_Collection getAppInSHLTCIndvCollection(APP_IN_SHLTC_Collection appInSHLTCCollection, int indvSeqNumber, String shelterTypeCD) {
		APP_IN_SHLTC_Collection returnSHLTCColl=new APP_IN_SHLTC_Collection();
		for(int i=0;i<appInSHLTCCollection.size();i++){
			APP_IN_SHLTC_Cargo returnSHLTCCargo= (APP_IN_SHLTC_Cargo) appInSHLTCCollection.get(i);
						int cargo_indv_seq_num=Integer.parseInt(returnSHLTCCargo.getIndv_seq_num());
						String cargo_shelterTypeCD=returnSHLTCCargo.getShlt_typ();
						if(cargo_indv_seq_num==indvSeqNumber && cargo_shelterTypeCD.equalsIgnoreCase(shelterTypeCD)){
							returnSHLTCColl.addCargo(returnSHLTCCargo);
						}
			}
		return returnSHLTCColl;
	}
	
	private APP_IN_UEI_Collection getAppInUEICollection(APP_IN_UEI_Collection appInUEIColl, int indvSeqNumber, String otherIncomeType) {
		APP_IN_UEI_Collection returnUEIOtherColl=new APP_IN_UEI_Collection();
		for(int i=0;i<appInUEIColl.size();i++){
			APP_IN_UEI_Cargo returnUEICargo= (APP_IN_UEI_Cargo) appInUEIColl.get(i);
						int cargo_indv_seq_num=Integer.parseInt(returnUEICargo.getIndv_seq_num());
						String cargo_shelterTypeCD=returnUEICargo.getUei_typ();
						if(cargo_indv_seq_num==indvSeqNumber && cargo_shelterTypeCD.equalsIgnoreCase(otherIncomeType)){
							returnUEIOtherColl.addCargo(returnUEICargo);
						}
			}
		return returnUEIOtherColl;
	}
	
	private APP_IN_LQD_ASET_Collection getAppInLQDASETCollection(APP_IN_LQD_ASET_Collection appInLQDASETColl, int indvSeqNumber) {
		APP_IN_LQD_ASET_Collection returnLQDASETColl=new APP_IN_LQD_ASET_Collection();
		for(int i=0;i<appInLQDASETColl.size();i++){
			APP_IN_LQD_ASET_Cargo returnLQDASETCargo= (APP_IN_LQD_ASET_Cargo) appInLQDASETColl.get(i);
						if(returnLQDASETCargo.getIndv_seq_num()!=null){
							if( Integer.parseInt(returnLQDASETCargo.getIndv_seq_num())== indvSeqNumber){
								returnLQDASETColl.addCargo(returnLQDASETCargo);
							}
						}
			}
		return returnLQDASETColl;
	}
	
	private APP_IN_SUPPORT_DETAIL_Collection getAppInSupportDetailCollection(APP_IN_SUPPORT_DETAIL_Collection appInSupportDetailCollection, int indvSeqNumber) {
		APP_IN_SUPPORT_DETAIL_Collection retApp_IN_SUPPORT_DETAIL_Collection=new APP_IN_SUPPORT_DETAIL_Collection();
		for(int i=0;i<appInSupportDetailCollection.size();i++){
			APP_IN_SUPPORT_DETAIL_Cargo returnSupport_DETAIL_Cargo= (APP_IN_SUPPORT_DETAIL_Cargo) appInSupportDetailCollection.get(i);
						if(returnSupport_DETAIL_Cargo.getIndv_seq_num()!=null){
							if( Integer.parseInt(returnSupport_DETAIL_Cargo.getIndv_seq_num())== indvSeqNumber){
								retApp_IN_SUPPORT_DETAIL_Collection.addCargo(returnSupport_DETAIL_Cargo);
							}
						}
			}
		return retApp_IN_SUPPORT_DETAIL_Collection;
	}
	
	private APP_IN_EMPL_A_WAGE_Cargo getAppInEMPL_A_WAGECargo(APP_IN_EMPL_A_WAGE_Collection appInEMPL_A_WAGEColl, int indvSeqNumber, String wageType, int employeeSeqNum) {
		for(int i=0;i<appInEMPL_A_WAGEColl.size();i++){
			APP_IN_EMPL_A_WAGE_Cargo returnWAGECargo= (APP_IN_EMPL_A_WAGE_Cargo) appInEMPL_A_WAGEColl.get(i);
						int cargo_indv_seq_num=Integer.parseInt(returnWAGECargo.getIndv_seq_num());
						String cargo_wageTypeCD=returnWAGECargo.getAdtl_pay_seq_num();
						int cargo_employee_seq_num=Integer.parseInt(returnWAGECargo.getEmpl_seq_num());
						if(cargo_indv_seq_num==indvSeqNumber && cargo_wageTypeCD.equalsIgnoreCase(wageType) && (cargo_employee_seq_num==employeeSeqNum)){
							return returnWAGECargo;
						}
			}
		return null;
	}
	
	private APP_IN_EMPL_Collection getAppInEMPLCollection(APP_IN_EMPL_Collection appInEMPLColl, int indvSeqNumber) {
		APP_IN_EMPL_Collection returnEMPLColl=new APP_IN_EMPL_Collection();
		for(int i=0;i<appInEMPLColl.size();i++){
			APP_IN_EMPL_Cargo returnEMPLCargo= (APP_IN_EMPL_Cargo) appInEMPLColl.get(i);
						int cargo_indv_seq_num=Integer.parseInt(returnEMPLCargo.getIndv_seq_num());
						if(cargo_indv_seq_num==indvSeqNumber){
							returnEMPLColl.addCargo(returnEMPLCargo);
						}
			}
		return returnEMPLColl;		
	}
	

	//	Returns individuals who are eligible for Expedited SNAP 
	public INDIVIDUAL_Custom_Collection getExpeditedSNAPHouseHoldCollection(INDIVIDUAL_Custom_Collection aIndvCustomColl, String appNumber)
	{
			INDIVIDUAL_Custom_Collection expSNAPColl = new INDIVIDUAL_Custom_Collection();
			ABRelevanceBO relevanceBO = new ABRelevanceBO();
				APP_HSHL_RLT_Collection houseHoldCollection=new APP_HSHL_RLT_Collection();
				houseHoldCollection=relevanceBO.loadHSHLRLT(appNumber);					//Taking Relationship Detail for this individual
			int size = houseHoldCollection.size();
			
			//add Primary User/People to Exp.SnapCollection
			expSNAPColl.add(getIndvCargo(aIndvCustomColl,1));
			for(int i=0; i<size; i++){
				APP_HSHL_RLT_Cargo relationCargo=houseHoldCollection.getCargo(i);
				int refIndvSeqNum=Integer.parseInt(relationCargo.getRef_indv_seq_num());
				int srcIndvSeqNum= Integer.parseInt(relationCargo.getSrc_indv_seq_num());
				// check if atleast on is Primary User/People
				if((refIndvSeqNum==1 || srcIndvSeqNum==1) && (relationCargo.getPnp_tghr_sw().equalsIgnoreCase("Y"))){ //otherwise ignore that cargo
					if(refIndvSeqNum==1){
						expSNAPColl.add(getIndvCargo(aIndvCustomColl,srcIndvSeqNum));
					}else{
						expSNAPColl.add(getIndvCargo(aIndvCustomColl,refIndvSeqNum));
					}
				}
			}
			return expSNAPColl;
	}
//Method to get CargoByIndvSeqNum from collection
	private INDIVIDUAL_Custom_Cargo getIndvCargo(INDIVIDUAL_Custom_Collection aIndvCustomColl, int indvSeqNum) {
		for(int i=0;i<aIndvCustomColl.size();i++){
			INDIVIDUAL_Custom_Cargo indvCustomCargo= (INDIVIDUAL_Custom_Cargo) aIndvCustomColl.get(i);
			if(Integer.parseInt(indvCustomCargo.getIndv_seq_num())==indvSeqNum){
				return indvCustomCargo;
			}
	}
		return null;
	}
	//Method to get App_in_prfl_cargo from collection
	private APP_IN_PRFL_Cargo getappINDVCargo(APP_IN_PRFL_Collection aIndvCustomColl, int indvSeqNum) {
		for(int i=0;i<aIndvCustomColl.size();i++){
			APP_IN_PRFL_Cargo appInPrflCargo= (APP_IN_PRFL_Cargo) aIndvCustomColl.get(i);
			if(Integer.parseInt(appInPrflCargo.getIndv_seq_num())==indvSeqNum){
				return appInPrflCargo;
			}
	}
		return null;
	}
	
	private APP_IN_SUPPORT_DETAIL_Cargo getAppInSupportDetailCargo(APP_IN_SUPPORT_DETAIL_Collection appInSupportDetailColl, String appNumber) {
		for(int i=0;i<appInSupportDetailColl.size();i++){
			APP_IN_SUPPORT_DETAIL_Cargo app_IN_SUPPORT_DETAIL_Cargo= (APP_IN_SUPPORT_DETAIL_Cargo) appInSupportDetailColl.get(i);
			if(app_IN_SUPPORT_DETAIL_Cargo.getApp_num().equals(appNumber)){
				return app_IN_SUPPORT_DETAIL_Cargo;
			}
	}
		return null;
	}
	//APP_PGM_RQST_Collection
	private APP_PGM_RQST_Cargo getappPGMRQSTCargo(APP_PGM_RQST_Collection app_PGM_RQST_Collection, String appNumber) {
		for(int i=0;i<app_PGM_RQST_Collection.size();i++){
			APP_PGM_RQST_Cargo appPGMRQSTCargo= (APP_PGM_RQST_Cargo) app_PGM_RQST_Collection.get(i);
			if(appPGMRQSTCargo.getApp_num().equals(appNumber)){
				return appPGMRQSTCargo;
			}
	}
		return null;
	}
	
	private APP_PRIR_SRV_Cargo getappPRIRSRVCargo(APP_PRIR_SRV_Collection app_PRIR_SRV_Collection, String appNumber) {
		for(int i=0;i<app_PRIR_SRV_Collection.size();i++){
			APP_PRIR_SRV_Cargo app_PRIR_SRV_Cargo= (APP_PRIR_SRV_Cargo) app_PRIR_SRV_Collection.get(i);
			if(app_PRIR_SRV_Cargo.getApp_num().equals(appNumber)){
				return app_PRIR_SRV_Cargo;
			}
	}
		return null;
	}
	// END: added by Arpanday for expedited snap : ILIES-174321
	
	/**
	 * This method is used for getting the program inforamtion
	 */
	public void getProgramInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {
		Map session = txnBean.getSession();
		Map pageCollection = null;
		String appNumber = null;
		short[] programKeyArray = null;
		short[] hcProgramKey = null;
		ABSERAssistanceBO assistanceBO = new ABSERAssistanceBO();

		try {
			appNumber = (String) session.get(AppConstants.APP_NUMBER);
			if (session.get(FwConstants.AFB_DRIVER) == null) {
				// we need to get the driver information from the data base.
				// we need to create the driver array
				int[] driver = driverManager.loadDriver(FwConstants.AFB_DRIVER,
						appNumber);
				session.put(FwConstants.AFB_DRIVER, driver);
			}
			// if we found in the session we will get those values and display
			// in the page
			if (session.get(FwConstants.AFB_PROGRAM_KEY) != null) {
				programKeyArray = (short[]) session
						.get(FwConstants.AFB_PROGRAM_KEY);
			}
			// else we load the program key from the program manager
			else {
				Map pgmKey = (Map) programManager.loadProgramKey(appNumber);
				programKeyArray = (short[]) pgmKey.get("0");
				// hcProgramKey = (short[])pgmKey.get("1");
				// programKeyArray[3] = hcProgramKey[0];
			}
			session.put(FwConstants.AFB_PROGRAM_KEY, programKeyArray);

			// now i am setting the values to the collection
			APP_PGM_RQST_Collection appPgmRqstColl = new APP_PGM_RQST_Collection();
			APP_PGM_RQST_Cargo appPgmRqstCargo = new APP_PGM_RQST_Cargo();
			appPgmRqstCargo.setApp_num(appNumber);
			appPgmRqstCargo.setFma_rqst_ind(String.valueOf(programKeyArray[0]));
			appPgmRqstCargo.setFpw_rqst_ind(String.valueOf(programKeyArray[1]));
			appPgmRqstCargo.setFs_rqst_ind(String.valueOf(programKeyArray[2]));
			appPgmRqstCargo.setSer_rqst_ind(String.valueOf(programKeyArray[5]));
			appPgmRqstCargo.setSer_burial_request_ind(String
					.valueOf(programKeyArray[6]));
			appPgmRqstCargo.setHc_rqst_ind(String.valueOf(programKeyArray[3]));
			appPgmRqstCargo.setMedicare_rqst_ind(String
					.valueOf(programKeyArray[7]));
			appPgmRqstCargo.setFpp_rqst_ind(String.valueOf(programKeyArray[8]));
			
			if (AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo
					.getSer_rqst_ind())) {
				APP_PGM_RQST_Collection appPgmRqstCollforEdi = assistanceBO
						.getAppPgmRqstDeatils(appNumber);
				APP_PGM_RQST_Cargo appPrmRqstCargoForEdi = appPgmRqstCollforEdi
						.getCargo(0);
				appPgmRqstCargo.setEdi_acceptable_sw(appPrmRqstCargoForEdi
						.getEdi_acceptable_sw());
			}
			appPgmRqstColl.add(appPgmRqstCargo);
			pageCollection = new HashMap();
			pageCollection.put("APP_PGM_RQST_Collection", appPgmRqstColl);

			// now i am getting the months
			ABProgramInformationBO programInfoBo = new ABProgramInformationBO();
			APP_RQST_Collection appRqstColl = programInfoBo
					.loadProgramInformation(appNumber);
			// Loading Medicaid months
			// int i =0;
			pageCollection.put("MA_BACK_DTD_MTS",
					dateRoutine.getBackDatedMonths(fwDate.getDate()));
			if (appRqstColl != null && appRqstColl.size() > 0) {
				APP_RQST_Cargo appRqstCargo = appRqstColl.getCargo(0);
				/*int currentMonth = fwDate.getMonth(fwDate.getDate());
				int startDateMonth = 0;

				if (appRqstCargo.getApp_strt_tms() == null) {
					startDateMonth = currentMonth;
				} else {
					startDateMonth = fwDate.getMonth(dateRoutine
							.getDateFromTimeStamp(appRqstCargo.getUpdt_dt()));
				}
				if (startDateMonth != currentMonth) {
					appRqstCargo.setMa_backdt_mo_1_ind("0");
					appRqstCargo.setMa_backdt_mo_2_ind("0");
					appRqstCargo.setMa_backdt_mo_3_ind("0");
				}*/
				pageCollection.put("APP_RQST_Collection", appRqstColl);
			}

			// Retro changed
			APP_PRFL_Collection appPrflColl = null;
			Map beforeMap = (Map) session.get(FwConstants.BEFORE_COLLECTION);
			if (beforeMap == null
					|| !beforeMap.containsKey("APP_PRFL_Collection")) {
				appPrflColl = appProfileManager.loadProfile(appNumber);
			} else {
				appPrflColl = (APP_PRFL_Collection) beforeMap
						.get("APP_PRFL_Collection");
			}
			pageCollection.put("APP_PRFL_Collection", appPrflColl);

			String providerInterface = FwConfigurationManager.getInstance()
					.getEnvironmentProperty(AppConstants.PROVIDER_INTERFACE_SW);
			pageCollection.put("PROVIDER_INTERFACE", providerInterface);
			txnBean.setPageCollection(pageCollection);
			session.put(FwConstants.BEFORE_COLLECTION, pageCollection);
			//ILIES-282236 changes start here .Removing the values from session
			ABRegistrationBO regBo = new ABRegistrationBO();
			regBo.clearSessionOfWarningMsgOnSaveAndExitFunc(session);//Removing the values from session.
			//ILIES-282236 changes end here

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getProgramInformation");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getProgramInformation", e);
			throw fe;
		}
	}

	/**
	 * Store program inforamtion
	 */
	public void storeProgramInformation(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		Map session = txnBean.getSession();
		Map request = txnBean.getRequest();
		Map pageCollection = txnBean.getPageCollection();

		FwMessageList validateInfo = null;
		int[] driverArray = null;
		String appNumber = null;
		Map beforeMap = null;
		APP_PGM_RQST_Collection appPgmRqstBeforeColl = null;
		APP_PGM_RQST_Cargo appPgmRqstCargo = null;
		APP_PGM_RQST_Cargo appPgmRqstBeforeCargo = null;
		APP_PGM_RQST_Collection appPgmRqstColl = null;
		APP_RQST_Collection appRqstColl = null;
		APP_RQST_Collection appRqstBeforeColl = null;
		APP_RQST_Cargo appRqstCargo = null;
		APP_RQST_Cargo appRqstBeforeCargo = null;
		APP_RGST_Collection appRgstAfterColl = null;
		APP_RGST_Cargo appRgstAfterCargo = null;
		boolean maSelectedFlag = false;
		boolean maOnlyAfterFlag = false;
		boolean fppSelectedFlag = false;
		boolean fppOnlyAfterFlag = false;


		ABPriorityServiceBO abPriSerBO = new ABPriorityServiceBO();
		String providerInterface = null;
		APP_PGM_RQST_Cargo[] clonedPrflCollArray=null;
		ArrayList<ICargoCollection> collList = new ArrayList();
		APP_PGM_RQST_Collection appInCollNew= new APP_PGM_RQST_Collection();
		short[] programKeyArray = null;
		// String[] maPriorMths = null;
		int currentPageStatus = 0;
		try {
			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			appNumber = (String) session.get(AppConstants.APP_NUMBER);
			beforeMap = (Map) session.get(FwConstants.BEFORE_COLLECTION);
			providerInterface = FwConfigurationManager.getInstance()
					.getEnvironmentProperty(AppConstants.PROVIDER_INTERFACE_SW);
			currentPageStatus = driverManager.getAFBStatus(
					FwConstants.AFB_DRIVER,
					(String) request.get(FwConstants.CURRENT_PAGE_ID),
					driverArray);
			ABProgramInformationBO programInfoBo = new ABProgramInformationBO();
			if (pageCollection.get("APP_PGM_RQST_Collection") != null) {
				appPgmRqstColl = (APP_PGM_RQST_Collection) pageCollection
						.get("APP_PGM_RQST_Collection");
				appPgmRqstCargo = appPgmRqstColl.getCargo(0);
				if ("N".equalsIgnoreCase(appPgmRqstCargo.getFs_rqst_ind())) {
					appPgmRqstCargo.setFs_rqst_ind("0");
				}
				else if(appPgmRqstCargo.getFs_rqst_ind() == null){
					appPgmRqstCargo.setFs_rqst_ind("3");
				}
				if (appPgmRqstCargo.getFpw_rqst_ind() == null || "N".equalsIgnoreCase(appPgmRqstCargo.getFpw_rqst_ind())) {
					appPgmRqstCargo.setFpw_rqst_ind("0");
				}
				if ("N".equalsIgnoreCase(appPgmRqstCargo.getFma_rqst_ind())) {
					appPgmRqstCargo.setFma_rqst_ind("0");
				}
				else if(appPgmRqstCargo.getFma_rqst_ind() == null){
					appPgmRqstCargo.setFma_rqst_ind("3");
				}
				if (appPgmRqstCargo.getSer_rqst_ind() == null || "N".equalsIgnoreCase(appPgmRqstCargo.getSer_rqst_ind())) {
					appPgmRqstCargo.setSer_rqst_ind("0");
				}
				if (appPgmRqstCargo.getSer_burial_request_ind() == null || "N".equalsIgnoreCase(appPgmRqstCargo.getSer_burial_request_ind())) {
					appPgmRqstCargo.setSer_burial_request_ind("0");
				}
				if ("N".equalsIgnoreCase(appPgmRqstCargo.getHc_rqst_ind()) ) {
					appPgmRqstCargo.setHc_rqst_ind("0");
				}
				else if(appPgmRqstCargo.getHc_rqst_ind() == null){
					appPgmRqstCargo.setHc_rqst_ind("3");
				}
				// mvanlenten - added for IL
				if ("N".equalsIgnoreCase(appPgmRqstCargo.getMedicare_rqst_ind())) {
					appPgmRqstCargo.setMedicare_rqst_ind("0");
				}
				else if(appPgmRqstCargo.getMedicare_rqst_ind() == null){
					appPgmRqstCargo.setMedicare_rqst_ind("3");
				}
				
				// FPP
				if ("N".equalsIgnoreCase(appPgmRqstCargo.getFpp_rqst_ind())) {
					appPgmRqstCargo.setFpp_rqst_ind("0");
				}
				else if(appPgmRqstCargo.getFpp_rqst_ind() == null){
					appPgmRqstCargo.setFpp_rqst_ind("3");
				}else if ("Y".equalsIgnoreCase(appPgmRqstCargo.getFpp_rqst_ind())) {
					appPgmRqstCargo.setFpp_rqst_ind("1");
				}

				
				appPgmRqstCargo.setApp_num(appNumber);

			}
			if (pageCollection.containsKey("APP_RQST_Collection")) {
				appRqstColl = (APP_RQST_Collection) pageCollection
						.get("APP_RQST_Collection");
				appRqstCargo = appRqstColl.getCargo(0);
			}
			if (pageCollection.containsKey("APP_RGST_Collection")) {
				appRgstAfterColl = (APP_RGST_Collection) pageCollection
						.get("APP_RGST_Collection");
				appRgstAfterCargo = appRgstAfterColl.getCargo(0);
				appRgstAfterCargo.setApp_num(appNumber);
			}

			if (beforeMap.containsKey("APP_RQST_Collection")) {
				appRqstBeforeColl = (APP_RQST_Collection) beforeMap
						.get("APP_RQST_Collection");
				appRqstBeforeCargo = appRqstBeforeColl.getCargo(0);
			}
			// before storing the values in the database we need to do the cargo
			// Comparison
			boolean programAddedFlag = false;
			if (beforeMap != null) {
				appPgmRqstBeforeColl = (APP_PGM_RQST_Collection) beforeMap
						.get("APP_PGM_RQST_Collection");
				if (appPgmRqstBeforeColl != null
						&& appPgmRqstBeforeColl.size() > 0) {
					// here we need to do compare the cargos
					appPgmRqstBeforeCargo = appPgmRqstBeforeColl.getCargo(0);

					if (appPgmRqstBeforeCargo.getFma_rqst_ind().equals(
							AppConstants.PROGRAM_SELECTED)) {
						maSelectedFlag = true;
					}

					if (currentPageStatus != FwConstants.DRIVER_REQUIRED) {
						appPgmRqstCargo = (APP_PGM_RQST_Cargo) isChanged(
								appPgmRqstBeforeCargo, appPgmRqstCargo);
						if (appPgmRqstCargo.isDirty()) {
							// he updated the some information on this page
							// that's why we are updating the information
							if (!appPgmRqstCargo.getFma_rqst_ind().equals(
									appPgmRqstBeforeCargo.getFma_rqst_ind())) {
								if (appPgmRqstCargo.getFma_rqst_ind().equals(
										AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}
							// fpp
							if (appPgmRqstCargo.getFpp_rqst_ind()!=null && !appPgmRqstCargo.getFpp_rqst_ind().equals(
									appPgmRqstBeforeCargo.getFpp_rqst_ind())) {
								if (appPgmRqstCargo.getFpp_rqst_ind()!=null  && appPgmRqstCargo.getFpp_rqst_ind().equals(
										AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}//fpp end
							if (!appPgmRqstCargo.getFpw_rqst_ind().equals(
									appPgmRqstBeforeCargo.getFpw_rqst_ind())) {
								if (appPgmRqstCargo.getFpw_rqst_ind().equals(
										AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}
							if (!appPgmRqstCargo.getFs_rqst_ind().equals(
									appPgmRqstBeforeCargo.getFs_rqst_ind())) {
								if (appPgmRqstCargo.getFs_rqst_ind().equals(
										AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}
							if (!appPgmRqstCargo.getSer_rqst_ind().equals(
									appPgmRqstBeforeCargo.getSer_rqst_ind())) {
								if (appPgmRqstCargo.getSer_rqst_ind().equals(
										AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}
							if (!appPgmRqstCargo.getSer_burial_request_ind()
									.equals(appPgmRqstBeforeCargo
											.getSer_burial_request_ind())) {
								if (appPgmRqstCargo.getSer_burial_request_ind()
										.equals(AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}
							if (!appPgmRqstCargo.getHc_rqst_ind().equals(
									appPgmRqstBeforeCargo.getHc_rqst_ind())) {
								if (appPgmRqstCargo.getHc_rqst_ind().equals(
										AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}
							if (!appPgmRqstCargo.getMedicare_rqst_ind().equals(
									appPgmRqstBeforeCargo
											.getMedicare_rqst_ind())) {
								if (appPgmRqstCargo.getMedicare_rqst_ind()
										.equals(AppConstants.PROGRAM_SELECTED)) {
									programAddedFlag = true;
								}
							}
						}
					}
				}
			}
			boolean secFlag = false;
			if (programAddedFlag) {
				if (request.get("InformationalMessage") != null) {
					secFlag = true;
					programAddedFlag = false;
				} else {
					request.put("InformationalMessage", "Y");
				}
			}
			Map httpSessionMap = (Map) session
				.get(FwConstants.HTTP_SESSION);
			String language = (String) httpSessionMap
				.get(AppConstants.LANGUAGE);
			// here we are validating the collection
			validateInfo = programInfoBo.validateProgramSelection(
					appPgmRqstCargo, programAddedFlag, appRqstCargo,
					appRgstAfterCargo, providerInterface,language);
			//ILIES-282236 Modified by Anvesh changes start here. Added logic to display Warning message on click on Save And Exit button
			
			appInCollNew.add(appPgmRqstCargo);
			
			//ILIES-282236 changes end here
			if (validateInfo != null && validateInfo.hasMessages()) {
				String reqWarningMsgs = (String) request
						.get(FwConstants.WARNING_MSG_DETAILS);
				if (!this.checkForWarningMesgs(reqWarningMsgs,
						programInfoBo.getMessageList())) {
					if (secFlag) {
						programInfoBo.addMessageCode("20063");
					}
					request.put(FwConstants.MESSAGE_LIST, validateInfo);
					appRqstColl = new APP_RQST_Collection();
					appRqstColl.add(appRqstCargo);
					pageCollection.put("MA_BACK_DTD_MTS",
							beforeMap.get("MA_BACK_DTD_MTS"));
					pageCollection.put("APP_PGM_RQST_Collection",
							appPgmRqstColl);
					pageCollection.put("APP_RQST_Collection", appRqstColl);
					pageCollection.put("APP_RGST_Collection", appRgstAfterColl);
					pageCollection.put("PROVIDER_INTERFACE", providerInterface);
					//ILIES-282236 Modified by Anvesh changes start here
					request.put(FwConstants.PAGE_COLL_0,appInCollNew);
					request.put(FwConstants.NUMBER_OF_COLLECTIONS_FOR_WARNING_MSG, 1);
					//ILIES-282236 changes start here
					return;
				}
			}
			programKeyArray = (short[]) session
					.get(FwConstants.AFB_PROGRAM_KEY);
			boolean fsRequested = false;
			boolean fpwRequested = false;
			boolean fmaRequested = false;
			boolean fppRequested = false;
			boolean fppDeRequested = false;
			boolean fsDeRequested = false;
			boolean fpwDeRequested = false;
			boolean fmaDeRequested = false;
			boolean cashRequested = false;
			boolean cashDeRequested = false;
			boolean serRequested = false;
			boolean serDeRequested = false;
			boolean serburialRequested = false;
			boolean serburialDeRequested = false;
			// mvanlenten - added for medicare savings program
			boolean medicareRequest = false;
			boolean medicareDeRequest = false;

			if (appPgmRqstBeforeColl != null && appPgmRqstBeforeColl.size() > 0) {
				// here we need to do compare the cargos
				appPgmRqstBeforeCargo = appPgmRqstBeforeColl.getCargo(0);
				appPgmRqstCargo = (APP_PGM_RQST_Cargo) isChanged(
						appPgmRqstBeforeCargo, appPgmRqstCargo);
				if (appPgmRqstCargo.isDirty()) {

					if (appPgmRqstCargo.getFma_rqst_ind().equals(
							AppConstants.PROGRAM_SELECTED)
							&& (appPgmRqstCargo.getFpw_rqst_ind().equals(
									AppConstants.PROGRAM_NOT_SELECTED)
									&& appPgmRqstCargo.getFs_rqst_ind().equals(
											AppConstants.PROGRAM_NOT_SELECTED)
									&& appPgmRqstCargo
											.getSer_rqst_ind()
											.equals(AppConstants.PROGRAM_NOT_SELECTED)
									&& appPgmRqstCargo
											.getSer_burial_request_ind()
											.equals(AppConstants.PROGRAM_NOT_SELECTED) && appPgmRqstCargo
									.getHc_rqst_ind().equals(
											AppConstants.PROGRAM_NOT_SELECTED))) {

						maOnlyAfterFlag = true;
					}
					
					
					//Fpp only 
					if ( appPgmRqstCargo != null 
							&& AppConstants.PROGRAM_SELECTED.equalsIgnoreCase(appPgmRqstCargo.getFpp_rqst_ind())
							&& (AppConstants.PROGRAM_NOT_SELECTED.equals(appPgmRqstCargo.getFma_rqst_ind()) 
						    && AppConstants.PROGRAM_NOT_SELECTED.equals(appPgmRqstCargo.getFpw_rqst_ind())
							&& AppConstants.PROGRAM_NOT_SELECTED.equals(appPgmRqstCargo.getFs_rqst_ind())
							&& AppConstants.PROGRAM_NOT_SELECTED.equals(appPgmRqstCargo.getSer_rqst_ind())
							&& AppConstants.PROGRAM_NOT_SELECTED.equals(appPgmRqstCargo.getSer_burial_request_ind()) 
							&& AppConstants.PROGRAM_NOT_SELECTED.equals(appPgmRqstCargo.getHc_rqst_ind()))) {

						fppOnlyAfterFlag = true;
					}
					
					

					// he updated the some information on this page that's why
					// we are updating the information
					if (!appPgmRqstCargo.getFma_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFma_rqst_ind())) {
						if (appPgmRqstCargo.getFma_rqst_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.FMA_INDEX, programKeyArray);
							fmaDeRequested = true;
						} else {
							programManager.addProgram(appNumber,
									FwConstants.FMA_INDEX, programKeyArray);
							fmaRequested = true;
						}
					}
					
					//fpp
					if (appPgmRqstCargo.getFpp_rqst_ind()!=null && !appPgmRqstCargo.getFpp_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFpp_rqst_ind())) {
						if (appPgmRqstCargo.getFpp_rqst_ind()!=null && appPgmRqstCargo.getFpp_rqst_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.FPP_INDEX, programKeyArray);
							fppDeRequested = true;
							fppDeRqst(txnBean,appNumber);
						} else {
							programManager.addProgram(appNumber,
									FwConstants.FPP_INDEX, programKeyArray);
							fppRequested = true;
						}
					}
					
					
					if (!appPgmRqstCargo.getFpw_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFpw_rqst_ind())) {
						if (appPgmRqstCargo.getFpw_rqst_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.FPW_INDEX, programKeyArray);
							fpwDeRequested = true;
						} else {
							programManager.addProgram(appNumber,
									FwConstants.FPW_INDEX, programKeyArray);
							fpwRequested = true;
						}
					}
					// mvanlenten - add for IL
					if (!appPgmRqstCargo.getMedicare_rqst_ind().equals(
							appPgmRqstBeforeCargo.getMedicare_rqst_ind())) {
						if (appPgmRqstCargo.getMedicare_rqst_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.MSP_INDEX, programKeyArray);
							medicareDeRequest = true;

						} else {
							programManager.addProgram(appNumber,
									FwConstants.MSP_INDEX, programKeyArray);
							medicareRequest = true;
						}
					}
					if (!appPgmRqstCargo.getFs_rqst_ind().equals(
							appPgmRqstBeforeCargo.getFs_rqst_ind())) {
						if (appPgmRqstCargo.getFs_rqst_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.FS_INDEX, programKeyArray);
							fsDeRequested = true;
						} else {
							programManager.addProgram(appNumber,
									FwConstants.FS_INDEX, programKeyArray);
							fsRequested = true;
						}
					}
					// Rotanak Added for cash program
					if (!appPgmRqstCargo.getHc_rqst_ind().equals(
							appPgmRqstBeforeCargo.getHc_rqst_ind())) {
						if (appPgmRqstCargo.getHc_rqst_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.HC_INDEX, programKeyArray);
							cashDeRequested = true;
						} else {
							programManager.addProgram(appNumber,
									FwConstants.HC_INDEX, programKeyArray);
							cashRequested = true;
						}
					}
					if (!appPgmRqstCargo.getSer_rqst_ind().equals(
							appPgmRqstBeforeCargo.getSer_rqst_ind())) {
						if (appPgmRqstCargo.getSer_rqst_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.SER_INDEX, programKeyArray);
							serDeRequested = true;
						} else {
							programManager.addProgram(appNumber,
									FwConstants.SER_INDEX, programKeyArray);
							programManager
									.updateAppPgmRqstForSER(appPgmRqstCargo);
							serRequested = true;
						}
					}
					if (!appPgmRqstCargo.getSer_burial_request_ind().equals(
							appPgmRqstBeforeCargo.getSer_burial_request_ind())) {
						if (appPgmRqstCargo.getSer_burial_request_ind().equals(
								AppConstants.PROGRAM_NOT_SELECTED)) {
							programManager.removeProgram(appNumber,
									FwConstants.SER_BURIAL_INDEX,
									programKeyArray);
							serburialDeRequested = true;
						} else {
							programManager.addProgram(appNumber,
									FwConstants.SER_BURIAL_INDEX,
									programKeyArray);
							// remove this update method rotanak
							// programManager.updateAppPgmRqstForSER(appPgmRqstCargo);
							serburialRequested = true;
						}
					}
				}
			}
			// we need to insert the new program values
//			else {
				if (appPgmRqstCargo != null && appPgmRqstCargo.getFma_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber, FwConstants.FMA_INDEX,
							programKeyArray);
					fmaRequested = true;
				}
				//fpp
				if (appPgmRqstCargo.getFpp_rqst_ind()!=null && appPgmRqstCargo.getFpp_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber, FwConstants.FPP_INDEX,
							programKeyArray);
					fppRequested = true;
				}
				
				if (appPgmRqstCargo.getFpw_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber, FwConstants.FPW_INDEX,
							programKeyArray);
					fpwRequested = true;
				}
				if (appPgmRqstCargo.getFs_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber, FwConstants.FS_INDEX,
							programKeyArray);
					fsRequested = true;
				}
				// rotanak
				if (appPgmRqstCargo.getHc_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber, FwConstants.HC_INDEX,
							programKeyArray);
					cashRequested = true;
				}
				if (appPgmRqstCargo.getSer_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber, FwConstants.SER_INDEX,
							programKeyArray);
					serRequested = true;
				}
				if (appPgmRqstCargo.getSer_burial_request_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber,
							FwConstants.SER_BURIAL_INDEX, programKeyArray);
					serburialRequested = true;
				}
				if (appPgmRqstCargo.getMedicare_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					programManager.addProgram(appNumber, FwConstants.MSP_INDEX,
							programKeyArray);
					medicareRequest = true;
				}
//			}
			if (appPgmRqstBeforeCargo != null && (appPgmRqstBeforeCargo.getEdi_acceptable_sw() != null)
					&& (!appPgmRqstCargo.getEdi_acceptable_sw().equals(
							appPgmRqstBeforeCargo.getEdi_acceptable_sw()))) {
				programManager.updateAppPgmRqstForSER(appPgmRqstCargo);
			}

		/*	if (appRqstColl != null && appRqstCargo != null) {
				if (appRqstCargo.getMa_backdt_mo_1_ind() == null) {
					appRqstCargo.setMa_backdt_mo_1_ind("0");
				} else {
					appRqstCargo.setMa_backdt_mo_1_ind("1");
				}
				if (appRqstCargo.getMa_backdt_mo_2_ind() == null) {
					appRqstCargo.setMa_backdt_mo_2_ind("0");
				} else {
					appRqstCargo.setMa_backdt_mo_2_ind("1");
				}
				if (appRqstCargo.getMa_backdt_mo_3_ind() == null) {
					appRqstCargo.setMa_backdt_mo_3_ind("0");
				} else {
					appRqstCargo.setMa_backdt_mo_3_ind("1");
				}
			}*/
			// removed ABEFD from String array ggr
			// Modified by Sai Katta #BRGUS00288688
			//ABBNR Page is deleted as per ILIES-174325 requirement
			if (fsRequested || fpwRequested || fmaRequested || serRequested
					|| serburialRequested || cashRequested || medicareRequest) {
				String[] requiredPages = { "ABHMD", "ABHHQ", "ABOIQ", "ABJIQ",
						"ABOEQ", "ABHMS", "ABJIS", "ABOIS", "ABESM", "ABHIS",
						"ABLAQ", "ABLAS", "ABOAQ", "ABOAS"};
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}// end
				// now i am updating the driver
				// ABPPS to succeed ABPRI
				// If only MA is selected then make the short form selection
				// screen required - RobbinsE1
			if ((fmaRequested || maOnlyAfterFlag)
					&& !(fsRequested || fpwRequested || serRequested
							|| serburialRequested || cashRequested)) {
				String[] requiredPages = { "ABPPS" };
				// added for ILIES-127671
				String[] notRequiredPages = { "ABSEN" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
				// added for ILIES-127671
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						notRequiredPages, driverArray, appNumber);
			}// End RobbinsE1
			if (maOnlyAfterFlag) {
				String[] requiredPages = { "ABPPS" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			} else {
				String[] notRequiredPages = { "ABMSF" };
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						notRequiredPages, driverArray, appNumber);
			}

			// Updated Code to schedule ABMDS page for Medical Assistance also
			// along with all other programs.
			// To Fix Production issue # ILIES-131182
			if (fmaRequested || medicareRequest || fsRequested || fpwRequested
					|| serburialRequested || cashRequested || serRequested) {
				String[] requiredPages = { "ABMDQ", "ABMDS" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}
			// Modified by Sai Katta #BRGUS00288688
			if (fsRequested) {
				String[] requiredPages = { "ABPPS", "ABPSQ", "ABHEQ", "ABHES" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}

			if (fmaRequested) {
				String[] requiredPages = { "ABATS" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}
			// rotanak added
			if (fpwRequested) {
				String[] requiredPages = { "ABCCR", "ABCCS", "ABHEQ", "ABHES" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}
			// Added by Uma to unschedule assets when only CDC is selected
			// fsRequested || fpwRequested || fmaRequested || serRequested
			// ||serburialRequested ||cashRequested || medicareRequest
			// if(AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo.getFpw_rqst_ind())
			// &&
			// !(AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo.getFs_rqst_ind())
			// ||AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo.getFma_rqst_ind())||
			// AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo.getSer_burial_request_ind())
			// ||AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo.getSer_rqst_ind())
			// ||AppConstants.PROGRAM_SELECTED.equals(appPgmRqstCargo.getHc_rqst_ind()))){
			// String[] notreqPages = {"ABLAQ","ABLAS","ABOAQ","ABOAS"};
			// driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,notreqPages,driverArray,appNumber);
			// }

			// ILIES-133651 - ravrajendran - ABE - SSA Edits (State List) -
			// Asset screens - Complete Application Development - START
			boolean cashMedicalSelected = false;
			boolean isMedicalSelected = false;

			if (appPgmRqstCargo.getFma_rqst_ind().equals(
					AppConstants.PROGRAM_SELECTED)
					&& appPgmRqstCargo.getHc_rqst_ind().equals(
							AppConstants.PROGRAM_SELECTED)) {
				cashMedicalSelected = true;
			}
			// ILIES-136018 - ravrajendran ABE - Aged and/or Disabled
			// Application does not queue Asset Screens - Start
			if (appPgmRqstCargo.getFma_rqst_ind().equals(
					AppConstants.PROGRAM_SELECTED)) {
				isMedicalSelected = true;
			}

			if(cashMedicalSelected || isMedicalSelected || programManager.isMSPProgramRequested(programKeyArray))
			{
				// ILIES-136018 - ravrajendran ABE - Aged and/or Disabled
				// Application does not queue Asset Screens - END
				String[] reqPages = { "ABLAQ", "ABLAS", "ABOAQ", "ABOAS" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER, reqPages,
						driverArray, appNumber);
			} else {
				//ILIES-282289: Commented out Liquid pages
				String[] notreqPages = {  "ABOAQ", "ABOAS" };
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						notreqPages, driverArray, appNumber);
			}
			// ILIES-133651 - ravrajendran - ABE - SSA Edits (State List) -
			// Asset screens - Complete Application Development - END
			// Start of BRGUS00286999 - Added by Cheyr
			if (serburialRequested) {
				String[] requiredPages = { "ABBAR", "ABSBI", "ABSBD", "ABSDB",
						"ABBRS", "ABHEQ", "ABHES" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}
			// End of BRGUS00286999 - Added by Cheyr
			// start of BRGUS00287188 by Cheyr
			if (cashRequested) {
				// start of BRGUS00287912 by cheyr
				//Delete ABCBS page per Usability Release 3ILIES-173330
				String[] requiredPages = { "ABMAC", "ABMDQ", "ABMDS",
						"ABHEQ", "ABHES" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}
			// end of BRGUS00287188 by Cheyr
			// end
			// start of BRGUS00287912 by cheyr
			if (cashDeRequested) {
				//Delete ABCBS page per Usability Release 3ILIES-173330
				String[] notrequiredPages = { "ABWSS", "ABMAC" };
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						notrequiredPages, driverArray, appNumber);
			}
			// start of BRGUS00287912 by cheyr
			if (serRequested) {
				String[] requiredPages = { "ABPPS", "ABHEQ", "ABHES" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}
			if (fsDeRequested || fpwDeRequested || fmaDeRequested
					|| serDeRequested || serburialDeRequested
					|| medicareDeRequest || fppDeRequested) {
				String[] requiredPages = { "ABHMD", "ABHMS", "ABJIS", "ABOIS",
						"ABATS", "ABHES", "ABESM", "ABHIS" };
				driverManager.makeRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
			}
			// Modified by Sai Katta #BRGUS00288688
			if (fsDeRequested) {
				// String[] notRequiredPages =
				// {"ABPSQ","ABHEQ","ABSCT","ABSCD","ABUCT","ABUCD","ABHES"};
				// Defect ILIES-125988 , ABHEQ page is required for SNAP and
				// Cash Program
				if (appPgmRqstCargo.getHc_rqst_ind().equals(
						AppConstants.PROGRAM_SELECTED)) {
					String[] notRequiredPages = { "ABPSQ", "ABSCT", "ABSCD",
							"ABUCT", "ABUCD" };
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);
				} else {
					String[] notRequiredPages = { "ABPSQ", "ABHEQ", "ABSCT",
							"ABSCD", "ABUCT", "ABUCD", "ABHES" };
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);
				}
				abPriSerBO.deletePriorityServiceQuestions(appNumber);
			}
			if (serDeRequested) {
				String[] notRequiredPages = { "ABPSQ", "ABHEQ", "ABSCT",
						"ABSCD", "ABUCT", "ABUCD", "ABHES" };
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						notRequiredPages, driverArray, appNumber);
				// PCR# 33903 -- Delte Priority Service Details if FS request
				// unselected.
				abPriSerBO.deletePriorityServiceQuestions(appNumber);
				updateSerRequestedInfromation(session, appNumber, driverArray);
			}
			//If MA is deselected remove the MA Short form selection page from required pages - RobbinsE1
			if(fmaDeRequested){
				String[] notRequiredPages = {"ABMSF","ABMDS","ABMDQ"};
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,notRequiredPages,driverArray,appNumber);
			}//End RobbinsE1
			// rotanak added
			String currentPageId = (String) request
					.get(FwConstants.CURRENT_PAGE_ID);
			int currentpageStatus = driverManager.getAFBStatus(
					FwConstants.AFB_DRIVER, currentPageId, driverArray);
			if (serburialDeRequested
					&& currentpageStatus != FwConstants.DRIVER_REQUIRED) {

				ABSERBurialDetailsBO burialBO = new ABSERBurialDetailsBO();
				// Deleting the Request Collection
				burialBO.deleteSERBurialRqstDetails(appNumber);

				short[] fieldName = { IApplicationManager.BURIAL_REQUEST_RESP };

				APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
						.get(AppConstants.APP_IN_PRFL_MASTER);
				if (appInPrflCollSession != null
						&& appInPrflCollSession.size() > 0) {
					for (int i = 0; i < appInPrflCollSession.size(); i++) {
						appInPrflCollSession.getCargo(i)
								.setBurial_request_resp("N");
						applicationManager.persist(appNumber,
								appInPrflCollSession.getCargo(i)
										.getIndv_seq_num(), fieldName,
								new String[] { "N" });
					}
				}
				String[] notRequiredPages = { "ABBAR", "ABSBI", "ABSBD",
						"ABSDB", "ABBRS" };
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						notRequiredPages, driverArray, appNumber);
			}

			if (fpwDeRequested) {
				String[] requiredPages = { "ABCCR", "ABCAP", "ABCDI", "ABCCD",
						"ABCCS" };
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						requiredPages, driverArray, appNumber);
				updateCDCInformation(session, appNumber);
			}

			if ((fmaDeRequested || medicareRequest)
					&& currentpageStatus != FwConstants.DRIVER_REQUIRED) {

				ABMedicalDetailsBO appInMedDetBO = new ABMedicalDetailsBO();
				ABMedicalCoverageDetailsBO appInMedCvgBO = new ABMedicalCoverageDetailsBO();
				ABMedicalDisabilityApplicationDetailsBO appInMedDblBO = new ABMedicalDisabilityApplicationDetailsBO();
				ABMAHealthyKidsBO healthyKidsBO = new ABMAHealthyKidsBO();

				APP_IN_MEDICAL_DETAIL_Collection earlyOnColl = appInMedDetBO
						.loadMedicalDetailsAFB(appNumber, AppConstants.EARLY_ON);
				if (earlyOnColl != null && earlyOnColl.size() > 0) {
					appInMedDetBO.deleteMedicalDetails(earlyOnColl,
							AppConstants.EARLY_ON);
				}
				APP_IN_MEDICAL_DETAIL_Collection speEduColl = appInMedDetBO
						.loadMedicalDetailsAFB(appNumber,
								AppConstants.SPECIAL_EDUCATION);
				if (speEduColl != null && speEduColl.size() > 0) {
					appInMedDetBO.deleteMedicalDetails(speEduColl,
							AppConstants.SPECIAL_EDUCATION);
				}
				APP_IN_MEDICAL_DETAIL_Collection rehabColl = appInMedDetBO
						.loadMedicalDetailsAFB(appNumber,
								AppConstants.REHAB_SERVICE);
				if (rehabColl != null && rehabColl.size() > 0) {
					appInMedDetBO.deleteMedicalDetails(rehabColl,
							AppConstants.REHAB_SERVICE);
				}
				APP_IN_MEDICAL_COVERAGE_Collection medCvgColl = appInMedCvgBO
						.loadMedicalCoverageDetails(appNumber);
				if (medCvgColl != null && medCvgColl.size() > 0) {
					appInMedCvgBO.deleteMedicalCoverage(medCvgColl);
				}
				APP_IN_MEDICAL_DISABILITY_Collection medDblColl = appInMedDblBO
						.loadDisabilityApplicationDetails(appNumber);
				if (medDblColl != null && medDblColl.size() > 0) {
					appInMedDblBO.deleteDisabilityApplication(medDblColl);
				}

				APP_IN_MI_CHILD_EXPENSE_Collection appInMiChExpCC = healthyKidsBO
						.loadHealthyKidsDetails(appNumber);
				if (appInMiChExpCC != null && appInMiChExpCC.size() > 0) {
					healthyKidsBO.deleteAllHealthyKidsDetails(appInMiChExpCC);
				}

				short[] fieldName = {
						IApplicationManager.DOMESTIC_VIOLENCE_VICTIM_RESP,
						IApplicationManager.IMMUNIZATION_RESP,
						IApplicationManager.SPECIAL_HEALTH_SERVICE_RESP,
						IApplicationManager.EARLY_ON_RESP,
						IApplicationManager.SPECIAL_EDUCATION_CLASS_RESP,
						IApplicationManager.ALCOHOL_DRUG_TREATMENT_RESP,
						IApplicationManager.MI_REHAB_RESP,
						IApplicationManager.CARETAKER_RESP,
						IApplicationManager.MEDICAL_COVERAGE_RESP,
						IApplicationManager.APPLIED_FOR_DISABILITY_RESP,
						IApplicationManager.SOCIAL_SECURITY_RESP,
						IApplicationManager.SUPPLEMENTAL_INCOME_RESP,
						IApplicationManager.OTHER_DISABILITY_RESP,
						IApplicationManager.STATE_HEALTH_INSURANCE_SW,
						IApplicationManager.PLAN_FIRST_MEDICARE_SW,
						IApplicationManager.CHILD_SUPPORT_SW,
						IApplicationManager.CHILD_CARE_SW,
						IApplicationManager.PAST_HEALTH_INSURANCE_SW,
						IApplicationManager.SPECIAL_HEALTH_CARE_SW,
						IApplicationManager.RENTAL_PROPERTY_EXP_SW,
						IApplicationManager.HEALTH_INSURANCE_SW,
						IApplicationManager.COURT_ORDERED_GUARDIAN_SW,
						IApplicationManager.PLAN_FIRST_MEDICAL_SW,
						IApplicationManager.PAST_CASH_MEDICAL_SW,
						IApplicationManager.PLAN_FIRST_MEDICAID_SW,
						IApplicationManager.PLAN_FIRST_OTHER_HEALTH_SW };

				APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
						.get(AppConstants.APP_IN_PRFL_MASTER);
				if (appInPrflCollSession != null
						&& appInPrflCollSession.size() > 0) {
					for (int i = 0; i < appInPrflCollSession.size(); i++) {
						APP_IN_PRFL_Cargo cargo = appInPrflCollSession
								.getCargo(i);
						cargo.setDomestic_violence_victim_resp("N");
						cargo.setImmunization_resp("N");
						cargo.setSpecial_health_service_resp("N");
						cargo.setEarly_on_resp("N");
						cargo.setSpecial_education_class_resp("N");
						cargo.setOp_aoda_tmt_rcv_sw("N");
						cargo.setMi_rehab_resp("N");
						cargo.setCaretaker_resp("N");
						cargo.setMedical_coverage_resp("N");
						cargo.setApplied_for_disability_resp("N");
						cargo.setSocial_security_resp("N");
						cargo.setSupplemental_income_resp("N");
						cargo.setOther_disability_resp("N");
						cargo.setHealth_insurance_sw("N");
						cargo.setPast_health_insurance_sw("N");
						cargo.setState_health_insurance_sw("N");
						cargo.setSpecial_health_care_sw("N");
						cargo.setPast_cash_medical_sw("N");
						cargo.setChild_support_sw("N");
						cargo.setCourt_ordered_guardian_sw("N");
						cargo.setChild_care_sw("N");
						cargo.setRental_property_exp_sw("N");
						cargo.setPlan_first_medicaid_sw("N");
						cargo.setPlan_first_medical_sw("N");
						cargo.setPlan_first_medicare_sw("N");
						cargo.setPlan_first_other_health_sw("N");
					

						applicationManager.persist(appNumber,
								cargo.getIndv_seq_num(), fieldName,
								new String[] { "N", "N", "N", "N", "N", "N",
										"N", "N", "N", "N", "N", "N", "N", "N",
										"N", "N", "N", "N", "N", "N", "N", "N",
										"N", "N", "N", "N" });

					}
				}
				String[] notRequiredPages = { "ABMSF", "ABMEA",
						"ABMRE", "ABMDD", "ABMCD", "ABMDT", "ABMDA", "ABMDS",
						"ABHKQ", "ABHKE", "ABHKC", "ABHKG", "ABHKR", "ABHCC",
						"ABPFQ", "ABNFI" };
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,
						notRequiredPages, driverArray, appNumber);

			}
			if ((maSelectedFlag && currentpageStatus != FwConstants.DRIVER_REQUIRED)
					&& (fsRequested || fpwRequested || serRequested
							|| serburialRequested || cashRequested)) {

				if (appRqstBeforeCargo != null && appRqstBeforeCargo.getMa_short_form_cd() != null
						&& (appRqstBeforeCargo.getMa_short_form_cd()
								.equalsIgnoreCase(AppConstants.MA_HEALTHY_KIDS)
								|| appRqstBeforeCargo.getMa_short_form_cd()
										.equalsIgnoreCase(
												AppConstants.MA_PLAN_FIRST) || appRqstBeforeCargo
								.getMa_short_form_cd().equalsIgnoreCase(
										AppConstants.MA_NURSING_FACILITY))) {

					ABMAHealthyKidsBO healthyKidsBO = new ABMAHealthyKidsBO();

					APP_IN_MI_CHILD_EXPENSE_Collection appInMiChExpCC = healthyKidsBO
							.loadHealthyKidsDetails(appNumber);

					if (appInMiChExpCC != null && appInMiChExpCC.size() > 0) {
						healthyKidsBO
								.deleteAllHealthyKidsDetails(appInMiChExpCC);
					}

					short[] fieldName = {

					IApplicationManager.STATE_HEALTH_INSURANCE_SW,
							IApplicationManager.PLAN_FIRST_MEDICARE_SW,
							IApplicationManager.CHILD_SUPPORT_SW,
							IApplicationManager.CHILD_CARE_SW,
							IApplicationManager.PAST_HEALTH_INSURANCE_SW,
							IApplicationManager.SPECIAL_HEALTH_CARE_SW,
							IApplicationManager.RENTAL_PROPERTY_EXP_SW,
							IApplicationManager.HEALTH_INSURANCE_SW,
							IApplicationManager.COURT_ORDERED_GUARDIAN_SW,
							IApplicationManager.PLAN_FIRST_MEDICAL_SW,
							IApplicationManager.PAST_CASH_MEDICAL_SW,
							IApplicationManager.PLAN_FIRST_MEDICAID_SW,
							IApplicationManager.PLAN_FIRST_OTHER_HEALTH_SW };

					APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
							.get(AppConstants.APP_IN_PRFL_MASTER);

					if (appInPrflCollSession != null) {

						for (int i = 0; i < appInPrflCollSession.size(); i++) {
							APP_IN_PRFL_Cargo cargo = appInPrflCollSession
									.getCargo(i);

							cargo.setHealth_insurance_sw("N");
							cargo.setPast_health_insurance_sw("N");
							cargo.setState_health_insurance_sw("N");
							cargo.setSpecial_health_care_sw("N");
							cargo.setPast_cash_medical_sw("N");
							cargo.setChild_support_sw("N");
							cargo.setCourt_ordered_guardian_sw("N");
							cargo.setChild_care_sw("N");
							cargo.setRental_property_exp_sw("N");
							cargo.setPlan_first_medicaid_sw("N");
							cargo.setPlan_first_medical_sw("N");
							cargo.setPlan_first_medicare_sw("N");
							cargo.setPlan_first_other_health_sw("N");

							applicationManager.persist(appNumber,
									cargo.getIndv_seq_num(), fieldName,
									new String[] { "N", "N", "N", "N", "N",
											"N", "N", "N", "N", "N", "N", "N",
											"N" });

						}
					}

					String[] notRequiredPages = { "ABMSF", "ABHKQ",
							"ABHKE", "ABHKC", "ABHKG", "ABHKR", "ABHCC",
							"ABPFQ", "ABNFI" };
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);

				} else if (appRqstBeforeCargo.getMa_short_form_cd() != null
						&& appRqstBeforeCargo.getMa_short_form_cd()
								.equalsIgnoreCase(AppConstants.ONLY_MA)) {

					String[] notRequiredPages = { "ABMSF" };
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, notRequiredPages,
							driverArray, appNumber);
				}
			 }

			if (fsRequested || fpwRequested || serRequested
					|| serburialRequested || cashRequested || medicareRequest || fppRequested) {
				APP_RQST_Collection appRqstCollFromDB = programInfoBo
						.loadProgramInformation(appNumber);
				if (appRqstCollFromDB != null && appRqstCollFromDB.size() > 0) {
					APP_RQST_Cargo tempAppRqstCargo = appRqstCollFromDB
							.getCargo(0);
					tempAppRqstCargo.setMa_short_form_cd(null);
					tempAppRqstCargo.setRowAction(FwConstants.ROWACTION_UPDATE);
					appRqstCollFromDB.add(tempAppRqstCargo);
					appRqstCollFromDB.persist(FwConstants.DAO);
				}
			}

			// retro month change
			APP_RETRO_RQST_Collection persistColl = new APP_RETRO_RQST_Collection();
			APP_RETRO_RQST_Cargo persistCargo = null;

			if (appRqstBeforeColl != null && appRqstBeforeColl.size() > 0) {
				appRqstBeforeCargo = appRqstBeforeColl.getCargo(0);

				/*// retro month change
				String[] indFromSess = getIndicatorFromCargo(appRqstBeforeCargo);
				String[] indFromPage = getIndicatorFromCargo(appRqstCargo);
				// now we need to compare the values
				if (appRqstBeforeCargo != null && (!appRqstBeforeCargo.getMa_backdt_mo_1_ind().equals(
						appRqstCargo.getMa_backdt_mo_1_ind())
						|| !appRqstBeforeCargo.getMa_backdt_mo_2_ind().equals(
								appRqstCargo.getMa_backdt_mo_2_ind())
						|| !appRqstBeforeCargo.getMa_backdt_mo_3_ind().equals(
								appRqstCargo.getMa_backdt_mo_3_ind()))) {
					// dirty
					appRqstColl = new APP_RQST_Collection();
					appRqstBeforeCargo.setMa_backdt_mo_1_ind(appRqstCargo
							.getMa_backdt_mo_1_ind());
					appRqstBeforeCargo.setMa_backdt_mo_2_ind(appRqstCargo
							.getMa_backdt_mo_2_ind());
					appRqstBeforeCargo.setMa_backdt_mo_3_ind(appRqstCargo
							.getMa_backdt_mo_3_ind());
					appRqstBeforeCargo.setUpdt_dt(fwDate.getDate().toString());
					appRqstBeforeCargo
							.setRowAction(FwConstants.ROWACTION_UPDATE);
					appRqstColl.add(appRqstBeforeCargo);
					programInfoBo.storeProgramInformation(appRqstColl);

				}

				// retro month
				// Flage indicate if there is any changes made on the screen
				int notSelectedCount = 0;
				boolean retroSelectedFlag = false;
				String retroStatus = IAppProfileManager.DEFAULT_APP_PRFL_SW;
				String[] backDate = dateRoutine.getBackDatedMonthsYears(fwDate
						.getDate());
				ABMedicareBO retroBo = new ABMedicareBO();

				for (int i = 0; i < indFromPage.length; i++) {
					persistCargo = new APP_RETRO_RQST_Cargo();
					persistCargo.setApp_num(appNumber);
					persistCargo
							.setRetro_month_seq_num(Integer.toString(i + 1));
					persistCargo.setRetro_month_dt(backDate[i]);
					if (!indFromPage[i].equals(indFromSess[i])) {

						if (indFromPage[i]
								.equals(AppConstants.PROGRAM_NOT_SELECTED)) {
							notSelectedCount++;
							persistCargo
									.setRowAction(FwConstants.ROWACTION_DELETE);
							retroBo.deleteRetroMonthDetails(persistCargo);
						} else {
							persistCargo
									.setRowAction(FwConstants.ROWACTION_INSERT);
							retroSelectedFlag = true;
						}
						persistColl.addCargo(persistCargo);
					} else // Counting Eventhough There is
					if (indFromPage[i]
							.equals(AppConstants.PROGRAM_NOT_SELECTED))
						notSelectedCount++;
				}
				// Insert into APP_RETRO_RQST Table
				retroBo.persistAppRetroRqstCol(persistColl);

				if (notSelectedCount == backDate.length) {
					retroStatus = IAppProfileManager.DEFAULT_APP_PRFL_SW;
					driverManager.makeAbsoluteNotRequired(
							FwConstants.AFB_DRIVER, "ABRMQ", driverArray,
							appNumber);
				}
				if (retroSelectedFlag) {
					retroStatus = String
							.valueOf(IAppProfileManager.STATUS_REQUIRED);
					if (currentPageStatus == driverManager.DRIVER_INDEX_COMPLETE)
						driverManager.makeAddNew(FwConstants.AFB_DRIVER,
								"ABRMQ", driverArray, appNumber);
					else
						driverManager.makeRequired(FwConstants.AFB_DRIVER,
								"ABRMQ", driverArray, appNumber);

				}*/
					
				APP_PRFL_Collection appPrflColl = new APP_PRFL_Collection();
				APP_PRFL_Cargo appPrflCargo = null;
				String retroStatus = IAppProfileManager.DEFAULT_APP_PRFL_SW;
				
				if (beforeMap != null)
					appPrflColl = (APP_PRFL_Collection) beforeMap
							.get("APP_PRFL_Collection");

				if (appPrflColl == null || appPrflColl.size() == 0) {
					appPrflCargo = new APP_PRFL_Cargo();
					appPrflCargo.setApp_num(appNumber);
					appPrflCargo.setRetro_rqst_sw(retroStatus);
					appPrflCargo
							.setPay_rmr_brd_resp(IAppProfileManager.DEFAULT_APP_PRFL_SW);
					appPrflCargo
							.setPlcy_hold_oth_resp(IAppProfileManager.DEFAULT_APP_PRFL_SW);
					appPrflCargo
							.setSbsid_hse_resp(IAppProfileManager.DEFAULT_APP_PRFL_SW);
					appPrflCargo
							.setSu_asst_lieap_resp(IAppProfileManager.DEFAULT_APP_PRFL_SW);
					appPrflCargo
							.setJet_dependable_child_care_sw(IAppProfileManager.DEFAULT_APP_PRFL_SW);
					appPrflCargo
							.setJet_transport_issue_sw(IAppProfileManager.DEFAULT_APP_PRFL_SW);
					// create appProfileManager
					appProfileManager.createAppProfile(appPrflCargo);
					appPrflColl.addCargo(appPrflCargo);
				} else {/*
					short[] fieldId = { IAppProfileManager.RETRO_RQST_SW };
					String[] reponseVal = { retroStatus };
					appPrflColl.getCargo(0).setRetro_rqst_sw(retroStatus);
					if (retroSelectedFlag
							|| notSelectedCount == backDate.length)
						appProfileManager.persist(appNumber, "", fieldId,
								reponseVal);
				*/}

				// but if back to before collection for comming back
				beforeMap.put("APP_PRFL_Collection", appPrflColl);

				// end of retro month

			} else {
				if (appRqstColl == null) {
					appRqstColl = new APP_RQST_Collection();
					appRqstCargo = new APP_RQST_Cargo();
					appRqstCargo.setMa_backdt_mo_1_ind("0");
					appRqstCargo.setMa_backdt_mo_2_ind("0");
					appRqstCargo.setMa_backdt_mo_3_ind("0");
				}
				if(appRqstCargo != null){
					appRqstCargo.setRowAction(FwConstants.ROWACTION_INSERT);
					appRqstCargo.setApp_num(appNumber);
					appRqstCargo
							.setApp_stat_cd(AppConstants.AFB_SUBMISSION_PENDING);
					appRqstCargo.setEcf_stat_cd(AppConstants.PDF_STORING_PENDING);
					appRqstCargo.setApp_cplt_tms("");
					appRqstCargo.setApp_strt_tms("");
					appRqstCargo.setFile_dt_only_resp(" ");
					appRqstCargo.setHshl_indv_ct("0");
					//ILIES-251019
					appRqstCargo.setUpdt_dt(String.valueOf(fwDate.getTimestamp()));
				}
				programInfoBo.storeProgramInformation(appRqstColl);
			}
			if(programManager.isMSPOnlyProgramRequested(programKeyArray)){
				//Page ABAPS is deleded as requirement ILIES-173329 R3
				//ABBNR Page is deleted as per ILIES-174325 requirement
				String[] notRequiredPages = {"ABMDQ","ABMDS","ABPRG","ABHHQ","ABWSS","ABAPD","ABCHI","ABSAP","ABAPI","ABADS","ABHEQ","ABHES","ABATS","ABSEN","ABHIS","ABMAC","ABPSQ"};
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,notRequiredPages,driverArray,appNumber);
			}
			//fpp
			if(programManager.isFPPOnlyProgramRequested(programKeyArray)){
				log(ILog.DEBUG,	 " RegistrationEJBBean:: storeProgramInformation :: isFPPOnlyProgramRequested:" +Arrays.toString(programKeyArray));
				if(fmaDeRequested && appNumber!=null && appNumber.trim().length()>0){
					deleteBackEndMonths(appNumber,session);
				}
				String[] notRequiredPages = {"ABESM", "ABMDQ","ABMDS","ABPRG","ABHHQ","ABWSS","ABAPD","ABCHI","ABSAP","ABAPI","ABADS","ABHEQ","ABHES","ABATS","ABSEN","ABHIS","ABMAC","ABPSQ"};
				driverManager.makeAbsoluteNotRequired(FwConstants.AFB_DRIVER,notRequiredPages,driverArray,appNumber);
				
				String[] requiredPages = {"ABHMD", "ABHMS", "ABJIS", "ABOIS", "ABUAD"};
				driverManager.makeRequired(FwConstants.AFB_DRIVER,requiredPages,driverArray,appNumber);
			}
			//ILIES-282289: Commented out Liquid pages
			//ILIES-279945
			/*if(programManager.isSNAPOnlyProgramRequested(programKeyArray) || programManager.isSNAPProgramRequested(programKeyArray)){
				String[] requiredPages = {"ABLAQ", "ABLAS"};
				driverManager.makeRequired(FwConstants.AFB_DRIVER,requiredPages,driverArray,appNumber);
			}*/
						
			driverManager.makeComplete(FwConstants.AFB_DRIVER, "ABPRI",
					driverArray, appNumber);
			driverManager.makeRequired(FwConstants.AFB_DRIVER,"ABPHH", driverArray, appNumber);
			session.put(FwConstants.AFB_PROGRAM_KEY, programKeyArray);
			//ILIES-282236 changes start here Modified by Anvesh .Removing the values from session
			ABRegistrationBO regBo = new ABRegistrationBO();
			regBo.clearSessionOfWarningMsgOnSaveAndExitFunc(session);
			//ILIES-282236 changes end here

			
			} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeProgramInformation");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeProgramInformation", e);
			throw fe;
		}
	
	}

	public void deleteBackEndMonths(String appNumber, Map session) {
		
		   try{	
				log(ILog.DEBUG,	 " RegistrationEJBBean:: deleteBackEndMonths :: appNumber:" +appNumber);
				ABMedicareBO retroBo = new ABMedicareBO();
				APP_RETRO_RQST_Cargo  persistCargo = null;
				APP_RETRO_RQST_Collection  persistColl = new APP_RETRO_RQST_Collection();
				APP_RETRO_RQST_Collection appRetroColl= new APP_RETRO_RQST_Collection();
				APP_RETRO_RQST_Cargo appRetroRqst = new APP_RETRO_RQST_Cargo();
				appRetroColl= retroBo.loadAppRetroRqstColl(appNumber);
				if(appRetroColl!=null && appRetroColl.size()>0){
						for (int i = 0; i < appRetroColl.size(); i++) {
							persistCargo = new APP_RETRO_RQST_Cargo();
							persistCargo.setApp_num(appNumber);
							persistCargo.setRetro_month_seq_num(Integer.toString(i + 1));
							persistCargo.setRowAction(FwConstants.ROWACTION_DELETE);
							retroBo.deleteRetroMonthDetails(persistCargo);
							persistColl.addCargo(persistCargo);
						}
						
					retroBo.persistAppRetroRqstCol(persistColl);
				}
				
				//ILIES-278263 - no need to update backdate month columns when application has FPPonly 
				/*APP_IN_PRFL_Collection appInPrflCollection = new APP_IN_PRFL_Collection();
				APP_IN_PRFL_Cargo appInPrflCargo = new APP_IN_PRFL_Cargo();
		
				Map<String, Object> criteria = new HashMap<String, Object>();
				FwDataCriteria[] dataCriteria = new FwDataCriteria[1];
				dataCriteria[0] = new FwDataCriteria();
				dataCriteria[0].setColumn_name("APP_NUM");
				dataCriteria[0].setColumn_value(appNumber);
				criteria.put(FwConstants.CRITERIA, dataCriteria);			
				APP_IN_PRFL_Cargo[] appInPrflCargos = (APP_IN_PRFL_Cargo[]) appInPrflCollection.select(FwConstants.DAO, criteria);
				appInPrflCollection.clear();

				APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
								.get(AppConstants.APP_IN_PRFL_MASTER);
						if (appInPrflCollSession != null && appInPrflCollSession.size()>0) {
							for (int i = 0; i < appInPrflCollSession.size(); i++) {
								APP_IN_PRFL_Cargo cargo = appInPrflCollSession
										.getCargo(i);
								cargo.setIndv_fma_rqst_ind("3");
								cargo.setBackdt_med_app("3");
								cargo.setMa_backdt_mo_1(null);
								cargo.setMa_backdt_mo_2(null);
								cargo.setMa_backdt_mo_3(null);
								if("1".equalsIgnoreCase(cargo.getIndv_fpp_pgm()) && "1".equalsIgnoreCase(cargo.getBackdt_fpp_app())){
									cargo.setBackdt_fpp_app("0");
								}
							}
						}
				if(appInPrflCargos!=null && appInPrflCargos.length>0){
						for(int i=0;i<appInPrflCargos.length;i++){
							appInPrflCargos[i].setApp_num(appNumber);
							appInPrflCargos[i].setIndv_fma_rqst_ind("3");
							appInPrflCargos[i].setBackdt_med_app("3");
							appInPrflCargos[i].setMa_backdt_mo_1(null);
							appInPrflCargos[i].setMa_backdt_mo_2(null);
							appInPrflCargos[i].setMa_backdt_mo_3(null);
							if("1".equalsIgnoreCase(appInPrflCargos[i].getIndv_fpp_pgm()) && "1".equalsIgnoreCase(appInPrflCargos[i].getBackdt_fpp_app())){
								appInPrflCargos[i].setBackdt_fpp_app("0");
							}
							appInPrflCargos[i].setRowAction(FwConstants.ROWACTION_UPDATE);
							appInPrflCollection.addCargo(appInPrflCargos[i]);	
						}
					appInPrflCollection.persist(FwConstants.DAO);
				}*/
				AFBNavigationBO bo = new AFBNavigationBO(); 
				bo.persitAppRqstBackDtMonths(appNumber);
					
		 }catch (FwException fe) {
			log(ILog.ERROR,	 " RegistrationEJBBean:: deleteBackEndMonths :: appNumber:" +appNumber);
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("deleteBackEndMonths");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			log(ILog.ERROR,	 " RegistrationEJBBean:: deleteBackEndMonths :: appNumber:" +appNumber);
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"deleteBackEndMonths", e);
			throw fe;
		}
	}

	private String[] getIndicatorFromCargo(APP_RQST_Cargo cargo) {
		String status[] = new String[3];
		if (cargo != null) {
			status[0] = cargo.getMa_backdt_mo_1_ind();
			status[1] = cargo.getMa_backdt_mo_2_ind();
			status[2] = cargo.getMa_backdt_mo_3_ind();
		}
		return status;
	}

	/**
	 * Comment here
	 */
	public void getPostProgramSelection(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

			Map request = txnBean.getRequest();
			Map session = txnBean.getSession();
			// Map pageCollection = txnBean.getPageCollection();
			componentManager.getComponents(
					(String) request.get(FwConstants.CURRENT_PAGE_ID), txnBean);
			session.put(FwConstants.BEFORE_COLLECTION,
					txnBean.getPageCollection());
		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getPostProgramSelection");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getPostProgramSelection", e);
			throw fe;
		}

	}

	/**
	 * Comment here
	 */
	public void storePostProgramSelection(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {
			// Map request = txnBean.getRequest();
			Map session = txnBean.getSession();
			// Map pageCollection = txnBean.getPageCollection();
			int[] driverArray = null;
			driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			driverManager.makeComplete(FwConstants.AFB_DRIVER, "ABPPS",
					driverArray, (String) session.get(AppConstants.APP_NUMBER));

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storePostProgramSelection");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storePostProgramSelection", e);
			throw fe;
		}

	}

	/**
	 * Comment here
	 */
	public void getOverview(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getOverview");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getOverview", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void storeOverview(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeOverview");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeOverview", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void getEstablishFilingDate(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getEstablishFilingDate");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getEstablishFilingDate", e);
			throw fe;
		}
	}

	/**
	 * Comment here
	 */
	public void storeEstablishFilingDate(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("storeEstablishFilingDate");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"storeEstablishFilingDate", e);
			throw fe;
		}
	}

	/**
	 * Comment here : Method to Load Help With Application Page
	 */
	public void getHelpWithApplications(FwTransaction txnBean)
			throws javax.ejb.EJBException {

		try {
			log(ILog.INFO,
					"RegistrationEJBBean::storeHelpWithApplications:Start");
			Map session = txnBean.getSession();
			Map pageCollection = txnBean.getPageCollection();
			Map request = txnBean.getRequest();

			APP_FILE_HELP_Cargo helpCargo = null;
			String currentPageID = (String) request
					.get(FwConstants.CURRENT_PAGE_ID);
			int[] driverArray = (int[]) session.get(FwConstants.AFB_DRIVER);
			int driverStatus = (int) driverManager.getAFBStatus(
					FwConstants.AFB_DRIVER, currentPageID, driverArray);
			String appNum = (String) session.get(AppConstants.APP_NUMBER);// holds
																			// application
																			// number
																			// from
																			// session
			APP_FILE_HELP_Collection helpColl = new APP_FILE_HELP_Collection();

			if (driverStatus == FwConstants.DRIVER_COMPLETE
					|| driverStatus == FwConstants.DRIVER_VISIT_AGAIN) {
				HelpWithApplicationBO helpBO = new HelpWithApplicationBO();
				helpCargo = helpBO.loadHelpWithApplication(appNum);

				if (helpCargo.getAgcy_num().equalsIgnoreCase("0"))
					helpCargo.setAgcy_num("");

				helpColl.addCargo(helpCargo);
				pageCollection.put("APP_FILE_HELP_Collection", helpColl);

			}
			
			// ILIES-270920 - To show warning message on page load to download pdf
			ABRegistrationSummaryBO registrationSummaryBO = new ABRegistrationSummaryBO();
			registrationSummaryBO.addMessageCode("99201");
			
			request.put(FwConstants.MESSAGE_LIST, registrationSummaryBO.getMessageList());
			
			// Assingning before collection from before collection if exists
			session.put(FwConstants.BEFORE_COLLECTION, pageCollection);
			txnBean.setPageCollection(pageCollection);

		} catch (FwException fe) {
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("getHelpWithApplications");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"getHelpWithApplications", e);
			throw fe;
		}
	}
	
	
	
	public void  fppDeRqst(FwTransaction txnBean, String appNumber){
		
		try{
			log(ILog.DEBUG,	 " RegistrationEJBBean:: fppDeRqst :: appNumber:" +appNumber);
			Map session = txnBean.getSession();
			APP_IN_PRFL_Collection appInPrflCollection = new APP_IN_PRFL_Collection();
			APP_IN_PRFL_Cargo appInPrflCargo = new APP_IN_PRFL_Cargo();

			Map<String, Object> criteria = new HashMap<String, Object>();
			FwDataCriteria[] dataCriteria = new FwDataCriteria[1];
			dataCriteria[0] = new FwDataCriteria();
			dataCriteria[0].setColumn_name("APP_NUM");
			dataCriteria[0].setColumn_value(appNumber);
			criteria.put(FwConstants.CRITERIA, dataCriteria);			
			APP_IN_PRFL_Cargo[] appInPrflCargos = (APP_IN_PRFL_Cargo[]) appInPrflCollection.select(FwConstants.DAO, criteria);
			appInPrflCollection.clear();

			APP_IN_PRFL_Collection appInPrflCollSession = (APP_IN_PRFL_Collection) session
							.get(AppConstants.APP_IN_PRFL_MASTER);
					if (appInPrflCollSession != null && appInPrflCollSession.size()>0){
						for (int i = 0; i < appInPrflCollSession.size(); i++) {
							APP_IN_PRFL_Cargo cargo = appInPrflCollSession
									.getCargo(i);
							if(!"1".equalsIgnoreCase(cargo.getIndv_fma_rqst_ind()) ){
								cargo.setMa_backdt_mo_1(null);
								cargo.setMa_backdt_mo_2(null);
								cargo.setMa_backdt_mo_3(null);
								cargo.setBackdt_fpp_app("3");
								cargo.setIndv_fpp_pgm("3");
							}
							else{
								cargo.setBackdt_fpp_app("3");
								cargo.setIndv_fpp_pgm("3");
							}
						}
					}
			if(appInPrflCargos!=null && appInPrflCargos.length>0){
					for(int i=0;i<appInPrflCargos.length;i++){
						 if(!"1".equalsIgnoreCase(appInPrflCargos[i].getIndv_fma_rqst_ind()) ){
								appInPrflCargos[i].setMa_backdt_mo_1(null);
								appInPrflCargos[i].setMa_backdt_mo_2(null);
								appInPrflCargos[i].setMa_backdt_mo_3(null);
								appInPrflCargos[i].setBackdt_fpp_app("3");
								appInPrflCargos[i].setIndv_fpp_pgm("3");
							}else{
								appInPrflCargos[i].setBackdt_fpp_app("3");
								appInPrflCargos[i].setIndv_fpp_pgm("3");
							}
							appInPrflCargos[i].setRowAction(FwConstants.ROWACTION_UPDATE);
							appInPrflCollection.addCargo(appInPrflCargos[i]);	
					}
				appInPrflCollection.persist(FwConstants.DAO);
		  }
			AFBNavigationBO bo = new AFBNavigationBO(); 
			bo.persitAppRqstBackDtMonths(appNumber);
		}catch (FwException fe) {
			log(ILog.ERROR,	 " RegistrationEJBBean:: fppDeRqst :: appNumber:" +appNumber);
			ctx.setRollbackOnly();
			FwWrappedException we = new FwWrappedException();
			we.setCallingClassID(this.getClass().getName());
			we.setCallingMethodID("fppDeRqst");
			we.setFwException(fe);
			throw we;
		} catch (Exception e) {
			log(ILog.ERROR,	 " RegistrationEJBBean:: fppDeRqst :: appNumber:" +appNumber);
			ctx.setRollbackOnly();
			FwException fe = createFwException(this.getClass().getName(),
					"fppDeRqst", e);
			throw fe;
		}
		
	}
	
	