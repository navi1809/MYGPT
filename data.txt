package IVA_Batch;
import egl.core.*;
import CommonMigratedParts.*;
import DataTables.*;
//*** PROGRAM=AME37A ****
// COMPONENT NAME: AME37A FOOD STAMP CASELOAD ACTIVITY REPORT
// ===============
// 
// DESCRIPTION:
// ============
// THIS REPORT SHOWS TOTAL NUMBER OF ACTIVE CASES,
// RETROACTIVE AND
// SUPPLEMENTAL PAYMENTS MADE, AND TYPES OF APPLICATIONS
// PROCESSED
// FOR ALL FS CASES.
// 
// 
// 
// ***********************
Program AME37A type basicProgram //VAGen Info - main batch program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes
  }

  // Data Declarations
  AME37W AME37W; // record
  AME37W-DET AME37W-DET; // record
  AME37W-HEAD AME37W-HEAD; // record
  AME37W-SUBH AME37W-SUBH; // record
  AME37W1 AME37W1; // record
  CEP01W CEP01W; // record
  FORMATW FORMATW; // record
  GDW GDW; // record
  H2-2-FAA-FAC H2-2-FAA-FAC; // record
  H2-2-FAA-FCH H2-2-FAA-FCH; // record
  H2-3-FAC-FCH-FSI H2-3-FAC-FCH-FSI; // record
  H2-3-FAC-FCH-PSY H2-3-FAC-FCH-PSY; // record
  H2-CASELD-DEBTLD H2-CASELD-DEBTLD; // record
  H2-OFFICE H2-OFFICE; // record
  H2-PRGM-CASE-HSTRY H2-PRGM-CASE-HSTRY; // record
  REP-COMMON REP-COMMON; // record
  REP-EOFNOF REP-EOFNOF; // record
  SR-132REP-RECOUT SR-132REP-RECOUT; // record
  SR-AME37-RECIN SR-AME37-RECIN; // record
  VDBCOMMON VDBCOMMON; // record
  VDBCONTROL VDBCONTROL; // record
  VMESSAGE VMESSAGE; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  // Use Declarations
  use VDB00T1 {deleteAfterUse = yes}; // table

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    AME37P9-MAIN: AME37P9-MAIN();
  end // end main
end // end AME37A


// PROCESS TO ACCUMULATE RPT VARS
Function AME37P9-ACT-CSLD()

  if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
  H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
  H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
  H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
    AME37W.WS-PACASES = AME37W.WS-PACASES + 1;
  else
    AME37W.WS-NACASES = AME37W.WS-NACASES + 1;
  end

  if (H2-3-FAC-FCH-FSI.EXPD-SRVC-IND == "Y")
    if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
      AME37W.WS-PAEXPCASE = AME37W.WS-PAEXPCASE + 1;
    else
      AME37W.WS-NAEXPCASE = AME37W.WS-NAEXPCASE + 1;
    end
  end

  if (H2-3-FAC-FCH-FSI.ISNCE-MTHD == "E")
    if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
      AME37W.WS-PAEBTCASE = AME37W.WS-PAEBTCASE + 1;
    else
      AME37W.WS-NAEBTCASE = AME37W.WS-NAEBTCASE + 1;
    end
    AME37W.WS-DMIEBT = AME37W.WS-DMIEBT + 1;
  else
    if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "3")
      if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
      H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
      H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
      H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
        AME37W.WS-PADAMS = AME37W.WS-PADAMS + 1;
      else
        AME37W.WS-NADAMS = AME37W.WS-NADAMS + 1;
      end
    else
      if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
      H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
      H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
      H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
        AME37W.WS-PASPHNDL = AME37W.WS-PASPHNDL + 1;
      else
        AME37W.WS-NASPHNDL = AME37W.WS-NASPHNDL + 1;
      end
    end
    if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "0" || 
    H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == " ")
      AME37W.WS-DMI0 = AME37W.WS-DMI0 + 1;
    else
      if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "1")
        AME37W.WS-DMI1 = AME37W.WS-DMI1 + 1;
      else
        if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "2")
          AME37W.WS-DMI2 = AME37W.WS-DMI2 + 1;
        else
          if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "3")
            AME37W.WS-DMI3 = AME37W.WS-DMI3 + 1;
          else
            if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "4")
              AME37W.WS-DMI4 = AME37W.WS-DMI4 + 1;
            else
              if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "5")
                AME37W.WS-DMI5 = AME37W.WS-DMI5 + 1;
              else
                if (H2-3-FAC-FCH-FSI.MTHD-OF-ISNCE == "6")
                  AME37W.WS-DMI6 = AME37W.WS-DMI6 + 1;
                end
              end
            end
          end
        end
      end
    end
  end

  if (H2-3-FAC-FCH-FSI.MTHLY-RPTR-IND == "Y")
    if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
      AME37W.WS-PAMRC = AME37W.WS-PAMRC + 1;
    else
      AME37W.WS-NAMRC = AME37W.WS-NAMRC + 1;
    end
  end
end // end AME37P9-ACT-CSLD


// PROCESS TO ACCUMULATE RPT VARS
Function AME37P9-APPLSPEC()
  AME37P9-SETINQ-S02(); /* ACTIVE CASELOAD INFO;*/
  AME37P9-SCAN-S02();
  while (AME37W.WS-S02-SQLCD == 0)
    AME37P9-ACT-CSLD();
    AME37P9-SCAN-S02();
  end

  AME37W.WS-GRNDTOT = AME37W.WS-PACASES + AME37W.WS-NACASES;
  AME37W.WS-SUBTOTEX = AME37W.WS-PAEXPCASE + AME37W.WS-NAEXPCASE;
  AME37W.WS-SUBTOTDM = AME37W.WS-PADAMS + AME37W.WS-NADAMS;
  AME37W.WS-SUBTOTSP = AME37W.WS-PASPHNDL + AME37W.WS-NASPHNDL;
  AME37W.WS-SUBTOTEBT = AME37W.WS-PAEBTCASE + AME37W.WS-NAEBTCASE;
  AME37W.WS-SUBTOTMRC = AME37W.WS-PAMRC + AME37W.WS-NAMRC;


  AME37P9-SETINQ-S03(); /* ISSUES MADE FOR LAST MTH & REVISED*/
  AME37P9-SCAN-S03(); /* CASELOAD FOR LAST MTH ;*/
  while (AME37W.WS-S03-SQLCD == 0)
    AME37P9-LAST-MTH();
    AME37P9-SCAN-S03();
  end

  AME37W.WS-SUBTOTIS = AME37W.WS-PALMISS + AME37W.WS-NALMISS;
  AME37W.WS-SUBTOTREV = AME37W.WS-PAREVISED + AME37W.WS-NAREVISED;

  if (AME37W.WS-PACASES != 0)
    AME37W.WS-PARETRO = mathLib.round((AME37W.WS-PALMISS * 100) / AME37W.WS-PACASES, -mathLib.decimals(AME37W.WS-PARETRO));
  else
    AME37W.WS-PARETRO = 0;
  end
  AME37W-DET.C-1 = "%";
  if (AME37W.WS-NACASES != 0)
    AME37W.WS-NARETRO = mathLib.round((AME37W.WS-NALMISS * 100) / AME37W.WS-NACASES, -mathLib.decimals(AME37W.WS-NARETRO));
  else
    AME37W.WS-NARETRO = 0;
  end
  AME37W-DET.C-2 = "%";

  if (AME37W.WS-GRNDTOT != 0)
    AME37W.WS-SUBTOTRET = mathLib.round((AME37W.WS-SUBTOTIS * 100) /     AME37W.WS-GRNDTOT, -mathLib.decimals(AME37W.WS-SUBTOTRET));
  else
    AME37W.WS-SUBTOTRET = 0;
  end
  AME37W-DET.C-3 = "%";

  AME37W.WS-PAEST = mathLib.round(AME37W.WS-PACASES +   (AME37W.WS-PARETRO * AME37W.WS-PACASES) / 100, -mathLib.decimals(AME37W.WS-PAEST));

  AME37W.WS-NAEST = mathLib.round(AME37W.WS-NACASES +   (AME37W.WS-NARETRO * AME37W.WS-NACASES) / 100, -mathLib.decimals(AME37W.WS-NAEST));

  AME37W.WS-GRNDTOTES = AME37W.WS-PAEST + AME37W.WS-NAEST;

  AME37P9-SETINQ-S04();
  set H2-2-FAA-FAC empty;
  AME37P9-SCAN-S04();
  while (AME37W.WS-S04-SQLCD == 0)
    H2-2-FAA-FCH.ICI = H2-2-FAA-FAC.ICI;
    H2-2-FAA-FCH.ACTN-TS = H2-2-FAA-FAC.ACTN-TS;
    AME37P9-READ-S02(); /* READ PREV RECORD OF FAM_ACTNS;*/
    if ((H2-2-FAA-FCH.ACTN-TYP == "FA" || 
    H2-2-FAA-FCH.ACTN-TYP == "RE" || 
    H2-2-FAA-FCH.ACTN-TYP == "RI"))
      H2-PRGM-CASE-HSTRY.ICI = H2-2-FAA-FAC.ICI;
      AME37P9-READ-S03(); /* READ PROGRAM_CASE_HSTRY;*/
      if ((H2-2-FAA-FCH.FS-SUFX == "P" || 
      H2-2-FAA-FCH.FS-SUFX == "S" || 
      H2-2-FAA-FCH.FS-SUFX == "G" || 
      H2-2-FAA-FCH.FS-SUFX == "A"))
        AME37W.WS-PABNFT = AME37W.WS-PABNFT + 1;

        if (H2-PRGM-CASE-HSTRY.RCRT-APL-DT >= AME37W.WS-RPT-BEG-DT && 
        H2-PRGM-CASE-HSTRY.RCRT-APL-DT <= AME37W.WS-RPT-END-DT)

          AME37W.WS-PANEW = AME37W.WS-PANEW + 1;
        else
          AME37W.WS-PASUBS = AME37W.WS-PASUBS + 1;
        end

      else

        AME37W.WS-NABNFT = AME37W.WS-NABNFT + 1;

        if (H2-PRGM-CASE-HSTRY.RCRT-APL-DT >= AME37W.WS-RPT-BEG-DT && 
        H2-PRGM-CASE-HSTRY.RCRT-APL-DT <= AME37W.WS-RPT-END-DT)

          AME37W.WS-NANEW = AME37W.WS-NANEW + 1;
        else
          AME37W.WS-NASUBS = AME37W.WS-NASUBS + 1;
        end

      end
    end
    AME37P9-SCAN-S04();

  end

  AME37W.WS-SUBTOTBN = AME37W.WS-PABNFT + AME37W.WS-NABNFT;

  /* THERE IS NO PARTIAL FS BENEFITS ISSUED IN NOMADS; WHEN WE MOVED FROM*/
  /* CYCLES TO MONTHLY THIS LOGIC NEEDS TO BE MODIFIED TO REPORT PARTIAL*/
  /* BENEFITS; TILL THEN IT POPULATES 0 FOR PARTIAL BENEFITS;*/

  AME37W.WS-PAPART = 0;
  AME37W.WS-NAPART = 0;
  AME37W.WS-SUBTOTPRT = AME37W.WS-PAPART + AME37W.WS-NAPART;
  /*  */
  AME37W.WS-PAAPPRV = AME37W.WS-PABNFT + AME37W.WS-PAPART;
  AME37W.WS-NAAPPRV = AME37W.WS-NABNFT + AME37W.WS-NAPART;
  AME37W.WS-SUBTOTAP = AME37W.WS-PAAPPRV + AME37W.WS-NAAPPRV;


  AME37P9-SETINQ-S05();
  set H2-3-FAC-FCH-PSY empty;
  AME37P9-SCAN-S05();
  AME37W.WS-ICI = 0;
  while (AME37W.WS-S05-SQLCD == 0)
    if (H2-3-FAC-FCH-PSY.ICI != AME37W.WS-ICI)
      AME37W.WS-ICI = H2-3-FAC-FCH-PSY.ICI;
      if ((H2-3-FAC-FCH-PSY.FS-SUFX == "P" || 
      H2-3-FAC-FCH-PSY.FS-SUFX == "S" || 
      H2-3-FAC-FCH-PSY.FS-SUFX == "G" || 
      H2-3-FAC-FCH-PSY.FS-SUFX == "A"))

        AME37W.WS-PAWTDR = AME37W.WS-PAWTDR + 1;

        if (H2-3-FAC-FCH-PSY.RCRT-APL-DT >= AME37W.WS-RPT-BEG-DT && 
        H2-3-FAC-FCH-PSY.RCRT-APL-DT <= AME37W.WS-RPT-END-DT)

          AME37W.WS-PANEW = AME37W.WS-PANEW + 1;
        else
          AME37W.WS-PASUBS = AME37W.WS-PASUBS + 1;
        end

      else

        AME37W.WS-NAWTDR = AME37W.WS-NAWTDR + 1;

        if (H2-3-FAC-FCH-PSY.RCRT-APL-DT >= AME37W.WS-RPT-BEG-DT && 
        H2-3-FAC-FCH-PSY.RCRT-APL-DT <= AME37W.WS-RPT-END-DT)

          AME37W.WS-NANEW = AME37W.WS-NANEW + 1;
        else
          AME37W.WS-NASUBS = AME37W.WS-NASUBS + 1;
        end

      end
    end
    AME37P9-SCAN-S05();
  end

  AME37W.WS-SUBTOTWD = AME37W.WS-PAWTDR + AME37W.WS-NAWTDR;

  AME37P9-SETINQ-S06();
  set H2-3-FAC-FCH-PSY empty;
  AME37P9-SCAN-S06();
  AME37W.WS-ICI = 0;
  while (AME37W.WS-S06-SQLCD == 0)
    if (H2-3-FAC-FCH-PSY.ICI != AME37W.WS-ICI)
      AME37W.WS-ICI = H2-3-FAC-FCH-PSY.ICI;
      if ((H2-3-FAC-FCH-PSY.FS-SUFX == "P" || 
      H2-3-FAC-FCH-PSY.FS-SUFX == "S" || 
      H2-3-FAC-FCH-PSY.FS-SUFX == "G" || 
      H2-3-FAC-FCH-PSY.FS-SUFX == "A"))

        AME37W.WS-PATOT = AME37W.WS-PATOT + 1;

        if (H2-3-FAC-FCH-PSY.RCRT-APL-DT >= AME37W.WS-RPT-BEG-DT && 
        H2-3-FAC-FCH-PSY.RCRT-APL-DT <= AME37W.WS-RPT-END-DT)

          AME37W.WS-PANEW = AME37W.WS-PANEW + 1;
        else
          AME37W.WS-PASUBS = AME37W.WS-PASUBS + 1;
        end

        if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "11")
          AME37W.WS-PADENY = AME37W.WS-PADENY + 1;
        else
          if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "08")
            AME37W.WS-PANCOOP = AME37W.WS-PANCOOP + 1;
          else
            if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "10")
              AME37W.WS-PAQUIT = AME37W.WS-PAQUIT + 1;
            else
              if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "20")
                AME37W.WS-PARSRC = AME37W.WS-PARSRC + 1;
              else
                AME37W.WS-PAOTHR = AME37W.WS-PAOTHR + 1;
              end
            end
          end
        end

      else

        AME37W.WS-NATOT = AME37W.WS-NATOT + 1;

        if (H2-3-FAC-FCH-PSY.RCRT-APL-DT >= AME37W.WS-RPT-BEG-DT && 
        H2-3-FAC-FCH-PSY.RCRT-APL-DT <= AME37W.WS-RPT-END-DT)

          AME37W.WS-NANEW = AME37W.WS-NANEW + 1;
        else
          AME37W.WS-NASUBS = AME37W.WS-NASUBS + 1;
        end

        if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "11")
          AME37W.WS-NADENY = AME37W.WS-NADENY + 1;
        else
          if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "08")
            AME37W.WS-NANCOOP = AME37W.WS-NANCOOP + 1;
          else
            if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "10")
              AME37W.WS-NAQUIT = AME37W.WS-NAQUIT + 1;
            else
              if (H2-3-FAC-FCH-PSY.SYS-CLSRE-DNL-RSN == "20")
                AME37W.WS-NARSRC = AME37W.WS-NARSRC + 1;
              else
                AME37W.WS-NAOTHR = AME37W.WS-NAOTHR + 1;
              end
            end
          end
        end

      end
    end
    AME37P9-SCAN-S06();
  end

  AME37W.WS-SUBTOTDNY = AME37W.WS-PADENY + AME37W.WS-NADENY;
  AME37W.WS-SUBTOTNC = AME37W.WS-PANCOOP + AME37W.WS-NANCOOP;
  AME37W.WS-SUBTOTQT = AME37W.WS-PAQUIT + AME37W.WS-NAQUIT;
  AME37W.WS-SUBTOTRC = AME37W.WS-PARSRC + AME37W.WS-NARSRC;
  AME37W.WS-SUBTOTOTH = AME37W.WS-PAOTHR + AME37W.WS-NAOTHR;

  AME37W.WS-SUBTOTTOT = AME37W.WS-PATOT + AME37W.WS-NATOT;

  AME37W.WS-PAAPPL = AME37W.WS-PAAPPRV + AME37W.WS-PAWTDR   + AME37W.WS-PATOT;

  AME37W.WS-NAAPPL = AME37W.WS-NAAPPRV + AME37W.WS-NAWTDR   + AME37W.WS-NATOT;

  AME37W.WS-GRNDTOTAPP = AME37W.WS-PAAPPL + AME37W.WS-NAAPPL;

  AME37W.WS-SUBTOTNEW = AME37W.WS-PANEW + AME37W.WS-NANEW;

  AME37W.WS-SUBTOTSUBS = AME37W.WS-PASUBS + AME37W.WS-NASUBS;


  AME37P9-SETINQ-S07();
  set H2-3-FAC-FCH-PSY empty;
  AME37P9-SCAN-S07();
  while (AME37W.WS-S07-SQLCD == 0)
    if ((H2-3-FAC-FCH-PSY.FS-SUFX == "P" || 
    H2-3-FAC-FCH-PSY.FS-SUFX == "S" || 
    H2-3-FAC-FCH-PSY.FS-SUFX == "G" || 
    H2-3-FAC-FCH-PSY.FS-SUFX == "A"))

      AME37W.WS-PAAPPLMTH = AME37W.WS-PAAPPLMTH + 1;
      if (H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "P")
        WS-PAPNDMTH = WS-PAPNDMTH + 1;
      else
        if (H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "O")
          AME37W.WS-PAAPPRVMTH = AME37W.WS-PAAPPRVMTH + 1;
        else
          if ((H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "D" || 
          H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "T"))
            AME37W.WS-PADNYWDMTH = AME37W.WS-PADNYWDMTH + 1;
          end
        end
      end

    else
      AME37W.WS-NAAPPLMTH = AME37W.WS-NAAPPLMTH + 1;
      if (H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "P")
        WS-NAPNDMTH = WS-NAPNDMTH + 1;
      else
        if (H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "O")
          AME37W.WS-NAAPPRVMTH = AME37W.WS-NAAPPRVMTH + 1;
        else
          if ((H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "D" || 
          H2-3-FAC-FCH-PSY.PRGM-CASE-STS == "T"))
            AME37W.WS-NADNYWDMTH = AME37W.WS-NADNYWDMTH + 1;
          end
        end
      end
    end
    AME37P9-SCAN-S07();
  end

  AME37W.WS-SUBTOTPNDMTH = AME37W.WS-NAPNDMTH + AME37W.WS-PAPNDMTH;
  AME37W.WS-SUBTOTAPMTH = AME37W.WS-PAAPPRVMTH + AME37W.WS-NAAPPRVMTH;
  AME37W.WS-SUBTOTDNYWD = AME37W.WS-PADNYWDMTH + AME37W.WS-NADNYWDMTH;
  AME37W.WS-GRNDTOTAPPMTH = AME37W.WS-PAAPPLMTH + AME37W.WS-NAAPPLMTH;


  AME37P9-SETINQ-S08();
  set H2-3-FAC-FCH-PSY empty;
  AME37P9-SCAN-S08();
  while (AME37W.WS-S08-SQLCD == 0)
    if ((H2-3-FAC-FCH-PSY.FS-SUFX == "P" || 
    H2-3-FAC-FCH-PSY.FS-SUFX == "S" || 
    H2-3-FAC-FCH-PSY.FS-SUFX == "G" || 
    H2-3-FAC-FCH-PSY.FS-SUFX == "A"))

      AME37W.WS-PATERM = AME37W.WS-PATERM + 1;

    else

      AME37W.WS-NATERM = AME37W.WS-NATERM + 1;

    end
    AME37P9-SCAN-S08();
  end

  AME37W.WS-SUBTOTTRM = AME37W.WS-PATERM + AME37W.WS-NATERM;
end // end AME37P9-APPLSPEC


// PROCESS TO CLOSE THE APPL
Function AME37P9-CLOS-PARA()
  /* cbsi start*/
  /* report termination process*/
  exit program;
  /* cbsi end*/
end // end AME37P9-CLOS-PARA


// INTIALISE ALL VARIABLES
Function AME37P9-INIT-PARA()
  /* Initialize the variables ....*/

  AME37P9-SET-EMPTY();

  REP-COMMON.WS-PAGE-NO = 1;
  REP-COMMON.WS-LINE-NO = 1;
  REP-COMMON.WS-NEW-PAGE = "Y";
  REP-COMMON.WS-MAX-NO-LINES = 56;

  /* perform process to initialize constants*/

  AME37P9-INITCON();

  /* set standard header variables*/

  call "DATEAPP" (GDW, VDBCONTROL, VMESSAGE) {isNoRefresh = yes};
  REP-COMMON.WS-DT = GDW.DTL; /* current date*/
  REP-COMMON.WS-YEAR = REP-COMMON.WS-YY;
  REP-COMMON.WS-MONTH = REP-COMMON.WS-MM;
  REP-COMMON.WS-DAY = REP-COMMON.WS-DD;
  REP-COMMON.WS-F1 = "/";
  REP-COMMON.WS-F2 = "/";
  AME37W-HEAD.UDATE = REP-COMMON.WS-DATE;
  AME37W-HEAD.UTIME = VGVar.currentFormattedTime; /* current time*/
  AME37W-HEAD.UAPPL = "AME37A"; /* application name*/
  VDBCOMMON.UAPPLNAM = "AME37A";

  AME37P9-READIP();

  if (SR-AME37-RECIN.RPT-MONTH is numeric && 
  SR-AME37-RECIN.RPT-YEAR is numeric)
    AME37W.WS-TOPREC = SR-AME37-RECIN.TOPREC;
  else

  /* ------------------PTR 11842 Begin -------------------------*/

  /* Call CEP01A for invalid parameters*/

    VMESSAGE.UMSGCODE-JCL-ERR = 0;
    VMESSAGE.UMSGCODE = "ARX0402E";
    VMESSAGE.UMSGINS[2] = "AME37A";
    VDBCONTROL.UPROC-NM = "AME37P9-INIT-PARA";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VDBCONTROL.UPROC-OBJ = "SR-AME37-RECIN";
    VMESSAGE.UMSGINS[1] = " ";
    VDBCONTROL.UMSQLCODE = 0;
    WCM00P2-TO-CEP01A();
  end

  /* ------------------PTR 11842 End   -------------------------*/

  /* perform validation of input parameters*/

  if ((AME37W.WS-RPT-MONTH < 1 || 
  AME37W.WS-RPT-MONTH > 12 || 
  AME37W.WS-RPT-YEAR < 1900))

    /* ----------------- PTR 11842 Begin -------------------------*/

    /* Call CEP01A for invalid parameters*/

    VMESSAGE.UMSGCODE-JCL-ERR = 0;
    VMESSAGE.UMSGCODE = "ARX0402E";
    VMESSAGE.UMSGINS[2] = "AME37A";
    VDBCONTROL.UPROC-NM = "AME37P9-INIT-PARA";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VDBCONTROL.UPROC-OBJ = "SR-AME37-RECIN";
    VMESSAGE.UMSGINS[1] = " ";
    VDBCONTROL.UMSQLCODE = 0;
    WCM00P2-TO-CEP01A();

    /* ------------ PTR 11842 End ----------------------*/

  end

  /* populate application specific header*/

  /* populate sub header variables*/

  if ((AME37W.WS-RPT-MONTH == 01))
    AME37W-SUBH.S-RPT-MTH = "JAN,";
  else
    if ((AME37W.WS-RPT-MONTH == 02))
      AME37W-SUBH.S-RPT-MTH = "FEB,";
    else
      if ((AME37W.WS-RPT-MONTH == 03))
        AME37W-SUBH.S-RPT-MTH = "MAR,";
      else
        if ((AME37W.WS-RPT-MONTH == 04))
          AME37W-SUBH.S-RPT-MTH = "APR,";
        else
          if ((AME37W.WS-RPT-MONTH == 05))
            AME37W-SUBH.S-RPT-MTH = "MAY,";
          else
            if ((AME37W.WS-RPT-MONTH == 06))
              AME37W-SUBH.S-RPT-MTH = "JUN,";
            else
              if ((AME37W.WS-RPT-MONTH == 07))
                AME37W-SUBH.S-RPT-MTH = "JUL,";
              else
                if ((AME37W.WS-RPT-MONTH == 08))
                  AME37W-SUBH.S-RPT-MTH = "AUG,";
                else
                  if ((AME37W.WS-RPT-MONTH == 09))
                    AME37W-SUBH.S-RPT-MTH = "SEP,";
                  else
                    if ((AME37W.WS-RPT-MONTH == 10))
                      AME37W-SUBH.S-RPT-MTH = "OCT,";
                    else
                      if ((AME37W.WS-RPT-MONTH == 11))
                        AME37W-SUBH.S-RPT-MTH = "NOV,";
                      else
                        if ((AME37W.WS-RPT-MONTH == 12))
                          AME37W-SUBH.S-RPT-MTH = "DEC,";
                        end
                      end
                    end
                  end
                end
              end
            end
          end
        end
      end
    end
  end


  AME37W-SUBH.S-RPT-YR = AME37W.WS-RPT-YEAR;

  /* cbsi end*/
end // end AME37P9-INIT-PARA


// INITIALISE CONSTANTS
Function AME37P9-INITCON()
  /* this process intialises all the reports constants*/
  AME37W-HEAD.CONSTANT1 = "PAGE-NBR";
  AME37W-HEAD.FILLER1 = " ";
  AME37W-HEAD.FILLER2 = " ";
  AME37W-HEAD.CONSTANT2 = "STATE";
  AME37W-HEAD.FILLER3 = " ";
  AME37W-HEAD.CONSTANT3 = "OF";
  AME37W-HEAD.FILLER4 = " ";
  AME37W-HEAD.CONSTANT4 = "NEVADA";
  AME37W-HEAD.FILLER5 = " ";
  AME37W-HEAD.CONSTANT5 = "DATE";
  AME37W-HEAD.FILLER6 = " ";
  AME37W-HEAD.FILLER8 = " ";
  AME37W-HEAD.CONSTANT6 = "FOOD";
  AME37W-HEAD.FILLER9 = " ";
  AME37W-HEAD.CONSTANT7 = "STAMP";
  AME37W-HEAD.FILLER10 = " ";
  AME37W-HEAD.CONSTANT8 = "CASELOAD";
  AME37W-HEAD.FILLER11 = " ";
  AME37W-HEAD.CONSTANT9 = "ACTIVITY";
  AME37W-HEAD.FILLER12 = " ";
  AME37W-HEAD.CONSTANT10 = "REPORT";
  AME37W-HEAD.FILLER13 = " ";
  AME37W-HEAD.CONSTANT11 = "TIME";
  AME37W-HEAD.FILLER14 = " ";
  AME37W-SUBH.CONSTANT1 = "REPORT";
  AME37W-SUBH.FILLER1 = " ";
  AME37W-SUBH.CONSTANT2 = "MONTH";
  AME37W-SUBH.FILLER2 = " ";
  AME37W-SUBH.FILLER3 = " ";
  AME37W-SUBH.FILLER4 = " ";
  AME37W-SUBH.CONSTANT3 = "LEVEL";
  AME37W-SUBH.FILLER5 = " ";
  AME37W-SUBH.FILLER6 = " ";
  AME37W-SUBH.CONSTANT4 = "SUFFIX";
  AME37W-SUBH.FILLER7 = " ";
  AME37W-SUBH.CONSTANT5 = "SUFFIX";
  AME37W-SUBH.FILLER8 = " ";
  AME37W-SUBH.CONSTANT6 = "SUB";
  AME37W-SUBH.FILLER9 = " ";
  AME37W-SUBH.CONSTANT7 = "TOTAL";
  AME37W-SUBH.FILLER10 = " ";
  AME37W-SUBH.CONSTANT8 = "GRAND";
  AME37W-SUBH.FILLER11 = " ";
  AME37W-SUBH.CONSTANT9 = "TOTAL";
  AME37W-SUBH.FILLER12 = " ";
  AME37W-SUBH.FILLER13 = " ";
  AME37W-SUBH.CONSTANT10 = "P";
  AME37W-SUBH.FILLER14 = " ";
  AME37W-SUBH.CONSTANT11 = "NOT";
  AME37W-SUBH.FILLER15 = " ";
  AME37W-SUBH.CONSTANT12 = "P";
  AME37W-SUBH.FILLER16 = " ";
  AME37W-DET.CONSTANT1 = "ACTIVE";
  AME37W-DET.FILLER1 = " ";
  AME37W-DET.CONSTANT2 = "CASELOAD";
  AME37W-DET.FILLER2 = " ";
  AME37W-DET.CONSTANT3 = "(CASE";
  AME37W-DET.FILLER3 = " ";
  AME37W-DET.CONSTANT4 = "RECEIVED";
  AME37W-DET.FILLER4 = " ";
  AME37W-DET.CONSTANT5 = "BENEFIT)";
  AME37W-DET.FILLER5 = " ";
  AME37W-DET.FILLER6 = " ";
  AME37W-DET.FILLER7 = " ";
  AME37W-DET.FILLER8 = " ";
  AME37W-DET.FILLER9 = " ";
  AME37W-DET.CONSTANT6 = "(IDENTIFIES";
  AME37W-DET.FILLER10 = " ";
  AME37W-DET.CONSTANT7 = "EXPEDITED";
  AME37W-DET.FILLER11 = " ";
  AME37W-DET.CONSTANT8 = "SERVICE)";
  AME37W-DET.FILLER12 = " ";
  AME37W-DET.FILLER13 = " ";
  AME37W-DET.FILLER14 = " ";
  AME37W-DET.FILLER15 = " ";
  AME37W-DET.FILLER16 = " ";
  AME37W-DET.CONSTANT9 = "(IDENTIFIES";
  AME37W-DET.FILLER17 = " ";
  AME37W-DET.CONSTANT10 = "OTC )";
  AME37W-DET.FILLER18 = " ";
  AME37W-DET.FILLER19 = " ";
  AME37W-DET.FILLER20 = " ";
  AME37W-DET.FILLER21 = " ";
  AME37W-DET.FILLER22 = " ";
  AME37W-DET.FILLER16E = " ";
  AME37W-DET.CONSTANT9E = "(IDENTIFIES";
  AME37W-DET.FILLER17E = " ";
  AME37W-DET.CONSTANT10E = "EBT )";
  AME37W-DET.FILLER18E = " ";
  AME37W-DET.FILLER19E = " ";
  AME37W-DET.FILLER20E = " ";
  AME37W-DET.FILLER21E = " ";
  AME37W-DET.FILLER22 = " ";
  AME37W-DET.CONSTANT11 = "(IDENTIFIES";
  AME37W-DET.FILLER23 = " ";
  AME37W-DET.CONSTANT12 = "DMI )";
  AME37W-DET.FILLER24 = " ";
  AME37W-DET.FILLER27 = " ";
  AME37W-DET.FILLER28 = " ";
  AME37W-DET.FILLER29 = " ";
  AME37W-DET.CONSTANT15 = "CASES";
  AME37W-DET.FILLER30 = " ";
  AME37W-DET.CONSTANT16 = "WITH";
  AME37W-DET.FILLER31 = " ";
  AME37W-DET.CONSTANT17 = "ISSUES";
  AME37W-DET.FILLER32 = " ";
  AME37W-DET.CONSTANT18 = "MADE";
  AME37W-DET.FILLER33 = " ";
  AME37W-DET.CONSTANT19 = "FOR";
  AME37W-DET.FILLER34 = " ";
  AME37W-DET.CONSTANT20 = "LAST";
  AME37W-DET.FILLER35 = " ";
  AME37W-DET.CONSTANT21 = "MONTH";
  AME37W-DET.FILLER36 = " ";
  AME37W-DET.FILLER37 = " ";
  AME37W-DET.FILLER38 = " ";
  AME37W-DET.FILLER39 = " ";
  AME37W-DET.CONSTANT22 = "REVISED";
  AME37W-DET.FILLER40 = " ";
  AME37W-DET.CONSTANT23 = "CASELOAD";
  AME37W-DET.FILLER41 = " ";
  AME37W-DET.CONSTANT24 = "FOR";
  AME37W-DET.FILLER42 = " ";
  AME37W-DET.CONSTANT25 = "PRIOR";
  AME37W-DET.FILLER43 = " ";
  AME37W-DET.CONSTANT26 = "MONTH";
  AME37W-DET.FILLER44 = " ";
  AME37W-DET.FILLER45 = " ";
  AME37W-DET.FILLER46 = " ";
  AME37W-DET.FILLER47 = " ";
  AME37W-DET.CONSTANT27 = "%";
  AME37W-DET.FILLER48 = " ";
  AME37W-DET.CONSTANT28 = "RETRO";
  AME37W-DET.FILLER49 = " ";
  AME37W-DET.CONSTANT29 = "ISSUE";
  AME37W-DET.FILLER50 = " ";
  AME37W-DET.CONSTANT30 = "TO";
  AME37W-DET.FILLER51 = " ";
  AME37W-DET.CONSTANT31 = "PRIOR";
  AME37W-DET.FILLER52 = " ";
  AME37W-DET.CONSTANT32 = "MONTH";
  AME37W-DET.FILLER53 = " ";
  AME37W-DET.CONSTANT33 = "CASELOAD";
  AME37W-DET.FILLER54 = " ";
  AME37W-DET.FILLER55 = " ";
  AME37W-DET.FILLER56 = " ";
  AME37W-DET.FILLER57 = " ";
  AME37W-DET.FILLER58 = " ";
  AME37W-DET.CONSTANT34 = "ESTIMATED";
  AME37W-DET.FILLER59 = " ";
  AME37W-DET.CONSTANT35 = "CURRENT";
  AME37W-DET.FILLER60 = " ";
  AME37W-DET.CONSTANT36 = "MONTH";
  AME37W-DET.FILLER61 = " ";
  AME37W-DET.CONSTANT37 = "CASELOAD";
  AME37W-DET.FILLER62 = " ";
  AME37W-DET.FILLER63 = " ";
  AME37W-DET.FILLER64 = " ";
  AME37W-DET.FILLER65 = " ";
  AME37W-DET.FILLER66 = " ";
  AME37W-DET.CONSTANT38 = "(ACTIVE";
  AME37W-DET.FILLER67 = " ";
  AME37W-DET.CONSTANT39 = "CASELOAD";
  AME37W-DET.FILLER68 = " ";
  AME37W-DET.CONSTANT40 = "PLUS";
  AME37W-DET.FILLER69 = " ";
  AME37W-DET.CONSTANT41 = "%";
  AME37W-DET.FILLER70 = " ";
  AME37W-DET.CONSTANT42 = "RETRO)";
  AME37W-DET.FILLER71 = " ";
  AME37W-DET.FILLER72 = " ";
  AME37W-DET.FILLER73 = " ";
  AME37W-DET.FILLER74 = " ";
  AME37W-DET.FILLER75 = " ";
  AME37W-DET.CONSTANT43 = "FOOD";
  AME37W-DET.FILLER76 = " ";
  AME37W-DET.CONSTANT44 = "STAMP";
  AME37W-DET.FILLER77 = " ";
  AME37W-DET.CONSTANT45 = "ACTIONS:";
  AME37W-DET.FILLER78 = " ";
  AME37W-DET.FILLER79 = " ";
  AME37W-DET.CONSTANT46 = "APPLICATIONS";
  AME37W-DET.FILLER80 = " ";
  AME37W-DET.CONSTANT47 = "PROCESSED:";
  AME37W-DET.FILLER81 = " ";
  AME37W-DET.FILLER82 = " ";
  AME37W-DET.CONSTANT48 = "APPROVED";
  AME37W-DET.FILLER83 = " ";
  AME37W-DET.CONSTANT49 = "APPLICATIONS:";
  AME37W-DET.FILLER84 = " ";
  AME37W-DET.FILLER85 = " ";
  AME37W-DET.CONSTANT50 = "1.";
  AME37W-DET.FILLER86 = " ";
  AME37W-DET.CONSTANT51 = "FULL";
  AME37W-DET.FILLER87 = " ";
  AME37W-DET.CONSTANT52 = "BENEFIT";
  AME37W-DET.FILLER88 = " ";
  AME37W-DET.FILLER89 = " ";
  AME37W-DET.FILLER90 = " ";
  AME37W-DET.FILLER91 = " ";
  AME37W-DET.FILLER92 = " ";
  AME37W-DET.CONSTANT53 = "2.";
  AME37W-DET.FILLER93 = " ";
  AME37W-DET.CONSTANT54 = "PARTIAL";
  AME37W-DET.FILLER94 = " ";
  AME37W-DET.CONSTANT55 = "BENEFIT";
  AME37W-DET.FILLER95 = " ";
  AME37W-DET.FILLER96 = " ";
  AME37W-DET.FILLER97 = " ";
  AME37W-DET.FILLER98 = " ";
  AME37W-DET.FILLER99 = " ";
  AME37W-DET.CONSTANT56 = "TOTAL";
  AME37W-DET.FILLER100 = " ";
  AME37W-DET.CONSTANT57 = "APPROVED";
  AME37W-DET.FILLER101 = " ";
  AME37W-DET.FILLER102 = " ";
  AME37W-DET.FILLER103 = " ";
  AME37W-DET.FILLER104 = " ";
  AME37W-DET.FILLER105 = " ";
  AME37W-DET.CONSTANT58 = "WITHDRAWN";
  AME37W-DET.FILLER106 = " ";
  AME37W-DET.CONSTANT59 = "APPLICATIONS";
  AME37W-DET.FILLER107 = " ";
  AME37W-DET.FILLER108 = " ";
  AME37W-DET.FILLER109 = " ";
  AME37W-DET.FILLER110 = " ";
  AME37W-DET.FILLER111 = " ";
  AME37W-DET.CONSTANT60 = "DENIED";
  AME37W-DET.FILLER112 = " ";
  AME37W-DET.CONSTANT61 = "APPLICATIONS:";
  AME37W-DET.FILLER113 = " ";
  AME37W-DET.FILLER114 = " ";
  AME37W-DET.CONSTANT62 = "3.";
  AME37W-DET.FILLER115 = " ";
  AME37W-DET.CONSTANT63 = "EXCESS";
  AME37W-DET.FILLER116 = " ";
  AME37W-DET.CONSTANT64 = "INCOME";
  AME37W-DET.FILLER117 = " ";
  AME37W-DET.FILLER118 = " ";
  AME37W-DET.FILLER119 = " ";
  AME37W-DET.FILLER120 = " ";
  AME37W-DET.FILLER121 = " ";
  AME37W-DET.CONSTANT65 = "4.";
  AME37W-DET.FILLER122 = " ";
  AME37W-DET.CONSTANT66 = "NON-COOPERATION";
  AME37W-DET.FILLER123 = " ";
  AME37W-DET.FILLER124 = " ";
  AME37W-DET.FILLER125 = " ";
  AME37W-DET.FILLER126 = " ";
  AME37W-DET.FILLER127 = " ";
  AME37W-DET.CONSTANT67 = "5.";
  AME37W-DET.FILLER128 = " ";
  AME37W-DET.CONSTANT68 = "WORK-REG,";
  AME37W-DET.FILLER129 = " ";
  AME37W-DET.CONSTANT69 = "OR";
  AME37W-DET.FILLER130 = " ";
  AME37W-DET.CONSTANT70 = "QUIT";
  AME37W-DET.FILLER131 = " ";
  AME37W-DET.FILLER132 = " ";
  AME37W-DET.FILLER133 = " ";
  AME37W-DET.FILLER134 = " ";
  AME37W-DET.FILLER135 = " ";
  AME37W-DET.CONSTANT71 = "6.";
  AME37W-DET.FILLER136 = " ";
  AME37W-DET.CONSTANT72 = "EXCESS";
  AME37W-DET.FILLER137 = " ";
  AME37W-DET.CONSTANT73 = "RESOURCE";
  AME37W-DET.FILLER138 = " ";
  AME37W-DET.FILLER139 = " ";
  AME37W-DET.FILLER140 = " ";
  AME37W-DET.FILLER141 = " ";
  AME37W-DET.FILLER142 = " ";
  AME37W-DET.CONSTANT74 = "7.";
  AME37W-DET.FILLER143 = " ";
  AME37W-DET.CONSTANT75 = "OTHER";
  AME37W-DET.FILLER144 = " ";
  AME37W-DET.FILLER145 = " ";
  AME37W-DET.FILLER146 = " ";
  AME37W-DET.FILLER147 = " ";
  AME37W-DET.FILLER148 = " ";
  AME37W-DET.CONSTANT76 = "TOTAL";
  AME37W-DET.FILLER149 = " ";
  AME37W-DET.CONSTANT77 = "DENIED";
  AME37W-DET.FILLER150 = " ";
  AME37W-DET.FILLER151 = " ";
  AME37W-DET.FILLER152 = " ";
  AME37W-DET.FILLER153 = " ";
  AME37W-DET.FILLER154 = " ";
  AME37W-DET.CONSTANT78 = "TOTAL";
  AME37W-DET.FILLER155 = " ";
  /* line modified for wi16861 (append a ":" to the literal "processed")*/
  AME37W-DET.CONSTANT79 = "APPLICATIONS PROCESSED:";
  AME37W-DET.FILLER156 = " ";
  AME37W-DET.FILLER157 = " ";
  AME37W-DET.FILLER158 = " ";
  AME37W-DET.FILLER159 = " ";
  AME37W-DET.FILLER160 = " ";
  AME37W-DET.CONSTANT80 = "RECEIVED";
  AME37W-DET.FILLER161 = " ";
  AME37W-DET.CONSTANT81 = "THIS";
  AME37W-DET.FILLER162 = " ";
  AME37W-DET.CONSTANT82 = "MONTH";
  AME37W-DET.FILLER163 = " ";
  AME37W-DET.FILLER164 = " ";
  AME37W-DET.FILLER165 = " ";
  AME37W-DET.FILLER166 = " ";
  AME37W-DET.FILLER167 = " ";
  AME37W-DET.CONSTANT83 = "RECEIVED";
  AME37W-DET.FILLER168 = " ";
  AME37W-DET.CONSTANT84 = "PREVIOUS MONTHS";
  AME37W-DET.FILLER169 = " ";
  AME37W-DET.FILLER170 = " ";
  AME37W-DET.FILLER171 = " ";
  AME37W-DET.FILLER172 = " ";
  /*  */
  /* Added for WI 15820*/
  /*  */
  AME37W-DET.FILLER173 = " ";
  AME37W-DET.CONSTANT85 = "APPLICATIONS";
  AME37W-DET.FILLER174 = " ";
  AME37W-DET.CONSTANT86 = "RECEIVED";
  AME37W-DET.FILLER175 = " ";
  AME37W-DET.CONSTANT87 = "DURING";
  AME37W-DET.FILLER176 = " ";
  AME37W-DET.CONSTANT88 = "MONTH:";
  AME37W-DET.FILLER177 = " ";
  AME37W-DET.FILLER178 = " ";
  AME37W-DET.CONSTANT89 = "1.";
  AME37W-DET.FILLER179 = " ";
  AME37W-DET.CONSTANT90 = "PENDING";
  AME37W-DET.FILLER180 = " ";
  AME37W-DET.FILLER181 = " ";
  AME37W-DET.FILLER182 = " ";
  AME37W-DET.FILLER183 = " ";
  AME37W-DET.FILLER184 = " ";
  AME37W-DET.CONSTANT91 = "2.";
  AME37W-DET.FILLER185 = " ";
  AME37W-DET.CONSTANT92 = "APPROVED";
  AME37W-DET.FILLER186 = " ";
  AME37W-DET.FILLER187 = " ";
  AME37W-DET.FILLER188 = " ";
  AME37W-DET.FILLER189 = " ";
  AME37W-DET.FILLER190 = " ";
  AME37W-DET.CONSTANT93 = "3.";
  AME37W-DET.FILLER191 = " ";
  AME37W-DET.CONSTANT94 = "DENIED/WITHDRAWN";
  AME37W-DET.FILLER192 = " ";
  AME37W-DET.FILLER193 = " ";
  AME37W-DET.FILLER194 = " ";
  AME37W-DET.FILLER195 = " ";
  AME37W-DET.FILLER196 = " ";
  AME37W-DET.CONSTANT95 = "TOTAL";
  AME37W-DET.FILLER197 = " ";
  AME37W-DET.CONSTANT96 = "APPLICATIONS-REPORT";
  AME37W-DET.FILLER198 = " ";
  AME37W-DET.CONSTANT97 = "MONTH:";
  AME37W-DET.FILLER199 = " ";
  AME37W-DET.FILLER200 = " ";
  AME37W-DET.FILLER201 = " ";
  AME37W-DET.FILLER202 = " ";
  /*  */
  /* End of WI 15820*/
  AME37W-DET.FILLER203 = " ";
  AME37W-DET.CONSTANT98 = "NON-APPLICATION";
  AME37W-DET.FILLER204 = " ";
  AME37W-DET.CONSTANT99 = "ACTION:";
  AME37W-DET.FILLER205 = " ";
  AME37W-DET.FILLER206 = " ";
  AME37W-DET.CONSTANT100 = "TERMINATIONS";
  AME37W-DET.FILLER207 = " ";
  AME37W-DET.FILLER208 = " ";
  AME37W-DET.FILLER209 = " ";
  AME37W-DET.FILLER210 = " ";
  AME37W-DET.FILLER211 = " ";
  AME37W-DET.CONSTANT101 = "UPDATES";
  AME37W-DET.FILLER212 = " ";
  AME37W-DET.CONSTANT102 = "(INCLUDES";
  AME37W-DET.FILLER213 = " ";
  AME37W-DET.CONSTANT103 = "TRANSFERS)";
  AME37W-DET.FILLER214 = " ";
  AME37W-DET.FILLER215 = " ";
  AME37W-DET.FILLER216 = " ";
  AME37W-DET.FILLER217 = " ";
  AME37W-DET.FILLER218 = " ";
  AME37W-DET.CONSTANT104 = "TOTAL";
  AME37W-DET.FILLER219 = " ";
  AME37W-DET.CONSTANT105 = "NON-APPLICATION";
  AME37W-DET.FILLER220 = " ";
  AME37W-DET.CONSTANT106 = "ACTIONS";
  AME37W-DET.FILLER221 = " ";
  AME37W-DET.FILLER222 = " ";
  AME37W-DET.FILLER223 = " ";
  AME37W-DET.FILLER224 = " ";
  AME37W-DET.CONSTANT107 = "MANDATORY";
  AME37W-DET.FILLER225 = " ";
  AME37W-DET.CONSTANT108 = "REPORT";
  AME37W-DET.FILLER226 = " ";
  AME37W-DET.CONSTANT109 = "CASES:";
  AME37W-DET.FILLER227 = " ";
  AME37W-DET.FILLER228 = " ";
  AME37W-DET.FILLER229 = " ";
  AME37W-DET.FILLER230 = " ";
  /* Change due to WI 16330 Begin ---------------*/
  AME37W-DET.CONSTANT11A = "METHOD OF ISSUANCE";
  AME37W-DET.FILLER231 = " ";
  AME37W-DET.CONSTANT11B = "CODE-0 ";
  AME37W-DET.CONSTANT110 = "CODE-1";
  AME37W-DET.FILLER232 = " ";
  AME37W-DET.CONSTANT111 = "CODE-2";
  AME37W-DET.FILLER233 = " ";
  AME37W-DET.CONSTANT112 = "CODE-3";
  AME37W-DET.FILLER234 = " ";
  AME37W-DET.CONSTANT113 = "CODE-4";
  AME37W-DET.FILLER235 = " ";
  AME37W-DET.CONSTANT114 = "CODE-5";
  AME37W-DET.FILLER236 = " ";
  AME37W-DET.CONSTANT115 = "CODE-6";
  AME37W-DET.FILLER237 = " ";
  AME37W-DET.CONSTANT115A = "EBT";
  AME37W-DET.FILLER237A = " ";
  /* Change due to WI 16330 End  -----------*/
  AME37W-DET.FILLER238 = " ";
  AME37W-DET.FILLER239 = " ";
  AME37W-DET.FILLER240 = " ";
  AME37W-DET.FILLER241 = " ";
  AME37W-DET.FILLER242 = " ";
  AME37W-DET.FILLER243 = " ";
  AME37W-DET.FILLER244 = " ";
  AME37W-DET.S-GRNDTOTRE = " ";
  AME37W-DET.S-PAPLUS = " ";
  AME37W-DET.S-NAPLUS = " ";
  AME37W-DET.S-SUBTOTPLUS = " ";
  AME37W-DET.S-GRNDTOTPL = " ";
  AME37W-DET.S-FILL1 = " ";
  AME37W-DET.S-FILL2 = " ";
  AME37W-DET.S-FILL3 = " ";
  AME37W-DET.S-FILL4 = " ";
  AME37W-DET.S-FILL5 = " ";
end // end AME37P9-INITCON


// PROCESS TO ACCUMULATE RPT VARS
Function AME37P9-LAST-MTH()
  if (H2-3-FAC-FCH-FSI.ISNCE-DT >= AME37W.WS-RPT-BEG-DT
   && H2-3-FAC-FCH-FSI.ISNCE-DT <= AME37W.WS-RPT-END-DT)

    if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
    H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
      AME37W.WS-PALMISS = AME37W.WS-PALMISS + 1;
    else
      AME37W.WS-NALMISS = AME37W.WS-NALMISS + 1;
    end

  end

  if ((H2-3-FAC-FCH-FSI.FS-SUFX == "P" || 
  H2-3-FAC-FCH-FSI.FS-SUFX == "S" || 
  H2-3-FAC-FCH-FSI.FS-SUFX == "G" || 
  H2-3-FAC-FCH-FSI.FS-SUFX == "A"))
    AME37W.WS-PAREVISED = AME37W.WS-PAREVISED + 1;
  else
    AME37W.WS-NAREVISED = AME37W.WS-NAREVISED + 1;
  end
end // end AME37P9-LAST-MTH


// PROCESS TO CHECK LEAP YEAR
Function AME37P9-LEAP()
  /* CBSI START*/
  AME37W.WS-LEAP-YEAR-FLAG = "N";
  AME37W.WS-REM = AME37W.WS-RPT-BEG-DT-YY % 100;
  if (AME37W.WS-REM == 0)
    AME37W.WS-REM = AME37W.WS-RPT-BEG-DT-YY % 400;
    if (AME37W.WS-REM == 0)
      WS-LEAP-YEAR-FLAG = "Y";
    end
  else
    AME37W.WS-REM = AME37W.WS-RPT-BEG-DT-YY % 4;
    if (AME37W.WS-REM == 0)
      AME37W.WS-LEAP-YEAR-FLAG = "Y";
    end
  end
  /* CBSI END*/
end // end AME37P9-LEAP


// REPORTS MAIN PARA
Function AME37P9-MAIN()
  /* Main process for AME37A report Application*/

  /* Perform process to initialize variables*/

  AME37P9-INIT-PARA();

  /* Perform process to print report*/

  AME37P9-PRINT-PARA();

  /* Perform process to close application*/

  AME37P9-CLOS-PARA();

  /*  */
end // end AME37P9-MAIN


// TO FIND BEG DT AND END DT
Function AME37P9-PARA1()
  /* DERIVE RPT-BEG-DT AND RPT-END-DT*/

  AME37W.WS-F1 = "-";
  AME37W.WS-F2 = "-";
  AME37W.WS-F3 = "-";
  AME37W.WS-F4 = "-";
  AME37W.WS-RPT-BEG-DT-DD = 01;
  AME37W.WS-RPT-BEG-DT-MM = AME37W.WS-RPT-MONTH;
  AME37W.WS-RPT-BEG-DT-YY = AME37W.WS-RPT-YEAR;
  AME37W.WS-RPT-MONTH-BIN = AME37W.WS-RPT-MONTH;
  AME37W.WS-RPT-YEAR-BIN = AME37W.WS-RPT-YEAR;
  AME37P9-LEAP();
  if (AME37W.WS-RPT-BEG-DT-MM == 01 || 
  AME37W.WS-RPT-BEG-DT-MM == 03 || 
  AME37W.WS-RPT-BEG-DT-MM == 05 || 
  AME37W.WS-RPT-BEG-DT-MM == 07 || 
  AME37W.WS-RPT-BEG-DT-MM == 08 || 
  AME37W.WS-RPT-BEG-DT-MM == 10 || 
  AME37W.WS-RPT-BEG-DT-MM == 12)
    AME37W.WS-RPT-END-DT-DD = 31;
  else
    AME37W.WS-RPT-END-DT-DD = 30;
  end
  if (AME37W.WS-RPT-BEG-DT-MM == 2)
    if (AME37W.WS-LEAP-YEAR-FLAG == "Y")
      AME37W.WS-RPT-END-DT-DD = 29;
    else
      AME37W.WS-RPT-END-DT-DD = 28;
    end
  end
  AME37W.WS-RPT-END-DT-MM = AME37W.WS-RPT-MONTH;
  AME37W.WS-RPT-END-DT-YY = AME37W.WS-RPT-YEAR;
  if (AME37W.WS-RPT-MONTH == 1)
    AME37W.WS-PREV-RPT-MTH = 12;
    AME37W.WS-PRNM-RPT-YR = AME37W.WS-RPT-YEAR - 1;
    AME37W.WS-PREV-RPT-YR-YY = AME37W.WS-PRNM-RPT-YR-YY;
    AME37W.WS-PREV-RPT-YR = AME37W.WS-PRNM-RPT-YR;
  else
    AME37W.WS-PREV-RPT-MTH = AME37W.WS-RPT-MONTH - 1;
    AME37W.WS-PRNM-RPT-YR = AME37W.WS-RPT-YEAR;
    AME37W.WS-PREV-RPT-YR-YY = AME37W.WS-PRNM-RPT-YR-YY;
    AME37W.WS-PREV-RPT-YR = AME37W.WS-PRNM-RPT-YR;
  end

  AME37W.WS-REP-BEG-TS-DT = AME37W.WS-RPT-BEG-DT;
  AME37W.WS-REP-BEG-TS-TIME = "-00.00.00.000000";

  AME37W.WS-REP-END-TS-DT = AME37W.WS-RPT-END-DT;
  AME37W.WS-REP-END-TS-TIME = "-23.59.59.999999";
  /*  */
end // end AME37P9-PARA1


// POPULATE REP-DET FOR AN OFFICE
Function AME37P9-POP-OFDET()
  AME37W.WS-NODATA-FLG = "N";
  if (AME37W.WS-PACASES != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PACASES;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PACASES = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PACASES = "     0";
  end

  if (AME37W.WS-NACASES != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NACASES;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NACASES = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NACASES = "     0";
  end

  if (AME37W.WS-GRNDTOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-GRNDTOT;
    FORMATW.LENGTH = 9;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNDTOT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-GRNDTOT = "        0";
  end

  if (AME37W.WS-PAEXPCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAEXPCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAEXPCASE = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAEXPCASE = "     0";
  end

  if (AME37W.WS-NAEXPCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAEXPCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAEXPCASE = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAEXPCASE = "     0";
  end

  if (AME37W.WS-SUBTOTEX != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTEX;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTEX = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTEX = "      0";
  end


  if (AME37W.WS-PADAMS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PADAMS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PADAMS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PADAMS = "     0";
  end

  if (AME37W.WS-NADAMS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NADAMS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NADAMS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NADAMS = "     0";
  end

  if (AME37W.WS-SUBTOTDM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTDM;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTDM = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTDM = "      0";
  end

  if (AME37W.WS-PASPHNDL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PASPHNDL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PASPHNDL = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PASPHNDL = "     0";
  end

  if (AME37W.WS-NASPHNDL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NASPHNDL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NASPHNDL = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NASPHNDL = "     0";
  end

  if (AME37W.WS-SUBTOTSP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTSP;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTSP = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTSP = "      0";
  end

  if (AME37W.WS-PAEBTCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAEBTCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAEBTCASE = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAEBTCASE = "     0";
  end

  if (AME37W.WS-NAEBTCASE != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAEBTCASE;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAEBTCASE = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAEBTCASE = "     0";
  end

  if (AME37W.WS-SUBTOTEBT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTEBT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTEBT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTEBT = "      0";
  end


  if (AME37W.WS-PALMISS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PALMISS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PALMISS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PALMISS = "     0";
  end

  if (AME37W.WS-NALMISS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NALMISS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NALMISS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NALMISS = "     0";
  end

  if (AME37W.WS-SUBTOTIS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTIS;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTIS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTIS = "      0";
  end

  if (AME37W.WS-PAREVISED != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAREVISED;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAREVISED = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAREVISED = "     0";
  end

  if (AME37W.WS-NAREVISED != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAREVISED;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAREVISED = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAREVISED = "     0";
  end

  if (AME37W.WS-SUBTOTREV != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTREV;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTREV = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTREV = "      0";
  end

  if (AME37W.WS-PARETRO != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PARETRO;
    FORMATW.LENGTH = 5;
    FORMATW.DEC-COUNT = 1;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PARETRO = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PARETRO = "  0.0";
  end

  if (AME37W.WS-NARETRO != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NARETRO;
    FORMATW.LENGTH = 5;
    FORMATW.DEC-COUNT = 1;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NARETRO = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NARETRO = "  0.0";
  end

  if (AME37W.WS-SUBTOTRET != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTRET;
    FORMATW.LENGTH = 5;
    FORMATW.DEC-COUNT = 1;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTRET = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTRET = "  0.0";
  end

  if (AME37W.WS-PAEST != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAEST;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAEST = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAEST = "     0";
  end

  if (AME37W.WS-NAEST != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAEST;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAEST = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAEST = "     0";
  end

  if (AME37W.WS-GRNDTOTES != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-GRNDTOTES;
    FORMATW.LENGTH = 9;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNDTOTES = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-GRNDTOTES = "        0";
  end

  if (AME37W.WS-PABNFT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PABNFT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PABNFT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PABNFT = "     0";
  end

  if (AME37W.WS-NABNFT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NABNFT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NABNFT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NABNFT = "     0";
  end


  if (AME37W.WS-SUBTOTBN != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTBN;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTBN = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTBN = "      0";
  end

  if (AME37W.WS-PAPART != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAPART;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAPART = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAPART = "     0";
  end

  if (AME37W.WS-NAPART != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAPART;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAPART = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAPART = "     0";
  end


  if (AME37W.WS-SUBTOTPRT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTPRT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTPRT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTPRT = "      0";
  end

  if (AME37W.WS-PAAPPRV != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAAPPRV;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPRV = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAAPPRV = "     0";
  end

  if (AME37W.WS-NAAPPRV != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAAPPRV;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPRV = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAAPPRV = "     0";
  end

  if (AME37W.WS-SUBTOTAP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTAP;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTAP = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTAP = "      0";
  end

  if (AME37W.WS-PAWTDR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAWTDR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAWTDR = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAWTDR = "     0";
  end

  if (AME37W.WS-NAWTDR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAWTDR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAWTDR = FORMATW.OUTPUT-CHAR;
  else
    AME37W-DET.S-NAWTDR = "     0";
  end

  if (AME37W.WS-SUBTOTWD != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTWD;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTWD = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTWD = "      0";
  end

  if (AME37W.WS-PADENY != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PADENY;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PADENY = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PADENY = "     0";
  end

  if (AME37W.WS-NADENY != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NADENY;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NADENY = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NADENY = "     0";
  end

  if (AME37W.WS-SUBTOTDNY != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTDNY;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTDNY = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTDNY = "      0";
  end

  if (AME37W.WS-PANCOOP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PANCOOP;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PANCOOP = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PANCOOP = "     0";
  end

  if (AME37W.WS-NANCOOP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NANCOOP;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NANCOOP = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NANCOOP = "     0";
  end

  if (AME37W.WS-SUBTOTNC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTNC;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTNC = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTNC = "      0";
  end

  if (AME37W.WS-PAQUIT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAQUIT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAQUIT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAQUIT = "     0";
  end

  if (AME37W.WS-NAQUIT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAQUIT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAQUIT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAQUIT = "     0";
  end


  if (AME37W.WS-SUBTOTQT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTQT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTQT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTQT = "      0";
  end

  if (AME37W.WS-PARSRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PARSRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PARSRC = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PARSRC = "     0";
  end

  if (AME37W.WS-NARSRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NARSRC;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NARSRC = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NARSRC = "     0";
  end


  if (AME37W.WS-SUBTOTRC != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTRC;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTRC = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTRC = "      0";
  end

  if (AME37W.WS-PAOTHR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAOTHR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAOTHR = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAOTHR = "     0";
  end

  if (AME37W.WS-NAOTHR != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAOTHR;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAOTHR = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAOTHR = "     0";
  end


  if (AME37W.WS-SUBTOTOTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTOTH;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTOTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTOTH = "      0";
  end


  if (AME37W.WS-PATOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PATOT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PATOT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PATOT = "     0";
  end

  if (AME37W.WS-NATOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NATOT;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NATOT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NATOT = "     0";
  end

  if (AME37W.WS-SUBTOTTOT != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTTOT;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTTOT = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTTOT = "      0";
  end

  if (AME37W.WS-PAAPPL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAAPPL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPL = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAAPPL = "     0";
  end

  if (AME37W.WS-NAAPPL != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAAPPL;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPL = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAAPPL = "     0";
  end

  if (AME37W.WS-GRNDTOTAPP != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-GRNDTOTAPP;
    FORMATW.LENGTH = 9;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNTOTAPP = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-GRNTOTAPP = "        0";
  end

  if (AME37W.WS-PANEW != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PANEW;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PANEW = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PANEW = "     0";
  end

  if (AME37W.WS-NANEW != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NANEW;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NANEW = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NANEW = "     0";
  end


  if (AME37W.WS-SUBTOTNEW != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTNEW;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTNEW = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTNEW = "      0";
  end

  if (AME37W.WS-PASUBS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PASUBS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PASUBS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PASUBS = "     0";
  end

  if (AME37W.WS-NASUBS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NASUBS;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NASUBS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NASUBS = "     0";
  end

  if (AME37W.WS-SUBTOTSUBS != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTSUBS;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTSUBS = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTSUBS = "      0";
  end


  if (AME37W.WS-PAPNDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAPNDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAPNDMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAPNDMTH = "     0";
  end

  if (AME37W.WS-NAPNDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAPNDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAPNDMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAPNDMTH = "     0";
  end


  if (AME37W.WS-SUBTOTPNDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTPNDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTPNDMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTPNDMTH = "     0";
  end

  if (AME37W.WS-PAAPPRVMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAAPPRVMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPRVMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAAPPRVMTH = "     0";
  end

  if (AME37W.WS-NAAPPRVMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAAPPRVMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPRVMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAAPPRVMTH = "     0";
  end

  if (AME37W.WS-SUBTOTAPMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTAPMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTAPMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTAPMTH = "     0";
  end

  if (AME37W.WS-PADNYWDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PADNYWDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PADNYWDMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PADNYWDMTH = "     0";
  end

  if (AME37W.WS-NADNYWDMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NADNYWDMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NADNYWDMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NADNYWDMTH = "     0";
  end

  if (AME37W.WS-SUBTOTDNYWD != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTDNYWD;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTDNYWD = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTDNYWD = "     0";
  end


  if (AME37W.WS-PAAPPLMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PAAPPLMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PAAPPLMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PAAPPLMTH = "     0";
  end

  if (AME37W.WS-NAAPPLMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NAAPPLMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NAAPPLMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NAAPPLMTH = "     0";
  end

  if (AME37W.WS-GRNDTOTAPPMTH != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-GRNDTOTAPPMTH;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-GRNTOTAPPMTH = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-GRNTOTAPPMTH = "     0";
  end


  if (AME37W.WS-PATERM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-PATERM;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-PATERM = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-PATERM = "     0";
  end

  if (AME37W.WS-NATERM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-NATERM;
    FORMATW.LENGTH = 6;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-NATERM = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-NATERM = "     0";
  end


  if (AME37W.WS-SUBTOTTRM != 0)
    set FORMATW empty;
    FORMATW.INPUT-NUMBER = AME37W.WS-SUBTOTTRM;
    FORMATW.LENGTH = 7;
    FORMATW.FORMAT-FLAG = "Y";
    FORMATW.DOLLAR-FLAG = "N";
    REPP9-FORMAT-PROC();
    AME37W-DET.S-SUBTOTTRM = FORMATW.OUTPUT-CHAR;
    AME37W.WS-NODATA-FLG = "Y";
  else
    AME37W-DET.S-SUBTOTTRM = "      0";
  end