public String getIncapDiablityIndicator(SnapCharacteristicInputParam inputParam)
        throws BatchBusinessException {
    try {
        String sqlQuery = getQueryWithSchemaName(QueryConstants.GET_INCAP_DSBLTY_IND);
        Object[] params = new Object[] {
            inputParam.getParam1(),
            inputParam.getParam2(),
            inputParam.getParam3()
        };

        // query(...) is the modern alternative to queryForObject
        List<String> results = jdbcTemplate.query(sqlQuery, params, (rs, rowNum) -> rs.getString(1));

        if (!results.isEmpty() && StringConstants.CHAR_Y.equalsIgnoreCase(results.get(0))) {
            return StringConstants.CHAR_Y; // or "Y"
        } else {
            return StringConstants.CHAR_N; // or "N"
        }

    } catch (EmptyResultDataAccessException e) {
        return StringConstants.CHAR_N;
    } catch (Exception e) {
        Throwable cause = e.getCause();
        if (cause instanceof SQLException) {
            inputParam.setSqlErrorFlag(true);  // assuming instance method
        } else {
            inputParam.setSqlErrorFlag(false);
        }
        throw new BatchBusinessException("Error occurred while fetching incap disability indicator", e);
    }
}
