<%/********************************************************************************************
Name: DCPGDExpeditedCaseDenial.jsp		Created By: Matthew Van Lenten	Created on: 03/03/2014
Purpose: To display the Sanction Details
Modification Logs: -
Modified By 				Date		Marker			Reason & description
********************************************************************************************/%>
<%/* NOT EDITABLE - FW Page Directive, Imports, and URIs */%>
<%@ include file = "/fwincludes/directives.jsp" %>

<%/* EDITABLE - Page Specific Imports and URIs (You can add code to this section) */%>
<%@ include file = "/includes/DcDirectives.jsp" %>

<%/* EDITABLE - Page Specific useBean tags(You can add code to this section) */%>
<jsp:useBean id="noticeSupprSw" class="gov.illinois.ies.presentation.view.pageelements.NoticeSupprSw" scope="application"/>
<jsp:useBean id="iesCaseNum" class="gov.illinois.ies.presentation.view.pageelements.IESCaseNum" scope="application"/>
<jsp:useBean id="legacyCaseNum" class="gov.illinois.ies.presentation.view.pageelements.LegacyCaseNum" scope="application"/>
<jsp:useBean id="denialReasonCode" class="gov.illinois.ies.presentation.view.pageelements.DenialReasonCode" scope="application"/>
<jsp:useBean id="relatedFFM" class="gov.illinois.ies.presentation.view.pageelements.RelatedFFM" scope="application"/>
<jsp:useBean id="denialReasonDate" class="gov.illinois.ies.presentation.view.pageelements.DenialReasonDate" scope="application"/>
<jsp:useBean id="DenialCargo" class="gov.illinois.ies.business.entities.miscellaneous.DCCaseDenialCustomCargo" scope="request"/>
<jsp:useBean id="iESAppOrCaseNum" class="gov.illinois.ies.presentation.view.pageelements.IESAppOrCaseNum" scope="application"/>

<%/* NOT EDITABLE - Head Tag Include */%>
<%@ include file = "/fwincludes/headTag.jsp" %>

<%
	String onloadJS = "onLoad=\"disableEnableLegacyNum();disableDenialDate();\"";
%>

<%/* EDITABLE WITH PERMISSION (You can add code to this section) - Body and Form Tags */%>
<TL:FWBodyTag security="<%=securityAttr.getPermission()%>" mode="<%=pageMode%>" caseMode="<%=simulation%>" other="<%=onloadJS%>"/>

<%/* Including javascript in the Body tag */ %>
<script src="/js/dc.js" type="text/javascript"></script>
<script type="text/javascript">
function disableEnableLegacyNum(){
	var ffmSw = document.form1.relatedFFM.value;
	if (ffmSw=="Y"){
		document.form1.legacyCaseNum.disabled=false;
		document.form1.iESAppOrCaseNum.disabled=false;
	}else{
		document.form1.legacyCaseNum.disabled=true;
		document.form1.legacyCaseNum.value="";
		document.form1.iESAppOrCaseNum.disabled=true;
		document.form1.iESAppOrCaseNum.value="";
	}
}
function disableDenialDate(){
	document.form1.monthdenialReasonDate.disabled=true;
	document.form1.datedenialReasonDate.disabled=true;
	document.form1.yeardenialReasonDate.disabled=true;
}
function validateLegacyCaseNum(){
	var validateString = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-";
	var legacyCaseNum = document.form1.legacyCaseNum.value;
	if (legacyCaseNum!=""){
		legacyCaseNum = legacyCaseNum.trim();
		var length = legacyCaseNum.length;
		for (var i=0; i<length; i++){
			var currentChar = legacyCaseNum.charAt(i);
			if (validateString.indexOf(currentChar)==-1){
				alertMe("DC4402",document.form1.legacyCaseNum);
				return false;
			}
		}
		var parsedString = legacyCaseNum.split("-").join("");
		if (parsedString.length>15){
			alertMe("DC4403",document.form1.legacyCaseNum);
			return false;
		}
	}
	return true;
}
//function to validate case/app number field
function validateAppCaseNum(appCaseNum){
	var appCaseNumber = appCaseNum.value.toUpperCase().trim();
	if (appCaseNumber==""){
		return true;
	}
	if (appCaseNumber.charAt(0)=='T'){
		return isValidNumber('T',8,appCaseNumber,appCaseNum);
	}else{
		return isNumeric(appCaseNum);
	}
}
//function to validate if required fields for FFM are completed
function validateFFM(){
	var ffmSw = document.form1.relatedFFM.value;
	if (ffmSw=="Y"){
		if(document.form1.legacyCaseNum.value=="" && document.form1.iESAppOrCaseNum.value==""){
			alertMe("DC4404");
			return false;
		}
	}
	return true;
}
</script>

<form name="form1" method="post" action="/ControllerServlet">

<%/* NOT EDITABLE - Framework Hidden Fields */%>
<%@ include file = "/fwincludes/hiddenFields.jsp" %>

 <%/* NOT EDITABLE - Top of Page Include */%>
<%@ include file = "/fwincludes/tabs.jsp" %>

<%/* NOT EDITABLE - Spacer Images */%>
<%@ include file = "/fwincludes/spacing.jsp" %>  

<div id="MainHeader" repeat="N">

<%/* NOT EDITABLE - Begin Outter HTML Table  and  messages file*/%>
<%@ include file="/fwincludes/messageDisplay.jsp" %>

<%
	StringBuffer sb = new StringBuffer("onclick=\"javascript:return doReset(document.form1)\"");
   	String resetScript = sb.toString();
   	
   	sb =  new StringBuffer("onclick=\"javascript:setActionFieldAndSubmit(document.form1,'"+ViewConstants.SUBMIT_BUTTON+"');return false;\"");
   	String submitScript = sb.toString();
   	
   	String caseNumJS = "validate=\"isComplete(document.form1.IESCaseNum);isNumeric(document.form1.IESCaseNum);\"";
   	String legacyJS = "validate=\"validateFFM();validateLegacyCaseNum();\"";
   	String ffmJS = "onChange=\"disableEnableLegacyNum();\"";
   	String appCaseVal = "validate=\"validateAppCaseNum(document.form1.iESAppOrCaseNum);\"";
   	
   	String currentDate = (new java.sql.Timestamp(new java.util.Date().getTime())).toString();
   	String caseNum = "";
   	String denialReason = "";
   	String denialDate = currentDate;
   	String suppressNotice = "";
   	String ffm = "";
   	String legacyCase = "";
   	String appCaseNumber = "";
   	if (DenialCargo!=null){
   		if (DenialCargo.getCaseNum()!=0){
   			caseNum = String.valueOf(DenialCargo.getCaseNum());
   		}
   		if (DenialCargo.getDenialReason()!=null){
   			denialReason = DenialCargo.getDenialReason();
   		}
   		if (DenialCargo.getDenialDate()!=null){
   			denialDate  = DenialCargo.getDenialDate().toString();
   		}
   		if (DenialCargo.getSuppressNoticeSw()!=0){
   			suppressNotice = String.valueOf(DenialCargo.getSuppressNoticeSw());
   		}
   		if (DenialCargo.getRelatedFFMSw()!=0){
   			ffm = String.valueOf(DenialCargo.getRelatedFFMSw());
   		}
   		if (DenialCargo.getLegacyCase()!=null){
   			legacyCase = DenialCargo.getLegacyCase();
   		}
   		if (DenialCargo.getAppCaseNum()!=null){
   			appCaseNumber = DenialCargo.getAppCaseNum();
   		}
   	}
%>

<DCTagLibrary:DcButtonTag buttonType="RS"
	resetScript="<%=resetScript%>"
	submitScript="<%=submitScript%>"
	buttonSecurity ="<%=String.valueOf(securityAttr.getPermission())%>"
	tabPosition="top"
	altId="topButtons"/>
	
<table width="723" border="0" cellspacing="0" cellpadding="0" class="bodyFormLabels"  role = "presentation" title="Expedited Case Denial">
	<tr height="26">
		<td width="180">
			<TL:FWLabelTag bean="<%=iesCaseNum%>" required="Y"/>
		</td>
		<td width="543">
			<TL:FWTextTag bean="<%=iesCaseNum%>"  size="10" maxlength="9" other="<%=caseNumJS%>" value="<%=caseNum%>"/>
		</td>
	</tr>
	<tr height="26">
		<td width="180">
			<TL:FWLabelTag bean="<%=denialReasonCode%>" required="Y"/>
		</td>
		<td width="543">
			<TL:FWRTSelectTag bean="<%=denialReasonCode%>" referenceTableName="DENIALREASON" filter="YES" filterColumn="ARFILTER" filterValue="Y" size="40"  selected="<%=denialReason%>"/>
		</td>
	</tr>
	<tr height="26">
		<td width="180">
			<TL:FWLabelTag bean="<%=denialReasonDate%>"/>
		</td>
		<td width="543">
			<TL:FWGroupCustomDateTag beanId="denialReasonDate"  disableLabel="Y" dateValue="<%=denialDate%>" mode="0"/>
		</td>
	</tr>
	<tr height="26">
		<td width="180">
			<TL:FWLabelTag bean="<%=noticeSupprSw%>"/>
		</td>
		<td width="543">
			<TL:FWRTSelectTag referenceTableName="YESNO" bean="<%=noticeSupprSw%>"  selected="<%=suppressNotice%>"/>
		</td>
	</tr>
	<tr height="26">
		<td width="180">
			<TL:FWLabelTag bean="<%=relatedFFM%>"/>
		</td>
		<td width="543">
			<TL:FWRTSelectTag referenceTableName="YESNO" bean="<%=relatedFFM%>"  other="<%=ffmJS%>" selected="<%=ffm%>"/>
		</td>
	</tr>
	<tr height="26">
		<td width="180">
			<TL:FWLabelTag bean="<%=legacyCaseNum%>"/>
		</td>
		<td width="543">
			<TL:FWTextTag bean="<%=legacyCaseNum%>"  size="20" maxlength="20" other="<%=legacyJS%>" value="<%=legacyCase%>"/>
		</td>
	</tr>
	<tr height="26">
        <td width="180">
        	<TL:FWLabelTag bean="<%=iESAppOrCaseNum%>" required="N"/>
        </td>
		<td width="543">
			<TL:FWTextTag bean="<%=iESAppOrCaseNum%>" value="<%=appCaseNumber%>" size="10" maxlength="9"  other="<%=appCaseVal %>"/>
		</td>
	</tr>
</table>

<DCTagLibrary:DcButtonTag buttonType="RS" 
   resetScript="<%=resetScript%>"
   submitScript="<%=submitScript%>"
   buttonSecurity ="<%=String.valueOf(securityAttr.getPermission())%>"
   altId="bottomButtons"/>

<%/* NOT EDITABLE - End Outer HTML Table */%>     
<%@ include file = "/fwincludes/endTable.jsp" %>  