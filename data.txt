//APP_IN_NEWB
	/**
	 * This method is used ot delete the pregnancy details
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public void deletePregnancy(String indvSeqNumber, String appNumber){
		try{
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1021");
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deletePregnancy", e);
			throw fe;
		}
	}

	//
	/**
	 * This method is used ot delete the relationship details
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public void deleteRelationship(String indvSeqNumber, String appNumber){
		try{
			FwDataCriteria[] criteria = new FwDataCriteria[3];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("REF_INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			criteria[2] = new FwDataCriteria();
			criteria[2].setColumn_name("SRC_INDV_SEQ_NUM");
			criteria[2].setColumn_value(indvSeqNumber);
			criteria[2].setData_type(FwConstants.SHORT);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1019");
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteRelationship", e);
			throw fe;
		}
	}

	//APP_IN_SCHLE
	/**
	 * This method is ued to delete the school enrollment details
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public void deleteSchoolEnrollment(String indvSeqNumber, String appNumber){
		try{
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1020");
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteSchoolEnrollment", e);
			throw fe;
		}
	}
//	APP_IN_DABL
	/**
	 * This method is used ot delete the disability details
	 * @param indvSeqNumber
	 * @param appNumber
	 */
	public void deleteDisability(String indvSeqNumber, String appNumber){
		try{
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNumber);
			criteria[1].setData_type(FwConstants.SHORT);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1055");
			executeSQL(sqlMap);
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteDisability", e);
			throw fe;
		}
	}
//	Health Care Application Status check
	/**
	 * This method is used ot check health care apllication status
	 * @param appNum
	 * @param currentIndvSeqNum
	 * @return
	 */
	public ArrayList findParentChildRelation(String appNum, String currentIndvSeqNum){
		
		try{
			ArrayList parentIndvSeqNumList = new ArrayList();
			ArrayList srcIndvSeqNumList = new ArrayList();
			ArrayList refIndvSeqNumList = new ArrayList();
			
			Map sqlMap = new HashMap();
			FwDataCriteria[] criteria = null;
			sqlMap.put(FwConstants.SQL_IND, "sql-1051");
			criteria = new FwDataCriteria[3];
			criteria[0]= new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNum);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1]= new FwDataCriteria();
			criteria[1].setColumn_name("REF_INDV_SEQ_NUM");
			criteria[1].setColumn_value(currentIndvSeqNum);
			criteria[1].setData_type(FwConstants.INT);
			criteria[2]= new FwDataCriteria();
			criteria[2].setColumn_name("SRC_INDV_SEQ_NUM");
			criteria[2].setColumn_value(currentIndvSeqNum);
			criteria[2].setData_type(FwConstants.INT);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List tempList = executeSQL(sqlMap);
			int size = tempList.size();
			
			for(int i=0; i<size; i++){
				Map tempMap = (Map)tempList.get(i);
				srcIndvSeqNumList.add(tempMap.get("SRC_INDV_SEQ_NUM"));
				refIndvSeqNumList.add(tempMap.get("REF_INDV_SEQ_NUM"));
			}
			
			int listSize = srcIndvSeqNumList.size();
			
			for(int count=0; count<listSize; count++){
				if(srcIndvSeqNumList.get(count).equals(currentIndvSeqNum))
					parentIndvSeqNumList.add(refIndvSeqNumList.get(count));
				else if(refIndvSeqNumList.get(count).equals(currentIndvSeqNum))
					parentIndvSeqNumList.add(srcIndvSeqNumList.get(count));
			}
				
			return parentIndvSeqNumList;
		}catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "findParentChildRelation", e);
			throw fe;
		}
	}
	
	//get Living Arrange Type for Individual
	/**
	 * This method is used ot get the living arrangement type of an individual
	 * @param appNum
	 * @param indvSeqNum
	 * @return
	 */
	public String getlivingArrgType(String appNum, String indvSeqNum){
		try{
			String liveArrType = "0";
			
			Map sqlMap = new HashMap();
			FwDataCriteria[] criteria = null;
			sqlMap.put(FwConstants.SQL_IND, "sql-1054");
			criteria = new FwDataCriteria[2];
			criteria[0]= new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNum);
			criteria[0].setData_type(FwConstants.STRING);
			criteria[1]= new FwDataCriteria();
			criteria[1].setColumn_name("INDV_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNum);
			criteria[1].setData_type(FwConstants.INT);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List res = executeSQL(sqlMap);
			if (res.size() > 0) {
				Map temp = (Map) res.get(0);
				liveArrType =(String) temp.get("LIVE_ARNG_TYP");
			}
		return liveArrType;
		}catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "getlivingArrgType", e);
			throw fe;
		}
	}
	
	
	/**
	 * This method is used to get the disability details
	 * @param appNum
	 * @return
	 */
	public APP_IN_DABL_Collection getDABLPersonColl(String appNum){
		try {
			
			APP_IN_DABL_Collection dablColl = new APP_IN_DABL_Collection();
			Map criteriaMap = new HashMap();					
			FwDataCriteria[] criteria = new FwDataCriteria[1];			
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNum);	
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			APP_IN_DABL_Cargo[] tempCargo = (APP_IN_DABL_Cargo[])dablColl.select(FwConstants.DAO, criteriaMap);
			dablColl.setResults(tempCargo);	
			
			return dablColl;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "getDABLPersonColl", e);
			throw fe;
		}
	}
	
	/**
	 * This method is used ot get the policy sequence numbers
	 * @param app_num
	 * @param indvSeqNum
	 * @return
	 */
	private List getPlcySeqNumbers(String appNum, String indvSeqNum){
		try{
			//APP_MED_INS_Collection returnColl = new APP_MED_INS_Collection();
			List reultList = new ArrayList();
			Map sqlMap = new HashMap();
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			sqlMap.put(FwConstants.SQL_IND, "sql-1067");
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNum);
			criteria[0].setData_type(FwConstants.STRING);
			criteria[1] = new FwDataCriteria();
			criteria[1].setColumn_name("PLCY_HOLD_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNum);
			criteria[1].setData_type(FwConstants.STRING);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			List tempList = executeSQL(sqlMap);
			int resultSize = tempList.size();
			if(resultSize > 0){
				for(int i=0; i<resultSize; i++){
					Map temp = (Map) tempList.get(i);
					reultList.add((String) temp.get("PLCY_SEQ_NUM"));
				}
			}
		return reultList;
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "getPlcySeqNumbers", e);
			throw fe;
		}
	}
	
	/**
	 * This method is used to delete the indv policy details
	 * @param appNum
	 * @param indvSeqNum
	 * @param plcySeqNum
	 */
	private void deleteIndvPolcyDet(String appNum, String plcySeqNum){
		try{
			FwDataCriteria[] criteria = new FwDataCriteria[2];
			criteria[0]= new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNum);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1]= new FwDataCriteria();
			criteria[1].setColumn_name("PLCY_SEQ_NUM");
			criteria[1].setColumn_value(plcySeqNum);
			criteria[1].setData_type(FwConstants.STRING);
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.CRITERIA, criteria);
			sqlMap.put(FwConstants.SQL_IND, "sql-1065");
			executeSQL(sqlMap);
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteIndvPolcyDet", e);
			throw fe;
		}
	}
	
	/**
	 * This method is used ot delete the indv policy
	 * @param appNum
	 * @param indvSeqNum
	 */
	private void deleteIndvPolcy(String appNum, String indvSeqNum){
		try{
			Map sqlMap = new HashMap();
			FwDataCriteria[] criteria = null;
			sqlMap.put(FwConstants.SQL_IND, "sql-1066");
			criteria = new FwDataCriteria[2];
			criteria[0]= new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNum);
			criteria[0].setData_type(FwConstants.LONG);
			criteria[1]= new FwDataCriteria();
			criteria[1].setColumn_name("PLCY_HOLD_SEQ_NUM");
			criteria[1].setColumn_value(indvSeqNum);
			criteria[1].setData_type(FwConstants.INT);
			sqlMap.put(FwConstants.CRITERIA, criteria);
			executeSQL(sqlMap);
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteIndvPolcy", e);
			throw fe;
		}
	}
	
	/**
	 * This method is used to check the policy count
	 * @param appNum
	 * @return
	 */
	private int checkPlcyCount(String appNum){
		try{
			APP_MED_INS_Collection returnColl = new APP_MED_INS_Collection();
			
			Map criteriaMap = new HashMap();					
			FwDataCriteria[] criteria = new FwDataCriteria[1];			
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNum);
			criteria[0].setData_type(FwConstants.STRING);
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			APP_MED_INS_Cargo[] tempCargo = (APP_MED_INS_Cargo[])returnColl.select(FwConstants.DAO, criteriaMap);
			returnColl.setResults(tempCargo);
			return returnColl.size();
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "checkPlcyCount", e);
			throw fe;
		}
		
	}
		
	/**
	 * This method is used to check hte indv policy status
	 * @param appNum
	 * @param indvSeqNum
	 * @return
	 */
	public boolean checkIndvPlcyStatus(String appNum, String indvSeqNum){
		try{
			boolean returnStatus = false;
			List plcySeqNumList = getPlcySeqNumbers(appNum, indvSeqNum);
			if(!plcySeqNumList.isEmpty()){
				String plcySeqNumStr = "";
				int mailListSize = plcySeqNumList.size();
				
				if(mailListSize == 1){
					plcySeqNumStr = (String)plcySeqNumList.get(0);
				}else{
					for(int i=0; i<mailListSize; i++){
						if(i==0)
							plcySeqNumStr = (String)plcySeqNumList.get(i);
						else 
							plcySeqNumStr = plcySeqNumStr +","+(String) plcySeqNumList.get(i);
					}
				}
				//delete from APP_IN_MED_INS
				deleteIndvPolcyDet(appNum, plcySeqNumStr);
				//delete from APP_MED_INS
				deleteIndvPolcy(appNum, indvSeqNum);
				//check is there any policy for this app_num
				int plcyCount = checkPlcyCount(appNum);;
				
				if(plcyCount > 0)
					returnStatus = true;
			}
			
			return returnStatus;
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "checkIndvPlcyStatus", e);
			throw fe;
		}
	}
	
	//return out side home children indv seq num list -- PCR#33829
	/**
	 * This method is used ot get the outside home individual sequence number
	 * @param indvCustColl
	 * @return
	 */
	public List getOutSideHomeIndvSeqNum(INDIVIDUAL_Custom_Collection indvCustColl){
		try{
			List outSideHomeChildIndvSeqNumList = new ArrayList();
		 	if(indvCustColl != null && !indvCustColl.isEmpty()){
		 		INDIVIDUAL_Custom_Cargo indvCustCargo = null;
				for(int i=0; i <indvCustColl.size(); i++){
					indvCustCargo = indvCustColl.getResult(i);
					
					if(indvCustCargo.getOut_of_home_ind().trim().equals(FwConstants.YES)){
						outSideHomeChildIndvSeqNumList.add(indvCustCargo.getIndv_seq_num());
					}
				}
			}
			
		return outSideHomeChildIndvSeqNumList;
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "getOutSideHomeIndvSeqNum", e);
			throw fe;
		}
	}
	


	/**
	 * This method is used to load the individual type
	 * @param appIndvColl
	 * @param peopleInHomeCount
	 * @param childOutHomeCount
	 * @return
	 */
	public String getIndividualTypeForAdd(String appNumber, int peopleInHomeCount, int childOutHomeCount){
		try{
			String addType = "";
			APP_INDV_Cargo appIndvCargo = null;
			int inHomeCount = 0;
			int outHomeCount = 0;
			
			APP_INDV_Collection appIndvColl = new APP_INDV_Collection();
			appIndvColl = loadAppIndvColl(appNumber);
			int appIndvCollSize = appIndvColl.size();
			
			for(int i=0; i<appIndvCollSize; i++){
				appIndvCargo = appIndvColl.getCargo(i);
				//check is in or out of home
				if(appIndvCargo.getChld_out_home_resp().trim().equals(FwConstants.NO))
					inHomeCount = inHomeCount + 1;
				else
					outHomeCount = outHomeCount + 1;
			}
			
			if(inHomeCount != peopleInHomeCount)
				addType = "I";
			else if (outHomeCount != childOutHomeCount)
				addType = "O";
			
		return addType;	
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "getOutSideHomeIndvSeqNum", e);
			throw fe;
		}
	}
	
	/**
	 * This method is used to load the appIndv COllection
	 * @param appNumber
	 * @return
	 */
	public APP_INDV_Collection loadAppIndvColl(String appNumber) {
		APP_INDV_Collection appIndvColl = null;
		Map criteriaMap = null;
		FwDataCriteria[] criteria = null;
		try {
			//here i am getting the individual information
			appIndvColl = new APP_INDV_Collection();
			criteriaMap = new HashMap();
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
						
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			APP_INDV_Cargo[] appIndvCargoArray =	(APP_INDV_Cargo[]) appIndvColl.select(FwConstants.DAO, criteriaMap);
			if(appIndvCargoArray.length > 0){
				appIndvColl.setResults(appIndvCargoArray);
				//now we need to padding the number 
				//APP_INDV_Cargo appIndvCargo = appIndvColl.getCargo(0);
			return appIndvColl;
			}
			return appIndvColl;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdMemberDetail", e);
			throw fe;
		}
	}
	/**
	 * This method is used to get Marital status of primary person
	 * @author patilu
	 * @param appNumber
	 * @return
	 */
	public String getPrimPrsnMaritalStatus(String appNumber){		
		try{
			String maritalStatus = null;
			Map value = new HashMap();
			value.put(FwConstants.SQL_IND, "sql-1102");
			FwDataCriteria[] criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);
			value.put(FwConstants.CRITERIA, criteria);
			List result = this.executeSQL(value);
			if(result.size()>0){
				Map resMap = (Map) result.get(0);
				if(resMap.get("MRTL_STAT_CD")!=null && resMap.get("MRTL_STAT_CD").toString().trim().length()>0)
					maritalStatus = resMap.get("MRTL_STAT_CD").toString().trim();
			}				
			return maritalStatus;				
	}catch(FwException fe) {
		throw fe;
	} catch(Exception e) {
		FwException fe = createFwException(this.getClass().getName(), "getPrimPrsnMaritalStatus", e);
		throw fe;
	}
	}
	/**
	 * This method is used to delete all the houshold member details like from APP_INDV,APP_IN_PRFL,
	 * APP_IN_PREG,APP_IN_DABL,APP_IN_ABSNP, APP_ABS_PRNT tables
	 * @author patilu
	 * BRGUS00287916
	 * @param appNumber
	 */
	public void deleteHouseHoldDetails(String appNumber){
		IApplicationManager applicationManager = ApplicationManager.getInstance();
		try{
			PeopleHandler peopleHandler = new PeopleHandler();
			APP_INDV_Collection indvColl = null;
			APP_INDV_Collection tempColl = new APP_INDV_Collection();
			APP_INDV_Cargo indvCargo = null;
			ABMedicalDetailsBO medBO = new ABMedicalDetailsBO();
			DisabilityBO disBO = new DisabilityBO();
			PregnancyBO pregBO = new PregnancyBO();			
			APP_IN_PREG_Collection pregColl = null;
			APP_IN_DABL_Collection dablColl = null;
			APP_NURSING_ADDRESS_Collection addColl=null; 
			APP_IN_ABSNP_Collection inAbColl = null;
			APP_ABS_PRNT_Collection abColl = null;
			APP_ABS_PRNT_Collection tempabColl = new APP_ABS_PRNT_Collection();
			List abSeqNum = new ArrayList();
			indvColl = loadAppIndvColl(appNumber);
			ABHouseHoldRelationshipBO relations = new ABHouseHoldRelationshipBO();
			Map indvHshlRltnMap = new HashMap();
			indvHshlRltnMap=relations.loadHousholdRelationshipDetails(appNumber, 1);
			if(indvHshlRltnMap!=null && indvHshlRltnMap.size()>0){
				this.deleteHouseholdRelations(AppConstants.ONE, appNumber);
			}			
			APP_IN_PRFL_Collection appInPrflColl = null;
			APP_IN_PRFL_Cargo appInPrflCargo = null;
			appInPrflColl=applicationManager.loadAppIndividualProfile(appNumber);
			if(appInPrflColl!=null && appInPrflColl.size()>0){
				for(int i=0;i<appInPrflColl.size();i++){
					appInPrflCargo = appInPrflColl.getCargo(i);
					if(Integer.parseInt(appInPrflCargo.getIndv_seq_num())>1){
						applicationManager.deleteIndividualFromAppIndividualProfile(appInPrflColl, appInPrflCargo.getIndv_seq_num());
						i--;
					}
				}
			}
			addColl = medBO.loadSpouseAddress(appNumber, AppConstants.NF_SPOUSE_ADDRESS_TYPE);
			if(addColl!=null && addColl.size()>0){
				medBO.deleteSpouseAddress(addColl, AppConstants.NF_SPOUSE_ADDRESS_TYPE);
			}
			dablColl=disBO.loadDABLDetailsAFB(appNumber);
			if(dablColl!=null && dablColl.size()>0){
				for(int d=0;d<dablColl.size();d++){
					dablColl.getCargo(d).setRowAction(FwConstants.ROWACTION_DELETE);					
				}
				disBO.deleteAppInDablRecord(dablColl);
			}
			pregColl = pregBO.loadPregnancyDetails(appNumber,AppConstants.SRC_APP_IND_AFB);
			if(pregColl!=null && pregColl.size()>0){
				for(int p=0;p<pregColl.size();p++){
					pregColl.getCargo(p).setRowAction(FwConstants.ROWACTION_DELETE);					
				}
				pregBO.deleteAppInPregRecord(pregColl);
			}
			inAbColl = loadIndividualAbsentParent(appNumber);
			if(inAbColl!=null && inAbColl.size()>0){
				for(int a=0;a<inAbColl.size();a++){
					//start of BRGUS00289239 by rotanak
					abSeqNum.add(inAbColl.getResult(a).getSeq_num());
					//END of BRGUS00289239 by rotanak
					inAbColl.getResult(a).setRowAction(FwConstants.ROWACTION_DELETE);					
				}
				inAbColl.persist(FwConstants.DAO);
			}
			abColl = loadAbsentParent(appNumber);
			if(abColl!=null && abColl.size()>0){
				for(int j=0;j<abColl.size();j++){
					if(abSeqNum!=null&&abSeqNum.size()>0){
					for(int k=0;k<abSeqNum.size();k++){
						if(abSeqNum.get(k)!=null && abSeqNum.get(k).toString().trim().length()>0 && 
								abSeqNum.get(k).toString().trim().equalsIgnoreCase(abColl.getResult(j).getAp_seq_num())){
							abColl.getResult(j).setRowAction(FwConstants.ROWACTION_DELETE);
							tempabColl.add(abColl.getResult(j));
						}
					}
					}
				}tempabColl.persist(FwConstants.DAO);
			}
			if(indvColl!=null && indvColl.size()>0){
				for(int i=0;i<indvColl.size();i++){
					indvCargo = indvColl.getCargo(i);					
					if(Integer.parseInt(indvCargo.getIndv_seq_num())>1){
						peopleHandler.deleteIndividual(appNumber, indvCargo.getIndv_seq_num());
						indvCargo.setRowAction(FwConstants.ROWACTION_DELETE);
						tempColl.addCargo(indvCargo);
						indvHshlRltnMap = new HashMap();
						indvHshlRltnMap=relations.loadHousholdRelationshipDetails(appNumber, Integer.parseInt(indvCargo.getIndv_seq_num().toString()));
						if(indvHshlRltnMap!=null && indvHshlRltnMap.size()>0){
							this.deleteHouseholdRelations(indvCargo.getIndv_seq_num(), appNumber);
						}
					}
				}
			}if(tempColl!=null )
			tempColl.persist(FwConstants.DAO);
		}catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "deleteHouseHoldDetails", e);
			throw fe;
		}
	}
	/**
	 * This method is used to get the absent parent details from the table APP_IN_ABSNP table
	 * BRGUS00287916
	 * @author patilu
	 * @param appNumber
	 * @return APP_IN_ABSNP_Collection
	 */
	public APP_IN_ABSNP_Collection loadIndividualAbsentParent(String appNumber) {
		try{
			APP_IN_ABSNP_Collection appInDablColl = new APP_IN_ABSNP_Collection();
			Map criteriaMap = new HashMap();
			FwDataCriteria[] criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteriaMap.put(FwConstants.CRITERIA,criteria);
			APP_IN_ABSNP_Cargo[] cargoArray = (APP_IN_ABSNP_Cargo[])appInDablColl.select(FwConstants.DAO, criteriaMap);
			appInDablColl.setResults(cargoArray);
			return appInDablColl;
		}catch(FwException fe){
		}catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadIndividualAbsentParent", e);
			throw fe;
		}
		return null;
	}
	/**
	 * This method is used to load the Absent Parent Details from APP_ABS_PRNT table
	 * BRGUS00287916
	 * @author patilu 
	 * @param appNumber
	 * @return APP_ABS_PRNT_Collection
	 */
	public APP_ABS_PRNT_Collection loadAbsentParent(String appNumber) {
		try{
			APP_ABS_PRNT_Collection appInDablColl = new APP_ABS_PRNT_Collection();
			Map criteriaMap = new HashMap();
			FwDataCriteria[] criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.LONG);
			criteriaMap.put(FwConstants.CRITERIA,criteria);
			APP_ABS_PRNT_Cargo[] cargoArray = (APP_ABS_PRNT_Cargo[])appInDablColl.select(FwConstants.DAO, criteriaMap);
			appInDablColl.setResults(cargoArray);
			return appInDablColl;
		}catch(FwException fe){
		}catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadAbsentParent", e);
			throw fe;
		}
		return null;
	}
	
	
	/**
	 * This method is used to load the rmcIndv COllection
	 * @param appNumber
	 * @return
	 */
	public RMC_INDV_ID_Collection loadRMCIndvColl(String appNumber) {
		RMC_INDV_ID_Collection appIndvColl = null;
		Map criteriaMap = null;
		FwDataCriteria[] criteria = null;
		try {
			//here i am getting the individual information
			appIndvColl = new RMC_INDV_ID_Collection();
			criteriaMap = new HashMap();
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
			criteria[0].setData_type(FwConstants.STRING);		
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			RMC_INDV_ID_Cargo[] appIndvCargoArray =	(RMC_INDV_ID_Cargo[]) appIndvColl.select(FwConstants.DAO, criteriaMap);
			if(appIndvCargoArray.length > 0){
				appIndvColl.setResults(appIndvCargoArray);
				//now we need to padding the number 
				//APP_INDV_Cargo appIndvCargo = appIndvColl.getCargo(0);
			return appIndvColl;
			}
			return appIndvColl;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "loadHouseholdMemberDetail", e);
			throw fe;
		}
	}
	
	//ILIES-273207 - keep 1 if at least one indv has selected for each backdated month
	public String[] getIndicatorsfromAppInPrfl(String appNumber) {
		
		String[] indForBackdatedMonths = {"0","0","0"}; 
		IApplicationManager applicationManager = ApplicationManager.getInstance();
		APP_IN_PRFL_Collection appInPrflColl = null;
		APP_IN_PRFL_Cargo appInPrflCargo = null;
		appInPrflColl=applicationManager.loadAppIndividualProfile(appNumber);
		if(appInPrflColl!=null && appInPrflColl.size()>0){
			for(int i=0;i<appInPrflColl.size();i++){
				appInPrflCargo = appInPrflColl.getCargo(i);
				if(appInPrflCargo!=null && appInPrflCargo.getMa_backdt_mo_1()!=null && "1".equalsIgnoreCase(appInPrflCargo.getBackdt_med_app()) ) {
					indForBackdatedMonths[0] = "1"; 
				}
				if(appInPrflCargo!=null && appInPrflCargo.getMa_backdt_mo_2()!=null  && "1".equalsIgnoreCase(appInPrflCargo.getBackdt_med_app())) {
					indForBackdatedMonths[1] = "1"; 
				}
				if(appInPrflCargo!=null && appInPrflCargo.getMa_backdt_mo_3()!=null && "1".equalsIgnoreCase(appInPrflCargo.getBackdt_med_app())) {
					indForBackdatedMonths[2] = "1"; 
				}
			}
		}
		
		return indForBackdatedMonths;
		
	}
	
	//ILIES-273207 - validation check for programs selected on ABPRI screen at ABHMD screen
	public void validateProgramSelection(APP_IN_PRFL_Cargo appInPrfl, Map session) {
		
		APP_PGM_RQST_Cargo appPgmRqst = new APP_PGM_RQST_Cargo();
		APP_PGM_RQST_Collection appPgmRqstColl = new APP_PGM_RQST_Collection();
		String appNum = (String) session.get(AppConstants.APP_NUMBER);
		
		if(appNum!=null && appNum!=" " && appNum.length()>0) {
			Map criteria = new HashMap();
			FwDataCriteria[] dataCriteria = new FwDataCriteria[1];
			dataCriteria[0] = new FwDataCriteria();
			dataCriteria[0].setColumn_name("APP_NUM");
			dataCriteria[0].setColumn_value(String.valueOf(appNum));
			criteria.put(FwConstants.CRITERIA, dataCriteria);
			APP_PGM_RQST_Cargo[] appPgmResult = (APP_PGM_RQST_Cargo[]) appPgmRqstColl.select(FwConstants.DAO, criteria);
			appPgmRqst = appPgmResult[0];
			
			if(appPgmRqst!=null && appInPrfl!=null) {
				if((appPgmRqst.getFs_rqst_ind()!=null && "1".equalsIgnoreCase(appPgmRqst.getFs_rqst_ind()) && appInPrfl.getIndv_fs_rqst_ind()==null)
						|| (appPgmRqst.getFma_rqst_ind()!=null && "1".equalsIgnoreCase(appPgmRqst.getFma_rqst_ind()) && appInPrfl.getIndv_fma_rqst_ind()==null)
						|| (appPgmRqst.getHc_rqst_ind()!=null && "1".equalsIgnoreCase(appPgmRqst.getHc_rqst_ind()) && appInPrfl.getIndv_hc_rqst_ind()==null)
						|| (appPgmRqst.getMedicare_rqst_ind()!=null && "1".equalsIgnoreCase(appPgmRqst.getMedicare_rqst_ind()) && appInPrfl.getIndv_msp_rqst_ind()==null)
						|| (appPgmRqst.getFpp_rqst_ind()!=null && "1".equalsIgnoreCase(appPgmRqst.getFpp_rqst_ind()) && (appInPrfl.getIndv_fpp_pgm()==null  || "3".equalsIgnoreCase(appInPrfl.getIndv_fpp_pgm())))
						) {
					this.addMessageCode("95500");
				}
			}
		}
		
	}
	
	public List getDocMhProviders (String appNumber) {
		log(ILog.DEBUG, "ABHouseHoldMemberBO.getDocMHProviders start - appNumber - " + appNumber);
		try {
			Map sqlMap = new HashMap();
			sqlMap.put(FwConstants.SQL_IND, "sql-1146");
			List docMhProviders = executeSQL(sqlMap);
			log(ILog.DEBUG, "ABHouseHoldMemberBO.getDocMHProviders end - docMhProviders - " + docMhProviders);
			return docMhProviders;
		} catch (Exception e) {
			log(ILog.ERROR, this.getClass().getSimpleName()+ ".getDocMhProviders failed - appNumber - " + appNumber + 
					" exception info - " + e + " - message - " + e.getMessage() + " - stackTrace - " + e.getStackTrace() + " - cause - " + e.getCause());
			FwException fe = createFwException(this.getClass().getName(),"getDocMhProviders - ", e);
			throw fe;
		}
	}
	
	/**
	 * ILIES-311795
	 * @param appNumber
	 * @return
	 */
	public APP_RQST_Cargo getAppRqstForHH(String appNumber) {
		APP_RQST_Cargo appRqstCargoResult = new APP_RQST_Cargo();
		APP_RQST_Collection appRqstColl = null;
		Map criteriaMap = null;
		FwDataCriteria[] criteria = null;
		try {
			
			appRqstColl = new APP_RQST_Collection();
			criteriaMap = new HashMap();
			criteria = new FwDataCriteria[1];
			criteria[0] = new FwDataCriteria();
			criteria[0].setColumn_name("APP_NUM");
			criteria[0].setColumn_value(appNumber);
						
			criteriaMap.put(FwConstants.CRITERIA, criteria);
			APP_RQST_Cargo[] appRqstCargo =	(APP_RQST_Cargo[]) appRqstColl.select(FwConstants.DAO, criteriaMap);
			if(appRqstCargo.length > 0){
			appRqstCargoResult= appRqstCargo[0];
			}
			return appRqstCargoResult;
		} catch(FwException fe) {
			throw fe;
		} catch(Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "getAppRqstForHH", e);
			throw fe;
		}
	}

	public void validateHouseHoldCount(int peopleCount) {
		int addCount = peopleCount+1;
		if(addCount > 16){
			Object error[] = new Object[] { new FwMessageTextLabel("30555")};
			this.addMessageWithFieldValues("99349", error);
		}
	}
}