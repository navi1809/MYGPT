function DOR39P9-M-PROVISN()
/*  */
/* Check for variation in child support CURRENT*/
/*  */
    DOR39W.WS-CUR-VAR-IND = "N";
    if(DOR39W.WS-INACT-IND[1] != "Y")
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "CS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-M-VARIATN();
    end
    /*  */
    /* Check for variation in child support arrears*/
    /*  */
    DOR39W.WS-ARR-VAR-IND = "N";
    if(DOR39W.WS-INACT-IND[2] != "Y")
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "CS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-M-VARIATN();
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N"))
        DOR39P9-PRV-S05Q1();
        if(H2-PRVSN not noRecordFound)
            if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[1] == "N")
                if(H2-PRVSN.CHD-SUPRT-FREQ == "M")
                    DOR39W.WS-CSPRAMT = H2-PRVSN.CHD-SUPRT-AMT;
                else
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.CHD-SUPRT-AMT;
                    DFC34W.PI2-FREQ = H2-PRVSN.CHD-SUPRT-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-CSPRAMT = DFC34W.PO1-CURR-SUPP-CMOA;
                end
            end
            if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[2] == "N")
                if(H2-PRVSN.AREGE-FREQ == "M")
                    DOR39W.WS-ZAPRAMT = H2-PRVSN.AREGE-COA;
                else
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.AREGE-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.AREGE-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-ZAPRAMT = DFC34W.PO1-CURR-SUPP-CMOA;
                end
            end
            DOR39P9-FIO-S06Q1(); /* If Finantial Obligation present (>0)*/
        /* overlay this amount from there*/
        end
    end
    /*  */
    /* Check for variation in medical cash current*/
    /*  */
    if(DOR39W.WS-INACT-IND[5] != "Y")
        DOR39W.WS-CUR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MC";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-M-VARIATN();
    end
    /*  */
    /* Check for variation in medical cash arrears*/
    /*  */
    if(DOR39W.WS-INACT-IND[6] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MC";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-M-VARIATN();
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N") &&(
            DOR39W.WS-INACT-IND[5] == "N" || DOR39W.WS-INACT-IND[6] == "N"))
        DOR39P9-PRV-S05Q2();
        if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[5] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.MDCSH-CRSUP-COA-FQ !=
                            " ")
                if(H2-PRVSN.MDCSH-CRSUP-COA-FQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.MED-CSH-CRSUP-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.MDCSH-CRSUP-COA-FQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-MCPRAMT = DOR39W.WS-MCPRAMT +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                else
                    DOR39W.WS-MCPRAMT = DOR39W.WS-MCPRAMT +
                            H2-PRVSN.MED-CSH-CRSUP-COA;
                end
            end
        end
        if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[6] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.MDCSH-AREGE-COA-FQ !=
                            " ")
                if(H2-PRVSN.MDCSH-AREGE-COA-FQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.MED-CSH-AREGE-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.MDCSH-AREGE-COA-FQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                else
                    DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                            H2-PRVSN.MED-CSH-AREGE-COA;
                end
            end
        end
    end
    /*  */
    /* Check for variation in medical outstanding arrears*/
    /*  */
    if(DOR39W.WS-INACT-IND[7] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MX";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-M-VARIATN();
    end
    /*  */
    if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[7] == "N")
        DOR39P9-PRV-S05Q3();
        if(H2-PRVSN not noRecordFound && H2-PRVSN.MEDOS-AREGE-COA-FQ != " ")
            if(H2-PRVSN.MEDOS-AREGE-COA-FQ != "M")
                DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.MEDOS-AREGE-COA;
                DFC34W.PI2-FREQ = H2-PRVSN.MEDOS-AREGE-COA-FQ;
                call "DFC34A"(VDBCONTROL, VMESSAGE, DFC34W){isNoRefresh = yes};
                if(VDBCONTROL.URC > 104)
                    exit program;
                end
                DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                        DFC34W.PO1-CURR-SUPP-CMOA;
            else
                DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                        H2-PRVSN.MEDOS-AREGE-COA;
            end
        end
    end
    /*  */
    /* Check for variation in spousal support current*/
    /*  */
    if(DOR39W.WS-INACT-IND[3] != "Y")
        DOR39W.WS-CUR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "SS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-M-VARIATN();
    end
    /*  */
    /* Check for variation in spousal support arrears*/
    /*  */
    if(DOR39W.WS-INACT-IND[4] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "SS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /*  */
        /* WI835 - Add in perform that was probably deleted earlier * start **/
        DOR39P9-M-VARIATN();
    /* WI835 - Add in perform that was probably deleted earlier * end **/
    /*  */
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N") &&(
            DOR39W.WS-INACT-IND[3] == "N" || DOR39W.WS-INACT-IND[4] == "N"))
        DOR39P9-PRV-S05Q4();
        if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[3] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.SPSL-SUPRT-FREQ != " ")
                if(H2-PRVSN.SPSL-SUPRT-FREQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.SPSL-SUPRT-AMT;
                    DFC34W.PI2-FREQ = H2-PRVSN.SPSL-SUPRT-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                else
                    /*  */
                    /* WI835 - Split SS arrears from SS current * start **/
                    /* DOR39W.WS-OPRAMT2 =*/
                    /* DOR39W.WS-OPRAMT2 + H2-PRVSN.SPSL-SUPRT-AMT;*/
                    DOR39W.WS-OPRAMT4 = DOR39W.WS-OPRAMT4 +
                            H2-PRVSN.SPSL-SUPRT-AMT;
                /* WI835 - Split SS arrears from SS current * end **/
                /*  */
                end
            end
        end
        if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[4] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.AREGE-FREQ != " ")
                if(H2-PRVSN.AREGE-FREQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.AREGE-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.AREGE-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    /*  */
                    /* WI835 - Note spousal support arrears separately * start **/
                    /* DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 +*/
                    /* DFC34W.PO1-CURR-SUPP-CMOA;*/
                    DOR39W.WS-OPRAMT4 = DOR39W.WS-OPRAMT4 +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                /* WI835 - Note spousal support arrears separately * end **/
                /*  */
                else
                    /*  */
                    /* WI835 - Track spousal support arrears separately * start **/
                    /* DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 + H2-PRVSN.AREGE-COA;*/
                    DOR39W.WS-OPRAMT4 = DOR39W.WS-OPRAMT4 + H2-PRVSN.AREGE-COA;
                /* WI835 - Track spousal support arrears separately * end **/
                /*  */
                end
            end
        end
    end
    /*  */
    if(DOR39W.WS-INACT-IND[8] != "Y")
        DOR39P9-PRV-S05Q5();
        if(H2-PRVSN not noRecordFound && H2-PRVSN.FEE-COA-FREQ != " ")
            if(H2-PRVSN.FEE-COA-FREQ != "M")
                DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.FEE-COA;
                DFC34W.PI2-FREQ = H2-PRVSN.FEE-COA-FREQ;
                call "DFC34A"(VDBCONTROL, VMESSAGE, DFC34W){isNoRefresh = yes};
                if(VDBCONTROL.URC > 104)
                    exit program;
                end
                DOR39W.WS-OPRAMT3 = DFC34W.PO1-CURR-SUPP-CMOA;
            else
                DOR39W.WS-OPRAMT3 = H2-PRVSN.FEE-COA;
            end
        end
    end
    /*  */
end // end DOR39P9-M-PROVISN

// Upd job hist & gen forms

function DOR39P9-M-UPDT-EMP()
/*  */
    set H2-EMPLR-WWH-DTLS empty;
    H2-EMPLR-WWH-DTLS.EMPLR-ID = H2-JOB-HISTORY.EMPLR-ID;
    H2-EMPLR-WWH-DTLS.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    DOR39P9-EWD-S09Q1();
    /*  */
    /* SET Original or Amended Indicator*/
    /*  */
    if(sysVar.sqlData.sqlcode == 0)
        if(H2-EMPLR-WWH-DTLS.EMPLR-WWH-ESTD-AMT == DOR39W.WS-TOTAMT &&
                H2-EMPLR-WWH-DTLS.INC-WH-TRMND-DT == "9999-12-31" &&
                FDOR-IWIT-DTLS.F-APPL-NAME != "DFM04A")
            return; /* IWIT did not change and not from*/
        end /* forms menu. Do not generate form.*/
        if(H2-EMPLR-WWH-DTLS.INC-WH-TRMND-DT == "9999-12-31" &&
                H2-EMPLR-WWH-DTLS.INC-WH-STRT-DT != "9999-12-31")
            DOR39W.WS-OA-IND = "A";
        else
            DOR39W.WS-OA-IND = "O";
        end
    else
        DOR39W.WS-OA-IND = "O";
    end
    if(FDOR-IWIT-DTLS.F-FORM-ID == "NV014O")
        DOR39W.WS-OA-IND = "O";
    end
    if(FDOR-IWIT-DTLS.F-FORM-ID == "NV014A")
        DOR39W.WS-OA-IND = "A";
    end
    /*  */
    H2-EMPLR-WWH-DTLS.EMPLR-WWH-ESTD-AMT = DOR39W.WS-TOTAMT;
    if(sysVar.sqlData.sqlcode != 0 || H2-EMPLR-WWH-DTLS.INC-WH-TRMND-DT !=
                    "9999-12-31")
        H2-EMPLR-WWH-DTLS.EMPLR-DELIN-DT = "9999-12-31";
    end
    H2-EMPLR-WWH-DTLS.INC-WH-TRMND-DT = "9999-12-31";
    H2-EMPLR-WWH-DTLS.INC-WH-STRT-DT = DOR39W1.WS-CRNT-DATE;
    /*  */
    if(sysVar.sqlData.sqlcode == 0)
        DOR39P9-EWD-U03Q1();
    else
        DOR39P9-EWD-I04Q1();
    end
    /*  */
    /* GET TOTAL IWIT FOR NCP/EMPLOYER COMBO*/
    /*  */
    set H2-2-DOC-EWD empty;
    H2-2-DOC-EWD.UPI = DOR39W.WS-NCP-UPI;
    H2-2-DOC-EWD.EMPLR-ID = DOR39W.WS-EMPLR-ID;
    DOR39P9-DOC-EWD-S();
    /*  */
    set H3-JOB-HISTORY empty;
    move H2-JOB-HISTORY to H3-JOB-HISTORY withV60Compat;
    H3-JOB-HISTORY.NCP-WWH-ESTD-AMT = H2-2-DOC-EWD.EMPLR-WWH-ESTD-AMT;
    if(DOR39W.WS-NCP-WWH-STS == "  ")
        H3-JOB-HISTORY.NCP-WWH-STS = "CO";
    else
        H3-JOB-HISTORY.NCP-WWH-STS = DOR39W.WS-NCP-WWH-STS;
    end
    if(H3-JOB-HISTORY.NCP-WWH-EFF-DT == "9999-12-31")
        H3-JOB-HISTORY.NCP-WWH-EFF-DT = DOR39W.WS-INCWH-DATE;
    end

    DOR39P9-JHS-U02Q1();
    /*  */
    /* ************************************************************************/
    /* Generate Form NV0014                                                 **/
    /* ************************************************************************/
    if(FDOR-IWIT-DTLS.F-FORM-ID == "NV0014")
        if(DOR39W.WS-OA-IND == "O")
            FDOR-IWIT-DTLS.F-FORM-ID = "NV014O";
        else
            FDOR-IWIT-DTLS.F-FORM-ID = "NV014A";
        end
    end

    if(FDOR-IWIT-DTLS.F-FORM-ID == "NV014O")
        DOR39U6-DOC();
    end

    /* Find Total Arrears*/
    set H2-NCP-ACCT-RCBL empty;
    H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    DOR39P9-NAC-S07Q2();
    DOR39W.WS-ARREARS = H2-NCP-ACCT-RCBL.ADJ-ARERS-BAL-AMT +
            H2-NCP-ACCT-RCBL.UNADJ-ARS-BAL-AMT;
    DOR39W.WS-CS-T-3 = mathLib.round(DOR39W.WS-CSPRAMT * 3,
            -mathLib.decimals(DOR39W.WS-CS-T-3));
    /*  */
    /* WI 1753 BEG - CHECK IF EMPLOYER PARTICPATES IN E-IWO */
    set DOR39W3 empty;
    DOR39W3.WS-BUILD1-FEIN = H2-JOB-HISTORY.EMPLR-ID;
    if(DOR39W3.WS-BUILD1-FEIN-FILL1 == "-")
        DOR39W3.WS-FORMATTED1-FEIN-1 = DOR39W3.WS-BUILD1-FEIN-1;
        DOR39W3.WS-FORMATTED1-FEIN-2 = DOR39W3.WS-BUILD1-FEIN-2;
        DOR39W3.WS-EIN-TXT = DOR39W3.WS-FORMATTED1-FEIN;
    else
        DOR39W3.WS-BUILD2-FEIN = H2-JOB-HISTORY.EMPLR-ID;
        DOR39W3.WS-FORMATTED2-FEIN-1 = DOR39W3.WS-BUILD2-FEIN-1;
        DOR39W3.WS-FORMATTED2-FEIN-2 = DOR39W3.WS-BUILD2-FEIN-2;
        DOR39W3.WS-EIN-TXT = DOR39W3.WS-FORMATTED2-FEIN;
    end
    set H2-OCSE-EMPLYR empty;
    H2-OCSE-EMPLYR.EMPLYR-ACTIVE-IND = "I";
    H2-OCSE-EMPLYR.EMPLYR-FEIN = DOR39W3.WS-EIN-TXT;
    DOR39P9-EIWO-EMPLYR();
    if(H2-OCSE-EMPLYR.EMPLYR-ACTIVE-IND == "A")
        DOR39P9-EIWO-PROC();
    else
        /* WI 1753 END */
        /* If DOR39A was called from an online application...*/
        if(DOR39W.WS-APPL-TYPE == "O")
            set DFMPOP-TRANSFER empty;
            DFMPOP-TRANSFER.PO1-LENGTH = 9801;
            DFMPOP-TRANSFER.PO1-TRANID = "WM01";
            DFMPOP-TRANSFER.PO1-TRID-FILLER = "    ";
            DFMPOP-TRANSFER.PIO-FORM-ID = FDOR-IWIT-DTLS.F-FORM-ID;
            DFMPOP-TRANSFER.PIO-CASE-SUFX = DOR39W.WS-CASE-SUFX;
            DFMPOP-TRANSFER.PIO-UPI = DOR39W.WS-NCP-UPI;
            DFMPOP-TRANSFER.PIO-DCKT-NMB = DOR39W.WS-DCKT-NMB;
            DFMPOP-TRANSFER.PIO-LST-SQ-NMB = DOR39W.WS-SQNC-NMB;
            DFMPOP-TRANSFER.PIO-OFC-CNTY-CD = G-IV-D.G-OFC-CNTY-CD;
            DFMPOP-TRANSFER.PIO-NMB-OF-COPIES = 1;
            if(DOR39W.WS-APPL-NAME == "DFM04A") /* FORMS MENU*/
                DFMPOP-TRANSFER.PIO-MODE-IND = "F";
            else
                DFMPOP-TRANSFER.PIO-MODE-IND = "D";
            end
            DFMPOP-TRANSFER.PIO-USRID = GNOMADS.G-USER-ID;
            DFMPOP-TRANSFER.PIO-TERMID = GNOMADS.G-TERM-ID;
            VSTRREC4.USTRING = GNOMADS.G-FRST-NAME;
            VSTRREC4.UCONCAT = GNOMADS.G-MID-NAME;
            VSTRREC4.UCONCAT2 = GNOMADS.G-LST-NAME;
            VSTRREC4.UCONCAT3 = GNOMADS.G-MODIFIER;
            VSTRREC4.USTRLEN = 56;
            VSTRREC4.UCONLEN = 16;
            VSTRREC4.UCONLEN2 = 21;
            VSTRREC4.UCONLEN3 = 3;
            call "WST50A"(VSTRREC4){isNoRefresh = yes};
            DFMPOP-TRANSFER.PIO-NCP-NAME = VSTRREC4.USTRING;
            DFMPOP-TRANSFER.PIO-FIRST-THREE-SSN = GNOMADS.G-CASE-SSN-FIRST-THREE;
            DFMPOP-TRANSFER.PIO-NEXT-TWO-SSN = GNOMADS.G-CASE-SSN-NEXT-TWO;
            DFMPOP-TRANSFER.PIO-LAST-FOUR-SSN = GNOMADS.G-CASE-SSN-LAST-FOUR;
            if(FDOR-IWIT-DTLS.F-CASE-SUFX == DOR39W.WS-CASE-SUFX)
                VSTRREC4.USTRING = G-IV-D.G-CST-FRST-NAME;
                VSTRREC4.UCONCAT = G-IV-D.G-CST-MID-NAME;
                VSTRREC4.UCONCAT2 = G-IV-D.G-CST-LST-NAME;
                VSTRREC4.UCONCAT3 = G-IV-D.G-CST-MODIFIER;
                VSTRREC4.USTRLEN = 56;
                VSTRREC4.UCONLEN = 16;
                VSTRREC4.UCONLEN2 = 21;
                VSTRREC4.UCONLEN3 = 3;
                call "WST50A"(VSTRREC4){isNoRefresh = yes};
                DFMPOP-TRANSFER.PIO-CST-NAME = VSTRREC4.USTRING;
                DFMPOP-TRANSFER.PIO-CST-SSN = G-IV-D.G-CST-SSN;
            else
                DOR39P9-GET-CST();
            end
            /*  */
            DFMPOP-TRANSFER.PIO-PARM-NMB = 90;
            /*  */
            DFMPOP-TRANSFER.PIO-POP-PARM[1] = H2-JOB-HISTORY.EMPLR-ID;
            DFMPOP-TRANSFER.PIO-POP-PARM[2] = DOR39W.WS-OA-IND;
            DFMPOP-TRANSFER.PIO-POP-PARM[3] = FDOR-IWIT-DTLS.F-WS-DEF27-IND;
            DFMPOP-TRANSFER.PIO-POP-PARM[45] = DOR39W.WS-CSPRAMT-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[47] = DOR39W.WS-ZAPRAMT-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[49] = DOR39W.WS-MCPRAMT-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[51] = DOR39W.WS-OPRAMT1-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[54] = DOR39W.WS-OPRAMT2-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[57] = DOR39W.WS-TOTAMT-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[86] = DOR39W.WS-OPRAMT3-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[89] = DOR39W.WS-OPRAMT4-A;
            /*  */
            /* Check if 12 weeks' worth of child support are due:*/
            if(DOR39W.WS-ARREARS > DOR39W.WS-CS-T-3)
                DFMPOP-TRANSFER.PIO-POP-PARM[59] = "X"; /* "yes" box*/
                DFMPOP-TRANSFER.PIO-POP-PARM[60] = " "; /* "no" box*/
            else
                DFMPOP-TRANSFER.PIO-POP-PARM[59] = " ";
                DFMPOP-TRANSFER.PIO-POP-PARM[60] = "X";
            end
            DFMPOP-TRANSFER.PIO-POP-PARM[61] = DOR39W.WS-WAMT-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[62] = DOR39W.WS-BAMT-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[63] = DOR39W.WS-SAMT-A;
            DFMPOP-TRANSFER.PIO-POP-PARM[64] = DOR39W.WS-MAMT-A;
            DFMPOP-TRANSFER.WS-APPL-ID = FDOR-IWIT-DTLS.F-APPL-NAME;
            DFMPOP-TRANSFER.FILLER = "M";
            call "DFM07A"(VDBCONTROL, VMESSAGE,
                    DFMPOP-TRANSFER){isNoRefresh = yes};
            if(VDBCONTROL.URC > 104)
                exit program;
            end
            FDOR-IWIT-DTLS.F-NV0014-GENERATED-IND = "Y";

        end
        /*  */
        /* If DOR39A was called from a batch application...*/
        if(DOR39W.WS-APPL-TYPE == "B")
            set DFMBTCH-XFER empty;
            DFMBTCH-XFER.PIO-FORM-ID = FDOR-IWIT-DTLS.F-FORM-ID;
            DFMBTCH-XFER.PIO-DCKT-NMB = DOR39W.WS-DCKT-NMB;
            DFMBTCH-XFER.PIO-DCKT-SQ-NMB = DOR39W.WS-SQNC-NMB;
            DFMBTCH-XFER.PIO-UPI = DOR39W.WS-NCP-UPI;
            DFMBTCH-XFER.PIO-CASE-SUFX = DOR39W.WS-CASE-SUFX;
            DFMBTCH-XFER.PIO-NMB-OF-COPIES = 1;
            /*  */
            DFMBTCH-XFER.PIO-PARM-NMB = 90;
            /*  */
            DFMBTCH-XFER.PIO-POP-PARM[1] = H2-JOB-HISTORY.EMPLR-ID;
            DFMBTCH-XFER.PIO-POP-PARM[2] = DOR39W.WS-OA-IND;
            DFMBTCH-XFER.PIO-POP-PARM[3] = FDOR-IWIT-DTLS.F-WS-DEF27-IND;
            DFMBTCH-XFER.PIO-POP-PARM[45] = DOR39W.WS-CSPRAMT-A;
            DFMBTCH-XFER.PIO-POP-PARM[47] = DOR39W.WS-ZAPRAMT-A;
            DFMBTCH-XFER.PIO-POP-PARM[49] = DOR39W.WS-MCPRAMT-A;
            DFMBTCH-XFER.PIO-POP-PARM[51] = DOR39W.WS-OPRAMT1-A;
            DFMBTCH-XFER.PIO-POP-PARM[54] = DOR39W.WS-OPRAMT2-A;
            DFMBTCH-XFER.PIO-POP-PARM[57] = DOR39W.WS-TOTAMT-A;
            DFMBTCH-XFER.PIO-POP-PARM[86] = DOR39W.WS-OPRAMT3-A;
            DFMBTCH-XFER.PIO-POP-PARM[89] = DOR39W.WS-OPRAMT4-A;
            /*  */
            /* Check if 12 weeks' worth of child support are due:*/
            if(DOR39W.WS-ARREARS > DOR39W.WS-CS-T-3)
                DFMBTCH-XFER.PIO-POP-PARM[59] = "X"; /* "yes" box*/
                DFMBTCH-XFER.PIO-POP-PARM[60] = " "; /* "no" box*/
            else
                DFMBTCH-XFER.PIO-POP-PARM[59] = " ";
                DFMBTCH-XFER.PIO-POP-PARM[60] = "X";
            end
            DFMBTCH-XFER.PIO-POP-PARM[61] = DOR39W.WS-WAMT-A;
            DFMBTCH-XFER.PIO-POP-PARM[62] = DOR39W.WS-BAMT-A;
            DFMBTCH-XFER.PIO-POP-PARM[63] = DOR39W.WS-SAMT-A;
            DFMBTCH-XFER.PIO-POP-PARM[64] = DOR39W.WS-MAMT-A;
            DFMBTCH-XFER.WS-APPL-ID = FDOR-IWIT-DTLS.F-APPL-NAME;
            call "DFM08A"(VDBCONTROL, VMESSAGE,
                    DFMBTCH-XFER){isNoRefresh = yes};
            if(VDBCONTROL.URC > 104)
                exit program;
            end
            FDOR-IWIT-DTLS.F-NV0014-GENERATED-IND = "Y";
            /* WI 1932 begin*/
            /* WI 1180 begin*/
            set H2-IVD-CASELD-CASE empty;
            H2-IVD-CASELD-CASE.UPI = DOR39W.WS-NCP-UPI;
            H2-IVD-CASELD-CASE.CASE-SUFX = DOR39W.WS-CASE-SUFX;
            DOR39P9-S03();
            // if(H2-IVD-CASELD-CASE.OFC-CD == "02")
            DOR39P9-EWS-IWO();
        // end 
        /* WI 1180 end*/
        /* WI 1932 end */
        end
    end

    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();
    if(VDBCONTROL.URC > 104)
        exit program;
    end
    /*  */
end // end DOR39P9-M-UPDT-EMP

// Check for Variations

function DOR39P9-M-VARIATN()
/* ---------------------------------------------------------------*/
/* Change log*/
/* Date        Work Item  Description*/
/* ----------  ---------  ----------------------------------------*/
/* 08/12/2009  WI835      D.Bugli- Split out the variation of*/
/* spousal support into current and arrears*/
/* so new SS/A field on NV0014 can have its*/
/* value.*/
/* ---------------------------------------------------------------*/
/*  */
/* Check TWNOBLGN_SUSPN for obligation suspension for all provision*/
/* types:*/
    call "TOSSS3A"(VDBCONTROL, VMESSAGE, H-TOSSS3){isNoRefresh = yes};
    if(VDBCONTROL.URC > 104)
        exit program;
    end

    /* If no record not found => return*/
    if(VDBCONTROL.URC != 0)
        return;
    end

    if(H-TOSSS3.OBLGN-SUSPN-TYPE == "C")
        DOR39W.WS-CUR-VAR-IND = "Y";
    else
        DOR39W.WS-ARR-VAR-IND = "Y";
    end

    if(H-TOSSS3.PRVSN-TYPE == "CS")
        if(H-TOSSS3.OBLGN-SUSPN-TYPE == "C")
            DOR39W.WS-CSPRAMT = DOR39W.WS-CSPRAMT + H-TOSSS3.VARTN-AMT;
        else
            DOR39W.WS-ZAPRAMT = DOR39W.WS-ZAPRAMT + H-TOSSS3.VARTN-AMT;
        end
    end

    if(H-TOSSS3.PRVSN-TYPE == "MC" || H-TOSSS3.PRVSN-TYPE == "MX")
        DOR39W.WS-MCPRAMT = DOR39W.WS-MCPRAMT + H-TOSSS3.VARTN-AMT;
    end
    /*  */
    /* WI835 - Treat spousal support 2 ways * start **/
    /* IF H-TOSSS3.PRVSN-TYPE = 'SS';*/
    /* DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 + H-TOSSS3.VARTN-AMT;*/
    /* END;*/
    if(H-TOSSS3.PRVSN-TYPE == "SS")
        if(H-TOSSS3.OBLGN-SUSPN-TYPE == "C")
            DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 + H-TOSSS3.VARTN-AMT;
        else
            DOR39W.WS-OPRAMT4 = DOR39W.WS-OPRAMT4 + H-TOSSS3.VARTN-AMT;
        end
    end
    /* WI835 - Treat spousal support 2 ways * end **/
    /*  */

    if(H-TOSSS3.PRVSN-TYPE == "FE")
        DOR39W.WS-OPRAMT3 = DOR39W.WS-OPRAMT3 + H-TOSSS3.VARTN-AMT;
    end
    /*  */
end // end DOR39P9-M-VARIATN

// NCP Accounts Receivable

function DOR39P9-NAC-S07Q1()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    VDBCOMMON.USQLREC = "H2-NCP-ACCT-RCBL";
    VDBCONTROL.UPROC-OBJ = "H2-NCP-ACCT-RCBL";
    VDBCONTROL.UPROC-NM = "DOR39P9-NAC-S07Q1";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    /*  */
    try
        get H2-NCP-ACCT-RCBL singleRow
                with #sql{
        select CRSUP_CMOA, ARERS_CMOA, ADJ_ARERS_BAL_AMT, UNADJ_ARS_BAL_AMT
        from TWNNCP_ACCT_RCBL T1
        WHERE  T1.DCKT_NMB = :DCKT-NMB AND
               T1.SQNC_NMB = :SQNC-NMB AND
               T1.PRVSN_TYPE = :PRVSN-TYPE AND
               T1.NCP_ACCT_RCBL_YR =
                 (SELECT MAX(T2.NCP_ACCT_RCBL_YR) FROM TWNNCP_ACCT_RCBL T2
                  WHERE T2.DCKT_NMB = T1.DCKT_NMB AND
                        T2.SQNC_NMB = T1.SQNC_NMB AND
                        T2.PRVSN_TYPE = T1.PRVSN_TYPE) AND
               T1.NCP_ACCT_RCBL_MTH =
                 (SELECT MAX(T3.NCP_ACCT_RCBL_MTH) FROM TWNNCP_ACCT_RCBL T3
                  WHERE T3.DCKT_NMB = T1.DCKT_NMB AND
                        T3.SQNC_NMB = T1.SQNC_NMB AND
                        T3.PRVSN_TYPE = T1.PRVSN_TYPE AND
                        T3.NCP_ACCT_RCBL_YR = T1.NCP_ACCT_RCBL_YR)
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into CRSUP-CMOA, ARERS-CMOA, ADJ-ARERS-BAL-AMT, UNADJ-ARS-BAL-AMT;
    end
    /*  */
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        VDBCOMMON.UNRF = "1";
        VDBCOMMON.UNRF = "N";
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
    /*  */
end // end DOR39P9-NAC-S07Q1

// NCP Accounts Receivable

function DOR39P9-NAC-S07Q2()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    VDBCOMMON.USQLREC = "H2-NCP-ACCT-RCBL";
    VDBCONTROL.UPROC-OBJ = "H2-NCP-ACCT-RCBL";
    VDBCONTROL.UPROC-NM = "DOR39P9-NAC-S07Q2";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    /*  */
    try
        get H2-NCP-ACCT-RCBL singleRow
                with #sql{
        select SUM(ADJ_ARERS_BAL_AMT), SUM(UNADJ_ARS_BAL_AMT)
        from TWNNCP_ACCT_RCBL T1
        WHERE  T1.DCKT_NMB = :DCKT-NMB AND
               T1.SQNC_NMB = :SQNC-NMB AND
               T1.NCP_ACCT_RCBL_YR =
                 (SELECT MAX(T2.NCP_ACCT_RCBL_YR) FROM TWNNCP_ACCT_RCBL T2
                  WHERE T2.DCKT_NMB = T1.DCKT_NMB AND
                        T2.SQNC_NMB = T1.SQNC_NMB)       AND
               T1.NCP_ACCT_RCBL_MTH =
                 (SELECT MAX(T3.NCP_ACCT_RCBL_MTH) FROM TWNNCP_ACCT_RCBL T3
                  WHERE T3.DCKT_NMB = T1.DCKT_NMB AND
                        T3.SQNC_NMB = T1.SQNC_NMB AND
                        T3.NCP_ACCT_RCBL_YR = T1.NCP_ACCT_RCBL_YR)
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into ADJ-ARERS-BAL-AMT, UNADJ-ARS-BAL-AMT;
    end
    /*  */
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        VDBCOMMON.UNRF = "N";
        VDBCOMMON.UNRF = "N";
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
    /*  */
end // end DOR39P9-NAC-S07Q2

// get ncp3 auto gen iw indicator

function DOR39P9-NCP-S01Q1()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    VDBCOMMON.USQLREC = "H2-NON-CUST-PARENT";
    VDBCONTROL.UPROC-OBJ = "H2-NON-CUST-PARENT";
    VDBCONTROL.UPROC-NM = "DOR39P9-NCP-S01Q1";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    try
        get H2-NON-CUST-PARENT singleRow
                with #sql{
        select NCP_SPOUS_BNKR_IND,
          bankruptcy_chapter,
          AUTO_GEN_IW_IND
        from twnnon_cust_parent T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        where upi = :UPI
         --** INSERT ORDER BY CLAUSE HERE **
        with ur
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into NCP-SPOUS-BNKR-IND, BANKRUPTCY-CHAPTER, AUTO-GEN-IW-IND;
    end
    VDBCOMMON.UNRF = "Y";
    VDBCOMMON.UDUP = "N";
    WDB00PE-SQLERR();
    if(VDBCONTROL.URC > 104)
        exit program;
    end
end // end DOR39P9-NCP-S01Q1

function DOR39P9-ONE-DOCKET()
/* ************************************************************************/
/* Change Log                               **/
/* ************************************************************************/
/* WNMLF  06/25/2002  WI 22594                                          **/
/* **/
/* **/
/* **/
/* **/
/* ************************************************************************/

    DOR39W.WS-SEND-LETTER = "N";
    DOR39W.WS-INCLD-DOCKET = "N";
    DOR39W.WS-SQL-CODE = 0;
    DOR39W.WS-NCP-WWH-STS = "CO";

    set H2-2-COR-DOC empty;
    H2-2-COR-DOC.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    DOR39P9-CDI-S01Q2();
    DOR39W.WS-SQNC-NMB = H2-2-COR-DOC.SQNC-NMB;
    DOR39W.WS-ORDER-TYPE = H2-2-COR-DOC.ORDER-TYPE;
    DOR39W.WS-PYMNT-DATE = H2-2-COR-DOC.CS-PYMNT-CMNCT-DT;
    DOR39W.WS-IW-NOTICE-SENT = H2-2-COR-DOC.IW-NOTICE-SENT;
    DOR39W.WS-DELIN-STS-EFF-DT = H2-2-COR-DOC.DELIN-STS-EFF-DT;
    DOR39W.WS-DELIN-STS = H2-2-COR-DOC.NCP-DELIN-STS;
    DOR39W.WS-INTID-INCWH-EST-DT = H2-2-COR-DOC.INTID-INCWH-EST-DT;
    DOR39W.WS-JRSDT-TYPE = H2-2-COR-DOC.JRSDT-TYPE;
    DOR39P9-PROC-DOCKT();
    /*  */
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    /*  */
    WDB00PE-SQLERR();
    if(VDBCONTROL.URC > 104)
        exit program;
    end
    /*  */
end // end DOR39P9-ONE-DOCKET

// Do NV0014, Flexiform or both

function DOR39P9-PROC-DOCKT()
/* M = do NV0014 on the mainframe, S = do Flexiform on the server:*/
/*  */
    if(DOR39W.WS-FORM-DEST == "M")
        DFMPOP-TRANSFER.FILLER = "M";
        DOR39P9-M-PROC-DKT();
    end

    if(DOR39W.WS-FORM-DEST == "S")
        DFMPOP-TRANSFER.FILLER = "S";
        DOR39P9-S-PROC-DKT();
    end

    /* Do both Flexiform and NV0014:*/
    if(DOR39W.WS-FORM-DEST == "B")
        DFMPOP-TRANSFER.FILLER = "S";
        DOR39P9-S-PROC-DKT();

        DFMPOP-TRANSFER.FILLER = "M";
        DOR39P9-M-PROC-DKT();
    end
    /*  */
end // end DOR39P9-PROC-DOCKT

// INQUIRY TWNPRVSN

function DOR39P9-PRV-S02Q1()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    VDBCONTROL.UPROC-OBJ = "H2-PRVSN";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCONTROL.UPROC-NM = "DOR39P9-PRV-S02Q1";
    VDBCOMMON.USQLREC = "H2-PRVSN";
    try
        get H2-PRVSN singleRow
                with #sql{
        select IMD_INCWH_ORDR_IND
        from TWNPRVSN T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
         --** INSERT ORDER BY CLAUSE HERE **
        WHERE DCKT_NMB   = :DCKT-NMB
          AND SQNC_NMB   = :SQNC-NMB
          AND PRVSN_TYPE = :PRVSN-TYPE
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into IMD-INCWH-ORDR-IND;
    end
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        /*  */
        VDBCOMMON.UNRF = "Y";
        VDBCOMMON.UDUP = "N";
        /*  */
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
    /*  */
end // end DOR39P9-PRV-S02Q1

// Inquire Provision

function DOR39P9-PRV-S05Q1()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    set H2-PRVSN empty;
    VDBCOMMON.USQLREC = "H2-PRVSN";
    VDBCONTROL.UPROC-OBJ = "H2-PRVSN";
    VDBCONTROL.UPROC-NM = "DOR39P9-PRV-S05Q1";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    H2-PRVSN.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-PRVSN.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    /*  */
    try
        get H2-PRVSN singleRow
                with #sql{
        select CHD_SUPRT_AMT , CHD_SUPRT_FREQ,
               AREGE_COA , AREGE_FREQ
        from TWNPRVSN T1
        WHERE  DCKT_NMB = :DCKT-NMB AND
                SQNC_NMB = :SQNC-NMB AND
                PRVSN_TYPE = 'CS'
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into CHD-SUPRT-AMT, CHD-SUPRT-FREQ, AREGE-COA, AREGE-FREQ;
    end
    /*  */
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        VDBCOMMON.UNRF = "1";
        VDBCOMMON.UNRF = "N";
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
end // end DOR39P9-PRV-S05Q1

// H2-PRVSN

function DOR39P9-PRV-S05Q2()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    set H2-PRVSN empty;
    VDBCOMMON.USQLREC = "H2-PRVSN";
    VDBCONTROL.UPROC-OBJ = "H2-PRVSN";
    VDBCONTROL.UPROC-NM = "DOR39P9-PRV-S05Q2";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    H2-PRVSN.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-PRVSN.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    /*  */
    try
        get H2-PRVSN singleRow
                with #sql{
        select MDCSH_AREGE_COA_FQ, MED_CSH_AREGE_COA, MDCSH_CRSUP_COA_FQ,
          MED_CSH_CRSUP_COA
        from TWNPRVSN T1
        WHERE
          DCKT_NMB = :DCKT-NMB AND
          SQNC_NMB = :SQNC-NMB AND
          PRVSN_TYPE = 'MC'
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into MDCSH-AREGE-COA-FQ, MED-CSH-AREGE-COA, MDCSH-CRSUP-COA-FQ, MED-CSH-CRSUP-COA;
    end
    /*  */
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        VDBCOMMON.UNRF = "1";
        VDBCOMMON.UNRF = "N";
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
end // end DOR39P9-PRV-S05Q2

// H2-PRVSN

function DOR39P9-PRV-S05Q3()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    set H2-PRVSN empty;
    VDBCOMMON.USQLREC = "H2-PRVSN";
    VDBCONTROL.UPROC-OBJ = "H2-PRVSN";
    VDBCONTROL.UPROC-NM = "DOR39P9-PRV-S05Q3";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    H2-PRVSN.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-PRVSN.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    /*  */
    try
        get H2-PRVSN singleRow
                with #sql{
        select MEDOS_AREGE_COA_FQ, MEDOS_AREGE_COA
        from TWNPRVSN T1
        WHERE
          DCKT_NMB = :DCKT-NMB AND
          SQNC_NMB = :SQNC-NMB AND
          PRVSN_TYPE = 'MX'
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into MEDOS-AREGE-COA-FQ, MEDOS-AREGE-COA;
    end
    /*  */
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        VDBCOMMON.UNRF = "1";
        VDBCOMMON.UNRF = "N";
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
end // end DOR39P9-PRV-S05Q3

// H2-PRVSN

function DOR39P9-PRV-S05Q4()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    set H2-PRVSN empty;
    VDBCOMMON.USQLREC = "H2-PRVSN";
    VDBCONTROL.UPROC-OBJ = "H2-PRVSN";
    VDBCONTROL.UPROC-NM = "DOR39P9-PRV-S05Q4";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    H2-PRVSN.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-PRVSN.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    /*  */
    try
        get H2-PRVSN singleRow
                with #sql{
        select SPSL_SUPRT_AMT, SPSL_SUPRT_FREQ,
          AREGE_COA, AREGE_FREQ
        from TWNPRVSN T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE
          DCKT_NMB = :DCKT-NMB AND
          SQNC_NMB = :SQNC-NMB AND
          PRVSN_TYPE = 'SS'
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into SPSL-SUPRT-AMT, SPSL-SUPRT-FREQ, AREGE-COA, AREGE-FREQ;
    end
    /*  */
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        VDBCOMMON.UNRF = "1";
        VDBCOMMON.UNRF = "N";
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
end // end DOR39P9-PRV-S05Q4

// H2-PRVSN

function DOR39P9-PRV-S05Q5()
    WDB00PI();
    VDBCOMMON.UAPPLNAM = "DOR39A";
    /*  */
    set H2-PRVSN empty;
    VDBCOMMON.USQLREC = "H2-PRVSN";
    VDBCONTROL.UPROC-OBJ = "H2-PRVSN";
    VDBCONTROL.UPROC-NM = "DLB33P9-S07D";
    VDBCONTROL.UPROC-OPT = "INQUIRY";
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    H2-PRVSN.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-PRVSN.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    /*  */
    try
        get H2-PRVSN singleRow
                with #sql{
        select FEE_COA,
          FEE_COA_FREQ
        from TWNPRVSN T1
         --** INSERT WHERE, GROUP BY AND HAVING CLAUSES HERE **
        WHERE
          DCKT_NMB = :DCKT-NMB AND
          SQNC_NMB = :SQNC-NMB AND
          PRVSN_TYPE = 'FE'
         --** INSERT ORDER BY CLAUSE HERE **
      }
                into FEE-COA, FEE-COA-FREQ;
    end
    /*  */
    if(sysVar.sqlData.sqlcode != 0 && sysVar.sqlData.sqlcode != 100)
        VDBCOMMON.UNRF = "1";
        VDBCOMMON.UNRF = "N";
        WDB00PE-SQLERR();
        if(VDBCONTROL.URC > 104)
            exit program;
        end
    end
end // end DOR39P9-PRV-S05Q5

// Calc IWIT for Flexiforms

function DOR39P9-S-CALC-IWT()
/*  */
/* Scan for Inactivated Support Amounts*/
/*  */
    DOR39W.WS-INACT-IND[1] = "N"; /* Child support current (CS/C)*/
    DOR39W.WS-INACT-IND[2] = "N"; /* Child support arrears (CS/A)*/
    DOR39W.WS-INACT-IND[3] = "N"; /* Spousal support current (SS/C)*/
    DOR39W.WS-INACT-IND[4] = "N"; /* Spousal support arrears (SS/A)*/
    DOR39W.WS-INACT-IND[5] = "N"; /* Medical cash current (MC/C)*/
    DOR39W.WS-INACT-IND[6] = "N"; /* Medical cash arrears (MC/A)*/
    DOR39W.WS-INACT-IND[7] = "N"; /* Medical expense arrears (MX/A)*/
    DOR39W.WS-INACT-IND[8] = "N"; /* Fees (FE)*/
    /*  */
    DOR39P9-FIO-S03Q1();
    /*  */
    /* --- Monthly Support Amounts*/
    /*  */
    if(DOR39W.WS-PYMNT-DATE > DOR39W1.WS-FOR-DATE ||
            FDOR-IWIT-DTLS.F-WS-DEF27-IND == "E")
        DOR39P9-S-PROVISN();
    else
        DOR39P9-S-NCP-RCBL();
    end

    DOR39W.WS-TOTAMT = DOR39W.WS-CSPRAMT + DOR39W.WS-ZAPRAMT +
            DOR39W.WS-MCPRAMT + DOR39W.WS-OPRAMT1 + DOR39W.WS-OPRAMT2 +
            DOR39W.WS-OPRAMT3 + DOR39W.WS-OPRAMT4;
    DOR39W.WS-WAMT = mathLib.round(DOR39W.WS-TOTAMT * 12 / 52,
            -mathLib.decimals(DOR39W.WS-WAMT));
    DOR39W.WS-BAMT = mathLib.round(DOR39W.WS-TOTAMT * 12 / 26,
            -mathLib.decimals(DOR39W.WS-BAMT));
    DOR39W.WS-SAMT = mathLib.round(DOR39W.WS-TOTAMT * 12 / 24,
            -mathLib.decimals(DOR39W.WS-SAMT));
    DOR39W.WS-MAMT = DOR39W.WS-TOTAMT;
    DOR39W.WS-DCKT-AMOUNT = DOR39W.WS-TOTAMT;
    DOR39W.WS-NCP-AMOUNT = DOR39W.WS-NCP-AMOUNT + DOR39W.WS-TOTAMT;
end // end DOR39P9-S-CALC-IWT

// Calc amounts for Flexiforms

function DOR39P9-S-NCP-RCBL()
/*  */
/* Check for variation in child support current*/
/*  */
    DOR39W.WS-CUR-VAR-IND = "N";
    if(DOR39W.WS-INACT-IND[1] != "Y")
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "CS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /* PERFORM DOR39P9-VARIATION;*/
        DOR39P9-S-VARIATN();
    end
    /*  */
    /* Check for variation in child support arrears*/
    /*  */
    DOR39W.WS-ARR-VAR-IND = "N";
    if(DOR39W.WS-INACT-IND[2] != "Y")
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "CS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /* PERFORM DOR39P9-VARIATION;*/
        DOR39P9-S-VARIATN();
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N"))
        set H2-NCP-ACCT-RCBL empty;
        H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H2-NCP-ACCT-RCBL.PRVSN-TYPE = "CS";
        DOR39P9-NAC-S07Q1();
        if(H2-NCP-ACCT-RCBL not noRecordFound) /* If Record Found*/
            if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[1] == "N")
                DOR39W.WS-CSPRAMT = H2-NCP-ACCT-RCBL.CRSUP-CMOA;
            end
            if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[2] == "N")
                DOR39W.WS-ZAPRAMT = H2-NCP-ACCT-RCBL.ARERS-CMOA;
            end
            if(H2-NCP-ACCT-RCBL.ADJ-ARERS-BAL-AMT > 0 ||
                    H2-NCP-ACCT-RCBL.UNADJ-ARS-BAL-AMT > 0) /* If Arrears*/
                DOR39P9-FIO-S06Q1(); /* If Finantial Obligation present (>0)*/
            /* overlay this amount from there*/
            end
        end
    end
    /*  */
    /* Check for variation in medical cash current*/
    /*  */
    if(DOR39W.WS-INACT-IND[5] != "Y")
        DOR39W.WS-CUR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MC";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /* PERFORM DOR39P9-VARIATION;*/
        DOR39P9-S-VARIATN();
    end
    /*  */
    /* Check for variation in medical cash arrears*/
    /*  */
    if(DOR39W.WS-INACT-IND[6] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MC";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /* PERFORM DOR39P9-VARIATION;*/
        DOR39P9-S-VARIATN();
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N") &&(
            DOR39W.WS-INACT-IND[5] == "N" || DOR39W.WS-INACT-IND[6] == "N"))
        set H2-NCP-ACCT-RCBL empty;
        H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H2-NCP-ACCT-RCBL.PRVSN-TYPE = "MC";
        DOR39P9-NAC-S07Q1();
        if(H2-NCP-ACCT-RCBL not noRecordFound) /* If Record Found*/
            if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[5] == "N")
                DOR39W.WS-MCPRAMT = DOR39W.WS-MCPRAMT +
                        H2-NCP-ACCT-RCBL.CRSUP-CMOA;
            end
            if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[6] == "N")
                DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                        H2-NCP-ACCT-RCBL.ARERS-CMOA;
            end
        end
    end
    /*  */
    /* Check for variation in medical outstanding*/
    /*  */
    if(DOR39W.WS-INACT-IND[7] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MX";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /* PERFORM DOR39P9-VARIATION;*/
        DOR39P9-S-VARIATN();
        /*  */
        if(DOR39W.WS-ARR-VAR-IND == "N")
            set H2-NCP-ACCT-RCBL empty;
            H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
            H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
            H2-NCP-ACCT-RCBL.PRVSN-TYPE = "MX";
            DOR39P9-NAC-S07Q1();
            if(H2-NCP-ACCT-RCBL not noRecordFound) /* If Record Found*/
                DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                        H2-NCP-ACCT-RCBL.ARERS-CMOA;
            end
        end
    end
    /*  */
    /* Check for variation in spousal support current*/
    /*  */
    if(DOR39W.WS-INACT-IND[3] != "Y")
        DOR39W.WS-CUR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "SS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /* PERFORM DOR39P9-VARIATION;*/
        DOR39P9-S-VARIATN();
    end
    /*  */
    /* Check for variation in spousal support arrears*/
    /*  */
    if(DOR39W.WS-INACT-IND[4] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "SS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        /* PERFORM DOR39P9-VARIATION;*/
        DOR39P9-S-VARIATN();
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N") &&(
            DOR39W.WS-INACT-IND[3] == "N" || DOR39W.WS-INACT-IND[4] == "N"))
        set H2-NCP-ACCT-RCBL empty;
        H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H2-NCP-ACCT-RCBL.PRVSN-TYPE = "SS";
        DOR39P9-NAC-S07Q1();
        if(H2-NCP-ACCT-RCBL not noRecordFound) /* If Record Found*/
            if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[3] == "N")
                DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 +
                        H2-NCP-ACCT-RCBL.CRSUP-CMOA;
            end
            if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[4] == "N")
                DOR39W.WS-OPRAMT4 = DOR39W.WS-OPRAMT4 +
                        H2-NCP-ACCT-RCBL.ARERS-CMOA;
            end
        end
    end
    /*  */
    if(DOR39W.WS-INACT-IND[8] != "Y")
        set H2-NCP-ACCT-RCBL empty;
        H2-NCP-ACCT-RCBL.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H2-NCP-ACCT-RCBL.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H2-NCP-ACCT-RCBL.PRVSN-TYPE = "FE";
        DOR39P9-NAC-S07Q1();
        if(H2-NCP-ACCT-RCBL not noRecordFound) /* If Record Found*/
            if(DOR39W.WS-CUR-VAR-IND == "N")
                DOR39W.WS-OPRAMT3 = DOR39W.WS-OPRAMT3 +
                        H2-NCP-ACCT-RCBL.CRSUP-CMOA;
            end
            if(DOR39W.WS-ARR-VAR-IND == "N")
                DOR39W.WS-OPRAMT3 = DOR39W.WS-OPRAMT3 +
                        H2-NCP-ACCT-RCBL.ARERS-CMOA;
            end
        end
    end
    /*  */
end // end DOR39P9-S-NCP-RCBL

function DOR39P9-S-PROC-DKT()

/* Income Withholding Ordered?*/

    set H2-PRVSN empty;
    H2-PRVSN.DCKT-NMB = DOR39W.WS-DCKT-NMB;
    H2-PRVSN.SQNC-NMB = DOR39W.WS-SQNC-NMB;
    H2-PRVSN.PRVSN-TYPE = "IW";
    DOR39P9-PRV-S02Q1();
    if((sysVar.sqlData.sqlcode == 0 && H2-PRVSN.IMD-INCWH-ORDR-IND == "Y") ||
            DOR39W.WS-APPL-NAME == "DFM04A")
        DOR39W.WS-SEND-LETTER = "Y";
        DOR39W.WS-INCLD-DOCKET = "Y";
    end

    if((DOR39W.WS-INTID-INCWH-EST-DT > "0001-01-01" &&
            DOR39W.WS-INTID-INCWH-EST-DT < "9999-12-31"))
        DOR39W.WS-INCLD-DOCKET = "Y";
        if(DOR39W.WS-DELIN-STS == "D")
            DOR39W.WS-SEND-LETTER = "Y";
            DOR39W.WS-NCP-WWH-STS = "RW";
        end
    end
    /*  */
    if(DOR39W.WS-INCLD-DOCKET == "Y")
        DOR39W.WS-INCLD-DOCKET = "N";
    end

    /* IF DOR39W.WS-FORM-DEST = 'M' OR DOR39W.WS-FORM-DEST = 'B';*/
    /* MOVE 'M' TO DOR39W.WS-FORM-DEST;*/
    /* PERFORM DOR39P9-CALC-IWIT;     /*WI21347*/
    /* PERFORM DOR39P9-M-CALC-IWT;*/
    /* MOVE 'M' TO DOR39W.WS-FORM-PRNTD;*/
    /* END;*/
    /* IF DOR39W.WS-FORM-DEST = 'S' OR DOR39W.WS-FORM-DEST = 'B';*/
    /* MOVE 'S' TO DOR39W.WS-FORM-DEST;*/
    DOR39P9-S-CALC-IWT();
    /* END;*/
    /*  */
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";

    WDB00PE-SQLERR();
    if(VDBCONTROL.URC > 104)
        exit program;
    end

    if((DOR39W.WS-SEND-LETTER == "Y" && DOR39W.WS-TOTAMT > 0) ||
            DOR39W.WS-APPL-NAME == "DFM04A")
        if(DOR39W.WS-APPL-NAME != "DFM04A" &&  /* Not from forms menu*/
                DOR39W.WS-JRSDT-TYPE == "I")
            /* Nevada is initiating - do not generate NV0014*/
            if(DOR39W.WS-APPL-NAME == "TIWTC1A")
                /* New employer added from an interface - alert worker*/
                PCALINP.PAL-ALERT-CD = 370048; /**/
                PCALINP.PAL-UPI = DOR39W.WS-NCP-UPI;
                PCALINP.PAL-SUFFIX = DOR39W.WS-CASE-SUFX;
                PCALINP.PAL-ALERT-ACTION = "C";
                call "CAL11A"(VDBCONTROL, VMESSAGE,
                        PCALINP){isNoRefresh = yes};
                if(VDBCONTROL.URC > 104)
                    exit program;
                end
            end
        else
            /*  */
            /* PERFORM DOR39P9-PROC-EMPL;*/
            DOR39P9-S-PROC-EMP();
            if(DOR39W.WS-TOTAMT > 0)
                if(FDOR-IWIT-DTLS.F-NV0014-GENERATED-IND == "Y")
                    /* ************************************************************************/
                    /* Update Docket                                                **/
                    /* ************************************************************************/
                    if(DOR39W.WS-DELIN-STS-EFF-DT != "0001-01-01" &&
                            DOR39W.WS-DELIN-STS-EFF-DT != "9999-12-31")
                        DOR39W.WS-DELIN-DATE = DOR39W.WS-DELIN-STS-EFF-DT;
                    else
                        DOR39W.WS-DELIN-DATE = "9999-12-31";
                    end
                    /*  */
                    if((DOR39W.WS-INTID-INCWH-EST-DT != "0001-01-01" &&
                            DOR39W.WS-INTID-INCWH-EST-DT != "9999-12-31"))
                        DOR39W.WS-INCWH-DATE = DOR39W.WS-INTID-INCWH-EST-DT;
                    else
                        DOR39W.WS-INCWH-DATE = DOR39W1.WS-CRNT-DATE;
                    end
                    /*  */
                    set H2-DOCKET empty;
                    H2-DOCKET.DCKT-NMB = DOR39W.WS-DCKT-NMB;
                    H2-DOCKET.WWH-ESTD-AMT = DOR39W.WS-DCKT-AMOUNT;
                    if(DOR39W.WS-ORDER-TYPE == "A")
                        H2-DOCKET.IW-STS = "AO";
                        DOR39W.WS-NCP-WWH-STS = "AO";
                    else
                        H2-DOCKET.IW-STS = "CO";
                    end
                    if(DOR39W.WS-IW-NOTICE-SENT == " ")
                        H2-DOCKET.IW-NOTICE-SENT = "E";
                    end
                    if(DOR39W.WS-IW-NOTICE-SENT == "N")
                        H2-DOCKET.IW-NOTICE-SENT = "B";
                    end
                    /*  */
                    /* Comment: WI # 23375 - Include Last NV014 generation date*/
                    /*  */
                    H2-DOCKET.WWH-RQSTD-DT = DOR39W1.WS-CRNT-DATE;
                    /*  */
                    DOR39P9-DOC-U01Q1();
                /*  */
                end
            end
        /*  */
        end
    else
        VMESSAGE.UMSGCODE = "GEN0607E"; /* Income Withholding not ordered*/
        VMESSAGE.UMSGTYPE = "E";
        exit program;
    end

    set DOR39W empty;
    DOR39W.WS-NCP-UPI = FDOR-IWIT-DTLS.F-NCP-UPI;
    DOR39W.WS-CASE-SUFX = FDOR-IWIT-DTLS.F-CASE-SUFX;
    DOR39W.WS-APPL-NAME = FDOR-IWIT-DTLS.F-APPL-NAME;
    DOR39W.WS-APPL-TYPE = FDOR-IWIT-DTLS.F-APPL-TYPE;
    DOR39W.WS-EMPLR-ID = FDOR-IWIT-DTLS.F-EMPLR-ID; /* WI 14513*/
    DOR39W.WS-DCKT-NMB = FDOR-IWIT-DTLS.F-DCKT-NMB;
end // end DOR39P9-S-PROC-DKT

function DOR39P9-S-PROC-EMP()
/*  */
    set H2-JOB-HISTORY empty;
    H2-JOB-HISTORY.UPI = DOR39W.WS-NCP-UPI;
    if(FDOR-IWIT-DTLS.F-EMPLR-ID == " ")
        DOR39P9-JHS-S08Q1();
        if(sysVar.sqlData.sqlcode == 0)
            DOR39P9-JHS-S08QS();
            while(DOR39W.WS-SQL-CODE == 0)
                /* PERFORM DOR39P9-UPDT-EMPL;*/
                DOR39P9-S-UPDT-EMP();
                DOR39P9-JHS-S08QS();
            end
        end
    else
        H2-JOB-HISTORY.EMPLR-ID = FDOR-IWIT-DTLS.F-EMPLR-ID;
        DOR39P9-JHS-S08Q2();
        /* PERFORM DOR39P9-UPDT-EMPL;*/
        /* IF DOR39W.WS-FORM-DEST = 'M' OR DOR39W.WS-FORM-DEST = 'B';*/
        /* MOVE 'M' TO DOR39W.WS-FORM-DEST;*/
        /* PERFORM DOR39P9-M-UPDT-EMP;*/
        /* if DOR39W.WS-FORM-DEST = 'b';*/

        /* END;*/
        /* IF DOR39W.WS-FORM-DEST = 'S' OR DOR39W.WS-FORM-DEST = 'B';*/
        /* MOVE 'S' TO DOR39W.WS-FORM-DEST;*/
        DOR39P9-S-UPDT-EMP();
    /* END;*/
    end
    /*  */
    VDBCOMMON.UNRF = "1";
    VDBCOMMON.UDUP = "N";
    /*  */
    WDB00PE-SQLERR();
    if(VDBCONTROL.URC > 104)
        exit program;
    end
    /*  */
end // end DOR39P9-S-PROC-EMP

// Get Support Amounts

function DOR39P9-S-PROVISN()
/*  */
/* Check for variation in child support CURRENT*/
/*  */
    DOR39W.WS-CUR-VAR-IND = "N";
    if(DOR39W.WS-INACT-IND[1] != "Y")
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "CS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-S-VARIATN();
    end
    /*  */
    /* Check for variation in child support arrears*/
    /*  */
    DOR39W.WS-ARR-VAR-IND = "N";
    if(DOR39W.WS-INACT-IND[2] != "Y")
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "CS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-S-VARIATN();
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N"))
        DOR39P9-PRV-S05Q1();
        if(H2-PRVSN not noRecordFound)
            if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[1] == "N")
                if(H2-PRVSN.CHD-SUPRT-FREQ == "M")
                    DOR39W.WS-CSPRAMT = H2-PRVSN.CHD-SUPRT-AMT;
                else
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.CHD-SUPRT-AMT;
                    DFC34W.PI2-FREQ = H2-PRVSN.CHD-SUPRT-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-CSPRAMT = DFC34W.PO1-CURR-SUPP-CMOA;
                end
            end
            if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[2] == "N")
                if(H2-PRVSN.AREGE-FREQ == "M")
                    DOR39W.WS-ZAPRAMT = H2-PRVSN.AREGE-COA;
                else
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.AREGE-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.AREGE-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-ZAPRAMT = DFC34W.PO1-CURR-SUPP-CMOA;
                end
            end
            DOR39P9-FIO-S06Q1(); /* If Finantial Obligation present (>0)*/
        /* overlay this amount from there*/
        end
    end
    /*  */
    /* Check for variation in medical cash current*/
    /*  */
    if(DOR39W.WS-INACT-IND[5] != "Y")
        DOR39W.WS-CUR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MC";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-S-VARIATN();
    end
    /*  */
    /* Check for variation in medical cash arrears*/
    /*  */
    if(DOR39W.WS-INACT-IND[6] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MC";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-S-VARIATN();
    end
    /*  */
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N") &&(
            DOR39W.WS-INACT-IND[5] == "N" || DOR39W.WS-INACT-IND[6] == "N"))
        DOR39P9-PRV-S05Q2();
        if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[5] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.MDCSH-CRSUP-COA-FQ !=
                            " ")
                if(H2-PRVSN.MDCSH-CRSUP-COA-FQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.MED-CSH-CRSUP-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.MDCSH-CRSUP-COA-FQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-MCPRAMT = DOR39W.WS-MCPRAMT +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                else
                    DOR39W.WS-MCPRAMT = DOR39W.WS-MCPRAMT +
                            H2-PRVSN.MED-CSH-CRSUP-COA;
                end
            end
        end
        if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[6] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.MDCSH-AREGE-COA-FQ !=
                            " ")
                if(H2-PRVSN.MDCSH-AREGE-COA-FQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.MED-CSH-AREGE-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.MDCSH-AREGE-COA-FQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                else
                    DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                            H2-PRVSN.MED-CSH-AREGE-COA;
                end
            end
        end
    end
    /*  */
    /* Check for variation in medical outstanding arrears*/
    /*  */
    if(DOR39W.WS-INACT-IND[7] != "Y")
        DOR39W.WS-ARR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "MX";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-S-VARIATN();
    end
    /*  */
    if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[7] == "N")
        DOR39P9-PRV-S05Q3();
        if(H2-PRVSN not noRecordFound && H2-PRVSN.MEDOS-AREGE-COA-FQ != " ")
            if(H2-PRVSN.MEDOS-AREGE-COA-FQ != "M")
                DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.MEDOS-AREGE-COA;
                DFC34W.PI2-FREQ = H2-PRVSN.MEDOS-AREGE-COA-FQ;
                call "DFC34A"(VDBCONTROL, VMESSAGE, DFC34W){isNoRefresh = yes};
                if(VDBCONTROL.URC > 104)
                    exit program;
                end
                DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                        DFC34W.PO1-CURR-SUPP-CMOA;
            else
                DOR39W.WS-OPRAMT1 = DOR39W.WS-OPRAMT1 +
                        H2-PRVSN.MEDOS-AREGE-COA;
            end
        end
    end
    /*  */
    /* Check for variation in spousal support current*/

    if(DOR39W.WS-INACT-IND[3] != "Y")
        DOR39W.WS-CUR-VAR-IND = "N";
        set H-TOSSS3 empty;
        H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
        H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
        H-TOSSS3.PRVSN-TYPE = "SS";
        H-TOSSS3.OBLGN-SUSPN-TYPE = "C";
        H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
        H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
        DOR39P9-S-VARIATN();
    end
    if((DOR39W.WS-CUR-VAR-IND == "N" || DOR39W.WS-ARR-VAR-IND == "N") &&(
            DOR39W.WS-INACT-IND[3] == "N" || DOR39W.WS-INACT-IND[4] == "N"))
        DOR39P9-PRV-S05Q4();
        if(DOR39W.WS-CUR-VAR-IND == "N" && DOR39W.WS-INACT-IND[3] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.SPSL-SUPRT-FREQ != " ")
                if(H2-PRVSN.SPSL-SUPRT-FREQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.SPSL-SUPRT-AMT;
                    DFC34W.PI2-FREQ = H2-PRVSN.SPSL-SUPRT-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                else
                    DOR39W.WS-OPRAMT2 = DOR39W.WS-OPRAMT2 +
                            H2-PRVSN.SPSL-SUPRT-AMT;
                end
            end
        end
        /* /**/
        /* /* Check for variation in spousal support arrears*/
        /* /**/
        if(DOR39W.WS-INACT-IND[4] != "Y")
            DOR39W.WS-ARR-VAR-IND = "N";
            set H-TOSSS3 empty;
            H-TOSSS3.DCKT-NMB = DOR39W.WS-DCKT-NMB;
            H-TOSSS3.SQNC-NMB = DOR39W.WS-SQNC-NMB;
            H-TOSSS3.PRVSN-TYPE = "SS";
            H-TOSSS3.OBLGN-SUSPN-TYPE = "A";
            H-TOSSS3.HW-YRMTH = DOR39W1.TOSSS3-YM;
            H-TOSSS3.HW-MONTH = DOR39W1.TOSSS3-MM;
            DOR39P9-S-VARIATN();
        end
        /*  */
        if(DOR39W.WS-ARR-VAR-IND == "N" && DOR39W.WS-INACT-IND[4] == "N")
            if(H2-PRVSN not noRecordFound && H2-PRVSN.AREGE-FREQ != " ")
                if(H2-PRVSN.AREGE-FREQ != "M")
                    DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.AREGE-COA;
                    DFC34W.PI2-FREQ = H2-PRVSN.AREGE-FREQ;
                    call "DFC34A"(VDBCONTROL, VMESSAGE,
                            DFC34W){isNoRefresh = yes};
                    if(VDBCONTROL.URC > 104)
                        exit program;
                    end
                    DOR39W.WS-OPRAMT4 = DOR39W.WS-OPRAMT4 +
                            DFC34W.PO1-CURR-SUPP-CMOA;
                else
                    DOR39W.WS-OPRAMT4 = DOR39W.WS-OPRAMT4 + H2-PRVSN.AREGE-COA;
                end
            end
        end
    end

    if(DOR39W.WS-INACT-IND[8] != "Y")
        DOR39P9-PRV-S05Q5();
        if(H2-PRVSN not noRecordFound && H2-PRVSN.FEE-COA-FREQ != " ")
            if(H2-PRVSN.FEE-COA-FREQ != "M")
                DFC34W.PI1-CURR-SUPP-COA = H2-PRVSN.FEE-COA;
                DFC34W.PI2-FREQ = H2-PRVSN.FEE-COA-FREQ;
                call "DFC34A"(VDBCONTROL, VMESSAGE, DFC34W){isNoRefresh = yes};
                if(VDBCONTROL.URC > 104)
                    exit program;
                end
                DOR39W.WS-OPRAMT3 = DFC34W.PO1-CURR-SUPP-CMOA;
            else
                DOR39W.WS-OPRAMT3 = H2-PRVSN.FEE-COA;
            end
        end
    end
end // end DOR39P9-S-PROVISN