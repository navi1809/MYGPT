package IVA_Batch;

import CommonMigratedParts.*;

Program AIN75A type basicProgram //VAGen Info - main batch program
  {
  includeReferencedFunctions = yes, allowUnqualifiedItemReferences = yes, 
  throwNrfEofExceptions = yes, handleHardIOErrors = no, V60ExceptionCompatibility = yes, 
  I4GLItemsNullable = no, textLiteralDefaultIsString = no, localSQLScope = yes, 
  inputRecord = AIN75WS1
  }

  // Data Declarations
  AIN7501R-INPUT AIN7501R-INPUT; // record
  AIN75WS1 AIN75WS1 ; // record
  CEP01W CEP01W; // record
  VDBCOMMON VDBCOMMON; // record
  VDBCONTROL VDBCONTROL; // record
  VMESSAGE VMESSAGE; // record

  // VAGen Info - items needed for migration
  VAGen_EZESYS char(8);
  VAGen_EZEREPLY num(1);
  VAGen_EZE_WAIT_TIME bin(9,2);
  VAGen_EZE_ITEMLEN int;

  function main()
    // VAGen Info - initialization needed for migration
    VAGen_EZESYS = VGLib.getVAGSysType();
    AIN75L1-MAIN: AIN75L1-MAIN();
  end // end main
end // end AIN75A


Function AIN7501P1-SCAN-INP()
  try
    get next AIN7501R-INPUT ;
  end
  AIN75WS1.SDX-IN-REC = AIN7501R-INPUT.SDX-IN-REC;
end // end AIN7501P1-SCAN-INP


Function AIN75L1-MAIN()
  set AIN75WS1 empty;
  AIN7501P1-SCAN-INP(); /* THIS READS THE FIRST ACTUAL RECORD*/
  if (AIN75WS1.SDX-FILE-TYPE == "RECN")
    VDBCONTROL.UMSQLCODE = 0;
    VDBCONTROL.UPROC-NM = "AIN75L1-MAIN";
    VDBCONTROL.UPROC-OPT = "SCAN";
    VMESSAGE.UMSGCODE-JCL-ERR = 5;
    VMESSAGE.UMSGCODE = "GEN0274";
    VMESSAGE.UMSGINS[2] = "AIN75A";
    VMESSAGE.UMSGINS[1] = "  ";
    WCM00P2-TO-CEP01A();
  else
    if (AIN75WS1.SDX-FILE-TYPE == "TRES")
      VDBCONTROL.UMSQLCODE = 0;
      VDBCONTROL.UPROC-NM = "AIN75L1-MAIN";
      VDBCONTROL.UPROC-OPT = "SCAN";
      VMESSAGE.UMSGCODE-JCL-ERR = 6;
      VMESSAGE.UMSGCODE = "GEN0274";
      VMESSAGE.UMSGINS[2] = "AIN75A";
      VMESSAGE.UMSGINS[1] = "  ";
      WCM00P2-TO-CEP01A();
    else
    end
  end
end // end AIN75L1-MAIN


Record AIN7501R-INPUT type serialRecord  {
  fileName = "SDXIN"
  }
  4 SDX-IN-REC char(3000) ; 
end // end AIN7501R-INPUT


Record AIN75WS1 type basicRecord
  3 SDX-IN-REC char(3000) ; 
    5 SDX-DATA-1 char(24) ; 
    5 SDX-FILE-TYPE char(4) ; 
    5 SDX-DATA-2 char(2972) ; 
end // end AIN75WS1


