public String getIncapDiablityIndicator(SnapCharacteristicInputParam inputParam)
        throws BatchBusinessException {
    try {
        String sqlQuery = getQueryWithSchemaName(QueryConstants.GET_INCAP_DSBLTY_IND);

        return jdbcTemplate.query(
            sqlQuery,
            ps -> {
                ps.setObject(1, inputParam.getParam1());
                ps.setObject(2, inputParam.getParam2());
                ps.setObject(3, inputParam.getParam3());
            },
            rs -> {
                if (rs.next()) {
                    String value = rs.getString(1);
                    if (StringConstants.CHAR_Y.equalsIgnoreCase(value)) {
                        return StringConstants.CHAR_Y;
                    }
                }
                return StringConstants.CHAR_N; // default to "N" if not "Y"
            }
        );

    } catch (EmptyResultDataAccessException e) {
        return StringConstants.CHAR_N;
    } catch (Exception e) {
        Throwable cause = e.getCause();
        if (cause instanceof SQLException) {
            inputParam.setSqlErrorFlag(true);
        } else {
            inputParam.setSqlErrorFlag(false);
        }
        throw new BatchBusinessException("Error occurred while fetching incap disability indicator", e);
    }
}
