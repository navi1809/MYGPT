function AIF38P9-READ-PROC()
/*  */
/* Perform the process to read the buy-in medicare extract interface file*/
//    if(AIF38W.WS-ENV != "NOMADS")
//        SysLib.writeStdout("ENTERING AIF38P9-READ-PROC");
//        SysLib.writeStdout("READ FIRST FILE ");
//    end
    AIF38Q-RD-IN-FLE();
//    if(AIF38W.WS-ENV != "NOMADS")
//        SysLib.writeStdout("FIRST RECORD " + SR-BUYIN-MDCR-EXT-IN.REC-TYPE +
//                        SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID);
//    end
    /* BATCH ERROR CHECKING - PASS 8 IF NO RECS*/
    if(sysVar.errorCode != "00000000")
        VMESSAGE.UMSGCODE-JCL-ERR = 8;
        VDBCONTROL.UPROC-NM = "AIF38Q-RD-IN-FLE";
        VDBCONTROL.UPROC-OBJ = "SR-BUYIN-MDCR-EXT-IN";
        VDBCONTROL.UPROC-OPT = "SCAN";

        AIF38W.WS-ERR-CD = sysVar.errorCode;
        VMESSAGE.UMSGINS[1] = AIF38W.WS-ERR-LAST-FOUR;
        VMESSAGE.UMSGINS[2] = "AIF38A";
        WCM00P2-TO-CEP01A();
    end
//    if(AIF38W.WS-ENV != "NOMADS")
//        SysLib.writeStdout("ENTERING WHILE LOOP ");
//    end
	AIF38W.WS-PREV-MED-ID = "";
    while(sysVar.errorCode == "00000000")
//        if(AIF38W.WS-ENV != "NOMADS")
//            SysLib.writeStdout("CURRENT REC TYPE " + SR-BUYIN-MDCR-EXT-IN.REC-TYPE);
//            SysLib.writeStdout("CURRENT MED ID " + SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID);
//        end
        if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "B INFO" ||
           SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "T INFO" ||
           SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "HICN  " ||
           SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART A" ||
           SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART B" ||
           SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART C" ||
           SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART D" ||
            SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PT PBP")

//            if(AIF38W.WS-ENV != "NOMADS")
//                SysLib.writeStdout("PREV-MED-ID = " + AIF38W.WS-PREV-MED-ID);
//                SysLib.writeStdout("SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID = " + SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID);
//            end
            if(AIF38W.WS-PREV-MED-ID == "")
                AIF38P9-NEW-MED-ID();
            else
                if(AIF38W.WS-PREV-MED-ID == SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID)
                    AIF38P9-PROC-REC-TYPE();
                else
                    if(AIF38W.WS-SQL-OUTPUT-IND == "I")
                        AIF38P9-INSERT-DATA();
                    end
                    if(AIF38W.WS-SQL-OUTPUT-IND == "U")
                        AIF38P9-UPDATE-DATA();
                    end
                    set AIF38W1 empty;
                    set AIF38W2 empty;
                    set AIF38W3 empty;
                    AIF38P9-NEW-MED-ID();
                end
            end
        end
        AIF38Q-RD-IN-FLE();
    end // end While
    
    if(AIF38W.WS-SQL-OUTPUT-IND == "I")
        AIF38P9-INSERT-DATA();
    end
    if(AIF38W.WS-SQL-OUTPUT-IND == "U")
        AIF38P9-UPDATE-DATA();
    end
end // end AIF38P9-READ-PROC


Function AIF38Q-RD-IN-FLE()
//	if (AIF38W.WS-ENV != "NOMADS")
//    SysLib.writeStdout("ENTERING AIF38Q-RD-IN-FLE" );
//  	end	
  VGVar.handleHardIOErrors = 1;
  /* *******************************************************/
  /* This process is to read the file from buyin medicare extract         **/
  /* *******************************************************/
  /*  */
  try
    get next SR-BUYIN-MDCR-EXT-IN ;
  end
  /*  */
  /* If error occured on reading the file*/
  /*  */
  if (SR-BUYIN-MDCR-EXT-IN is ioError && SR-BUYIN-MDCR-EXT-IN not endOfFile)
    VDBCONTROL.UPROC-NM = "AIF38P9-RD-IN-FLE";
    VDBCONTROL.UPROC-OBJ = "SR-BUYIN-MDCR-EXT-IN";
    VDBCONTROL.UPROC-OPT = "SCAN";
    AIF38W.WS-ERR-CD = sysVar.errorCode;
    VMESSAGE.UMSGINS[1] = AIF38W.WS-ERR-LAST-FOUR;
    VMESSAGE.UMSGINS[2] = "AIF38A";
       /* the following conditions are added to move the corresponding*/
       /* error message*/
       /*  */
    if (SR-BUYIN-MDCR-EXT-IN is fileNotAvailable)
      VDBCONTROL.UEZESQRRM = "FILE IS NOT AVAILABLE";
    else
      if (SR-BUYIN-MDCR-EXT-IN is fileNotFound)
        VDBCONTROL.UEZESQRRM = "FILE NOT FOUND" ;
      else
        if (SR-BUYIN-MDCR-EXT-IN is invalidFormat)
          VDBCONTROL.UEZESQRRM = "FILE FORMAT MISMATCH";
        end /* ** end check for format mismatch*/
      end /* ** end check for file not found*/
    end /* ** end check for file not available*/
    WCM00P2-TO-CEP01A();
  end
end // end AIF38Q-RD-IN-FLE

function AIF38P9-NEW-MED-ID()
//	if (AIF38W.WS-ENV != "NOMADS")
//  		SysLib.writeStdout("ENTERING NEW-MED-ID()" );
//	end	
	// ERROR PROCESS
	if(SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID == " ")
    	SR-BUYIN-MDCR-EXT-OUT.REC-TYPE = "MED-ID";
    	SR-BUYIN-MDCR-EXT-OUT.MEDICAID-ID = AIF38W.WS-PREV-MED-ID;
        SR-BUYIN-MDCR-EXT-OUT.BUYIN-MDCR-EXT-DTL = "MED-ID IS BLANK - PREV-MED-ID      ";
        AIF38P9-WRITE-DTL();
	end
	AIF38W.WS-PREV-MED-ID =	SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID;
	AIF38W.WS-KEY-MEDICAID-ID = SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID;
	AIF38P9-GET-H2-REC();
//	if (AIF38W.WS-ENV != "NOMADS")
//  		SysLib.writeStdout("VDBCONTROL.URC " + VDBCONTROL.URC);
//  		SysLib.writeStdout("H2-BUYIN-MDCR-EXT.MEDIC-BLNG-SQ-NMB " + H2-BUYIN-MDCR-EXT.MEDIC-BLNG-SQ-NMB);
//  		SysLib.writeStdout("H2-BUYIN-MDCR-EXT.RCVD-DT " + H2-BUYIN-MDCR-EXT.RCVD-DT);
//	end	
	IF (VDBCONTROL.URC == 0)
		AIF38W.WS-SQL-OUTPUT-IND = "U";
	else
		AIF38P9-INIT-T-B-HICN();
		AIF38W.WS-SQL-OUTPUT-IND = "I";
	end
//	if (AIF38W.WS-ENV != "NOMADS")
//  		SysLib.writeStdout("AIF38W.WS-SQL-OUTPUT-IND = " + AIF38W.WS-SQL-OUTPUT-IND);
//	end	
	AIF38P9-INIT-PARTS-DATA();

	AIF38W.WS-HICN-ACT-IND = "";
	AIF38W.WS-HICN-INACT-IND = "";
	AIF38W.WS-ACTV-MEDCR-CLM-NUM = "";
	AIF38W.WS-INACTV-MEDCR-CLM-NUM = "";
	
	AIF38P9-PROC-REC-TYPE();
end // end	NEW-MED-ID()


function AIF38P9-WRITE-DTL()
    if(AIF38W.WS-ENV != "NOMADS")
        SysLib.writeStdout("ENTERING AIF38P9-WRITE-DTL");
    end

    try
        add SR-BUYIN-MDCR-EXT-OUT;
    end
    if(SR-BUYIN-MDCR-EXT-OUT is ioError)
        VDBCONTROL.UPROC-NM = "AIF38P9-WRITE-DTL";
        VDBCONTROL.UPROC-OBJ = "SR-BUYIN-MDCR-EXT-OUT";
        VDBCONTROL.UPROC-OPT = "ADD";
        VMESSAGE.UMSGCODE = "        ";
        VDBCONTROL.UMSQLCODE = 0;
        AIF38W.WS-ERR-CD = sysVar.errorCode;
        VMESSAGE.UMSGINS[1] = AIF38W.WS-ERR-FIRST-FOUR;
        VMESSAGE.UMSGINS[2] = "AIF38A";
        WCM00P2-TO-CEP01A();

    end
end // end AIF38P9-WRITE-DTL()

function AIF38P9-GET-H2-REC()
//	if (AIF38W.WS-ENV != "NOMADS")
//    SysLib.writeStdout("ENTERING AIF38P9-GET-H2-REC" );
//  	end	
  VDBCOMMON.USQLREC = "H2-BUYIN-MDCR-EXT";
  VDBCONTROL.UPROC-OPT = "INQUIRY";
  VDBCONTROL.UPROC-NM = "AIF38P9-GET-H2-REC";
  VDBCONTROL.UPROC-OBJ = "H2-BUYIN-MDCR-EXT";
  VDBCONTROL.UACCTYP = "R";
  try
    get H2-BUYIN-MDCR-EXT
      with #sql{
        select 	MEDIC_BLNG_SQ_NMB
        	,MEDCR_CLM_NMB
        	,OLD_MEDCR_CLM_NUM
        	,RCVD_DT
        	,MDCR_ACTIVE
        	,B_SSN
        	,B_LST_NM
        	,B_FRST_NM
        	,B_MID_NM
        	,B_NAM_SUFFIX
        	,B_DOB
        	,B_DEATH_DT
        	,B_SEX_CD
        	,T_SSN
        	,T_LST_NM
        	,T_FRST_NM
        	,T_MID_NM
        	,T_NAM_SUFFIX
        	,T_DOB  
        	,T_DEATH_DT
        	,T_SEX_CD
        	,RAILRD_RTRMT
        	,PART_A_BEG_DT
        	,PART_A_END_DT
        	,FREE_PART_A_IND
        	,PART_B_BEG_DT
        	,PART_B_END_DT
        	,PART_C_BEG_DT
        	,PART_C_END_DT
        	,PART_C_CNTRCT_NMB
        	,PART_D_BEG_DT
        	,PART_D_END_DT 
        	,PT_PBP_BEG_DT 
        	,PT_PBP_END_DT
        	,PT_PBP_CNTRCT_NMB
        	,PT_PBP_PLAN_MNB
        	,PT_PBP_SPEC_NDS
        from TWNBUYIN_MDCR_EXT T1
        where
        MEDIC_BLNG_SQ_NMB = :WS-KEY-MEDIC-BLNG-SQ-NMB
      }
      into MEDIC-BLNG-SQ-NMB 
   		,MEDCR-CLM-NMB
       	,OLD-MEDCR-CLM-NUM
       	,RCVD-DT
       	,MDCR-ACTIVE
       	,B-SSN
       	,B-LST-NM
       	,B-FRST-NM
       	,B-MID-NM
       	,B-NAM-SUFFIX
 		,B-DOB
     	,B-DEATH-DT
        ,B-SEX-CD
        ,T-SSN
        ,T-LST-NM
        ,T-FRST-NM
        ,T-MID-NM
        ,T-NAM-SUFFIX
        ,T-DOB
        ,T-DEATH-DT
        ,T-SEX-CD
        ,RAILRD-RTRMT
        ,PART-A-BEG-DT
        ,PART-A-END-DT
        ,FREE-PART-A-IND
        ,PART-B-BEG-DT
        ,PART-B-END-DT
        ,PART-C-BEG-DT
        ,PART-C-END-DT
        ,PART-C-CNTRCT-NMB
        ,PART-D-BEG-DT
        ,PART-D-END-DT
        ,PT-PBP-BEG-DT
        ,PT-PBP-END-DT
        ,PT-PBP-CNTRCT-NMB
        ,PT-PBP-PLAN-MNB
        ,PT-PBP-SPEC-NDS; 
  end
  AIF38P9-SQLCD();
 
end // end AIF38P9-GET-H2-REC()


// Initialize the H2 record for the B Info, T Info and HICN data
function AIF38P9-INIT-T-B-HICN()
//	if (AIF38W.WS-ENV != "NOMADS")
//  		SysLib.writeStdout("ENTERING INIT-T-B-HICN()" );
//	end	
	set H2-BUYIN-MDCR-EXT empty;
	AIF38W.WS-KEY-MEDICAID-ID = SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID;
	H2-BUYIN-MDCR-EXT.RCVD-DT = AIF38W.WS-RCVD-DT;
	H2-BUYIN-MDCR-EXT.MEDIC-BLNG-SQ-NMB = AIF38W.WS-KEY-MEDIC-BLNG-SQ-NMB;
	H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB = "";
	H2-BUYIN-MDCR-EXT.OLD-MEDCR-CLM-NUM = "";
    H2-BUYIN-MDCR-EXT.MDCR-ACTIVE = "";
	H2-BUYIN-MDCR-EXT.B-SSN = "";
    H2-BUYIN-MDCR-EXT.B-LST-NM = "";
    H2-BUYIN-MDCR-EXT.B-FRST-NM = "";
    H2-BUYIN-MDCR-EXT.B-MID-NM = "";
    H2-BUYIN-MDCR-EXT.B-NAM-SUFFIX = "";
    H2-BUYIN-MDCR-EXT.B-DOB = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.B-DEATH-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.B-SEX-CD = "";
    H2-BUYIN-MDCR-EXT.T-SSN = "";
    H2-BUYIN-MDCR-EXT.T-LST-NM = "";
    H2-BUYIN-MDCR-EXT.T-FRST-NM = "";
    H2-BUYIN-MDCR-EXT.T-MID-NM = "";
    H2-BUYIN-MDCR-EXT.T-NAM-SUFFIX = "";
    H2-BUYIN-MDCR-EXT.T-DOB = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.T-DEATH-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.T-SEX-CD = "";
    H2-BUYIN-MDCR-EXT.RAILRD-RTRMT = "";
	
end // end INIT-T-B-HICN()

function AIF38P9-INIT-PARTS-DATA()
//	if (AIF38W.WS-ENV != "NOMADS")
//  		SysLib.writeStdout("ENTERING INIT-PARTS-DATA()" );
//	end
    H2-BUYIN-MDCR-EXT.PART-A-BEG-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PART-A-END-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.FREE-PART-A-IND = "";
    H2-BUYIN-MDCR-EXT.PART-B-BEG-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PART-B-END-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PART-C-BEG-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PART-C-END-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PART-C-CNTRCT-NMB = "";
    H2-BUYIN-MDCR-EXT.PART-D-BEG-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PART-D-END-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PT-PBP-BEG-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PT-PBP-END-DT = AIF38W.LOW-DATE;
    H2-BUYIN-MDCR-EXT.PT-PBP-CNTRCT-NMB = "";
    H2-BUYIN-MDCR-EXT.PT-PBP-PLAN-MNB = "";
    H2-BUYIN-MDCR-EXT.PT-PBP-SPEC-NDS = "";
end // end INIT-PARTS-DATA()

function AIF38P9-PROC-REC-TYPE()
//	if (AIF38W.WS-ENV != "NOMADS")
//    SysLib.writeStdout("ENTERING PROC-REC-TYPE()" );
//  	end	

	H2-BUYIN-MDCR-EXT.RCVD-DT = AIF38W.WS-RCVD-DT;
	
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "B INFO")
        AIF38P9-SET-B-INFO();
    end

    // POPULATE T-INFO DEMO 
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "T INFO")
        AIF38P9-SET-T-INFO();
    end
    
    // set H2 record valuses for HICN
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "HICN  ")
    	AIF38P9-SET-HICN();
	end

    // set H2 record valuses for PART-A
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART A")
        AIF38P9-SET-PART-A();
    end

    // set H2 record values for PART-B
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART B")
        AIF38P9-SET-PART-B();
    end
    
    // set H2 record values for PART-C
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART C")
        AIF38P9-SET-PART-C();
    end

    // set H2 record values for PART-D
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PART D")
        AIF38P9-SET-PART-D();
    end

    // set H2 record values for PT-PBP
    if(SR-BUYIN-MDCR-EXT-IN.REC-TYPE == "PT PBP")
        AIF38P9-SET-PART-PBP();
    end
end // end AIF38P9-PROC-REC-TYPE())

function AIF38P9-SET-B-INFO()
//    if(AIF38W.WS-ENV != "NOMADS")
//        SysLib.writeStdout("ENTERING AIF38P9-SET-B-INFO");
//    end

    AIF38W1.WS-BT-INFO-REC-TYPE = SR-BUYIN-MDCR-EXT-IN.REC-TYPE;
    AIF38W1.WS-BT-MEDICAID-ID = SR-BUYIN-MDCR-EXT-IN.MEDICAID-ID;
    AIF38W1.WS-BT-INFO-REC-DTL = SR-BUYIN-MDCR-EXT-IN.BUYIN-MDCR-EXT-DTL;

    H2-BUYIN-MDCR-EXT.B-SSN = AIF38W1.WS-BT-INFO-SSN;
    H2-BUYIN-MDCR-EXT.B-LST-NM = AIF38W1.WS-BT-INFO-LST-NM;
    H2-BUYIN-MDCR-EXT.B-FRST-NM = AIF38W1.WS-BT-INFO-FRST-NM;
    H2-BUYIN-MDCR-EXT.B-MID-NM = AIF38W1.WS-BT-INFO-MID-INIT;
    H2-BUYIN-MDCR-EXT.B-NAM-SUFFIX = AIF38W1.WS-BT-NM-SFFX;

    set AIF38W.WS-TEMP-DT EMPTY;
    set AIF38W.WS-DATE EMPTY;
    AIF38W.WS-TEMP-DT = AIF38W1.WS-BT-INFO-DOB;
    // ERROR PROCESS
    if(AIF38W1.WS-BT-INFO-DOB == " ")
    	SR-BUYIN-MDCR-EXT-OUT.REC-TYPE = "DATE  ";
    	SR-BUYIN-MDCR-EXT-OUT.MEDICAID-ID = AIF38W.WS-KEY-MEDICAID-ID;
        SR-BUYIN-MDCR-EXT-OUT.BUYIN-MDCR-EXT-DTL = "DATE IS BLANK - DOB                ";
        AIF38P9-WRITE-DTL();
	end
    AIF38P9-TRANSFORM-DATES();

    H2-BUYIN-MDCR-EXT.B-DOB = AIF38W.WS-DATE;

    if(AIF38W1.WS-BT-INFO-DEATH-DT == "0       ")
        AIF38W1.WS-BT-INFO-DEATH-DT = "00010101";
    end
    set AIF38W.WS-TEMP-DT EMPTY;
    set AIF38W.WS-DATE EMPTY;
    AIF38W.WS-TEMP-DT = AIF38W1.WS-BT-INFO-DEATH-DT;
//    if(AIF38W.WS-ENV != "NOMADS")
//        SysLib.writeStdout("AIF38W1.WS-BT-INFO-DEATH-DT " + AIF38W1.WS-BT-INFO-DEATH-DT);
//        SysLib.writeStdout("AIF38W.WS-TEMP-DT " + AIF38W.WS-TEMP-DT);
//    end
    // ERROR PROCESS
    if(AIF38W1.WS-BT-INFO-DEATH-DT == " ")
    	SR-BUYIN-MDCR-EXT-OUT.REC-TYPE = "DATE  ";
    	SR-BUYIN-MDCR-EXT-OUT.MEDICAID-ID = AIF38W.WS-KEY-MEDICAID-ID;
        SR-BUYIN-MDCR-EXT-OUT.BUYIN-MDCR-EXT-DTL = "DATE IS BLANK - DOD                ";
        AIF38P9-WRITE-DTL();
	end
    AIF38P9-TRANSFORM-DATES();

    H2-BUYIN-MDCR-EXT.B-DEATH-DT = AIF38W.WS-DATE;
   
    H2-BUYIN-MDCR-EXT.B-SEX-CD = AIF38W1.WS-BT-INFO-SEX-CD;
	set AIF38W1 empty;
end // end AIF38P9-SET-B-INFO()

function AIF38P9-INSERT-DATA()
//	if (AIF38W.WS-ENV != "NOMADS")
//  		SysLib.writeStdout("ENTERING INSERT-DATA" );
//  		SysLib.writeStdout("MEDICAID-ID" + H2-BUYIN-MDCR-EXT.MEDIC-BLNG-SQ-NMB);
//  		SysLib.writeStdout("MEDICARE-ID" + H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB);
//  		SysLib.writeStdout("MEDCR-ACTV-IND " + AIF38W2.WS-HICN-MDCR-ACTIVE);
//	end	
    if(AIF38W.WS-HICN-ACT-IND == "Y")
        H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB = AIF38W.WS-ACTV-MEDCR-CLM-NUM;
        H2-BUYIN-MDCR-EXT.MDCR-ACTIVE = "Y";
        H2-BUYIN-MDCR-EXT.OLD-MEDCR-CLM-NUM = " ";
    end
    if(AIF38W.WS-HICN-INACT-IND == "Y")
        if(AIF38W.WS-HICN-ACT-IND == " ")
            H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB = AIF38W.WS-INACTV-MEDCR-CLM-NUM;
            H2-BUYIN-MDCR-EXT.MDCR-ACTIVE = "N";
        else
        	H2-BUYIN-MDCR-EXT.OLD-MEDCR-CLM-NUM = AIF38W.WS-INACTV-MEDCR-CLM-NUM;
        end
            
    end
    // ERROR PROCESS
    if(H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB == " ")
    	SR-BUYIN-MDCR-EXT-OUT.REC-TYPE = "MDCRNM";
    	SR-BUYIN-MDCR-EXT-OUT.MEDICAID-ID = AIF38W.WS-KEY-MEDICAID-ID;
        SR-BUYIN-MDCR-EXT-OUT.BUYIN-MDCR-EXT-DTL = "MEDCR-CLM-NMB IS BLANK - INSERT    ";
        AIF38P9-WRITE-DTL();
//        if (AIF38W.WS-ENV != "NOMADS")
//  			SysLib.writeStdout("SR-BUYIN-MDCR-EXT-OUT.REC-TYPE " + SR-BUYIN-MDCR-EXT-OUT.REC-TYPE);
//  			SysLib.writeStdout("SR-BUYIN-MDCR-EXT-OUT.MEDICAID-ID " + AIF38W.WS-KEY-MEDIC-BLNG-SQ-NMB);
//  			SysLib.writeStdout("SR-BUYIN-MDCR-EXT-OUT.BUYIN-MDCR-EXT-DTL " 
//  				+ SR-BUYIN-MDCR-EXT-OUT.BUYIN-MDCR-EXT-DTL);
//		end	
    end
    
    
    if(AIF38W.WS-HICN-ACT-IND == "Y" || AIF38W.WS-HICN-INACT-IND == "Y")
        if(H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB != " ")
            if(H2-BUYIN-MDCR-EXT.MEDIC-BLNG-SQ-NMB > 0)
                AIF38P9-INSERT-H2-BUYIN-MDCR-EXT();
            end    
        end
    end
end

function AIF38P9-UPDATE-DATA()
//    if(AIF38W.WS-ENV != "NOMADS")
//        SysLib.writeStdout("ENTERING UPDATE-DATA");
//        SysLib.writeStdout("MEDICAID-ID" + H2-BUYIN-MDCR-EXT.MEDIC-BLNG-SQ-NMB);
//        SysLib.writeStdout("MEDICARE-ID" + H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB);
//        SysLib.writeStdout("MEDCR-ACTV-IND" + AIF38W2.WS-HICN-MDCR-ACTIVE);
//    end
    if(AIF38W.WS-HICN-ACT-IND == "Y")
        H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB = AIF38W.WS-ACTV-MEDCR-CLM-NUM;
        H2-BUYIN-MDCR-EXT.MDCR-ACTIVE = "Y";
    end
    if(AIF38W.WS-HICN-INACT-IND == "Y")
        if(AIF38W.WS-HICN-ACT-IND == "")
            H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB = AIF38W.WS-INACTV-MEDCR-CLM-NUM;
            H2-BUYIN-MDCR-EXT.MDCR-ACTIVE = "N";
        else
            H2-BUYIN-MDCR-EXT.OLD-MEDCR-CLM-NUM = AIF38W.WS-INACTV-MEDCR-CLM-NUM;
        end
    end
    // ERROR PROCESS
    if(H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB == " ")
    	SR-BUYIN-MDCR-EXT-OUT.REC-TYPE = "MDCRNM";
        SR-BUYIN-MDCR-EXT-OUT.MEDICAID-ID = AIF38W.WS-KEY-MEDICAID-ID;
        SR-BUYIN-MDCR-EXT-OUT.BUYIN-MDCR-EXT-DTL = "MEDCR-CLM-NMB IS BLANK - UPDATE    ";
        AIF38P9-WRITE-DTL();
    end
    if(H2-BUYIN-MDCR-EXT.MEDCR-CLM-NMB != " ")
        AIF38P9-UPDATE-H2-BUYIN-MDCR-EXT();
    end
end