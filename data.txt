if ((this.appMgr.isFieldEmpty(appRgstCargo.getAlt_sta_adr())) || (appRgstCargo.getAlt_sta_adr().equals("AA")))
      {
          Object[] error = { new FwMessageTextLabel("31287") };
          //Please choose your State in the Another Mailing Address section.          
          addMessageWithFieldValues("10008", error);
      } 

      if (this.appMgr.isFieldEmpty(appRgstCargo.getAlt_zip_adr())) {
          Object[] error = { new FwMessageTextLabel("31288") };
        //Please fill in your Zip Code in the Mailing Address section.    
          addMessageWithFieldValues(AppConstants.ID_10000, error);
      }
      else if (!this.appMgr.isInteger(appRgstCargo.getAlt_zip_adr())) {
        Object[] error = { new FwMessageTextLabel("31288") };
      //Please be sure to type in only numbers for ~.    
        addMessageWithFieldValues(AppConstants.ID_10010, error);
      }
      else if ((appRgstCargo.getAlt_zip_adr().length() != 5) && (appRgstCargo.getAlt_zip_adr().length() != 9))
      {
        Object[] error = { new FwMessageTextLabel("31288") };
        //Please make sure that the ~ has numbers only and is 5 or 9 digits long. 
        //For example, 53705. If you want to give us your nine-digit Zip Code (for example, 53705-3847), you should type it in without a hyphen: 537053847.
        addMessageWithFieldValues("20071", error);
      }else if (!this.appMgr.isZero(appRgstCargo.getAlt_zip_adr()))
      {
        Object[] error = { new FwMessageTextLabel("31288") };
        //Please be sure to enter a valid zip code.
        addMessageWithFieldValues("40119", error);
      }
  }
  
  public boolean isAddressChanged(APP_RGST_Cargo beforeCargo, APP_RGST_Cargo afterCargo){
	  if(beforeCargo == null && afterCargo != null){
		  return true;
	  }
	  if(beforeCargo != null && afterCargo != null){
		  if(   ((beforeCargo.getAlt_st_adr() != null && afterCargo.getAlt_st_adr() != null && beforeCargo.getAlt_st_adr().trim().equals(afterCargo.getAlt_st_adr().trim())) || ( beforeCargo.getAlt_st_adr() == null && afterCargo.getAlt_st_adr() == null)) 
				  && ((beforeCargo.getAlt_l2_adr() != null && afterCargo.getAlt_l2_adr() != null && beforeCargo.getAlt_l2_adr().trim().equals(afterCargo.getAlt_l2_adr().trim())) || ( beforeCargo.getAlt_l2_adr() == null && afterCargo.getAlt_l2_adr() == null)) 
				  && ((beforeCargo.getAlt_city_adr() != null && afterCargo.getAlt_city_adr() != null && beforeCargo.getAlt_city_adr().trim().equals(afterCargo.getAlt_city_adr().trim())) || ( beforeCargo.getAlt_city_adr() == null && afterCargo.getAlt_city_adr() == null))
				  && ((beforeCargo.getAlt_sta_adr() != null && afterCargo.getAlt_sta_adr() != null && beforeCargo.getAlt_sta_adr().trim().equals(afterCargo.getAlt_sta_adr().trim())) || ( beforeCargo.getAlt_sta_adr() == null && afterCargo.getAlt_sta_adr() == null))
				  && ((beforeCargo.getAlt_zip_adr() != null && afterCargo.getAlt_zip_adr() != null && beforeCargo.getAlt_zip_adr().trim().equals(afterCargo.getAlt_zip_adr().trim())) || ( beforeCargo.getAlt_zip_adr() == null && afterCargo.getAlt_zip_adr() == null))
				  && ((beforeCargo.getHshl_l1_adr() != null && afterCargo.getHshl_l1_adr() != null && beforeCargo.getHshl_l1_adr().trim().equals(afterCargo.getHshl_l1_adr().trim())) || ( beforeCargo.getHshl_l1_adr() == null && afterCargo.getHshl_l1_adr() == null)) 
				  && ((beforeCargo.getHshl_l2_adr() != null && afterCargo.getHshl_l2_adr() != null && beforeCargo.getHshl_l2_adr().trim().equals(afterCargo.getHshl_l2_adr().trim())) || ( beforeCargo.getHshl_l2_adr() == null && afterCargo.getHshl_l2_adr() == null)) 
				  && ((beforeCargo.getHshl_city_adr() != null && afterCargo.getHshl_city_adr() != null && beforeCargo.getHshl_city_adr().trim().equals(afterCargo.getHshl_city_adr().trim())) || ( beforeCargo.getHshl_city_adr() == null && afterCargo.getHshl_city_adr() == null))
				  && ((beforeCargo.getHshl_sta_adr() != null && afterCargo.getHshl_sta_adr() != null && beforeCargo.getHshl_sta_adr().trim().equals(afterCargo.getHshl_sta_adr().trim())) || ( beforeCargo.getHshl_sta_adr() == null && afterCargo.getHshl_sta_adr() == null))
				  && ((beforeCargo.getHshl_zip_adr() != null && afterCargo.getHshl_zip_adr() != null && beforeCargo.getHshl_zip_adr().trim().equals(afterCargo.getHshl_zip_adr().trim())) || ( beforeCargo.getHshl_zip_adr() == null && afterCargo.getHshl_zip_adr() == null))){
			  return false;
		  }
	  }
	  return true;
  }
  
  /**
   * To insert record into PEbtAppRqst table. ILIES-261766.
  */
	public void insertPEbtAppRqstRecord(String appNumber, Map session) throws Exception {
		log(ILog.INFO, "ABRegistrationBO::insertPEbtAppRqstRecord::Start");
		try {
			String acsId = null;
			Map httpSession = (Map) session.get(FwConstants.HTTP_SESSION);
			acsId = (String)((Map)httpSession.get(FwConstants.SECURED_SESSION)).get(FwConstants.ACS_ID);
			
			if(acsId == null || acsId.trim().length() == 0 || Long.parseLong(acsId) <= 0){
				String ACS_ID_MAX_VALUE = FwPropertyLoader.getProperties("/properties/config/env.properties").getProperty("ACS_ID_MAX_VALUE");
				acsId = ACS_ID_MAX_VALUE != null ? ACS_ID_MAX_VALUE : "-1";
				log(ILog.ERROR, "ABRegistrationBO::insertPEbtAppRqstRecord:: Acs_Id:"+acsId+" for AppNum:" + appNumber);
				
				FwWrappedException we = new FwWrappedException();
	            we.setCallingClassID(this.getClass().getName());
	            we.setCallingMethodID("ABRegistrationBO::insertPEbtAppRqstRecord:");
	            we.setPreviousPageID("N/A");
                we.setCurrentPageID("ABWEL - PEBT");
                FwException fe = new FwException();
                fe.setParameterText("Exception occured while inserting App Num:: "+ appNumber );
                FwExceptionManager exceptionMgr = (FwExceptionManager) FwServiceFactory.getInstance().create(IException.class);
	            exceptionMgr.log(we);
			}
			
						
			if("0".equalsIgnoreCase(acsId) || acsId == null){
				log(ILog.ERROR, "ABRegistrationBO::insertPEbtAppRqstRecord:: Invalid Acs_Id:acsId"+" for AppNum:" + appNumber);
				throw new Exception(" Invalid Acs_Id for AppNum:" + appNumber);
			}
			
			FwDate fwDate = FwDate.getInstance();
			String todayDate = fwDate.getTimestamp().toString();
			PEBT_APP_RQST_Collection pEbtAppRqstCollection = new PEBT_APP_RQST_Collection();
			PEBT_APP_RQST_Cargo pEbtAppRqstCargo = new PEBT_APP_RQST_Cargo();
			
			pEbtAppRqstCargo.setApp_num(appNumber);
			pEbtAppRqstCargo.setApp_end_dt(dateRoutine.getValidTimestampFormatForDB(null));
			pEbtAppRqstCargo.setEcf_stat_cd("");
			pEbtAppRqstCargo.setHtml_p_id("");
			pEbtAppRqstCargo.setP_id("");
			pEbtAppRqstCargo.setRetry_tms(dateRoutine.getValidTimestampFormatForDB(null));
			pEbtAppRqstCargo.setSbms_tms(dateRoutine.getValidTimestampFormatForDB(null));
			pEbtAppRqstCargo.setStat_cd("PE");
			pEbtAppRqstCargo.setStrt_tms(todayDate);
			pEbtAppRqstCargo.setAcs_id(acsId);
			pEbtAppRqstCargo.setCreate_dt(todayDate);
			pEbtAppRqstCargo.setRowAction(FwConstants.ROWACTION_INSERT);
			
			pEbtAppRqstCollection.add(pEbtAppRqstCargo);
			pEbtAppRqstCollection.persist(FwConstants.DAO);
		log(ILog.INFO, "ABRegistrationBO::insertPEbtAppRqstRecord::End");
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(getClass().getName(),
					"insertPEbtAppRqstRecord", e);

			throw fe;
		}
	}
	
	
	/**
	 * Insert Individual Details to PEBT_APP_INDV ILIES-261766.
	 * 
	 * @param indvColl
	 */
	public void insertPebtAppIndvDetails(PEBT_APP_INDV_Collection indvColl) {
		log(ILog.INFO, "ABRegistrationBO::insertPebtAppIndvDetails::Start");
		try {
			if (indvColl != null && indvColl.size() > 0) {
				indvColl.persist(FwConstants.DAO);
			}
		log(ILog.INFO, "ABRegistrationBO::insertPebtAppIndvDetails::End");
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(),
					"insertPebtAppIndvDetails", e);
			throw fe;
		}
	}
	
	
	/**
	 * Insert Demographic Details to PEBT_APP_DEMOGRAPHICS ILIES-261766.
	 * 
	 * @param livingColl
	 */
	public void insertPebtAppDemographicDetails(PEBT_APP_DEMOGRAPHICS_Collection livingColl) {
		log(ILog.INFO, "ABRegistrationBO::insertPebtAppDemographicDetails::Start");
		try {
			if (livingColl != null && livingColl.size() > 0) {
				livingColl.persist(FwConstants.DAO);
			}
		log(ILog.INFO, "ABRegistrationBO::insertPebtAppDemographicDetails::End");
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(),
					"insertPebtAppDemographicDetails", e);
			throw fe;
		}
	}
	
	/**
	 * Convert mm/dd/yyyy to time stamp
	*/
	public Timestamp convertMMDDYYYYDateToTimestamp(String date){
		log(ILog.INFO, "ABRegistrationBO::convertMMDDYYYYDateToTimestamp::Start");
		SimpleDateFormat  dateFormatter = new SimpleDateFormat("MMddyyyy");
		Timestamp timeStampDate = null;
		try {
			if(StringUtils.isNotEmpty(date)){
			timeStampDate = new Timestamp(dateFormatter.parse(date).getTime());
			}else {
				timeStampDate = Timestamp.valueOf("9999-12-31 00:00:00.0");
			}
			log(ILog.INFO, "ABRegistrationBO::convertMMDDYYYYDateToTimestamp::End");
		} catch (FwException fe) {
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(),
					"convertMMDDYYYYDateToTimestamp", e);
			throw fe;
		}
		return timeStampDate;
	}
	
	public PEBTAppCreationRequest[] buildPEBTAppCreationRequest(String pebtAppNum, String bridgesPEBTAppNum) throws Exception {
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppCreationRequest::Start " + pebtAppNum);
		PEBTAppCreationRequest[] pebtAppCreationRequestArray = null;
		try{
			PEBTAppCreationRequest pebtAppCreationRequest = new PEBTAppCreationRequest();
			pebtAppCreationRequest.setPebtAppDemographics(buildPEBTAppDemographics(pebtAppNum, bridgesPEBTAppNum));
			pebtAppCreationRequest.setPebtAppRequest(buildPEBTAppRequest(pebtAppNum, bridgesPEBTAppNum));
		//	pebtAppCreationRequest.setPebtAppDemographics(buildPEBTAppDemographics(pebtAppNum, bridgesPEBTAppNum));
			pebtAppCreationRequest.setPebtAppIndviduals(buildPEBTAppIndvs(pebtAppNum, bridgesPEBTAppNum));
			
			pebtAppCreationRequestArray = new PEBTAppCreationRequest[1];
			pebtAppCreationRequestArray[0] = pebtAppCreationRequest;
		}catch(Exception ex){
			log(ILog.ERROR, "Exception in ABRegistrationBO.buildPEBTAppCreationRequest:: "+ pebtAppNum +" "+ ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppCreationRequest::End "+ pebtAppNum);
		return pebtAppCreationRequestArray;
	}
	
	public PEBTAppRequest buildPEBTAppRequest (String pebtAppNum, String bridgesPEBTAppNum) throws Exception {
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppRequest::Start");
		PEBTAppRequest pebtAppRequest = null;
		try{
			PEBT_APP_RQST_Cargo pebtAppRqstCargo = getPEBTAppRequest(pebtAppNum);
			if(pebtAppRqstCargo != null) {
				pebtAppRequest = new PEBTAppRequest();
				pebtAppRequest.setAppNum(bridgesPEBTAppNum);
				pebtAppRequest.setHtmlPid(pebtAppRqstCargo.getHtml_p_id());
				pebtAppRequest.setPid(pebtAppRqstCargo.getP_id());
				pebtAppRequest.setRetryTms(pebtAppRqstCargo.getRetry_tms());
				pebtAppRequest.setSbmsTms(pebtAppRqstCargo.getSbms_tms());
				pebtAppRequest.setStatCd(pebtAppRqstCargo.getStat_cd());
				pebtAppRequest.setOfcNum(pebtOfficeNumber);
			}
		}catch(Exception ex){
			log(ILog.ERROR, "Exception in ABRegistrationBO.buildPEBTAppRequest:: " + pebtAppNum + ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppRequest::End");
		return pebtAppRequest;
	}
	
	public PEBT_APP_RQST_Cargo getPEBTAppRequest(String pebtAppNum)
			throws Exception {
		log(ILog.INFO, "ABRegistrationBO::getPEBTAppRequest::Start");
		PEBT_APP_RQST_Cargo retCargo = null;
		try {
			PEBT_APP_RQST_Cargo cargo = new PEBT_APP_RQST_Cargo();
			cargo.setApp_num(pebtAppNum);
			PEBT_APP_RQST_Collection requestDetailsCollection = new PEBT_APP_RQST_Collection();
			requestDetailsCollection.add(cargo);
			PEBT_APP_RQST_Cargo[] cargos = (PEBT_APP_RQST_Cargo[]) requestDetailsCollection
					.select(FwConstants.DAO, "findByAppNumber");
			if (cargos.length > 0) {
				retCargo = cargos[0];
			}
		} catch (Exception ex) {
			log(ILog.ERROR, "Exception in ABRegistrationBO.getPEBTAppRequest:: "
					+ ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::getPEBTAppRequest::End");
		return retCargo;
	}
	
	
	public DIST_SCHOOL_MAP_Cargo[] readSchoolInfo(Map session) throws Exception {
		log(ILog.INFO, "ABRegistrationBO::readSchoolInfo::Start");
		
		Map<String, String> districtMap = new HashMap<String, String>();
		HashMap<String, String> schoolMap = new HashMap<String, String>();
		
		try {
			DIST_SCHOOL_MAP_Cargo cargo1 = new DIST_SCHOOL_MAP_Cargo();
			DIST_SCHOOL_MAP_Collection coll = new DIST_SCHOOL_MAP_Collection();
			coll.add(cargo1);
			DIST_SCHOOL_MAP_Cargo[] cargos = (DIST_SCHOOL_MAP_Cargo[]) coll.select(FwConstants.DAO, "findSChoolDistInfoBySeqNum");
			
			if (null != cargos && cargos.length > 0) {
				for(DIST_SCHOOL_MAP_Cargo cargo : cargos){
					if(!districtMap.containsKey(cargo.getDistrict_code())){
						districtMap.put(cargo.getDistrict_code(), cargo.getDist_name());
					}
					
					if(!schoolMap.containsKey(cargo.getSchool_cd())){
						schoolMap.put(cargo.getDistrict_code()+"~"+cargo.getSchool_cd(), cargo.getSchool_name());
					}
				}
				
				session.put("DIST_MAP", sortHashMapByValues(districtMap));
				session.put("SCH_MAP", sortHashMapByValues(schoolMap));
			}
		} catch (Exception ex) {
			log(ILog.ERROR,
					"Exception in ABRegistrationBO.readSchoolInfo:: "+ ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::getPEBTAppRequest::End");
		return null;
	}
	
	private Map<String, String> sortHashMapByValues(Map<String, String> map) { 
		
       List<Map.Entry<String, String>> list = new LinkedList<Map.Entry<String, String>>(map.entrySet());
       // Defined Custom Comparator here
       // Sort the list 
        Collections.sort(list, new Comparator<Map.Entry<String, String> >() { 
            public int compare(Map.Entry<String, String> o1,  
                               Map.Entry<String, String> o2) 
            { 
                return (o1.getValue()).compareTo(o2.getValue()); 
            } 
        });

     // put data from sorted list to hashmap  
        HashMap<String, String> temp = new LinkedHashMap<String, String>(); 
        for (Map.Entry<String, String> aa : list) { 
            temp.put(aa.getKey(), aa.getValue()); 
        } 
       return temp;
  }
	
	
	public PEBTAppDemographics buildPEBTAppDemographics (String pebtAppNum, String bridgesPEBTAppNum) throws Exception {
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppDemographics::Start");
		PEBTAppDemographics pebtAppDemographics = null;
		try{
			pebtOfficeNumber = 0;
			PEBT_APP_DEMOGRAPHICS_Cargo pebtAppDemoCargo = getPEBTAppDemographics(pebtAppNum);
			if(pebtAppDemoCargo != null){
				AgencyAddressBO AABO = new AgencyAddressBO();
				if(pebtAppDemoCargo.getZip()!=null  && !pebtAppDemoCargo.getZip().trim().isEmpty() 
						&& pebtAppDemoCargo.getZip().trim().length()>=5 && pebtAppDemoCargo.getZip().trim().length()<10){
					pebtOfficeNumber = Long. parseLong(AABO.getOfficeNumberByZip(pebtAppDemoCargo.getZip().trim().substring(0, 5)));
				}else if(pebtAppDemoCargo.getMail_zip()!=null  && !pebtAppDemoCargo.getMail_zip().trim().isEmpty()
						&& pebtAppDemoCargo.getMail_zip().trim().length()>=5 && pebtAppDemoCargo.getMail_zip().trim().length()<10){
					pebtOfficeNumber = Long. parseLong(AABO.getOfficeNumberByZip(pebtAppDemoCargo.getMail_zip().trim().substring(0, 5)));
				}
				pebtAppDemographics = new PEBTAppDemographics();
				pebtAppDemographics.setAppNum(bridgesPEBTAppNum);
				pebtAppDemographics.setAddrLine(pebtAppDemoCargo.getAddr_line());
				pebtAppDemographics.setAddrLine2(pebtAppDemoCargo.getAddr_line_2());
				if(pebtAppDemoCargo.getCell_ph_num() != null && !"".equalsIgnoreCase(pebtAppDemoCargo.getCell_ph_num().trim()))
					pebtAppDemographics.setCellPhNum(Long.valueOf(pebtAppDemoCargo.getCell_ph_num()));
				pebtAppDemographics.setCity(pebtAppDemoCargo.getCity());
				if(pebtAppDemoCargo.getAddr_line()!=null && pebtAppDemoCargo.getAddr_line().trim().length()>0){
					pebtAppDemographics.setCounty(pebtAppDemoCargo.getCounty());
					pebtAppDemographics.setState(pebtAppDemoCargo.getState());
				}
				else{
					pebtAppDemographics.setCounty("0");
					pebtAppDemographics.setState(null);
				}
				pebtAppDemographics.setHomelessSw(pebtAppDemoCargo.getHomeless_sw());
				pebtAppDemographics.setMailAddrLine(pebtAppDemoCargo.getMail_addr_line());
				pebtAppDemographics.setMailAddrLine2(pebtAppDemoCargo.getMail_addr_line_2());
				pebtAppDemographics.setMailCity(pebtAppDemoCargo.getMail_city());
				pebtAppDemographics.setMailState(pebtAppDemoCargo.getMail_state());
				pebtAppDemographics.setMailZip(pebtAppDemoCargo.getMail_zip());
				if(pebtAppDemoCargo.getMsg_ph_num() != null && !"".equalsIgnoreCase(pebtAppDemoCargo.getMsg_ph_num().trim()))
					pebtAppDemographics.setMsgPhNum(Long.valueOf(pebtAppDemoCargo.getMsg_ph_num()));
				if(pebtAppDemoCargo.getPh_num() != null && !"".equalsIgnoreCase(pebtAppDemoCargo.getPh_num().trim()))
					pebtAppDemographics.setPhNum(Long.valueOf(pebtAppDemoCargo.getPh_num()));
				if(pebtAppDemoCargo.getWork_extn_num() != null && !"".equalsIgnoreCase(pebtAppDemoCargo.getWork_extn_num().trim()))
					pebtAppDemographics.setWorkExtnNum(Long.valueOf(pebtAppDemoCargo.getWork_extn_num()));
				if(pebtAppDemoCargo.getWork_ph_num() != null && !"".equalsIgnoreCase(pebtAppDemoCargo.getWork_ph_num().trim()))
					pebtAppDemographics.setWorkPhNum(Long.valueOf(pebtAppDemoCargo.getWork_ph_num()));
				pebtAppDemographics.setZip(pebtAppDemoCargo.getZip());
				pebtAppDemographics.setEmail(pebtAppDemoCargo.getEmail());
			}
		}catch(Exception ex){
			log(ILog.ERROR, "Exception in ABRegistrationBO.buildPEBTAppDemographics:: " + ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppDemographics::End");
		return pebtAppDemographics;
	}
	
	public PEBT_APP_DEMOGRAPHICS_Cargo getPEBTAppDemographics(String pebtAppNum)
			throws Exception {
		log(ILog.INFO, "ABRegistrationBO::getPEBTAppDemographics::Start");
		PEBT_APP_DEMOGRAPHICS_Cargo retCargo = null;
		try {
			PEBT_APP_DEMOGRAPHICS_Cargo cargo = new PEBT_APP_DEMOGRAPHICS_Cargo();
			cargo.setApp_num(pebtAppNum);
			PEBT_APP_DEMOGRAPHICS_Collection requestDetailsCollection = new PEBT_APP_DEMOGRAPHICS_Collection();
			requestDetailsCollection.add(cargo);
			PEBT_APP_DEMOGRAPHICS_Cargo[] cargos = (PEBT_APP_DEMOGRAPHICS_Cargo[]) requestDetailsCollection
					.select(FwConstants.DAO, "findByAppNumber");
			if (cargos.length > 0) {
				retCargo = cargos[0];
			}
		} catch (Exception ex) {
			log(ILog.ERROR, "Exception in ABRegistrationBO.getPEBTAppDemographics:: "
					+ ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::getPEBTAppDemographics::End");
		return retCargo;
	}
	
	public PEBTAppIndv[] buildPEBTAppIndvs (String pebtAppNum, String bridgesPEBTAppNum) throws Exception {
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppDemographics::Start");
		PEBTAppIndv[] pebtAppIndvs = null;
		try{
			PEBT_APP_INDV_Cargo[] pebtAppDemoCargos = getPEBTAppINDVs(pebtAppNum);
			if(pebtAppDemoCargos != null && pebtAppDemoCargos.length > 0){
				pebtAppIndvs = new PEBTAppIndv[pebtAppDemoCargos.length];
				for(int i = 0; i < pebtAppDemoCargos.length; i++){
					PEBTAppIndv pebtAppIndv =  new PEBTAppIndv();
					pebtAppIndv.setAppNum(bridgesPEBTAppNum);
					pebtAppIndv.setApplicantSw(pebtAppDemoCargos[i].getApplicant_sw());
					pebtAppIndv.setDob(pebtAppDemoCargos[i].getDob());
					pebtAppIndv.setFirstName(pebtAppDemoCargos[i].getFirst_name());
					pebtAppIndv.setFreeLunchSw(pebtAppDemoCargos[i].getFree_lunch_sw().charAt(0));
					pebtAppIndv.setGenderCd(pebtAppDemoCargos[i].getGender_cd().charAt(0));
					if(pebtAppDemoCargos[i].getIndv_seq() != null && !"".equalsIgnoreCase(pebtAppDemoCargos[i].getIndv_seq().trim())){
						pebtAppIndv.setIndvSeq(Long.parseLong(pebtAppDemoCargos[i].getIndv_seq()));
					}else{
						pebtAppIndv.setIndvSeq(0L);
					}
					pebtAppIndv.setLastName(pebtAppDemoCargos[i].getLast_name());
					pebtAppIndv.setMidName(pebtAppDemoCargos[i].getMid_name());
					pebtAppIndv.setSchoolCd(pebtAppDemoCargos[i].getSchool_cd());
					pebtAppIndv.setSchoolDistrictCd(pebtAppDemoCargos[i].getSchool_district_cd());
					pebtAppIndv.setSsn(pebtAppDemoCargos[i].getSsn());
					pebtAppIndv.setSuffix(pebtAppDemoCargos[i].getSuffix());
					pebtAppIndvs[i] = pebtAppIndv;
				}
			}
		}catch(Exception ex){
			log(ILog.ERROR, "Exception in ABRegistrationBO.buildPEBTAppDemographics:: " + ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::buildPEBTAppDemographics::End");
		return pebtAppIndvs;
	}
	
	public PEBT_APP_INDV_Cargo[] getPEBTAppINDVs(String pebtAppNum)
			throws Exception {
		log(ILog.INFO, "ABRegistrationBO::getPEBTAppINDVs::Start");
		PEBT_APP_INDV_Cargo[] retCargo = null;
		try {
			PEBT_APP_INDV_Cargo cargo = new PEBT_APP_INDV_Cargo();
			cargo.setApp_num(pebtAppNum);
			PEBT_APP_INDV_Collection requestDetailsCollection = new PEBT_APP_INDV_Collection();
			requestDetailsCollection.add(cargo);
			PEBT_APP_INDV_Cargo[] cargos = (PEBT_APP_INDV_Cargo[]) requestDetailsCollection
					.select(FwConstants.DAO, "findByAppNumber");
			if (cargos.length > 0) {
				retCargo = cargos;
			}
		} catch (Exception ex) {
			log(ILog.ERROR, "Exception in ABRegistrationBO.getPEBTAppINDVs:: "
					+ ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::getPEBTAppINDVs::End");
		return retCargo;
	}
	
	public PEBTAppCreationResponseSet constructRequestAndCallPEBTWebService(String pebtAppNum, String bridgesPEBTAppNum) throws Exception {
		log(ILog.INFO, "ABRegistrationBO::constructRequestAndCallPEBTWebService::Start"+ pebtAppNum);
		PEBTAppCreationResponseSet webServiceResponseSet = null;
		try{
			String webServiceURL = FwConfigurationManager.getInstance().getEnvironmentProperty(AppConstants.PEBT_IES_WEBSERVICE_URL);
			PEBTAppCreationRequest[] pebtAppCreationReqeustArray = buildPEBTAppCreationRequest(pebtAppNum, bridgesPEBTAppNum);
			webServiceResponseSet = CallWebService.callPEBTAppCreationWebService(webServiceURL, pebtAppCreationReqeustArray);
		}catch (Exception ex){
			log(ILog.ERROR, "Exception in ABRegistrationBO.constructRequestAndCallPEBTWebService:: "
					+ ex.getMessage());
			throw ex;
		}
		log(ILog.INFO, "ABRegistrationBO::constructRequestAndCallPEBTWebService::End" + pebtAppNum);
		return webServiceResponseSet;
	}
	
	public void updatePEBTAppRqstStatus(PEBT_APP_RQST_Collection pebtAppRqstColl) throws Exception {
		try{
			log(ILog.INFO, "ABRegistrationBO::updatePEBTAppRqstStatus::Start");
			if(pebtAppRqstColl != null && pebtAppRqstColl.size() > 0){
				pebtAppRqstColl.persist(FwConstants.DAO);
			}
			log(ILog.INFO, "ABRegistrationBO::updatePEBTAppRqstStatus::End");
		} catch(Exception ex) {
			log(ILog.ERROR, "Exception in ABRegistrationBO.updatePEBTAppRqstStatus:: " + ex.getMessage());
			throw ex;
		}
	}
	
	public void updateECFStatusForPEBTApp(String aAppNum, String aStatus) {
		try {
			log(ILog.INFO, "ABRegistrationBO::updateECFStatusForPEBTApp::Start");
			Map criteria = new HashMap();
			criteria.put(FwConstants.SQL_IND, "sql-PEBT04");
			FwDataCriteria[] dataCriteria = new FwDataCriteria[2];
			dataCriteria[0] = new FwDataCriteria();
			dataCriteria[0].setColumn_value(aStatus);
			dataCriteria[0].setData_type(FwConstants.STRING);
			dataCriteria[1] = new FwDataCriteria();
			dataCriteria[1].setColumn_value(aAppNum);
			dataCriteria[1].setData_type(FwConstants.STRING);
			criteria.put(FwConstants.CRITERIA, dataCriteria);
			List result = executeSQL(criteria);
			int updateCount = Integer.parseInt((String)result.get(0));
			if(updateCount==0){
				FwException fe = createFwException(this.getClass().getName(), "updateECFStatusForPEBTApp", new Exception("No records updated"));
				throw fe;	
			}
			log(ILog.INFO, "ABRegistrationBO::updateECFStatusForPEBTApp::End");
		} catch(Exception ex){
			log(ILog.ERROR, "Exception in ABRegistrationBO.updateECFStatusForPEBTApp:: " + ex.getMessage());
			FwException objFwExp = createFwException(this.getClass().getName(),"Exception in ABRegistrationBO - updateECFStatusForPEBTApp()", ex);
			objFwExp.setMethodID("updateECFStatusForPEBTApp()");
			objFwExp.setStackTrace(ex.getStackTrace());
			objFwExp.setExceptionText("Exception occurred while updating PEBT ECF Status "+aAppNum);			
			throw objFwExp;
		}
	}
	
	//Added by Nancy Jain for ILIES-282238 : Remove values from session.
	public void clearSessionOfWarningMsgOnSaveAndExitFunc(Map session){
		if (session.get(FwConstants.WARNING_MESAGE_BEFORE_SAVE_AND_EXIT) != null) {
			session.remove(FwConstants.WARNING_MESAGE_BEFORE_SAVE_AND_EXIT);
		}
		if (session.get(FwConstants.BEFORE_FIRST_COLLECTION_TO_COMPARE) != null) {
			session.remove(FwConstants.BEFORE_FIRST_COLLECTION_TO_COMPARE);
		}
		if (session.get(FwConstants.BEFORE_SECOND_COLLECTION_TO_COMPARE) != null) {
			session.remove(FwConstants.BEFORE_SECOND_COLLECTION_TO_COMPARE);
		}
		if (session.get(FwConstants.BEFORE_THIRD_COLLECTION_TO_COMPARE) != null) {
			session.remove(FwConstants.BEFORE_THIRD_COLLECTION_TO_COMPARE);
		}
		if (session.get(FwConstants.BEFORE_FOURTH_COLLECTION_TO_COMPARE) != null) {
			session.remove(FwConstants.BEFORE_FOURTH_COLLECTION_TO_COMPARE);
		}
	}
	//ILIES-282238 changes end here
	
	public void updateDsapAppRqstStatus(APP_DSNAP_RQST_Collection dsnapAppRqstColl) throws Exception {
		try{
			log(ILog.INFO, "ABRegistrationBO::updateDsapAppRqstStatus::Start");
			if(dsnapAppRqstColl != null && dsnapAppRqstColl.size() > 0){
				dsnapAppRqstColl.persist(FwConstants.DAO);
			}
			log(ILog.INFO, "ABRegistrationBO::updateDsapAppRqstStatus::End");
		} catch(Exception ex) {
			log(ILog.ERROR, "Exception in updateDsapAppRqstStatus:: " + ex.getMessage());
			throw ex;
		}
	}
	
public FwMessageList validateAPRDRScreen(APP_RGST_Cargo appRgstCargo, String disChargDt, String curPageId, String prePageId, String indvId) {
		
		try
	    { 
		  if(StringUtils.isEmpty(indvId) || "0".equalsIgnoreCase(indvId) || indvId.length() <= 2 )
		  {
			this.addMessageCode("99266");
			return getMessageList();
		  }
	      char[] specialChars = { '#', '/', '\'', '-', '(', ')', '@', '_', ',', '.', ' ' };
	      //char[] specialCharsAddress = { '.','/','-','#',' ','\'',',' };
	      char[] specialCharsAddress = {'.','/','-','#',' ','\''} ;
	      //added in order to accept '-' '\'' Hyphen & Apostrophe for First Name and Last Name on the Registration Page JIRA #129702	      
	      //to see if user has entered a physical address or mailing address (for homeless check) ILIES-69318
	      boolean enteredPhysicalAddr = true;
	      boolean enteredMailingAddr = true;  
	      boolean homeLessflag = false;
	      //HOMELESS
	      if ((appRgstCargo.getHless_sw() != null) && (appRgstCargo.getHless_sw().equals("Y")))
	      {
	        homeLessflag = true;
	        validateMailingAddress(appRgstCargo);
	      }else if (!(this.appMgr.isFieldEmpty(appRgstCargo.getAlt_st_adr())) || !(this.appMgr.isFieldEmpty(appRgstCargo.getAlt_l2_adr())) || !(this.appMgr.isFieldEmpty(appRgstCargo.getAlt_city_adr())) || !(this.appMgr.isFieldEmpty(appRgstCargo.getAlt_zip_adr()))){
	    	  validateMailingAddress(appRgstCargo);
	      }
	      
	      //STREET ADDRESS IN THE WHERE YOU LIVE SECTION
	      if ((this.appMgr.isFieldEmpty(appRgstCargo.getHshl_l1_adr())) && (this.appMgr.isFieldEmpty(appRgstCargo.getHshl_l2_adr())))
	      {
	    	  enteredPhysicalAddr = false;
	        if (!homeLessflag) {
	         /* Object[] error = { new FwMessageTextLabel(AppConstants.ID_31279) };
	          //Street Address in the Where You Live section
	          addMessageWithFieldValues(AppConstants.ID_10000, error);*/
	        	this.addMessageCode("99308");
	        }
	      }
	      else if (!this.appMgr.isSpecialAlphaNumeric(appRgstCargo.getHshl_l1_adr(),specialCharsAddress) || !this.appMgr.isSpecialAlphaNumeric(appRgstCargo.getHshl_l2_adr(),specialCharsAddress))
	      {
	    	  enteredPhysicalAddr = false;
	        Object[] error = { new FwMessageTextLabel("180017143") };
	        //Please be sure to type only letters and/or numbers for the ~. You may also use periods, commas or any of these characters: # / ' and -.
	        addMessageWithFieldValues("99314", error);
	      }
	      
	      if(!validPhysicalLine1AndLine2APADR(appRgstCargo)){
	    	  enteredPhysicalAddr = false;
	      }
	      
	      //CITY IN THE WHERE YOU LIVE SECTION
	      if (this.appMgr.isFieldEmpty(appRgstCargo.getHshl_city_adr())) {
	    	  enteredPhysicalAddr = false;
	        if (!homeLessflag) {
	          Object[] error = { new FwMessageTextLabel("180017144") };
	          //City in the Where You Live section
	          addMessageWithFieldValues("99318", error);
	        }
	      } else if (!this.appMgr.isAlphaWithSpace(appRgstCargo.getHshl_city_adr()))
	      {
	    	  enteredPhysicalAddr = false;
	        Object[] error = { new FwMessageTextLabel("180017144") };
	        //Please be sure to type only letters or spaces for the ~.
	        addMessageWithFieldValues(AppConstants.ID_95098, error);
	      }
	      //STATE IN THE WHERE YOU LIVE SECTION
	      //needs to be changed to only allow IL state
	      if ((this.appMgr.isFieldEmpty(appRgstCargo.getHshl_sta_adr())) || (appRgstCargo.getHshl_sta_adr().equals("AA")))
	      {
	    	  enteredPhysicalAddr = false;
	        if (!homeLessflag) {
	          Object[] error = { new FwMessageTextLabel("180017145") };
	          //Please choose your State in the Where You Live section.
	          addMessageWithFieldValues(AppConstants.ID_10008, error);
	        }
	      } else if (!appRgstCargo.getHshl_sta_adr().equals("IL")) {
	    	  if (!homeLessflag){
	        	/*Object[] error = { new FwMessageTextLabel(AppConstants.ID_31282) };
	        	addMessageWithFieldValues(AppConstants.ID_35000, error);*/
	    	  }
	    	  this.addMessageCode("99309");
	      }

	      if (this.appMgr.isFieldEmpty(appRgstCargo.getHshl_zip_adr())) {
	    	  enteredPhysicalAddr = false;
	        if (!homeLessflag) {
	          Object[] error = { new FwMessageTextLabel("180017146") };

	          addMessageWithFieldValues("99318", error);
	        }
	      }
	      else if (!this.appMgr.isInteger(appRgstCargo.getHshl_zip_adr())) {
	    	  enteredPhysicalAddr = false;
	        Object[] error = { new FwMessageTextLabel("180017146") };

	        addMessageWithFieldValues(AppConstants.ID_10010, error);
	      }
	      else if ((appRgstCargo.getHshl_zip_adr().length() != 5) && (appRgstCargo.getHshl_zip_adr().length() != 9))
	      {
	    	  enteredPhysicalAddr = false;
	        Object[] error = { new FwMessageTextLabel("180017146") };

	        addMessageWithFieldValues(AppConstants.ID_20071, error);
	      }else if (!this.appMgr.isZero(appRgstCargo.getHshl_zip_adr()))
	      {
	    	  enteredPhysicalAddr = false;
	        Object[] error = { new FwMessageTextLabel("180017146") };

	        addMessageWithFieldValues(AppConstants.ID_40119, error);
	      }
	      //mailing address check
	      if ((this.appMgr.isFieldEmpty(appRgstCargo.getAlt_st_adr())) || (this.appMgr.isFieldEmpty(appRgstCargo.getAlt_city_adr())) || (this.appMgr.isFieldEmpty(appRgstCargo.getAlt_sta_adr())) ||
	    		  (this.appMgr.isFieldEmpty(appRgstCargo.getAlt_zip_adr()))){
	    	  enteredMailingAddr = false;
	      }
	      if (!this.appMgr.isSpecialAlphaNumeric(appRgstCargo.getAlt_st_adr(),specialCharsAddress)|| !this.appMgr.isSpecialAlphaNumeric(appRgstCargo.getAlt_l2_adr(),specialCharsAddress))
	      {
	    	  enteredMailingAddr = false;
	        //Please be sure to type only letters and/or numbers for the Street Address or P.O. Box number in the Mailing Address section. You may also use periods or any of these characters: # / ' and -.
	    	  addMessageCode("99286");
	      }
		  
	      if (homeLessflag && !enteredMailingAddr && !enteredPhysicalAddr)
	      {
	    		  addMessageCode("20074");
	      }

	      if(!validMailingLine1AndLine2(appRgstCargo)){
	    	  enteredMailingAddr = false;
	      }
	      
	      boolean isPhysicalAddressValid = false;
	      boolean isMailingAddressValid = false;

	      String physicaladdrempty = "novalue";
	      String mailaddrempty = "novalue";
	      
	      if (!(this.appMgr.isFieldEmpty(appRgstCargo.getHshl_l1_adr())) || !(this.appMgr.isFieldEmpty(appRgstCargo.getHshl_l2_adr())) || !(this.appMgr.isFieldEmpty(appRgstCargo.getHshl_city_adr())) || !(this.appMgr.isFieldEmpty(appRgstCargo.getHshl_zip_adr()))){
	    	  if(homeLessflag){
	    		  addMessageCode(AppConstants.ID_36201);  
	    	  }
	      }
	      
	      if(enteredPhysicalAddr){
	    	  boolean physAddrL1 = this.appMgr.isFieldEmpty(appRgstCargo.getHshl_l1_adr());
		      boolean physAddrL2 = this.appMgr.isFieldEmpty(appRgstCargo.getHshl_l2_adr());
		      boolean physAddrCity = this.appMgr.isFieldEmpty(appRgstCargo.getHshl_city_adr());
		      boolean physAddrZip = this.appMgr.isFieldEmpty(appRgstCargo.getHshl_zip_adr());

		      if (((physAddrL1) || (physAddrL2)) && (physAddrCity) && (physAddrZip))
		      {
		        physicaladdrempty = "empty";
		      } else if (!this.appMgr.isSpecialAlphaNumeric(appRgstCargo.getHshl_zip_adr(), specialChars))
		      {
		        physicaladdrempty = "empty";
		      }
		      else {
		        physicaladdrempty = "notempty";
		        isPhysicalAddressValid = isAddressValid(appRgstCargo, true, curPageId, prePageId);
		       if (!isPhysicalAddressValid)
		        {
		          addMessageCode("36200");
		        }else{
		        	if(addrValServiceExp){
		        		addMessageCode(AppConstants.ID_95002);
		        	}
		        }

		      }
	      }

	      if(enteredMailingAddr){
	    	  boolean mailAddrL1 = this.appMgr.isFieldEmpty(appRgstCargo.getAlt_st_adr());
		      boolean mailAddrL2 = this.appMgr.isFieldEmpty(appRgstCargo.getAlt_l2_adr());
		      boolean mailAddrCity = this.appMgr.isFieldEmpty(appRgstCargo.getAlt_city_adr());
		      boolean mailAddrZip = this.appMgr.isFieldEmpty(appRgstCargo.getAlt_zip_adr());

		      if (((mailAddrL1) || (mailAddrL2)) && (mailAddrCity) && (mailAddrZip))
		      {
		        mailaddrempty = "empty";
		      }
		      else if (!this.appMgr.isSpecialAlphaNumeric(appRgstCargo.getAlt_zip_adr(), specialChars))
		      {
		        mailaddrempty = "empty";
		      }
		      else
		      {
		        mailaddrempty = "notempty";
		        if (!addrValServiceExp){
		          isMailingAddressValid = isAddressValid(appRgstCargo, false, curPageId, prePageId);
		          if (!isMailingAddressValid)
		          {
		          addMessageCode("36202");
		          }else{
		        	  if(addrValServiceExp){
		        		  addMessageCode("95002");
		        	  }
		          }
		       }
		      }
	      }

	     
	      if ((!this.appMgr.isFieldEmpty(appRgstCargo.getHshl_email_adr())) && 
	  	        (!this.appMgr.isEmail(appRgstCargo.getHshl_email_adr()))) {
	  	        addMessageCode(AppConstants.PERSON_LARGE_ALT);
	  	      }
			if ((!this.appMgr.isFieldEmpty(appRgstCargo.gethshlConfirmemailAdr())) && 
		  	        (!this.appMgr.isEmail(appRgstCargo.gethshlConfirmemailAdr()))) {
		  	        addMessageCode(AppConstants.PERSON_LARGE_ALT);
			}
	  	      if (!this.appMgr.isFieldEmpty(appRgstCargo.getHshl_home_phn_num())) {
	  	        if (!this.appMgr.isInteger(appRgstCargo.getHshl_home_phn_num().replaceAll("\\s+",""))) {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_30238) };

	  	          addMessageWithFieldValues(AppConstants.ID_90402, error);
	  	        } else if (!this.appMgr.validatePhone(appRgstCargo.getHshl_home_phn_num()))
	  	        {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_30238) };

	  	          addMessageWithFieldValues(AppConstants.ID_20048, error);
	  	        } else if (!this.appMgr.isZero(appRgstCargo.getHshl_home_phn_num().substring(0,3))){
	  	        	Object[] error = { new FwMessageTextLabel(AppConstants.ID_30238) };
	  	        	addMessageWithFieldValues(AppConstants.ID_35001, error);
	  	        }
	  	      }

	  	      if (!this.appMgr.isFieldEmpty(appRgstCargo.getHshl_cell_phn_num())) {
	  	        if (!this.appMgr.isInteger(appRgstCargo.getHshl_cell_phn_num().replaceAll("\\s+",""))) {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_30240) };

	  	          addMessageWithFieldValues(AppConstants.ID_90402, error);
	  	        } else if (!this.appMgr.validatePhone(appRgstCargo.getHshl_cell_phn_num()))
	  	        {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_30240) };

	  	          addMessageWithFieldValues(AppConstants.ID_20048, error);
	  	        } else if (!this.appMgr.isZero(appRgstCargo.getHshl_cell_phn_num().substring(0,3))){
	  	        	Object[] error = { new FwMessageTextLabel(AppConstants.ID_30240) };
	  	        	addMessageWithFieldValues(AppConstants.ID_35001, error);
	  	        }
	  	      }

	  	      if (!this.appMgr.isFieldEmpty(appRgstCargo.getHshl_work_phn_num())) {
	  	        if (!this.appMgr.isInteger(appRgstCargo.getHshl_work_phn_num().replaceAll("\\s+",""))) {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_30239) };

	  	          addMessageWithFieldValues(AppConstants.ID_90402, error);
	  	        } else if (!this.appMgr.validatePhone(appRgstCargo.getHshl_work_phn_num()))
	  	        {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_30239) };

	  	          addMessageWithFieldValues(AppConstants.ID_20048, error);
	  	        } else if (!this.appMgr.isZero(appRgstCargo.getHshl_work_phn_num().substring(0,3))){
	  	        	Object[] error = { new FwMessageTextLabel(AppConstants.ID_30239) };
	  	        	addMessageWithFieldValues(AppConstants.ID_35001, error);
	  	        }

	  	      }

	  	      if (!this.appMgr.isFieldEmpty(appRgstCargo.getMsg_phn_num())) {
	  	        if (!this.appMgr.isInteger(appRgstCargo.getMsg_phn_num().replaceAll("\\s+",""))) {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_1800060) };

	  	          addMessageWithFieldValues(AppConstants.ID_90402, error);
	  	        } else if (!this.appMgr.validatePhone(appRgstCargo.getMsg_phn_num())) {
	  	          Object[] error = { new FwMessageTextLabel(AppConstants.ID_1800060) };

	  	          addMessageWithFieldValues(AppConstants.ID_20048, error);
	  	        } else if (!this.appMgr.isZero(appRgstCargo.getMsg_phn_num().substring(0,3))){
	  	        	Object[] error = { new FwMessageTextLabel(AppConstants.ID_30238) };
	  	        	addMessageWithFieldValues(AppConstants.ID_35001, error);
	  	        }
	  	      }

	  	      if ((!this.appMgr.isFieldEmpty(appRgstCargo.getWork_phn_extn_num())) && 
	  	        (!this.appMgr.isInteger(appRgstCargo.getWork_phn_extn_num()))) {
	  	    	  	Object[] error = { new FwMessageTextLabel(AppConstants.ID_30553) };
	  	        	addMessageWithFieldValues(AppConstants.ID_90402, error);
	  	      }else if(appRgstCargo.getWork_phn_extn_num().length() > 6){
	  		        Object[] error = { new FwMessageTextLabel(AppConstants.ID_30553) };
	  		        addMessageWithFieldValues(AppConstants.ID_95100, error);	    	  
	  	      }

	  	      if ((!this.appMgr.isFieldEmpty(appRgstCargo.getMsg_phn_extn_num())) && 
	  	        (!this.appMgr.isInteger(appRgstCargo.getMsg_phn_extn_num()))) {
	  	        Object[] error = { new FwMessageTextLabel(AppConstants.ID_30554) };

	  	        addMessageWithFieldValues(AppConstants.ID_90402, error);
	  	      }
	  	      
	  	      //- validation for Phone for text reminders
	  	      String phoneForTextReminders = appRgstCargo.getPhn_txt_typ_cd();
	  	      if(phoneForTextReminders!=null && !"NN".equalsIgnoreCase(phoneForTextReminders) && phoneForTextReminders.trim().length()>0) {
	  	    	  if( (phoneForTextReminders.equalsIgnoreCase("HP") && this.appMgr.isFieldEmpty(appRgstCargo.getHshl_home_phn_num())) ||
	  	    		  (phoneForTextReminders.equalsIgnoreCase("CP") && this.appMgr.isFieldEmpty(appRgstCargo.getHshl_cell_phn_num())) ||
	  	    		  (phoneForTextReminders.equalsIgnoreCase("AP") && this.appMgr.isFieldEmpty(appRgstCargo.getMsg_phn_num()))  ) {
	  	    		  		addMessageCode("99210");
	  	    	  }
	  	      }
	  	    if(!(appRgstCargo.gethshlConfirmemailAdr()).trim().equals(appRgstCargo.getHshl_email_adr().trim())){
				  this.addMessageCode("97016");
			  }
	  	    
	  	    boolean projValidDate = true;
	  	  if( !appMgr.validateDate(disChargDt)){
	  		    projValidDate = false;
				this.addMessageCode("99306");
			}
			SimpleDateFormat dateFormat = new SimpleDateFormat("MM/dd/yyyy");
			if (projValidDate) {
				java.util.Date today = dateFormat.parse(dateFormat.format(new java.util.Date()));
				java.util.Date checkProjDate = (java.util.Date) dateFormat.parse(disChargDt);
				if (today == null || checkProjDate == null) {
					log(ILog.DEBUG, "returning due to null in the above dates");
				} else {
					log(ILog.DEBUG,
							"validateAPRDRScreen::checkProjDate::" + checkProjDate + "::today::" + today);
					if (checkProjDate.after(today)) {
						this.addMessageCode("99307"); // future date
					}
				}
			}
	  	  
	  	      
	      return getMessageList();
	    } catch (FwException fe) {
	    	log(ILog.ERROR,
					"FwException validateAPRDRScreen failed - stackTrace - " + fe.getStackTrace() + " - message - " + fe.getMessage() + " - cause - " + 
	    	fe.getCause()+"-FwException-"+fe);
	      throw fe;
	    } catch (Exception e) {
	    	log(ILog.ERROR,
					"Exception validateAPRDRScreen failed - stackTrace - " + e.getStackTrace() + " - message - " + e.getMessage() + " - cause - " + 
	    	e.getCause()+"-Exception-"+e);
	      throw createFwException(getClass().getName(), "validateAPRDRScreen", e);
	    } 
   }
		
	public boolean checkForAPADRSkipValidation(FwMessageList messageList) {
		log(ILog.DEBUG, "::checkForSkipValidation::Starts");
		try {// add loggers.
			int messageListSize = 0;
			if (messageList != null)
				messageListSize = messageList.getMessageListSize();
			boolean skipvalidation = false;
			for (int i = 0; i < messageListSize; i++) {
				if ("36200".equalsIgnoreCase(messageList.getMessageAtIndex(i).getMessageCode())
						|| "36202".equalsIgnoreCase(messageList.getMessageAtIndex(i).getMessageCode())) {
					// skipvalidation true only if there is only address
					// invalidation only
					skipvalidation = true;
				} else {
					skipvalidation = false;
					break;
				}
			}

			log(ILog.DEBUG, "::checkForSkipValidation::Ends");
			return skipvalidation;
		} catch (FwException fe) {
			log(ILog.ERROR,
					"FwException checkForSkipValidation failed - stackTrace - " + fe.getStackTrace() + " - message - " + fe.getMessage() + " - cause - " + 
	    	fe.getCause()+"-FwException-"+fe);
			throw fe;
		} catch (Exception e) {
			FwException fe = createFwException(this.getClass().getName(), "checkForSkipValidation", e);
			log(ILog.ERROR,
					"Exception checkForSkipValidation failed - stackTrace - " + fe.getStackTrace() + " - message - " + fe.getMessage() + " - cause - " + 
	    	fe.getCause()+"-Exception-"+e);
			throw fe;
		}
	}
	
}